/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e,t,n={4184:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var s=o.apply(null,n);s&&e.push(s)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var a in n)r.call(n,a)&&n[a]&&e.push(a)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},1424:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(8081),o=n.n(r),i=n(3645),s=n.n(i)()(o());s.push([e.id,"body {\n  margin: 0;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\ncode {\n  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',\n    monospace;\n}\n",""]);const a=s},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);r&&s[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},681:(e,t,n)=>{e.exports={graphlib:n(574),layout:n(8123),debug:n(7570),util:{time:n(1138).time,notime:n(1138).notime},version:n(8177)}},2188:(e,t,n)=>{"use strict";var r=n(8436),o=n(4079);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?o(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},o={};return r.forEach(e.nodes(),(function i(s){r.has(o,s)||(o[s]=!0,n[s]=!0,r.forEach(e.outEdges(s),(function(e){r.has(n,e.w)?t.push(e):i(e.w)})),delete n[s])})),t}(e);r.forEach(t,(function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"))}))},undo:function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}}},1133:(e,t,n)=>{var r=n(8436),o=n(1138);function i(e,t,n,r,i,s){var a={width:0,height:0,rank:s,borderType:t},c=i[t][s-1],l=o.addDummyNode(e,"border",a,n);i[t][s]=l,e.setParent(l,r),c&&e.setEdge(c,l,{weight:1})}e.exports=function(e){r.forEach(e.children(),(function t(n){var o=e.children(n),s=e.node(n);if(o.length&&r.forEach(o,t),r.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var a=s.minRank,c=s.maxRank+1;a<c;++a)i(e,"borderLeft","_bl",n,s,a),i(e,"borderRight","_br",n,s,a)}}))}},3258:(e,t,n)=>{"use strict";var r=n(8436);function o(e){r.forEach(e.nodes(),(function(t){i(e.node(t))})),r.forEach(e.edges(),(function(t){i(e.edge(t))}))}function i(e){var t=e.width;e.width=e.height,e.height=t}function s(e){e.y=-e.y}function a(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||o(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){r.forEach(e.nodes(),(function(t){s(e.node(t))})),r.forEach(e.edges(),(function(t){var n=e.edge(t);r.forEach(n.points,s),r.has(n,"y")&&s(n)}))}(e),"lr"!==t&&"rl"!==t||(function(e){r.forEach(e.nodes(),(function(t){a(e.node(t))})),r.forEach(e.edges(),(function(t){var n=e.edge(t);r.forEach(n.points,a),r.has(n,"x")&&a(n)}))}(e),o(e))}}},7822:e=>{function t(){var e={};e._next=e._prev=e,this._sentinel=e}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function r(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=t,t.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t},t.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&n(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},t.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,r)),n=n._prev;return"["+e.join(", ")+"]"}},7570:(e,t,n)=>{var r=n(8436),o=n(1138),i=n(574).Graph;e.exports={debugOrdering:function(e){var t=o.buildLayerMatrix(e),n=new i({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),(function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)})),r.forEach(e.edges(),(function(e){n.setEdge(e.v,e.w,{},e.name)})),r.forEach(t,(function(e,t){var o="layer"+t;n.setNode(o,{rank:"same"}),r.reduce(e,(function(e,t){return n.setEdge(e,t,{style:"invis"}),t}))})),n}}},574:(e,t,n)=>{var r;try{r=n(8282)}catch(e){}r||(r=window.graphlib),e.exports=r},4079:(e,t,n)=>{var r=n(8436),o=n(574).Graph,i=n(7822);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new o,s=0,a=0;r.forEach(e.nodes(),(function(e){n.setNode(e,{v:e,in:0,out:0})})),r.forEach(e.edges(),(function(e){var r=n.edge(e.v,e.w)||0,o=t(e),i=r+o;n.setEdge(e.v,e.w,i),a=Math.max(a,n.node(e.v).out+=o),s=Math.max(s,n.node(e.w).in+=o)}));var l=r.range(a+s+3).map((function(){return new i})),u=s+1;return r.forEach(n.nodes(),(function(e){c(l,u,n.node(e))})),{graph:n,buckets:l,zeroIdx:u}}(e,t||s),l=function(e,t,n){for(var r,o=[],i=t[t.length-1],s=t[0];e.nodeCount();){for(;r=s.dequeue();)a(e,t,n,r);for(;r=i.dequeue();)a(e,t,n,r);if(e.nodeCount())for(var c=t.length-2;c>0;--c)if(r=t[c].dequeue()){o=o.concat(a(e,t,n,r,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(l,(function(t){return e.outEdges(t.v,t.w)})),!0)};var s=r.constant(1);function a(e,t,n,o,i){var s=i?[]:void 0;return r.forEach(e.inEdges(o.v),(function(r){var o=e.edge(r),a=e.node(r.v);i&&s.push({v:r.v,w:r.w}),a.out-=o,c(t,n,a)})),r.forEach(e.outEdges(o.v),(function(r){var o=e.edge(r),i=r.w,s=e.node(i);s.in-=o,c(t,n,s)})),e.removeNode(o.v),s}function c(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}},8123:(e,t,n)=>{"use strict";var r=n(8436),o=n(2188),i=n(5995),s=n(8093),a=n(1138).normalizeRanks,c=n(4219),l=n(1138).removeEmptyRanks,u=n(2981),d=n(1133),h=n(3258),p=n(3408),f=n(7873),g=n(1138),m=n(574).Graph;e.exports=function(e,t){var n=t&&t.debugTiming?g.time:g.notime;n("layout",(function(){var t=n("  buildLayoutGraph",(function(){return function(e){var t=new m({multigraph:!0,compound:!0}),n=E(e.graph());return t.setGraph(r.merge({},y,C(n,_),r.pick(n,w))),r.forEach(e.nodes(),(function(n){var o=E(e.node(n));t.setNode(n,r.defaults(C(o,v),b)),t.setParent(n,e.parent(n))})),r.forEach(e.edges(),(function(n){var o=E(e.edge(n));t.setEdge(n,r.merge({},S,C(o,x),r.pick(o,k)))})),t}(e)}));n("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();t.ranksep/=2,r.forEach(e.edges(),(function(n){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(e)})),t("    removeSelfEdges",(function(){!function(e){r.forEach(e.edges(),(function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e)})),t("    acyclic",(function(){o.run(e)})),t("    nestingGraph.run",(function(){u.run(e)})),t("    rank",(function(){s(g.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),o={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};g.addDummyNode(e,"edge-proxy",o,"_ep")}}))}(e)})),t("    removeEmptyRanks",(function(){l(e)})),t("    nestingGraph.cleanup",(function(){u.cleanup(e)})),t("    normalizeRanks",(function(){a(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;r.forEach(e.nodes(),(function(n){var o=e.node(n);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,t=r.max(t,o.maxRank))})),e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){r.forEach(e.nodes(),(function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(e)})),t("    normalize.run",(function(){i.run(e)})),t("    parentDummyChains",(function(){c(e)})),t("    addBorderSegments",(function(){d(e)})),t("    order",(function(){p(e)})),t("    insertSelfEdges",(function(){!function(e){var t=g.buildLayerMatrix(e);r.forEach(t,(function(t){var n=0;r.forEach(t,(function(t,o){var i=e.node(t);i.order=o+n,r.forEach(i.selfEdges,(function(t){g.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:i.rank,order:o+ ++n,e:t.e,label:t.label},"_se")})),delete i.selfEdges}))}))}(e)})),t("    adjustCoordinateSystem",(function(){h.adjust(e)})),t("    position",(function(){f(e)})),t("    positionSelfEdges",(function(){!function(e){r.forEach(e.nodes(),(function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,s=n.x-o,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{x:o+s,y:i},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}}))}(e)})),t("    removeBorderNodes",(function(){!function(e){r.forEach(e.nodes(),(function(t){if(e.children(t).length){var n=e.node(t),o=e.node(n.borderTop),i=e.node(n.borderBottom),s=e.node(r.last(n.borderLeft)),a=e.node(r.last(n.borderRight));n.width=Math.abs(a.x-s.x),n.height=Math.abs(i.y-o.y),n.x=s.x+n.width/2,n.y=o.y+n.height/2}})),r.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(e)})),t("    normalize.undo",(function(){i.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);if(r.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(e)})),t("    undoCoordinateSystem",(function(){h.undo(e)})),t("    translateGraph",(function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,o=Number.POSITIVE_INFINITY,i=0,s=e.graph(),a=s.marginx||0,c=s.marginy||0;function l(e){var r=e.x,s=e.y,a=e.width,c=e.height;t=Math.min(t,r-a/2),n=Math.max(n,r+a/2),o=Math.min(o,s-c/2),i=Math.max(i,s+c/2)}r.forEach(e.nodes(),(function(t){l(e.node(t))})),r.forEach(e.edges(),(function(t){var n=e.edge(t);r.has(n,"x")&&l(n)})),t-=a,o-=c,r.forEach(e.nodes(),(function(n){var r=e.node(n);r.x-=t,r.y-=o})),r.forEach(e.edges(),(function(n){var i=e.edge(n);r.forEach(i.points,(function(e){e.x-=t,e.y-=o})),r.has(i,"x")&&(i.x-=t),r.has(i,"y")&&(i.y-=o)})),s.width=n-t+a,s.height=i-o+c}(e)})),t("    assignNodeIntersects",(function(){!function(e){r.forEach(e.edges(),(function(t){var n,r,o=e.edge(t),i=e.node(t.v),s=e.node(t.w);o.points?(n=o.points[0],r=o.points[o.points.length-1]):(o.points=[],n=s,r=i),o.points.unshift(g.intersectRect(i,n)),o.points.push(g.intersectRect(s,r))}))}(e)})),t("    reversePoints",(function(){!function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);n.reversed&&n.points.reverse()}))}(e)})),t("    acyclic.undo",(function(){o.undo(e)}))}(t,n)})),n("  updateInputGraph",(function(){!function(e,t){r.forEach(e.nodes(),(function(n){var r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,t.children(n).length&&(r.width=o.width,r.height=o.height))})),r.forEach(e.edges(),(function(n){var o=e.edge(n),i=t.edge(n);o.points=i.points,r.has(i,"x")&&(o.x=i.x,o.y=i.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))};var _=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],v=["width","height"],b={width:0,height:0},x=["minlen","weight","width","height","labeloffset"],S={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},k=["labelpos"];function C(e,t){return r.mapValues(r.pick(e,t),Number)}function E(e){var t={};return r.forEach(e,(function(e,n){t[n.toLowerCase()]=e})),t}},8436:(e,t,n)=>{var r;try{r={cloneDeep:n(361),constant:n(5703),defaults:n(1747),each:n(6073),filter:n(3105),find:n(3311),flatten:n(5564),forEach:n(4486),forIn:n(2620),has:n(8721),isUndefined:n(2353),last:n(928),map:n(5161),mapValues:n(6604),max:n(6162),merge:n(3857),min:n(3632),minBy:n(2762),now:n(7771),pick:n(9722),range:n(6026),reduce:n(4061),sortBy:n(9734),uniqueId:n(3955),values:n(2628),zipObject:n(7287)}}catch(e){}r||(r=window._),e.exports=r},2981:(e,t,n)=>{var r=n(8436),o=n(1138);function i(e,t,n,s,a,c,l){var u=e.children(l);if(u.length){var d=o.addBorderNode(e,"_bt"),h=o.addBorderNode(e,"_bb"),p=e.node(l);e.setParent(d,l),p.borderTop=d,e.setParent(h,l),p.borderBottom=h,r.forEach(u,(function(r){i(e,t,n,s,a,c,r);var o=e.node(r),u=o.borderTop?o.borderTop:r,p=o.borderBottom?o.borderBottom:r,f=o.borderTop?s:2*s,g=u!==p?1:a-c[l]+1;e.setEdge(d,u,{weight:f,minlen:g,nestingEdge:!0}),e.setEdge(p,h,{weight:f,minlen:g,nestingEdge:!0})})),e.parent(l)||e.setEdge(t,d,{weight:0,minlen:a+c[l]})}else l!==t&&e.setEdge(t,l,{weight:0,minlen:n})}e.exports={run:function(e){var t=o.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(o,i){var s=e.children(o);s&&s.length&&r.forEach(s,(function(e){n(e,i+1)})),t[o]=i}return r.forEach(e.children(),(function(e){n(e,1)})),t}(e),s=r.max(r.values(n))-1,a=2*s+1;e.graph().nestingRoot=t,r.forEach(e.edges(),(function(t){e.edge(t).minlen*=a}));var c=function(e){return r.reduce(e.edges(),(function(t,n){return t+e.edge(n).weight}),0)}(e)+1;r.forEach(e.children(),(function(r){i(e,t,a,c,s,n,r)})),e.graph().nodeRankFactor=a},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}}},5995:(e,t,n)=>{"use strict";var r=n(8436),o=n(1138);e.exports={run:function(e){e.graph().dummyChains=[],r.forEach(e.edges(),(function(t){!function(e,t){var n,r,i,s=t.v,a=e.node(s).rank,c=t.w,l=e.node(c).rank,u=t.name,d=e.edge(t),h=d.labelRank;if(l!==a+1){for(e.removeEdge(t),i=0,++a;a<l;++i,++a)d.points=[],r={width:0,height:0,edgeLabel:d,edgeObj:t,rank:a},n=o.addDummyNode(e,"edge",r,"_d"),a===h&&(r.width=d.width,r.height=d.height,r.dummy="edge-label",r.labelpos=d.labelpos),e.setEdge(s,n,{weight:d.weight},u),0===i&&e.graph().dummyChains.push(n),s=n;e.setEdge(s,c,{weight:d.weight},u)}}(e,t)}))},undo:function(e){r.forEach(e.graph().dummyChains,(function(t){var n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)}))}}},5093:(e,t,n)=>{var r=n(8436);e.exports=function(e,t,n){var o,i={};r.forEach(n,(function(n){for(var r,s,a=e.parent(n);a;){if((r=e.parent(a))?(s=i[r],i[r]=a):(s=o,o=a),s&&s!==a)return void t.setEdge(s,a);a=r}}))}},5439:(e,t,n)=>{var r=n(8436);e.exports=function(e,t){return r.map(t,(function(t){var n=e.inEdges(t);if(n.length){var o=r.reduce(n,(function(t,n){var r=e.edge(n),o=e.node(n.v);return{sum:t.sum+r.weight*o.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:o.sum/o.weight,weight:o.weight}}return{v:t}}))}},3128:(e,t,n)=>{var r=n(8436),o=n(574).Graph;e.exports=function(e,t,n){var i=function(e){for(var t;e.hasNode(t=r.uniqueId("_root")););return t}(e),s=new o({compound:!0}).setGraph({root:i}).setDefaultNodeLabel((function(t){return e.node(t)}));return r.forEach(e.nodes(),(function(o){var a=e.node(o),c=e.parent(o);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(o),s.setParent(o,c||i),r.forEach(e[n](o),(function(t){var n=t.v===o?t.w:t.v,i=s.edge(n,o),a=r.isUndefined(i)?0:i.weight;s.setEdge(n,o,{weight:e.edge(t).weight+a})})),r.has(a,"minRank")&&s.setNode(o,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))})),s}},6630:(e,t,n)=>{"use strict";var r=n(8436);function o(e,t,n){for(var o=r.zipObject(n,r.map(n,(function(e,t){return t}))),i=r.flatten(r.map(t,(function(t){return r.sortBy(r.map(e.outEdges(t),(function(t){return{pos:o[t.w],weight:e.edge(t).weight}})),"pos")})),!0),s=1;s<n.length;)s<<=1;var a=2*s-1;s-=1;var c=r.map(new Array(a),(function(){return 0})),l=0;return r.forEach(i.forEach((function(e){var t=e.pos+s;c[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=c[t+1]),c[t=t-1>>1]+=e.weight;l+=e.weight*n}))),l}e.exports=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=o(e,t[r-1],t[r]);return n}},3408:(e,t,n)=>{"use strict";var r=n(8436),o=n(2588),i=n(6630),s=n(1026),a=n(3128),c=n(5093),l=n(574).Graph,u=n(1138);function d(e,t,n){return r.map(t,(function(t){return a(e,t,n)}))}function h(e,t){var n=new l;r.forEach(e,(function(e){var o=e.graph().root,i=s(e,o,n,t);r.forEach(i.vs,(function(t,n){e.node(t).order=n})),c(e,n,i.vs)}))}function p(e,t){r.forEach(t,(function(t){r.forEach(t,(function(t,n){e.node(t).order=n}))}))}e.exports=function(e){var t=u.maxRank(e),n=d(e,r.range(1,t+1),"inEdges"),s=d(e,r.range(t-1,-1,-1),"outEdges"),a=o(e);p(e,a);for(var c,l=Number.POSITIVE_INFINITY,f=0,g=0;g<4;++f,++g){h(f%2?n:s,f%4>=2),a=u.buildLayerMatrix(e);var m=i(e,a);m<l&&(g=0,c=r.cloneDeep(a),l=m)}p(e,c)}},2588:(e,t,n)=>{"use strict";var r=n(8436);e.exports=function(e){var t={},n=r.filter(e.nodes(),(function(t){return!e.children(t).length})),o=r.max(r.map(n,(function(t){return e.node(t).rank}))),i=r.map(r.range(o+1),(function(){return[]})),s=r.sortBy(n,(function(t){return e.node(t).rank}));return r.forEach(s,(function n(o){if(!r.has(t,o)){t[o]=!0;var s=e.node(o);i[s.rank].push(o),r.forEach(e.successors(o),n)}})),i}},9567:(e,t,n)=>{"use strict";var r=n(8436);e.exports=function(e,t){var n={};return r.forEach(e,(function(e,t){var o=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(o.barycenter=e.barycenter,o.weight=e.weight)})),r.forEach(t.edges(),(function(e){var t=n[e.v],o=n[e.w];r.isUndefined(t)||r.isUndefined(o)||(o.indegree++,t.out.push(n[e.w]))})),function(e){var t=[];function n(e){return function(t){var n,o,i,s;t.merged||(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&(o=t,i=0,s=0,(n=e).weight&&(i+=n.barycenter*n.weight,s+=n.weight),o.weight&&(i+=o.barycenter*o.weight,s+=o.weight),n.vs=o.vs.concat(n.vs),n.barycenter=i/s,n.weight=s,n.i=Math.min(o.i,n.i),o.merged=!0)}}function o(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),r.forEach(i.in.reverse(),n(i)),r.forEach(i.out,o(i))}return r.map(r.filter(t,(function(e){return!e.merged})),(function(e){return r.pick(e,["vs","i","barycenter","weight"])}))}(r.filter(n,(function(e){return!e.indegree})))}},1026:(e,t,n)=>{var r=n(8436),o=n(5439),i=n(9567),s=n(7304);e.exports=function e(t,n,a,c){var l=t.children(n),u=t.node(n),d=u?u.borderLeft:void 0,h=u?u.borderRight:void 0,p={};d&&(l=r.filter(l,(function(e){return e!==d&&e!==h})));var f=o(t,l);r.forEach(f,(function(n){if(t.children(n.v).length){var o=e(t,n.v,a,c);p[n.v]=o,r.has(o,"barycenter")&&(i=n,s=o,r.isUndefined(i.barycenter)?(i.barycenter=s.barycenter,i.weight=s.weight):(i.barycenter=(i.barycenter*i.weight+s.barycenter*s.weight)/(i.weight+s.weight),i.weight+=s.weight))}var i,s}));var g=i(f,a);!function(e,t){r.forEach(e,(function(e){e.vs=r.flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})),!0)}))}(g,p);var m=s(g,c);if(d&&(m.vs=r.flatten([d,m.vs,h],!0),t.predecessors(d).length)){var _=t.node(t.predecessors(d)[0]),y=t.node(t.predecessors(h)[0]);r.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+_.order+y.order)/(m.weight+2),m.weight+=2}return m}},7304:(e,t,n)=>{var r=n(8436),o=n(1138);function i(e,t,n){for(var o;t.length&&(o=r.last(t)).i<=n;)t.pop(),e.push(o.vs),n++;return n}e.exports=function(e,t){var n,s=o.partition(e,(function(e){return r.has(e,"barycenter")})),a=s.lhs,c=r.sortBy(s.rhs,(function(e){return-e.i})),l=[],u=0,d=0,h=0;a.sort((n=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i})),h=i(l,c,h),r.forEach(a,(function(e){h+=e.vs.length,l.push(e.vs),u+=e.barycenter*e.weight,d+=e.weight,h=i(l,c,h)}));var p={vs:r.flatten(l,!0)};return d&&(p.barycenter=u/d,p.weight=d),p}},4219:(e,t,n)=>{var r=n(8436);e.exports=function(e){var t=function(e){var t={},n=0;return r.forEach(e.children(),(function o(i){var s=n;r.forEach(e.children(i),o),t[i]={low:s,lim:n++}})),t}(e);r.forEach(e.graph().dummyChains,(function(n){for(var r=e.node(n),o=r.edgeObj,i=function(e,t,n,r){var o,i,s=[],a=[],c=Math.min(t[n].low,t[r].low),l=Math.max(t[n].lim,t[r].lim);o=n;do{o=e.parent(o),s.push(o)}while(o&&(t[o].low>c||l>t[o].lim));for(i=o,o=r;(o=e.parent(o))!==i;)a.push(o);return{path:s.concat(a.reverse()),lca:i}}(e,t,o.v,o.w),s=i.path,a=i.lca,c=0,l=s[c],u=!0;n!==o.w;){if(r=e.node(n),u){for(;(l=s[c])!==a&&e.node(l).maxRank<r.rank;)c++;l===a&&(u=!1)}if(!u){for(;c<s.length-1&&e.node(l=s[c+1]).minRank<=r.rank;)c++;l=s[c]}e.setParent(n,l),n=e.successors(n)[0]}}))}},3573:(e,t,n)=>{"use strict";var r=n(8436),o=n(574).Graph,i=n(1138);function s(e,t){var n={};return r.reduce(t,(function(t,o){var i=0,s=0,a=t.length,l=r.last(o);return r.forEach(o,(function(t,u){var d=function(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),(function(t){return e.node(t).dummy}))}(e,t),h=d?e.node(d).order:a;(d||t===l)&&(r.forEach(o.slice(s,u+1),(function(t){r.forEach(e.predecessors(t),(function(r){var o=e.node(r),s=o.order;!(s<i||h<s)||o.dummy&&e.node(t).dummy||c(n,r,t)}))})),s=u+1,i=h)})),o})),n}function a(e,t){var n={};function o(t,o,i,s,a){var l;r.forEach(r.range(o,i),(function(o){l=t[o],e.node(l).dummy&&r.forEach(e.predecessors(l),(function(t){var r=e.node(t);r.dummy&&(r.order<s||r.order>a)&&c(n,t,l)}))}))}return r.reduce(t,(function(t,n){var i,s=-1,a=0;return r.forEach(n,(function(r,c){if("border"===e.node(r).dummy){var l=e.predecessors(r);l.length&&(i=e.node(l[0]).order,o(n,a,c,s,i),a=c,s=i)}o(n,a,n.length,i,t.length)})),n})),n}function c(e,t,n){if(t>n){var r=t;t=n,n=r}var o=e[t];o||(e[t]=o={}),o[n]=!0}function l(e,t,n){if(t>n){var o=t;t=n,n=o}return r.has(e[t],n)}function u(e,t,n,o){var i={},s={},a={};return r.forEach(t,(function(e){r.forEach(e,(function(e,t){i[e]=e,s[e]=e,a[e]=t}))})),r.forEach(t,(function(e){var t=-1;r.forEach(e,(function(e){var c=o(e);if(c.length){c=r.sortBy(c,(function(e){return a[e]}));for(var u=(c.length-1)/2,d=Math.floor(u),h=Math.ceil(u);d<=h;++d){var p=c[d];s[e]===e&&t<a[p]&&!l(n,e,p)&&(s[p]=e,s[e]=i[e]=i[p],t=a[p])}}}))})),{root:i,align:s}}function d(e,t,n,i,s){var a={},c=function(e,t,n,i){var s=new o,a=e.graph(),c=function(e,t,n){return function(o,i,s){var a,c=o.node(i),l=o.node(s),u=0;if(u+=c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=-c.width/2;break;case"r":a=c.width/2}if(a&&(u+=n?a:-a),a=0,u+=(c.dummy?t:e)/2,u+=(l.dummy?t:e)/2,u+=l.width/2,r.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":a=l.width/2;break;case"r":a=-l.width/2}return a&&(u+=n?a:-a),a=0,u}}(a.nodesep,a.edgesep,i);return r.forEach(t,(function(t){var o;r.forEach(t,(function(t){var r=n[t];if(s.setNode(r),o){var i=n[o],a=s.edge(i,r);s.setEdge(i,r,Math.max(c(e,t,o),a||0))}o=t}))})),s}(e,t,n,s),l=s?"borderLeft":"borderRight";function u(e,t){for(var n=c.nodes(),r=n.pop(),o={};r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return u((function(e){a[e]=c.inEdges(e).reduce((function(e,t){return Math.max(e,a[t.v]+c.edge(t))}),0)}),c.predecessors.bind(c)),u((function(t){var n=c.outEdges(t).reduce((function(e,t){return Math.min(e,a[t.w]-c.edge(t))}),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==l&&(a[t]=Math.max(a[t],n))}),c.successors.bind(c)),r.forEach(i,(function(e){a[e]=a[n[e]]})),a}function h(e,t){return r.minBy(r.values(t),(function(t){var n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return r.forIn(t,(function(t,r){var i=function(e,t){return e.node(t).width}(e,r)/2;n=Math.max(t+i,n),o=Math.min(t-i,o)})),n-o}))}function p(e,t){var n=r.values(t),o=r.min(n),i=r.max(n);r.forEach(["u","d"],(function(n){r.forEach(["l","r"],(function(s){var a,c=n+s,l=e[c];if(l!==t){var u=r.values(l);(a="l"===s?o-r.min(u):i-r.max(u))&&(e[c]=r.mapValues(l,(function(e){return e+a})))}}))}))}function f(e,t){return r.mapValues(e.ul,(function(n,o){if(t)return e[t.toLowerCase()][o];var i=r.sortBy(r.map(e,o));return(i[1]+i[2])/2}))}e.exports={positionX:function(e){var t,n=i.buildLayerMatrix(e),o=r.merge(s(e,n),a(e,n)),c={};r.forEach(["u","d"],(function(i){t="u"===i?n:r.values(n).reverse(),r.forEach(["l","r"],(function(n){"r"===n&&(t=r.map(t,(function(e){return r.values(e).reverse()})));var s=("u"===i?e.predecessors:e.successors).bind(e),a=u(0,t,o,s),l=d(e,t,a.root,a.align,"r"===n);"r"===n&&(l=r.mapValues(l,(function(e){return-e}))),c[i+n]=l}))}));var l=h(e,c);return p(c,l),f(c,e.graph().align)},findType1Conflicts:s,findType2Conflicts:a,addConflict:c,hasConflict:l,verticalAlignment:u,horizontalCompaction:d,alignCoordinates:p,findSmallestWidthAlignment:h,balance:f}},7873:(e,t,n)=>{"use strict";var r=n(8436),o=n(1138),i=n(3573).positionX;e.exports=function(e){(function(e){var t=o.buildLayerMatrix(e),n=e.graph().ranksep,i=0;r.forEach(t,(function(t){var o=r.max(r.map(t,(function(t){return e.node(t).height})));r.forEach(t,(function(t){e.node(t).y=i+o/2})),i+=o+n}))})(e=o.asNonCompoundGraph(e)),r.forEach(i(e),(function(t,n){e.node(n).x=t}))}},8457:(e,t,n)=>{"use strict";var r=n(8436),o=n(574).Graph,i=n(6681).slack;function s(e,t){return r.forEach(e.nodes(),(function n(o){r.forEach(t.nodeEdges(o),(function(r){var s=r.v,a=o===s?r.w:s;e.hasNode(a)||i(t,r)||(e.setNode(a,{}),e.setEdge(o,a,{}),n(a))}))})),e.nodeCount()}function a(e,t){return r.minBy(t.edges(),(function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return i(t,n)}))}function c(e,t,n){r.forEach(e.nodes(),(function(e){t.node(e).rank+=n}))}e.exports=function(e){var t,n,r=new o({directed:!1}),l=e.nodes()[0],u=e.nodeCount();for(r.setNode(l,{});s(r,e)<u;)t=a(r,e),n=r.hasNode(t.v)?i(e,t):-i(e,t),c(r,e,n);return r}},8093:(e,t,n)=>{"use strict";var r=n(6681).longestPath,o=n(8457),i=n(2472);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:!function(e){i(e)}(e);break;case"tight-tree":!function(e){r(e),o(e)}(e);break;case"longest-path":s(e)}};var s=r},2472:(e,t,n)=>{"use strict";var r=n(8436),o=n(8457),i=n(6681).slack,s=n(6681).longestPath,a=n(574).alg.preorder,c=n(574).alg.postorder,l=n(1138).simplify;function u(e){e=l(e),s(e);var t,n=o(e);for(p(n),d(n,e);t=g(n);)_(n,e,t,m(n,e,t))}function d(e,t){var n=c(e,e.nodes());n=n.slice(0,n.length-1),r.forEach(n,(function(n){!function(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=h(e,t,n)}(e,t,n)}))}function h(e,t,n){var o=e.node(n).parent,i=!0,s=t.edge(n,o),a=0;return s||(i=!1,s=t.edge(o,n)),a=s.weight,r.forEach(t.nodeEdges(n),(function(r){var s,c,l=r.v===n,u=l?r.w:r.v;if(u!==o){var d=l===i,h=t.edge(r).weight;if(a+=d?h:-h,s=n,c=u,e.hasEdge(s,c)){var p=e.edge(n,u).cutvalue;a+=d?-p:p}}})),a}function p(e,t){arguments.length<2&&(t=e.nodes()[0]),f(e,{},1,t)}function f(e,t,n,o,i){var s=n,a=e.node(o);return t[o]=!0,r.forEach(e.neighbors(o),(function(i){r.has(t,i)||(n=f(e,t,n,i,o))})),a.low=s,a.lim=n++,i?a.parent=i:delete a.parent,n}function g(e){return r.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function m(e,t,n){var o=n.v,s=n.w;t.hasEdge(o,s)||(o=n.w,s=n.v);var a=e.node(o),c=e.node(s),l=a,u=!1;a.lim>c.lim&&(l=c,u=!0);var d=r.filter(t.edges(),(function(t){return u===y(0,e.node(t.v),l)&&u!==y(0,e.node(t.w),l)}));return r.minBy(d,(function(e){return i(t,e)}))}function _(e,t,n,o){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(o.v,o.w,{}),p(e),d(e,t),function(e,t){var n=r.find(e.nodes(),(function(e){return!t.node(e).parent})),o=a(e,n);o=o.slice(1),r.forEach(o,(function(n){var r=e.node(n).parent,o=t.edge(n,r),i=!1;o||(o=t.edge(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)}))}(e,t)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e.exports=u,u.initLowLimValues=p,u.initCutValues=d,u.calcCutValue=h,u.leaveEdge=g,u.enterEdge=m,u.exchangeEdges=_},6681:(e,t,n)=>{"use strict";var r=n(8436);e.exports={longestPath:function(e){var t={};r.forEach(e.sources(),(function n(o){var i=e.node(o);if(r.has(t,o))return i.rank;t[o]=!0;var s=r.min(r.map(e.outEdges(o),(function(t){return n(t.w)-e.edge(t).minlen})));return s!==Number.POSITIVE_INFINITY&&null!=s||(s=0),i.rank=s}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},1138:(e,t,n)=>{"use strict";var r=n(8436),o=n(574).Graph;function i(e,t,n,o){var i;do{i=r.uniqueId(o)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function s(e){return r.max(r.map(e.nodes(),(function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n})))}e.exports={addDummyNode:i,simplify:function(e){var t=(new o).setGraph(e.graph());return r.forEach(e.nodes(),(function(n){t.setNode(n,e.node(n))})),r.forEach(e.edges(),(function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})})),t},asNonCompoundGraph:function(e){var t=new o({multigraph:e.isMultigraph()}).setGraph(e.graph());return r.forEach(e.nodes(),(function(n){e.children(n).length||t.setNode(n,e.node(n))})),r.forEach(e.edges(),(function(n){t.setEdge(n,e.edge(n))})),t},successorWeights:function(e){var t=r.map(e.nodes(),(function(t){var n={};return r.forEach(e.outEdges(t),(function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight})),n}));return r.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=r.map(e.nodes(),(function(t){var n={};return r.forEach(e.inEdges(t),(function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight})),n}));return r.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,o=e.x,i=e.y,s=t.x-o,a=t.y-i,c=e.width/2,l=e.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(a)*c>Math.abs(s)*l?(a<0&&(l=-l),n=l*s/a,r=l):(s<0&&(c=-c),n=c,r=c*a/s),{x:o+n,y:i+r}},buildLayerMatrix:function(e){var t=r.map(r.range(s(e)+1),(function(){return[]}));return r.forEach(e.nodes(),(function(n){var o=e.node(n),i=o.rank;r.isUndefined(i)||(t[i][o.order]=n)})),t},normalizeRanks:function(e){var t=r.min(r.map(e.nodes(),(function(t){return e.node(t).rank})));r.forEach(e.nodes(),(function(n){var o=e.node(n);r.has(o,"rank")&&(o.rank-=t)}))},removeEmptyRanks:function(e){var t=r.min(r.map(e.nodes(),(function(t){return e.node(t).rank}))),n=[];r.forEach(e.nodes(),(function(r){var o=e.node(r).rank-t;n[o]||(n[o]=[]),n[o].push(r)}));var o=0,i=e.graph().nodeRankFactor;r.forEach(n,(function(t,n){r.isUndefined(t)&&n%i!=0?--o:o&&r.forEach(t,(function(t){e.node(t).rank+=o}))}))},addBorderNode:function(e,t,n,r){var o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),i(e,"border",o,t)},maxRank:s,partition:function(e,t){var n={lhs:[],rhs:[]};return r.forEach(e,(function(e){t(e)?n.lhs.push(e):n.rhs.push(e)})),n},time:function(e,t){var n=r.now();try{return t()}finally{console.log(e+" time: "+(r.now()-n)+"ms")}},notime:function(e,t){return t()}}},8177:e=>{e.exports="0.8.5"},1785:function(e,t){var n,r;n=function(){function e(e,t,n,r,o,i,s,a){(e=document.createElement("canvas")).width=n,e.height=r;var c=e.getContext("2d");return c.mozImageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.webkitImageSmoothingEnabled=!0,c.msImageSmoothingEnabled=!0,c.imageSmoothingEnabled=!0,c.drawImage(t,o,i,s,a,0,0,n,r),e}function t(e){return e+.49<<0}function n(e,n,r,o,i,s,a){for(var c=new ImageData(n,r),l=new Int32Array(e.data.buffer),u=e.width,d=new Int32Array(c.data.buffer),h=c.width,p=n/s,f=r/a,g=t(1/p),m=t(1/f),_=g*m,y=0;y<c.height;y++)for(var w=0;w<h;w++){for(var v=o+t(w/p)+(i+t(y/f))*u,b=0,x=0,S=0,k=0,C=0;C<m;C++)for(var E=0;E<g;E++){var A=l[v+E+C*u];b+=A<<24>>>24,x+=A<<16>>>24,S+=A<<8>>>24,k+=A>>>24}b=t(b/_),x=t(x/_),S=t(S/_),k=t(k/_),d[w+y*h]=k<<24|S<<16|x<<8|b}return c}function r(e,t){return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e}function o(e,t,n,r,o,i){var s=o,a=i,c=o/i;0===e&&(e=t*c>>0),0===t&&(t=e/c>>0);var l=e/t;return l>c?i=o/l>>0:o=i*l>>0,{destWidth:e,destHeight:t,sourceX:n=n||(s-o)/2>>0,sourceY:r=r||(a-i)/2>>0,sourceWidth:o,sourceHeight:i}}function i(e,t,n){t.returnCanvas?n(e):t.returnBlob?e.toBlob(n,"image/"+(t.imageType||"jpeg"),t.quality||.85):n(e.toDataURL("image/"+(t.imageType||"jpeg"),t.quality||.85))}function s(e,t){e.complete?t():e.addEventListener("load",t)}function a(e){return e instanceof File?"File":e instanceof HTMLImageElement?"HTMLImageElement":e instanceof HTMLVideoElement?"HTMLVideoElement":"string"==typeof e?"URL":void 0}return function t(c,l,u,d){var h,p,f=function(e,t,n,r){var o=new Date,i={},s=o,a="01";return{mark:e?function(e){i[e=a+". "+(e||"...")]={"time (ms)":new Date-s},s=new Date,a=("0"+(1+(a>>0))).substr(-2)}:new Function,finish:e?function(){i[a+" TOTAL"]={"time (ms)":new Date-o},console.log("IMAGE SOURCE:",t),console.log("DOWNSCALE TO:",n+"x"+r),console.table(i)}:new Function}}(d&&d.debug||!1,c,l,u),g=(p=arguments).length<3?new TypeError("3 arguments required, but only "+p.length+" present."):a(p[0])?"number"!=typeof p[1]?new TypeError("Second argument should be a number"):"number"!=typeof p[2]?new TypeError("Third argument should be a number"):void 0:new TypeError("First argument should be HTMLImageElement, HTMLVideoElement, File of String");if(g instanceof TypeError)return Promise.reject(g);d=d||{};var m,_,y,w,v=new Promise((function(e,t){h=e}));t.canvas=t.canvas||document.createElement("canvas"),t.cache=t.cache||(m=[],_=[],y=[],w=new Object,{createSetter:function(e){if(!this.get(e)){var t=m.push(e)-1;return _.push(w),y.push([]),function(e){_[t]=e,y[t]=y[t].reduce((function(t,n){n(e)}),[])}}},get:function(e,t){var n=m.indexOf(e);~n&&(_[n]!==w?t(_[n]):y[n].push(t))},has:function(e){return!!~m.indexOf(e)}});var b=t.canvas,x=t.cache;if(x.has(c))return f.mark(),x.get(c,(function(t){f.mark("PENDING CACHE");var s=t[0],a=t[1],c=o(l,u,d.sourceX,d.sourceY,a.width,a.height);if(c.sourceWidth/c.destWidth>=2&&c.sourceHeight/c.destHeight>=2){f.mark();var p=n(a,c.destWidth,c.destHeight,c.sourceX,c.sourceY,c.sourceWidth,c.sourceHeight);f.mark("DOWNSCALE"),b=r(b,p)}else b=e(b,s,c.destWidth,c.destHeight,c.sourceX,c.sourceY,c.sourceWidth,c.sourceHeight),f.mark("RESIZE WITH CANVAS");i(b,d,(function(e){f.mark("PRODUCE RESULT"),h(e),f.finish()}))})),v;var S,k,C=function(t,s,c){var p=o(l,u,d.sourceX,d.sourceY,s,c);if(p.sourceWidth/p.destWidth>=2&&p.sourceHeight/p.destHeight>=2){f.mark();var g=function(e,t,n,r){e.width=n,e.height=r;var o=e.getContext("2d");return o.drawImage(t,0,0),o.getImageData(0,0,n,r)}(b,t,s,c);f.mark("GET IMAGE DATA");var m=n(g,p.destWidth,p.destHeight,p.sourceX,p.sourceY,p.sourceWidth,p.sourceHeight);f.mark("DOWNSCALE"),b=r(b,m),"HTMLVideoElement"!==a(t)&&x.createSetter(t)([t,g])}else b=e(b,t,p.destWidth,p.destHeight,p.sourceX,p.sourceY,p.sourceWidth,p.sourceHeight),f.mark("RESIZE WITH CANVAS");i(b,d,(function(e){f.mark("PRODUCE RESULT"),h(e),f.finish()}))},E=window.URL||window.webkitURL;switch(a(c)){case"File":var A=document.createElement("img");f.mark(),A.src=E.createObjectURL(c),f.mark("READ FILE"),s(A,(function(){f.mark("LOAD IMAGE"),C(A,A.naturalWidth,A.naturalHeight)}));break;case"HTMLImageElement":f.mark(),s(c,(function(){f.mark("LOAD IMAGE"),C(c,c.naturalWidth,c.naturalHeight)}));break;case"HTMLVideoElement":k=function(){C(c,c.videoWidth,c.videoHeight)},(S=c).readyState>1?k():S.addEventListener("loadeddata",k);break;case"URL":f.mark(),setTimeout((function(){!function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="arraybuffer",n.addEventListener("load",(function(){t(this.response)})),n.send()}(c,(function(e){f.mark("LOAD ARRAY BUFFER");var t=new Uint8Array(e),n=new Blob([t],{type:"image/jpeg"}),r=document.createElement("img");r.src=E.createObjectURL(n),f.mark(),s(r,(function(){f.mark("LOAD IMAGE"),C(r,r.naturalWidth,r.naturalHeight)}))}))}))}return v}},void 0===(r=n.apply(t,[]))||(e.exports=r)},6729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,o),!0;case 5:return u.fn.call(u.context,t,r,o,i),!0;case 6:return u.fn.call(u.context,t,r,o,i,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,o);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||o&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[i]=1===l.length?l[0]:l:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},8282:(e,t,n)=>{var r=n(2354);e.exports={Graph:r.Graph,json:n(8974),alg:n(2440),version:r.version}},2842:(e,t,n)=>{var r=n(9126);e.exports=function(e){var t,n={},o=[];function i(o){r.has(n,o)||(n[o]=!0,t.push(o),r.each(e.successors(o),i),r.each(e.predecessors(o),i))}return r.each(e.nodes(),(function(e){t=[],i(e),t.length&&o.push(t)})),o}},3984:(e,t,n)=>{var r=n(9126);function o(e,t,n,i,s,a){r.has(i,t)||(i[t]=!0,n||a.push(t),r.each(s(t),(function(t){o(e,t,n,i,s,a)})),n&&a.push(t))}e.exports=function(e,t,n){r.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),s=[],a={};return r.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);o(e,t,"post"===n,a,i,s)})),s}},4847:(e,t,n)=>{var r=n(3763),o=n(9126);e.exports=function(e,t,n){return o.transform(e.nodes(),(function(o,i){o[i]=r(e,i,t,n)}),{})}},3763:(e,t,n)=>{var r=n(9126),o=n(9675);e.exports=function(e,t,n,r){return function(e,t,n,r){var i,s,a={},c=new o,l=function(e){var t=e.v!==i?e.v:e.w,r=a[t],o=n(e),l=s.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+o);l<r.distance&&(r.distance=l,r.predecessor=i,c.decrease(t,l))};for(e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},c.add(e,n)}));c.size()>0&&(i=c.removeMin(),(s=a[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(l);return a}(e,String(t),n||i,r||function(t){return e.outEdges(t)})};var i=r.constant(1)},9096:(e,t,n)=>{var r=n(9126),o=n(5023);e.exports=function(e){return r.filter(o(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))}},8924:(e,t,n)=>{var r=n(9126);e.exports=function(e,t,n){return function(e,t,n){var r={},o=e.nodes();return o.forEach((function(e){r[e]={},r[e][e]={distance:0},o.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var o=n.v===e?n.w:n.v,i=t(n);r[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var t=r[e];o.forEach((function(n){var i=r[n];o.forEach((function(n){var r=i[e],o=t[n],s=i[n],a=r.distance+o.distance;a<s.distance&&(s.distance=a,s.predecessor=o.predecessor)}))}))})),r}(e,t||o,n||function(t){return e.outEdges(t)})};var o=r.constant(1)},2440:(e,t,n)=>{e.exports={components:n(2842),dijkstra:n(3763),dijkstraAll:n(4847),findCycles:n(9096),floydWarshall:n(8924),isAcyclic:n(2707),postorder:n(3308),preorder:n(2648),prim:n(514),tarjan:n(5023),topsort:n(2166)}},2707:(e,t,n)=>{var r=n(2166);e.exports=function(e){try{r(e)}catch(e){if(e instanceof r.CycleException)return!1;throw e}return!0}},3308:(e,t,n)=>{var r=n(3984);e.exports=function(e,t){return r(e,t,"post")}},2648:(e,t,n)=>{var r=n(3984);e.exports=function(e,t){return r(e,t,"pre")}},514:(e,t,n)=>{var r=n(9126),o=n(771),i=n(9675);e.exports=function(e,t){var n,s=new o,a={},c=new i;function l(e){var r=e.v===n?e.w:e.v,o=c.priority(r);if(void 0!==o){var i=t(e);i<o&&(a[r]=n,c.decrease(r,i))}}if(0===e.nodeCount())return s;r.each(e.nodes(),(function(e){c.add(e,Number.POSITIVE_INFINITY),s.setNode(e)})),c.decrease(e.nodes()[0],0);for(var u=!1;c.size()>0;){if(n=c.removeMin(),r.has(a,n))s.setEdge(n,a[n]);else{if(u)throw new Error("Input graph is not connected: "+e);u=!0}e.nodeEdges(n).forEach(l)}return s}},5023:(e,t,n)=>{var r=n(9126);e.exports=function(e){var t=0,n=[],o={},i=[];function s(a){var c=o[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){r.has(o,e)?o[e].onStack&&(c.lowlink=Math.min(c.lowlink,o[e].index)):(s(e),c.lowlink=Math.min(c.lowlink,o[e].lowlink))})),c.lowlink===c.index){var l,u=[];do{l=n.pop(),o[l].onStack=!1,u.push(l)}while(a!==l);i.push(u)}}return e.nodes().forEach((function(e){r.has(o,e)||s(e)})),i}},2166:(e,t,n)=>{var r=n(9126);function o(e){var t={},n={},o=[];if(r.each(e.sinks(),(function s(a){if(r.has(n,a))throw new i;r.has(t,a)||(n[a]=!0,t[a]=!0,r.each(e.predecessors(a),s),delete n[a],o.push(a))})),r.size(t)!==e.nodeCount())throw new i;return o}function i(){}e.exports=o,o.CycleException=i,i.prototype=new Error},9675:(e,t,n)=>{var r=n(9126);function o(){this._arr=[],this._keyIndices={}}e.exports=o,o.prototype.size=function(){return this._arr.length},o.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},o.prototype.has=function(e){return r.has(this._keyIndices,e)},o.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},o.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},o.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!r.has(n,e)){var o=this._arr,i=o.length;return n[e]=i,o.push({key:e,priority:t}),this._decrease(i),!0}return!1},o.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},o.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},o.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))},o.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},o.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t}},771:(e,t,n)=>{"use strict";var r=n(9126);e.exports=a;var o="\0",i="\0",s="";function a(e){this._isDirected=!r.has(e,"directed")||e.directed,this._isMultigraph=!!r.has(e,"multigraph")&&e.multigraph,this._isCompound=!!r.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[i]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function c(e,t){e[t]?e[t]++:e[t]=1}function l(e,t){--e[t]||delete e[t]}function u(e,t,n,i){var a=""+t,c=""+n;if(!e&&a>c){var l=a;a=c,c=l}return a+s+c+s+(r.isUndefined(i)?o:i)}function d(e,t){return u(e,t.v,t.w,t.name)}a.prototype._nodeCount=0,a.prototype._edgeCount=0,a.prototype.isDirected=function(){return this._isDirected},a.prototype.isMultigraph=function(){return this._isMultigraph},a.prototype.isCompound=function(){return this._isCompound},a.prototype.setGraph=function(e){return this._label=e,this},a.prototype.graph=function(){return this._label},a.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this},a.prototype.nodeCount=function(){return this._nodeCount},a.prototype.nodes=function(){return r.keys(this._nodes)},a.prototype.sources=function(){var e=this;return r.filter(this.nodes(),(function(t){return r.isEmpty(e._in[t])}))},a.prototype.sinks=function(){var e=this;return r.filter(this.nodes(),(function(t){return r.isEmpty(e._out[t])}))},a.prototype.setNodes=function(e,t){var n=arguments,o=this;return r.each(e,(function(e){n.length>1?o.setNode(e,t):o.setNode(e)})),this},a.prototype.setNode=function(e,t){return r.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=i,this._children[e]={},this._children[i][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},a.prototype.node=function(e){return this._nodes[e]},a.prototype.hasNode=function(e){return r.has(this._nodes,e)},a.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},a.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t=i;else{for(var n=t+="";!r.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},a.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},a.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==i)return t}},a.prototype.children=function(e){if(r.isUndefined(e)&&(e=i),this._isCompound){var t=this._children[e];if(t)return r.keys(t)}else{if(e===i)return this.nodes();if(this.hasNode(e))return[]}},a.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t)},a.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t)},a.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e))},a.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},a.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;r.each(this._nodes,(function(n,r){e(r)&&t.setNode(r,n)})),r.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var o={};function i(e){var r=n.parent(e);return void 0===r||t.hasNode(r)?(o[e]=r,r):r in o?o[r]:i(r)}return this._isCompound&&r.each(t.nodes(),(function(e){t.setParent(e,i(e))})),t},a.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this},a.prototype.edgeCount=function(){return this._edgeCount},a.prototype.edges=function(){return r.values(this._edgeObjs)},a.prototype.setPath=function(e,t){var n=this,o=arguments;return r.reduce(e,(function(e,r){return o.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r})),this},a.prototype.setEdge=function(){var e,t,n,o,i=!1,s=arguments[0];"object"==typeof s&&null!==s&&"v"in s?(e=s.v,t=s.w,n=s.name,2===arguments.length&&(o=arguments[1],i=!0)):(e=s,t=arguments[1],n=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var a=u(this._isDirected,e,t,n);if(r.has(this._edgeLabels,a))return i&&(this._edgeLabels[a]=o),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[a]=i?o:this._defaultEdgeLabelFn(e,t,n);var l=function(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}var a={v:o,w:i};return r&&(a.name=r),a}(this._isDirected,e,t,n);return e=l.v,t=l.w,Object.freeze(l),this._edgeObjs[a]=l,c(this._preds[t],e),c(this._sucs[e],t),this._in[t][a]=l,this._out[e][a]=l,this._edgeCount++,this},a.prototype.edge=function(e,t,n){var r=1===arguments.length?d(this._isDirected,arguments[0]):u(this._isDirected,e,t,n);return this._edgeLabels[r]},a.prototype.hasEdge=function(e,t,n){var o=1===arguments.length?d(this._isDirected,arguments[0]):u(this._isDirected,e,t,n);return r.has(this._edgeLabels,o)},a.prototype.removeEdge=function(e,t,n){var r=1===arguments.length?d(this._isDirected,arguments[0]):u(this._isDirected,e,t,n),o=this._edgeObjs[r];return o&&(e=o.v,t=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],l(this._preds[t],e),l(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},a.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var o=r.values(n);return t?r.filter(o,(function(e){return e.v===t})):o}},a.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var o=r.values(n);return t?r.filter(o,(function(e){return e.w===t})):o}},a.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},2354:(e,t,n)=>{e.exports={Graph:n(771),version:n(9631)}},8974:(e,t,n)=>{var r=n(9126),o=n(771);function i(e){return r.map(e.nodes(),(function(t){var n=e.node(t),o=e.parent(t),i={v:t};return r.isUndefined(n)||(i.value=n),r.isUndefined(o)||(i.parent=o),i}))}function s(e){return r.map(e.edges(),(function(t){var n=e.edge(t),o={v:t.v,w:t.w};return r.isUndefined(t.name)||(o.name=t.name),r.isUndefined(n)||(o.value=n),o}))}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:i(e),edges:s(e)};return r.isUndefined(e.graph())||(t.value=r.clone(e.graph())),t},read:function(e){var t=new o(e.options).setGraph(e.value);return r.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),r.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}}},9126:(e,t,n)=>{var r;try{r={clone:n(6678),constant:n(5703),each:n(6073),filter:n(3105),has:n(8721),isArray:n(1469),isEmpty:n(1609),isFunction:n(3560),isUndefined:n(2353),keys:n(3674),map:n(5161),reduce:n(4061),size:n(4238),transform:n(8718),union:n(3386),values:n(2628)}}catch(e){}r||(r=window._),e.exports=r},9631:e=>{e.exports="2.1.8"},2307:(e,t,n)=>{e=n.nmd(e);var r="__lodash_hash_undefined__",o=1,i=2,s=9007199254740991,a="[object Arguments]",c="[object Array]",l="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",h="[object Error]",p="[object Function]",f="[object GeneratorFunction]",g="[object Map]",m="[object Number]",_="[object Null]",y="[object Object]",w="[object Promise]",v="[object Proxy]",b="[object RegExp]",x="[object Set]",S="[object String]",k="[object Undefined]",C="[object WeakMap]",E="[object ArrayBuffer]",A="[object DataView]",I=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,M={};M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M[a]=M[c]=M[E]=M[u]=M[A]=M[d]=M[h]=M[p]=M[g]=M[m]=M[y]=M[b]=M[x]=M[S]=M[C]=!1;var T="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,j="object"==typeof self&&self&&self.Object===Object&&self,D=T||j||Function("return this")(),O=t&&!t.nodeType&&t,z=O&&e&&!e.nodeType&&e,F=z&&z.exports===O,R=F&&T.process,L=function(){try{return R&&R.binding&&R.binding("util")}catch(e){}}(),N=L&&L.isTypedArray;function B(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function $(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function U(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var V,W,K,H=Array.prototype,G=Function.prototype,q=Object.prototype,Y=D["__core-js_shared__"],X=G.toString,Z=q.hasOwnProperty,Q=(V=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"",J=q.toString,ee=RegExp("^"+X.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=F?D.Buffer:void 0,ne=D.Symbol,re=D.Uint8Array,oe=q.propertyIsEnumerable,ie=H.splice,se=ne?ne.toStringTag:void 0,ae=Object.getOwnPropertySymbols,ce=te?te.isBuffer:void 0,le=(W=Object.keys,K=Object,function(e){return W(K(e))}),ue=ze(D,"DataView"),de=ze(D,"Map"),he=ze(D,"Promise"),pe=ze(D,"Set"),fe=ze(D,"WeakMap"),ge=ze(Object,"create"),me=Ne(ue),_e=Ne(de),ye=Ne(he),we=Ne(pe),ve=Ne(fe),be=ne?ne.prototype:void 0,xe=be?be.valueOf:void 0;function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ke(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ce(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ee(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ce;++t<n;)this.add(e[t])}function Ae(e){var t=this.__data__=new ke(e);this.size=t.size}function Ie(e,t){for(var n=e.length;n--;)if(Be(e[n][0],t))return n;return-1}function Pe(e){return null==e?void 0===e?k:_:se&&se in Object(e)?function(e){var t=Z.call(e,se),n=e[se];try{e[se]=void 0;var r=!0}catch(e){}var o=J.call(e);return r&&(t?e[se]=n:delete e[se]),o}(e):function(e){return J.call(e)}(e)}function Me(e){return Ge(e)&&Pe(e)==a}function Te(e,t,n,r,s){return e===t||(null==e||null==t||!Ge(e)&&!Ge(t)?e!=e&&t!=t:function(e,t,n,r,s,l){var p=Ue(e),f=Ue(t),_=p?c:Re(e),w=f?c:Re(t),v=(_=_==a?y:_)==y,k=(w=w==a?y:w)==y,C=_==w;if(C&&Ve(e)){if(!Ve(t))return!1;p=!0,v=!1}if(C&&!v)return l||(l=new Ae),p||qe(e)?je(e,t,n,r,s,l):function(e,t,n,r,s,a,c){switch(n){case A:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case E:return!(e.byteLength!=t.byteLength||!a(new re(e),new re(t)));case u:case d:case m:return Be(+e,+t);case h:return e.name==t.name&&e.message==t.message;case b:case S:return e==t+"";case g:var l=$;case x:var p=r&o;if(l||(l=U),e.size!=t.size&&!p)return!1;var f=c.get(e);if(f)return f==t;r|=i,c.set(e,t);var _=je(l(e),l(t),r,s,a,c);return c.delete(e),_;case"[object Symbol]":if(xe)return xe.call(e)==xe.call(t)}return!1}(e,t,_,n,r,s,l);if(!(n&o)){var I=v&&Z.call(e,"__wrapped__"),P=k&&Z.call(t,"__wrapped__");if(I||P){var M=I?e.value():e,T=P?t.value():t;return l||(l=new Ae),s(M,T,n,r,l)}}return!!C&&(l||(l=new Ae),function(e,t,n,r,i,s){var a=n&o,c=De(e),l=c.length;if(l!=De(t).length&&!a)return!1;for(var u=l;u--;){var d=c[u];if(!(a?d in t:Z.call(t,d)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var p=!0;s.set(e,t),s.set(t,e);for(var f=a;++u<l;){var g=e[d=c[u]],m=t[d];if(r)var _=a?r(m,g,d,t,e,s):r(g,m,d,e,t,s);if(!(void 0===_?g===m||i(g,m,n,r,s):_)){p=!1;break}f||(f="constructor"==d)}if(p&&!f){var y=e.constructor,w=t.constructor;y==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof w&&w instanceof w||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,n,r,s,l))}(e,t,n,r,Te,s))}function je(e,t,n,r,s,a){var c=n&o,l=e.length,u=t.length;if(l!=u&&!(c&&u>l))return!1;var d=a.get(e);if(d&&a.get(t))return d==t;var h=-1,p=!0,f=n&i?new Ee:void 0;for(a.set(e,t),a.set(t,e);++h<l;){var g=e[h],m=t[h];if(r)var _=c?r(m,g,h,t,e,a):r(g,m,h,e,t,a);if(void 0!==_){if(_)continue;p=!1;break}if(f){if(!B(t,(function(e,t){if(o=t,!f.has(o)&&(g===e||s(g,e,n,r,a)))return f.push(t);var o}))){p=!1;break}}else if(g!==m&&!s(g,m,n,r,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function De(e){return function(e,t,n){var r=t(e);return Ue(e)?r:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,Ye,Fe)}function Oe(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function ze(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!He(e)||function(e){return!!Q&&Q in e}(e))&&(We(e)?ee:I).test(Ne(e))}(n)?n:void 0}Se.prototype.clear=function(){this.__data__=ge?ge(null):{},this.size=0},Se.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Se.prototype.get=function(e){var t=this.__data__;if(ge){var n=t[e];return n===r?void 0:n}return Z.call(t,e)?t[e]:void 0},Se.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:Z.call(t,e)},Se.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ge&&void 0===t?r:t,this},ke.prototype.clear=function(){this.__data__=[],this.size=0},ke.prototype.delete=function(e){var t=this.__data__,n=Ie(t,e);return!(n<0||(n==t.length-1?t.pop():ie.call(t,n,1),--this.size,0))},ke.prototype.get=function(e){var t=this.__data__,n=Ie(t,e);return n<0?void 0:t[n][1]},ke.prototype.has=function(e){return Ie(this.__data__,e)>-1},ke.prototype.set=function(e,t){var n=this.__data__,r=Ie(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Ce.prototype.clear=function(){this.size=0,this.__data__={hash:new Se,map:new(de||ke),string:new Se}},Ce.prototype.delete=function(e){var t=Oe(this,e).delete(e);return this.size-=t?1:0,t},Ce.prototype.get=function(e){return Oe(this,e).get(e)},Ce.prototype.has=function(e){return Oe(this,e).has(e)},Ce.prototype.set=function(e,t){var n=Oe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Ee.prototype.add=Ee.prototype.push=function(e){return this.__data__.set(e,r),this},Ee.prototype.has=function(e){return this.__data__.has(e)},Ae.prototype.clear=function(){this.__data__=new ke,this.size=0},Ae.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ae.prototype.get=function(e){return this.__data__.get(e)},Ae.prototype.has=function(e){return this.__data__.has(e)},Ae.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ke){var r=n.__data__;if(!de||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ce(r)}return n.set(e,t),this.size=n.size,this};var Fe=ae?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var r=-1,o=null==t?0:t.length,i=0,s=[];++r<o;){var a=t[r];c=a,oe.call(e,c)&&(s[i++]=a)}var c;return s}(ae(e)))}:function(){return[]},Re=Pe;function Le(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||P.test(e))&&e>-1&&e%1==0&&e<t}function Ne(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Be(e,t){return e===t||e!=e&&t!=t}(ue&&Re(new ue(new ArrayBuffer(1)))!=A||de&&Re(new de)!=g||he&&Re(he.resolve())!=w||pe&&Re(new pe)!=x||fe&&Re(new fe)!=C)&&(Re=function(e){var t=Pe(e),n=t==y?e.constructor:void 0,r=n?Ne(n):"";if(r)switch(r){case me:return A;case _e:return g;case ye:return w;case we:return x;case ve:return C}return t});var $e=Me(function(){return arguments}())?Me:function(e){return Ge(e)&&Z.call(e,"callee")&&!oe.call(e,"callee")},Ue=Array.isArray,Ve=ce||function(){return!1};function We(e){if(!He(e))return!1;var t=Pe(e);return t==p||t==f||t==l||t==v}function Ke(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function He(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ge(e){return null!=e&&"object"==typeof e}var qe=N?function(e){return function(t){return e(t)}}(N):function(e){return Ge(e)&&Ke(e.length)&&!!M[Pe(e)]};function Ye(e){return null!=(t=e)&&Ke(t.length)&&!We(t)?function(e,t){var n=Ue(e),r=!n&&$e(e),o=!n&&!r&&Ve(e),i=!n&&!r&&!o&&qe(e),s=n||r||o||i,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=a.length;for(var l in e)!t&&!Z.call(e,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Le(l,c))||a.push(l);return a}(e):function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||q))return le(e);var t,n,r=[];for(var o in Object(e))Z.call(e,o)&&"constructor"!=o&&r.push(o);return r}(e);var t}e.exports=function(e,t){return Te(e,t)}},3096:(e,t,n)=>{var r="Expected a function",o=NaN,i="[object Symbol]",s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,h="object"==typeof self&&self&&self.Object===Object&&self,p=d||h||Function("return this")(),f=Object.prototype.toString,g=Math.max,m=Math.min,_=function(){return p.Date.now()};function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&f.call(e)==i}(e))return o;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=c.test(e);return n||l.test(e)?u(e.slice(2),n?2:8):a.test(e)?o:+e}e.exports=function(e,t,n){var o=!0,i=!0;if("function"!=typeof e)throw new TypeError(r);return y(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),function(e,t,n){var o,i,s,a,c,l,u=0,d=!1,h=!1,p=!0;if("function"!=typeof e)throw new TypeError(r);function f(t){var n=o,r=i;return o=i=void 0,u=t,a=e.apply(r,n)}function v(e){var n=e-l;return void 0===l||n>=t||n<0||h&&e-u>=s}function b(){var e=_();if(v(e))return x(e);c=setTimeout(b,function(e){var n=t-(e-l);return h?m(n,s-(e-u)):n}(e))}function x(e){return c=void 0,p&&o?f(e):(o=i=void 0,a)}function S(){var e=_(),n=v(e);if(o=arguments,i=this,l=e,n){if(void 0===c)return function(e){return u=e,c=setTimeout(b,t),d?f(e):a}(l);if(h)return c=setTimeout(b,t),f(l)}return void 0===c&&(c=setTimeout(b,t)),a}return t=w(t)||0,y(n)&&(d=!!n.leading,s=(h="maxWait"in n)?g(w(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),S.cancel=function(){void 0!==c&&clearTimeout(c),u=0,o=l=i=c=void 0},S.flush=function(){return void 0===c?a:x(_())},S}(e,t,{leading:o,maxWait:t,trailing:i})}},7644:(e,t,n)=>{var r="__lodash_hash_undefined__",o="[object Function]",i="[object GeneratorFunction]",s=/^\[object .+?Constructor\]$/,a="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,l=a||c||Function("return this")();function u(e,t){return!(!e||!e.length)&&function(e,t,n){if(t!=t)return function(e,t,n,r){for(var o=e.length,i=-1;++i<o;)if(t(e[i],i,e))return i;return-1}(e,d);for(var r=-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t)>-1}function d(e){return e!=e}function h(e,t){return e.has(t)}function p(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var f,g=Array.prototype,m=Function.prototype,_=Object.prototype,y=l["__core-js_shared__"],w=(f=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+f:"",v=m.toString,b=_.hasOwnProperty,x=_.toString,S=RegExp("^"+v.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=g.splice,C=z(l,"Map"),E=z(l,"Set"),A=z(Object,"create");function I(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function P(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function T(e){var t=-1,n=e?e.length:0;for(this.__data__=new M;++t<n;)this.add(e[t])}function j(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}I.prototype.clear=function(){this.__data__=A?A(null):{}},I.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},I.prototype.get=function(e){var t=this.__data__;if(A){var n=t[e];return n===r?void 0:n}return b.call(t,e)?t[e]:void 0},I.prototype.has=function(e){var t=this.__data__;return A?void 0!==t[e]:b.call(t,e)},I.prototype.set=function(e,t){return this.__data__[e]=A&&void 0===t?r:t,this},P.prototype.clear=function(){this.__data__=[]},P.prototype.delete=function(e){var t=this.__data__,n=j(t,e);return!(n<0||(n==t.length-1?t.pop():k.call(t,n,1),0))},P.prototype.get=function(e){var t=this.__data__,n=j(t,e);return n<0?void 0:t[n][1]},P.prototype.has=function(e){return j(this.__data__,e)>-1},P.prototype.set=function(e,t){var n=this.__data__,r=j(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},M.prototype.clear=function(){this.__data__={hash:new I,map:new(C||P),string:new I}},M.prototype.delete=function(e){return O(this,e).delete(e)},M.prototype.get=function(e){return O(this,e).get(e)},M.prototype.has=function(e){return O(this,e).has(e)},M.prototype.set=function(e,t){return O(this,e).set(e,t),this},T.prototype.add=T.prototype.push=function(e){return this.__data__.set(e,r),this},T.prototype.has=function(e){return this.__data__.has(e)};var D=E&&1/p(new E([,-0]))[1]==1/0?function(e){return new E(e)}:function(){};function O(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function z(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){if(!F(e)||w&&w in e)return!1;var t=function(e){var t=F(e)?x.call(e):"";return t==o||t==i}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?S:s;return t.test(function(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(n)?n:void 0}function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return e&&e.length?function(e,t,n){var r=-1,o=u,i=e.length,s=!0,a=[],c=a;if(i>=200){var l=D(e);if(l)return p(l);s=!1,o=h,c=new T}else c=a;e:for(;++r<i;){var d=e[r],f=d;if(d=0!==d?d:0,s&&f==f){for(var g=c.length;g--;)if(c[g]===f)continue e;a.push(d)}else o(c,f,n)||(c!==a&&c.push(f),a.push(d))}return a}(e):[]}},8552:(e,t,n)=>{var r=n(852)(n(5639),"DataView");e.exports=r},1989:(e,t,n)=>{var r=n(1789),o=n(401),i=n(7667),s=n(1327),a=n(1866);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},8407:(e,t,n)=>{var r=n(7040),o=n(4125),i=n(2117),s=n(7529),a=n(4705);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},7071:(e,t,n)=>{var r=n(852)(n(5639),"Map");e.exports=r},3369:(e,t,n)=>{var r=n(4785),o=n(1285),i=n(6e3),s=n(9916),a=n(5265);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},3818:(e,t,n)=>{var r=n(852)(n(5639),"Promise");e.exports=r},8525:(e,t,n)=>{var r=n(852)(n(5639),"Set");e.exports=r},8668:(e,t,n)=>{var r=n(3369),o=n(619),i=n(2385);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=o,s.prototype.has=i,e.exports=s},6384:(e,t,n)=>{var r=n(8407),o=n(7465),i=n(3779),s=n(7599),a=n(4758),c=n(4309);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=o,l.prototype.delete=i,l.prototype.get=s,l.prototype.has=a,l.prototype.set=c,e.exports=l},2705:(e,t,n)=>{var r=n(5639).Symbol;e.exports=r},1149:(e,t,n)=>{var r=n(5639).Uint8Array;e.exports=r},577:(e,t,n)=>{var r=n(852)(n(5639),"WeakMap");e.exports=r},6874:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},7412:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},4963:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[o++]=s)}return i}},7443:(e,t,n)=>{var r=n(2118);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},1196:e=>{e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},4636:(e,t,n)=>{var r=n(2545),o=n(5694),i=n(1469),s=n(4144),a=n(5776),c=n(6719),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),u=!n&&o(e),d=!n&&!u&&s(e),h=!n&&!u&&!d&&c(e),p=n||u||d||h,f=p?r(e.length,String):[],g=f.length;for(var m in e)!t&&!l.call(e,m)||p&&("length"==m||d&&("offset"==m||"parent"==m)||h&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,g))||f.push(m);return f}},9932:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},2488:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},2663:e=>{e.exports=function(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}},2908:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},8983:(e,t,n)=>{var r=n(371)("length");e.exports=r},6556:(e,t,n)=>{var r=n(9465),o=n(7813);e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},4865:(e,t,n)=>{var r=n(9465),o=n(7813),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];i.call(e,t)&&o(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},8470:(e,t,n)=>{var r=n(7813);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},4037:(e,t,n)=>{var r=n(8363),o=n(3674);e.exports=function(e,t){return e&&r(t,o(t),e)}},3886:(e,t,n)=>{var r=n(8363),o=n(1704);e.exports=function(e,t){return e&&r(t,o(t),e)}},9465:(e,t,n)=>{var r=n(8777);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},5990:(e,t,n)=>{var r=n(6384),o=n(7412),i=n(4865),s=n(4037),a=n(3886),c=n(4626),l=n(278),u=n(8805),d=n(1911),h=n(8234),p=n(6904),f=n(4160),g=n(3824),m=n(9148),_=n(8517),y=n(1469),w=n(4144),v=n(6688),b=n(3218),x=n(2928),S=n(3674),k=n(1704),C="[object Arguments]",E="[object Function]",A="[object Object]",I={};I[C]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object DataView]"]=I["[object Boolean]"]=I["[object Date]"]=I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Map]"]=I["[object Number]"]=I[A]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object Symbol]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I["[object Error]"]=I[E]=I["[object WeakMap]"]=!1,e.exports=function e(t,n,P,M,T,j){var D,O=1&n,z=2&n,F=4&n;if(P&&(D=T?P(t,M,T,j):P(t)),void 0!==D)return D;if(!b(t))return t;var R=y(t);if(R){if(D=g(t),!O)return l(t,D)}else{var L=f(t),N=L==E||"[object GeneratorFunction]"==L;if(w(t))return c(t,O);if(L==A||L==C||N&&!T){if(D=z||N?{}:_(t),!O)return z?d(t,a(D,t)):u(t,s(D,t))}else{if(!I[L])return T?t:{};D=m(t,L,O)}}j||(j=new r);var B=j.get(t);if(B)return B;j.set(t,D),x(t)?t.forEach((function(r){D.add(e(r,n,P,r,t,j))})):v(t)&&t.forEach((function(r,o){D.set(o,e(r,n,P,o,t,j))}));var $=R?void 0:(F?z?p:h:z?k:S)(t);return o($||t,(function(r,o){$&&(r=t[o=r]),i(D,o,e(r,n,P,o,t,j))})),D}},3118:(e,t,n)=>{var r=n(3218),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},9881:(e,t,n)=>{var r=n(7816),o=n(9291)(r);e.exports=o},6029:(e,t,n)=>{var r=n(3448);e.exports=function(e,t,n){for(var o=-1,i=e.length;++o<i;){var s=e[o],a=t(s);if(null!=a&&(void 0===c?a==a&&!r(a):n(a,c)))var c=a,l=s}return l}},760:(e,t,n)=>{var r=n(9881);e.exports=function(e,t){var n=[];return r(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}},1848:e=>{e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},1078:(e,t,n)=>{var r=n(2488),o=n(7285);e.exports=function e(t,n,i,s,a){var c=-1,l=t.length;for(i||(i=o),a||(a=[]);++c<l;){var u=t[c];n>0&&i(u)?n>1?e(u,n-1,i,s,a):r(a,u):s||(a[a.length]=u)}return a}},8483:(e,t,n)=>{var r=n(5063)();e.exports=r},7816:(e,t,n)=>{var r=n(8483),o=n(3674);e.exports=function(e,t){return e&&r(e,t,o)}},7786:(e,t,n)=>{var r=n(1811),o=n(327);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},8866:(e,t,n)=>{var r=n(2488),o=n(1469);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},4239:(e,t,n)=>{var r=n(2705),o=n(9607),i=n(2333),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},3325:e=>{e.exports=function(e,t){return e>t}},8565:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e,n){return null!=e&&t.call(e,n)}},13:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},2118:(e,t,n)=>{var r=n(1848),o=n(2722),i=n(2351);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,o,n)}},9454:(e,t,n)=>{var r=n(4239),o=n(7005);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},939:(e,t,n)=>{var r=n(2492),o=n(7005);e.exports=function e(t,n,i,s,a){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,i,s,e,a))}},2492:(e,t,n)=>{var r=n(6384),o=n(7114),i=n(8351),s=n(6096),a=n(4160),c=n(1469),l=n(4144),u=n(6719),d="[object Arguments]",h="[object Array]",p="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,g,m,_){var y=c(e),w=c(t),v=y?h:a(e),b=w?h:a(t),x=(v=v==d?p:v)==p,S=(b=b==d?p:b)==p,k=v==b;if(k&&l(e)){if(!l(t))return!1;y=!0,x=!1}if(k&&!x)return _||(_=new r),y||u(e)?o(e,t,n,g,m,_):i(e,t,v,n,g,m,_);if(!(1&n)){var C=x&&f.call(e,"__wrapped__"),E=S&&f.call(t,"__wrapped__");if(C||E){var A=C?e.value():e,I=E?t.value():t;return _||(_=new r),m(A,I,n,g,_)}}return!!k&&(_||(_=new r),s(e,t,n,g,m,_))}},5588:(e,t,n)=>{var r=n(4160),o=n(7005);e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},2958:(e,t,n)=>{var r=n(6384),o=n(939);e.exports=function(e,t,n,i){var s=n.length,a=s,c=!i;if(null==e)return!a;for(e=Object(e);s--;){var l=n[s];if(c&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<a;){var u=(l=n[s])[0],d=e[u],h=l[1];if(c&&l[2]){if(void 0===d&&!(u in e))return!1}else{var p=new r;if(i)var f=i(d,h,u,e,t,p);if(!(void 0===f?o(h,d,3,i,p):f))return!1}}return!0}},2722:e=>{e.exports=function(e){return e!=e}},8458:(e,t,n)=>{var r=n(3560),o=n(5346),i=n(3218),s=n(346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?h:a).test(s(e))}},9221:(e,t,n)=>{var r=n(4160),o=n(7005);e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},9911:(e,t,n)=>{var r=n(4239),o=n(1780),i=n(7005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!s[r(e)]}},7206:(e,t,n)=>{var r=n(1573),o=n(6432),i=n(6557),s=n(1469),a=n(9601);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?o(e[0],e[1]):r(e):a(e)}},280:(e,t,n)=>{var r=n(5726),o=n(6916),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},313:(e,t,n)=>{var r=n(3218),o=n(5726),i=n(3498),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},433:e=>{e.exports=function(e,t){return e<t}},9199:(e,t,n)=>{var r=n(9881),o=n(8612);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}},1573:(e,t,n)=>{var r=n(2958),o=n(1499),i=n(2634);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},6432:(e,t,n)=>{var r=n(939),o=n(7361),i=n(9095),s=n(5403),a=n(9162),c=n(2634),l=n(327);e.exports=function(e,t){return s(e)&&a(t)?c(l(e),t):function(n){var s=o(n,e);return void 0===s&&s===t?i(n,e):r(t,s,3)}}},2980:(e,t,n)=>{var r=n(6384),o=n(6556),i=n(8483),s=n(9783),a=n(3218),c=n(1704),l=n(6390);e.exports=function e(t,n,u,d,h){t!==n&&i(n,(function(i,c){if(h||(h=new r),a(i))s(t,n,c,u,e,d,h);else{var p=d?d(l(t,c),i,c+"",t,n,h):void 0;void 0===p&&(p=i),o(t,c,p)}}),c)}},9783:(e,t,n)=>{var r=n(6556),o=n(4626),i=n(7133),s=n(278),a=n(8517),c=n(5694),l=n(1469),u=n(9246),d=n(4144),h=n(3560),p=n(3218),f=n(8630),g=n(6719),m=n(6390),_=n(3678);e.exports=function(e,t,n,y,w,v,b){var x=m(e,n),S=m(t,n),k=b.get(S);if(k)r(e,n,k);else{var C=v?v(x,S,n+"",e,t,b):void 0,E=void 0===C;if(E){var A=l(S),I=!A&&d(S),P=!A&&!I&&g(S);C=S,A||I||P?l(x)?C=x:u(x)?C=s(x):I?(E=!1,C=o(S,!0)):P?(E=!1,C=i(S,!0)):C=[]:f(S)||c(S)?(C=x,c(x)?C=_(x):p(x)&&!h(x)||(C=a(S))):E=!1}E&&(b.set(S,C),w(C,S,y,v,b),b.delete(S)),r(e,n,C)}}},8921:(e,t,n)=>{var r=n(9932),o=n(7786),i=n(7206),s=n(9199),a=n(1131),c=n(1717),l=n(5022),u=n(6557),d=n(1469);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return d(e)?function(t){return o(t,1===e.length?e[0]:e)}:e})):[u];var h=-1;t=r(t,c(i));var p=s(e,(function(e,n,o){return{criteria:r(t,(function(t){return t(e)})),index:++h,value:e}}));return a(p,(function(e,t){return l(e,t,n)}))}},5970:(e,t,n)=>{var r=n(3012),o=n(9095);e.exports=function(e,t){return r(e,t,(function(t,n){return o(e,n)}))}},3012:(e,t,n)=>{var r=n(7786),o=n(611),i=n(1811);e.exports=function(e,t,n){for(var s=-1,a=t.length,c={};++s<a;){var l=t[s],u=r(e,l);n(u,l)&&o(c,i(l,e),u)}return c}},371:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},6374:(e,t,n)=>{var r=n(7786);e.exports=function(e){return function(t){return r(t,e)}}},98:e=>{var t=Math.ceil,n=Math.max;e.exports=function(e,r,o,i){for(var s=-1,a=n(t((r-e)/(o||1)),0),c=Array(a);a--;)c[i?a:++s]=e,e+=o;return c}},107:e=>{e.exports=function(e,t,n,r,o){return o(e,(function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)})),n}},5976:(e,t,n)=>{var r=n(6557),o=n(5357),i=n(61);e.exports=function(e,t){return i(o(e,t,r),e+"")}},611:(e,t,n)=>{var r=n(4865),o=n(1811),i=n(5776),s=n(3218),a=n(327);e.exports=function(e,t,n,c){if(!s(e))return e;for(var l=-1,u=(t=o(t,e)).length,d=u-1,h=e;null!=h&&++l<u;){var p=a(t[l]),f=n;if("__proto__"===p||"constructor"===p||"prototype"===p)return e;if(l!=d){var g=h[p];void 0===(f=c?c(g,p,h):void 0)&&(f=s(g)?g:i(t[l+1])?[]:{})}r(h,p,f),h=h[p]}return e}},6560:(e,t,n)=>{var r=n(5703),o=n(8777),i=n(6557),s=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=s},1131:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},2545:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},531:(e,t,n)=>{var r=n(2705),o=n(9932),i=n(1469),s=n(3448),a=r?r.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(s(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},7561:(e,t,n)=>{var r=n(7990),o=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},1717:e=>{e.exports=function(e){return function(t){return e(t)}}},5652:(e,t,n)=>{var r=n(8668),o=n(7443),i=n(1196),s=n(4757),a=n(3593),c=n(1814);e.exports=function(e,t,n){var l=-1,u=o,d=e.length,h=!0,p=[],f=p;if(n)h=!1,u=i;else if(d>=200){var g=t?null:a(e);if(g)return c(g);h=!1,u=s,f=new r}else f=t?[]:p;e:for(;++l<d;){var m=e[l],_=t?t(m):m;if(m=n||0!==m?m:0,h&&_==_){for(var y=f.length;y--;)if(f[y]===_)continue e;t&&f.push(_),p.push(m)}else u(f,_,n)||(f!==p&&f.push(_),p.push(m))}return p}},7415:(e,t,n)=>{var r=n(9932);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},1757:e=>{e.exports=function(e,t,n){for(var r=-1,o=e.length,i=t.length,s={};++r<o;){var a=r<i?t[r]:void 0;n(s,e[r],a)}return s}},4757:e=>{e.exports=function(e,t){return e.has(t)}},4290:(e,t,n)=>{var r=n(6557);e.exports=function(e){return"function"==typeof e?e:r}},1811:(e,t,n)=>{var r=n(1469),o=n(5403),i=n(5514),s=n(9833);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(s(e))}},4318:(e,t,n)=>{var r=n(1149);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},4626:(e,t,n)=>{e=n.nmd(e);var r=n(5639),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}},7157:(e,t,n)=>{var r=n(4318);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},3147:e=>{var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},419:(e,t,n)=>{var r=n(2705),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},7133:(e,t,n)=>{var r=n(4318);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},6393:(e,t,n)=>{var r=n(3448);e.exports=function(e,t){if(e!==t){var n=void 0!==e,o=null===e,i=e==e,s=r(e),a=void 0!==t,c=null===t,l=t==t,u=r(t);if(!c&&!u&&!s&&e>t||s&&a&&l&&!c&&!u||o&&a&&l||!n&&l||!i)return 1;if(!o&&!s&&!u&&e<t||u&&n&&i&&!o&&!s||c&&n&&i||!a&&i||!l)return-1}return 0}},5022:(e,t,n)=>{var r=n(6393);e.exports=function(e,t,n){for(var o=-1,i=e.criteria,s=t.criteria,a=i.length,c=n.length;++o<a;){var l=r(i[o],s[o]);if(l)return o>=c?l:l*("desc"==n[o]?-1:1)}return e.index-t.index}},278:e=>{e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},8363:(e,t,n)=>{var r=n(4865),o=n(9465);e.exports=function(e,t,n,i){var s=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var l=t[a],u=i?i(n[l],e[l],l,n,e):void 0;void 0===u&&(u=e[l]),s?o(n,l,u):r(n,l,u)}return n}},8805:(e,t,n)=>{var r=n(8363),o=n(9551);e.exports=function(e,t){return r(e,o(e),t)}},1911:(e,t,n)=>{var r=n(8363),o=n(1442);e.exports=function(e,t){return r(e,o(e),t)}},4429:(e,t,n)=>{var r=n(5639)["__core-js_shared__"];e.exports=r},1463:(e,t,n)=>{var r=n(5976),o=n(6612);e.exports=function(e){return r((function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,a&&o(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,s)}return t}))}},9291:(e,t,n)=>{var r=n(8612);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,s=t?i:-1,a=Object(n);(t?s--:++s<i)&&!1!==o(a[s],s,a););return n}}},5063:e=>{e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===n(i[c],c,i))break}return t}}},7740:(e,t,n)=>{var r=n(7206),o=n(8612),i=n(3674);e.exports=function(e){return function(t,n,s){var a=Object(t);if(!o(t)){var c=r(n,3);t=i(t),n=function(e){return c(a[e],e,a)}}var l=e(t,n,s);return l>-1?a[c?t[l]:l]:void 0}}},7445:(e,t,n)=>{var r=n(98),o=n(6612),i=n(8601);e.exports=function(e){return function(t,n,s){return s&&"number"!=typeof s&&o(t,n,s)&&(n=s=void 0),t=i(t),void 0===n?(n=t,t=0):n=i(n),s=void 0===s?t<n?1:-1:i(s),r(t,n,s,e)}}},3593:(e,t,n)=>{var r=n(8525),o=n(308),i=n(1814),s=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=s},8777:(e,t,n)=>{var r=n(852),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},7114:(e,t,n)=>{var r=n(8668),o=n(2908),i=n(4757);e.exports=function(e,t,n,s,a,c){var l=1&n,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var h=c.get(e),p=c.get(t);if(h&&p)return h==t&&p==e;var f=-1,g=!0,m=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++f<u;){var _=e[f],y=t[f];if(s)var w=l?s(y,_,f,t,e,c):s(_,y,f,e,t,c);if(void 0!==w){if(w)continue;g=!1;break}if(m){if(!o(t,(function(e,t){if(!i(m,t)&&(_===e||a(_,e,n,s,c)))return m.push(t)}))){g=!1;break}}else if(_!==y&&!a(_,y,n,s,c)){g=!1;break}}return c.delete(e),c.delete(t),g}},8351:(e,t,n)=>{var r=n(2705),o=n(1149),i=n(7813),s=n(7114),a=n(8776),c=n(1814),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=a;case"[object Set]":var f=1&r;if(p||(p=c),e.size!=t.size&&!f)return!1;var g=h.get(e);if(g)return g==t;r|=2,h.set(e,t);var m=s(p(e),p(t),r,l,d,h);return h.delete(e),m;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},6096:(e,t,n)=>{var r=n(8234),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,s,a){var c=1&n,l=r(e),u=l.length;if(u!=r(t).length&&!c)return!1;for(var d=u;d--;){var h=l[d];if(!(c?h in t:o.call(t,h)))return!1}var p=a.get(e),f=a.get(t);if(p&&f)return p==t&&f==e;var g=!0;a.set(e,t),a.set(t,e);for(var m=c;++d<u;){var _=e[h=l[d]],y=t[h];if(i)var w=c?i(y,_,h,t,e,a):i(_,y,h,e,t,a);if(!(void 0===w?_===y||s(_,y,n,i,a):w)){g=!1;break}m||(m="constructor"==h)}if(g&&!m){var v=e.constructor,b=t.constructor;v==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(g=!1)}return a.delete(e),a.delete(t),g}},9021:(e,t,n)=>{var r=n(5564),o=n(5357),i=n(61);e.exports=function(e){return i(o(e,void 0,r),e+"")}},1957:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},8234:(e,t,n)=>{var r=n(8866),o=n(9551),i=n(3674);e.exports=function(e){return r(e,i,o)}},6904:(e,t,n)=>{var r=n(8866),o=n(1442),i=n(1704);e.exports=function(e){return r(e,i,o)}},5050:(e,t,n)=>{var r=n(7019);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},1499:(e,t,n)=>{var r=n(9162),o=n(3674);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],s=e[i];t[n]=[i,s,r(s)]}return t}},852:(e,t,n)=>{var r=n(8458),o=n(7801);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},5924:(e,t,n)=>{var r=n(5569)(Object.getPrototypeOf,Object);e.exports=r},9607:(e,t,n)=>{var r=n(2705),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[a]=n:delete e[a]),o}},9551:(e,t,n)=>{var r=n(4963),o=n(479),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return i.call(e,t)})))}:o;e.exports=a},1442:(e,t,n)=>{var r=n(2488),o=n(5924),i=n(9551),s=n(479),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:s;e.exports=a},4160:(e,t,n)=>{var r=n(8552),o=n(7071),i=n(3818),s=n(8525),a=n(577),c=n(4239),l=n(346),u="[object Map]",d="[object Promise]",h="[object Set]",p="[object WeakMap]",f="[object DataView]",g=l(r),m=l(o),_=l(i),y=l(s),w=l(a),v=c;(r&&v(new r(new ArrayBuffer(1)))!=f||o&&v(new o)!=u||i&&v(i.resolve())!=d||s&&v(new s)!=h||a&&v(new a)!=p)&&(v=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case g:return f;case m:return u;case _:return d;case y:return h;case w:return p}return t}),e.exports=v},7801:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},222:(e,t,n)=>{var r=n(1811),o=n(5694),i=n(1469),s=n(5776),a=n(1780),c=n(327);e.exports=function(e,t,n){for(var l=-1,u=(t=r(t,e)).length,d=!1;++l<u;){var h=c(t[l]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++l!=u?d:!!(u=null==e?0:e.length)&&a(u)&&s(h,u)&&(i(e)||o(e))}},2689:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},1789:(e,t,n)=>{var r=n(4536);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},401:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},7667:(e,t,n)=>{var r=n(4536),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},1327:(e,t,n)=>{var r=n(4536),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},1866:(e,t,n)=>{var r=n(4536);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},3824:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},9148:(e,t,n)=>{var r=n(4318),o=n(7157),i=n(3147),s=n(419),a=n(7133);e.exports=function(e,t,n){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return i(e);case"[object Symbol]":return s(e)}}},8517:(e,t,n)=>{var r=n(3118),o=n(5924),i=n(5726);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},7285:(e,t,n)=>{var r=n(2705),o=n(5694),i=n(1469),s=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(s&&e&&e[s])}},5776:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},6612:(e,t,n)=>{var r=n(7813),o=n(8612),i=n(5776),s=n(3218);e.exports=function(e,t,n){if(!s(n))return!1;var a=typeof t;return!!("number"==a?o(n)&&i(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},5403:(e,t,n)=>{var r=n(1469),o=n(3448),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||s.test(e)||!i.test(e)||null!=t&&e in Object(t)}},7019:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},5346:(e,t,n)=>{var r,o=n(4429),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!i&&i in e}},5726:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},9162:(e,t,n)=>{var r=n(3218);e.exports=function(e){return e==e&&!r(e)}},7040:e=>{e.exports=function(){this.__data__=[],this.size=0}},4125:(e,t,n)=>{var r=n(8470),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},2117:(e,t,n)=>{var r=n(8470);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7529:(e,t,n)=>{var r=n(8470);e.exports=function(e){return r(this.__data__,e)>-1}},4705:(e,t,n)=>{var r=n(8470);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},4785:(e,t,n)=>{var r=n(1989),o=n(8407),i=n(7071);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},1285:(e,t,n)=>{var r=n(5050);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},6e3:(e,t,n)=>{var r=n(5050);e.exports=function(e){return r(this,e).get(e)}},9916:(e,t,n)=>{var r=n(5050);e.exports=function(e){return r(this,e).has(e)}},5265:(e,t,n)=>{var r=n(5050);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},8776:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},2634:e=>{e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},4523:(e,t,n)=>{var r=n(8306);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},4536:(e,t,n)=>{var r=n(852)(Object,"create");e.exports=r},6916:(e,t,n)=>{var r=n(5569)(Object.keys,Object);e.exports=r},3498:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},1167:(e,t,n)=>{e=n.nmd(e);var r=n(1957),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o&&r.process,a=function(){try{return i&&i.require&&i.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5569:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},5357:(e,t,n)=>{var r=n(6874),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,s=-1,a=o(i.length-t,0),c=Array(a);++s<a;)c[s]=i[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=i[s];return l[t]=n(c),r(e,this,l)}}},5639:(e,t,n)=>{var r=n(1957),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},6390:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},619:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},2385:e=>{e.exports=function(e){return this.__data__.has(e)}},1814:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},61:(e,t,n)=>{var r=n(6560),o=n(1275)(r);e.exports=o},1275:e=>{var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var o=t(),i=16-(o-r);if(r=o,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},7465:(e,t,n)=>{var r=n(8407);e.exports=function(){this.__data__=new r,this.size=0}},3779:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},7599:e=>{e.exports=function(e){return this.__data__.get(e)}},4758:e=>{e.exports=function(e){return this.__data__.has(e)}},4309:(e,t,n)=>{var r=n(8407),o=n(7071),i=n(3369);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!o||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(s)}return n.set(e,t),this.size=n.size,this}},2351:e=>{e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},8016:(e,t,n)=>{var r=n(8983),o=n(2689),i=n(1903);e.exports=function(e){return o(e)?i(e):r(e)}},5514:(e,t,n)=>{var r=n(4523),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)})),t}));e.exports=s},327:(e,t,n)=>{var r=n(3448);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},346:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},7990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},1903:e=>{var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+r+"|"+o+")?",l="[\\ufe0e\\ufe0f]?",u=l+c+"(?:\\u200d(?:"+[i,s,a].join("|")+")"+l+c+")*",d="(?:"+[i+r+"?",r,s,a,n].join("|")+")",h=RegExp(o+"(?="+o+")|"+d+u,"g");e.exports=function(e){for(var t=h.lastIndex=0;h.test(e);)++t;return t}},6678:(e,t,n)=>{var r=n(5990);e.exports=function(e){return r(e,4)}},361:(e,t,n)=>{var r=n(5990);e.exports=function(e){return r(e,5)}},5703:e=>{e.exports=function(e){return function(){return e}}},1747:(e,t,n)=>{var r=n(5976),o=n(7813),i=n(6612),s=n(1704),a=Object.prototype,c=a.hasOwnProperty,l=r((function(e,t){e=Object(e);var n=-1,r=t.length,l=r>2?t[2]:void 0;for(l&&i(t[0],t[1],l)&&(r=1);++n<r;)for(var u=t[n],d=s(u),h=-1,p=d.length;++h<p;){var f=d[h],g=e[f];(void 0===g||o(g,a[f])&&!c.call(e,f))&&(e[f]=u[f])}return e}));e.exports=l},6073:(e,t,n)=>{e.exports=n(4486)},7813:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},3105:(e,t,n)=>{var r=n(4963),o=n(760),i=n(7206),s=n(1469);e.exports=function(e,t){return(s(e)?r:o)(e,i(t,3))}},3311:(e,t,n)=>{var r=n(7740)(n(998));e.exports=r},998:(e,t,n)=>{var r=n(1848),o=n(7206),i=n(554),s=Math.max;e.exports=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var c=null==n?0:i(n);return c<0&&(c=s(a+c,0)),r(e,o(t,3),c)}},5564:(e,t,n)=>{var r=n(1078);e.exports=function(e){return null!=e&&e.length?r(e,1):[]}},4486:(e,t,n)=>{var r=n(7412),o=n(9881),i=n(4290),s=n(1469);e.exports=function(e,t){return(s(e)?r:o)(e,i(t))}},2620:(e,t,n)=>{var r=n(8483),o=n(4290),i=n(1704);e.exports=function(e,t){return null==e?e:r(e,o(t),i)}},7361:(e,t,n)=>{var r=n(7786);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},8721:(e,t,n)=>{var r=n(8565),o=n(222);e.exports=function(e,t){return null!=e&&o(e,t,r)}},9095:(e,t,n)=>{var r=n(13),o=n(222);e.exports=function(e,t){return null!=e&&o(e,t,r)}},6557:e=>{e.exports=function(e){return e}},5694:(e,t,n)=>{var r=n(9454),o=n(7005),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},1469:e=>{var t=Array.isArray;e.exports=t},8612:(e,t,n)=>{var r=n(3560),o=n(1780);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},9246:(e,t,n)=>{var r=n(8612),o=n(7005);e.exports=function(e){return o(e)&&r(e)}},4144:(e,t,n)=>{e=n.nmd(e);var r=n(5639),o=n(5062),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,a=s&&s.exports===i?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;e.exports=c},1609:(e,t,n)=>{var r=n(280),o=n(4160),i=n(5694),s=n(1469),a=n(8612),c=n(4144),l=n(5726),u=n(6719),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||u(e)||i(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},3560:(e,t,n)=>{var r=n(4239),o=n(3218);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1780:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6688:(e,t,n)=>{var r=n(5588),o=n(1717),i=n(1167),s=i&&i.isMap,a=s?o(s):r;e.exports=a},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},8630:(e,t,n)=>{var r=n(4239),o=n(5924),i=n(7005),s=Function.prototype,a=Object.prototype,c=s.toString,l=a.hasOwnProperty,u=c.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==u}},2928:(e,t,n)=>{var r=n(9221),o=n(1717),i=n(1167),s=i&&i.isSet,a=s?o(s):r;e.exports=a},7037:(e,t,n)=>{var r=n(4239),o=n(1469),i=n(7005);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==r(e)}},3448:(e,t,n)=>{var r=n(4239),o=n(7005);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},6719:(e,t,n)=>{var r=n(9911),o=n(1717),i=n(1167),s=i&&i.isTypedArray,a=s?o(s):r;e.exports=a},2353:e=>{e.exports=function(e){return void 0===e}},3674:(e,t,n)=>{var r=n(4636),o=n(280),i=n(8612);e.exports=function(e){return i(e)?r(e):o(e)}},1704:(e,t,n)=>{var r=n(4636),o=n(313),i=n(8612);e.exports=function(e){return i(e)?r(e,!0):o(e)}},928:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},5161:(e,t,n)=>{var r=n(9932),o=n(7206),i=n(9199),s=n(1469);e.exports=function(e,t){return(s(e)?r:i)(e,o(t,3))}},6604:(e,t,n)=>{var r=n(9465),o=n(7816),i=n(7206);e.exports=function(e,t){var n={};return t=i(t,3),o(e,(function(e,o,i){r(n,o,t(e,o,i))})),n}},6162:(e,t,n)=>{var r=n(6029),o=n(3325),i=n(6557);e.exports=function(e){return e&&e.length?r(e,i,o):void 0}},8306:(e,t,n)=>{var r=n(3369);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=e.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},3857:(e,t,n)=>{var r=n(2980),o=n(1463)((function(e,t,n){r(e,t,n)}));e.exports=o},3632:(e,t,n)=>{var r=n(6029),o=n(433),i=n(6557);e.exports=function(e){return e&&e.length?r(e,i,o):void 0}},2762:(e,t,n)=>{var r=n(6029),o=n(7206),i=n(433);e.exports=function(e,t){return e&&e.length?r(e,o(t,2),i):void 0}},308:e=>{e.exports=function(){}},7771:(e,t,n)=>{var r=n(5639);e.exports=function(){return r.Date.now()}},9722:(e,t,n)=>{var r=n(5970),o=n(9021)((function(e,t){return null==e?{}:r(e,t)}));e.exports=o},9601:(e,t,n)=>{var r=n(371),o=n(6374),i=n(5403),s=n(327);e.exports=function(e){return i(e)?r(s(e)):o(e)}},6026:(e,t,n)=>{var r=n(7445)();e.exports=r},4061:(e,t,n)=>{var r=n(2663),o=n(9881),i=n(7206),s=n(107),a=n(1469);e.exports=function(e,t,n){var c=a(e)?r:s,l=arguments.length<3;return c(e,i(t,4),n,l,o)}},4238:(e,t,n)=>{var r=n(280),o=n(4160),i=n(8612),s=n(7037),a=n(8016);e.exports=function(e){if(null==e)return 0;if(i(e))return s(e)?a(e):e.length;var t=o(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length}},9734:(e,t,n)=>{var r=n(1078),o=n(8921),i=n(5976),s=n(6612),a=i((function(e,t){if(null==e)return[];var n=t.length;return n>1&&s(e,t[0],t[1])?t=[]:n>2&&s(t[0],t[1],t[2])&&(t=[t[0]]),o(e,r(t,1),[])}));e.exports=a},479:e=>{e.exports=function(){return[]}},5062:e=>{e.exports=function(){return!1}},8601:(e,t,n)=>{var r=n(4841);e.exports=function(e){return e?Infinity===(e=r(e))||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},554:(e,t,n)=>{var r=n(8601);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},4841:(e,t,n)=>{var r=n(7561),o=n(3218),i=n(3448),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):s.test(e)?NaN:+e}},3678:(e,t,n)=>{var r=n(8363),o=n(1704);e.exports=function(e){return r(e,o(e))}},9833:(e,t,n)=>{var r=n(531);e.exports=function(e){return null==e?"":r(e)}},8718:(e,t,n)=>{var r=n(7412),o=n(3118),i=n(7816),s=n(7206),a=n(5924),c=n(1469),l=n(4144),u=n(3560),d=n(3218),h=n(6719);e.exports=function(e,t,n){var p=c(e),f=p||l(e)||h(e);if(t=s(t,4),null==n){var g=e&&e.constructor;n=f?p?new g:[]:d(e)&&u(g)?o(a(e)):{}}return(f?r:i)(e,(function(e,r,o){return t(n,e,r,o)})),n}},3386:(e,t,n)=>{var r=n(1078),o=n(5976),i=n(5652),s=n(9246),a=o((function(e){return i(r(e,1,s,!0))}));e.exports=a},3955:(e,t,n)=>{var r=n(9833),o=0;e.exports=function(e){var t=++o;return r(e)+t}},2628:(e,t,n)=>{var r=n(7415),o=n(3674);e.exports=function(e){return null==e?[]:r(e,o(e))}},7287:(e,t,n)=>{var r=n(4865),o=n(1757);e.exports=function(e,t){return o(e||[],t||[],r)}},6961:(e,t,n)=>{var r,o=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var i={compressToBase64:function(e){if(null==e)return"";var n=i._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:i._decompress(e.length,32,(function(n){return o(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":i._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=i.compress(e),n=new Uint8Array(2*t.length),r=0,o=t.length;r<o;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(t){if(null==t)return i.decompress(t);for(var n=new Array(t.length/2),r=0,o=n.length;r<o;r++)n[r]=256*t[2*r]+t[2*r+1];var s=[];return n.forEach((function(t){s.push(e(t))})),i.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),i._decompress(e.length,32,(function(t){return o(n,e.charAt(t))})))},compress:function(t){return i._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var r,o,i,s={},a={},c="",l="",u="",d=2,h=3,p=2,f=[],g=0,m=0;for(i=0;i<e.length;i+=1)if(c=e.charAt(i),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=h++,a[c]=!0),l=u+c,Object.prototype.hasOwnProperty.call(s,l))u=l;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,m==t-1?(m=0,f.push(n(g)),g=0):m++;for(o=u.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1}else{for(o=1,r=0;r<p;r++)g=g<<1|o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o=0;for(o=u.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[u]}else for(o=s[u],r=0;r<p;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1;0==--d&&(d=Math.pow(2,p),p++),s[l]=h++,u=String(c)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(r=0;r<p;r++)g<<=1,m==t-1?(m=0,f.push(n(g)),g=0):m++;for(o=u.charCodeAt(0),r=0;r<8;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1}else{for(o=1,r=0;r<p;r++)g=g<<1|o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o=0;for(o=u.charCodeAt(0),r=0;r<16;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete a[u]}else for(o=s[u],r=0;r<p;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(o=2,r=0;r<p;r++)g=g<<1|1&o,m==t-1?(m=0,f.push(n(g)),g=0):m++,o>>=1;for(;;){if(g<<=1,m==t-1){f.push(n(g));break}m++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,r){var o,i,s,a,c,l,u,d=[],h=4,p=4,f=3,g="",m=[],_={val:r(0),position:n,index:1};for(o=0;o<3;o+=1)d[o]=o;for(s=0,c=Math.pow(2,2),l=1;l!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=r(_.index++)),s|=(a>0?1:0)*l,l<<=1;switch(s){case 0:for(s=0,c=Math.pow(2,8),l=1;l!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=r(_.index++)),s|=(a>0?1:0)*l,l<<=1;u=e(s);break;case 1:for(s=0,c=Math.pow(2,16),l=1;l!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=r(_.index++)),s|=(a>0?1:0)*l,l<<=1;u=e(s);break;case 2:return""}for(d[3]=u,i=u,m.push(u);;){if(_.index>t)return"";for(s=0,c=Math.pow(2,f),l=1;l!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=r(_.index++)),s|=(a>0?1:0)*l,l<<=1;switch(u=s){case 0:for(s=0,c=Math.pow(2,8),l=1;l!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=r(_.index++)),s|=(a>0?1:0)*l,l<<=1;d[p++]=e(s),u=p-1,h--;break;case 1:for(s=0,c=Math.pow(2,16),l=1;l!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=r(_.index++)),s|=(a>0?1:0)*l,l<<=1;d[p++]=e(s),u=p-1,h--;break;case 2:return m.join("")}if(0==h&&(h=Math.pow(2,f),f++),d[u])g=d[u];else{if(u!==p)return null;g=i+i.charAt(0)}m.push(g),d[p++]=i+g.charAt(0),i=g,0==--h&&(h=Math.pow(2,f),f++)}}};return i}();void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)},7460:function(e,t){var n,r;n=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,r=t.IS_PAPA_WORKER||!1,o={},i=0,s={parse:function(n,r){var a=(r=r||{}).dynamicTyping||!1;if(b(a)&&(r.dynamicTypingFunction=a,a={}),r.dynamicTyping=a,r.transform=!!b(r.transform)&&r.transform,r.worker&&s.WORKERS_SUPPORTED){var c=function(){if(!s.WORKERS_SUPPORTED)return!1;var n,r,a=(n=t.URL||t.webkitURL||null,r=e.toString(),s.BLOB_URL||(s.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))),c=new t.Worker(a);return c.onmessage=m,c.id=i++,o[c.id]=c}();return c.userStep=r.step,c.userChunk=r.chunk,c.userComplete=r.complete,c.userError=r.error,r.step=b(r.step),r.chunk=b(r.chunk),r.complete=b(r.complete),r.error=b(r.error),delete r.worker,void c.postMessage({input:n,config:r,workerId:c.id})}var p=null;return s.NODE_STREAM_INPUT,"string"==typeof n?(n=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(n),p=r.download?new l(r):new d(r)):!0===n.readable&&b(n.read)&&b(n.on)?p=new h(r):(t.File&&n instanceof File||n instanceof Object)&&(p=new u(r)),p.stream(n)},unparse:function(e,t){var n=!1,r=!0,o=",",i="\r\n",a='"',c=a+a,l=!1,u=null,d=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||s.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(o=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(l=t.skipEmptyLines),"string"==typeof t.newline&&(i=t.newline),"string"==typeof t.quoteChar&&(a=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");u=t.columns}void 0!==t.escapeChar&&(c=t.escapeChar+a),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(d=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var h=new RegExp(f(a),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return p(null,e,l);if("object"==typeof e[0])return p(u||Object.keys(e[0]),e,l)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||u),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),p(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function p(e,t,n){var s="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var a=Array.isArray(e)&&0<e.length,c=!Array.isArray(t[0]);if(a&&r){for(var l=0;l<e.length;l++)0<l&&(s+=o),s+=g(e[l],l);0<t.length&&(s+=i)}for(var u=0;u<t.length;u++){var d=a?e.length:t[u].length,h=!1,p=a?0===Object.keys(t[u]).length:0===t[u].length;if(n&&!a&&(h="greedy"===n?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===n&&a){for(var f=[],m=0;m<d;m++){var _=c?e[m]:m;f.push(t[u][_])}h=""===f.join("").trim()}if(!h){for(var y=0;y<d;y++){0<y&&!p&&(s+=o);var w=a&&c?e[y]:y;s+=g(t[u][w],y)}u<t.length-1&&(!n||0<d&&!p)&&(s+=i)}}return s}function g(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var r=!1;d&&"string"==typeof e&&d.test(e)&&(e="'"+e,r=!0);var i=e.toString().replace(h,c);return(r=r||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(i,s.BAD_DELIMITERS)||-1<i.indexOf(o)||" "===i.charAt(0)||" "===i.charAt(i.length-1))?a+i+a:i}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\ufeff",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!n&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=g,s.ParserHandle=p,s.NetworkStreamer=l,s.FileStreamer=u,s.StringStreamer=d,s.ReadableStreamStreamer=h,t.jQuery){var a=t.jQuery;a.fn.parse=function(e){var n=e.config||{},r=[];return this.each((function(e){if("INPUT"!==a(this).prop("tagName").toUpperCase()||"file"!==a(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)r.push({file:this.files[o],inputElem:this,instanceConfig:a.extend({},n)})})),o(),this;function o(){if(0!==r.length){var t,n,o,c=r[0];if(b(e.before)){var l=e.before(c.file,c.inputElem);if("object"==typeof l){if("abort"===l.action)return"AbortError",t=c.file,n=c.inputElem,o=l.reason,void(b(e.error)&&e.error({name:"AbortError"},t,n,o));if("skip"===l.action)return void i();"object"==typeof l.config&&(c.instanceConfig=a.extend(c.instanceConfig,l.config))}else if("skip"===l)return void i()}var u=c.instanceConfig.complete;c.instanceConfig.complete=function(e){b(u)&&u(e,c.file,c.inputElem),i()},s.parse(c.file,c.instanceConfig)}else b(e.complete)&&e.complete()}function i(){r.splice(0,1),o()}}}function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=w(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new p(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&b(this._config.beforeFirstChunk)){var o=this._config.beforeFirstChunk(e);void 0!==o&&(e=o)}this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+e;this._partialLine="";var a=this._handle.parse(i,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var c=a.meta.cursor;this._finished||(this._partialLine=i.substring(c-this._baseIndex),this._baseIndex=c),a&&a.data&&(this._rowCount+=a.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)t.postMessage({results:a,workerId:s.WORKER_ID,finished:l});else if(b(this._config.chunk)&&!n){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);a=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!l||!b(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){b(this._config.error)?this._config.error(e):r&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function l(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),c.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=v(this._chunkLoaded,this),t.onerror=v(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var o=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+o)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function u(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),c.call(this,e);var r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=v(this._chunkLoaded,this),t.onerror=v(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var o=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,o)}var i=t.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;c.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,n=this._config.chunkSize;return n?(e=t.substring(0,n),t=t.substring(n)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){c.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=v((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=v((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=v((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=v((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function p(e){var t,n,r,o=Math.pow(2,53),i=-o,a=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,u=0,d=0,h=!1,p=!1,m=[],_={data:[],errors:[],meta:{}};if(b(e.step)){var y=e.step;e.step=function(t){if(_=t,S())x();else{if(x(),0===_.data.length)return;u+=t.data.length,e.preview&&u>e.preview?n.abort():(_.data=_.data[0],y(_,l))}}}function v(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function x(){return _&&r&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(_.data=_.data.filter((function(e){return!v(e)}))),S()&&function(){if(_)if(Array.isArray(_.data[0])){for(var t=0;S()&&t<_.data.length;t++)_.data[t].forEach(n);_.data.splice(0,1)}else _.data.forEach(n);function n(t,n){b(e.transformHeader)&&(t=e.transformHeader(t,n)),m.push(t)}}(),function(){if(!_||!e.header&&!e.dynamicTyping&&!e.transform)return _;function t(t,n){var r,o=e.header?{}:[];for(r=0;r<t.length;r++){var i=r,s=t[r];e.header&&(i=r>=m.length?"__parsed_extra":m[r]),e.transform&&(s=e.transform(s,i)),s=k(i,s),"__parsed_extra"===i?(o[i]=o[i]||[],o[i].push(s)):o[i]=s}return e.header&&(r>m.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+m.length+" fields but parsed "+r,d+n):r<m.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+m.length+" fields but parsed "+r,d+n)),o}var n=1;return!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(t),n=_.data.length):_.data=t(_.data,0),e.header&&_.meta&&(_.meta.fields=m),d+=n,_}()}function S(){return e.header&&0===m.length}function k(t,n){return r=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[r]&&(e.dynamicTyping[r]=e.dynamicTypingFunction(r)),!0===(e.dynamicTyping[r]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(a.test(e)){var t=parseFloat(e);if(i<t&&t<o)return!0}return!1}(n)?parseFloat(n):c.test(n)?new Date(n):""===n?null:n):n;var r}function C(e,t,n,r){var o={type:e,code:t,message:n};void 0!==r&&(o.row=r),_.errors.push(o)}this.parse=function(o,i,a){var c=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var n=new RegExp(f(t)+"([^]*?)"+f(t),"gm"),r=(e=e.replace(n,"")).split("\r"),o=e.split("\n"),i=1<o.length&&o[0].length<r[0].length;if(1===r.length||i)return"\n";for(var s=0,a=0;a<r.length;a++)"\n"===r[a][0]&&s++;return s>=r.length/2?"\r\n":"\r"}(o,c)),r=!1,e.delimiter)b(e.delimiter)&&(e.delimiter=e.delimiter(o),_.meta.delimiter=e.delimiter);else{var l=function(t,n,r,o,i){var a,c,l,u;i=i||[",","\t","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var d=0;d<i.length;d++){var h=i[d],p=0,f=0,m=0;l=void 0;for(var _=new g({comments:o,delimiter:h,newline:n,preview:10}).parse(t),y=0;y<_.data.length;y++)if(r&&v(_.data[y]))m++;else{var w=_.data[y].length;f+=w,void 0!==l?0<w&&(p+=Math.abs(w-l),l=w):l=w}0<_.data.length&&(f/=_.data.length-m),(void 0===c||p<=c)&&(void 0===u||u<f)&&1.99<f&&(c=p,a=h,u=f)}return{successful:!!(e.delimiter=a),bestDelimiter:a}}(o,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);l.successful?e.delimiter=l.bestDelimiter:(r=!0,e.delimiter=s.DefaultDelimiter),_.meta.delimiter=e.delimiter}var u=w(e);return e.preview&&e.header&&u.preview++,t=o,n=new g(u),_=n.parse(t,i,a),x(),h?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=b(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(h=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,n.abort(),_.meta.aborted=!0,b(e.complete)&&e.complete(_),t=""}}function f(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t,n=(e=e||{}).delimiter,r=e.newline,o=e.comments,i=e.step,a=e.preview,c=e.fastMode,l=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(l=e.escapeChar),("string"!=typeof n||-1<s.BAD_DELIMITERS.indexOf(n))&&(n=","),o===n)throw new Error("Comment character same as delimiter");!0===o?o="#":("string"!=typeof o||-1<s.BAD_DELIMITERS.indexOf(o))&&(o=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var u=0,d=!1;this.parse=function(s,h,p){if("string"!=typeof s)throw new Error("Input must be a string");var g=s.length,m=n.length,_=r.length,y=o.length,w=b(i),v=[],x=[],S=[],k=u=0;if(!s)return H();if(e.header&&!h){var C=s.split(r)[0].split(n),E=[],A={},I=!1;for(var P in C){var M=C[P];b(e.transformHeader)&&(M=e.transformHeader(M,P));var T=M,j=A[M]||0;for(0<j&&(I=!0,T=M+"_"+j),A[M]=j+1;E.includes(T);)T=T+"_"+j;E.push(T)}if(I){var D=s.split(r);D[0]=E.join(n),s=D.join(r)}}if(c||!1!==c&&-1===s.indexOf(t)){for(var O=s.split(r),z=0;z<O.length;z++){if(S=O[z],u+=S.length,z!==O.length-1)u+=r.length;else if(p)return H();if(!o||S.substring(0,y)!==o){if(w){if(v=[],U(S.split(n)),G(),d)return H()}else U(S.split(n));if(a&&a<=z)return v=v.slice(0,a),H(!0)}}return H()}for(var F=s.indexOf(n,u),R=s.indexOf(r,u),L=new RegExp(f(l)+f(t),"g"),N=s.indexOf(t,u);;)if(s[u]!==t)if(o&&0===S.length&&s.substring(u,u+y)===o){if(-1===R)return H();u=R+_,R=s.indexOf(r,u),F=s.indexOf(n,u)}else if(-1!==F&&(F<R||-1===R))S.push(s.substring(u,F)),u=F+m,F=s.indexOf(n,u);else{if(-1===R)break;if(S.push(s.substring(u,R)),K(R+_),w&&(G(),d))return H();if(a&&v.length>=a)return H(!0)}else for(N=u,u++;;){if(-1===(N=s.indexOf(t,N+1)))return p||x.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:u}),W();if(N===g-1)return W(s.substring(u,N).replace(L,t));if(t!==l||s[N+1]!==l){if(t===l||0===N||s[N-1]!==l){-1!==F&&F<N+1&&(F=s.indexOf(n,N+1)),-1!==R&&R<N+1&&(R=s.indexOf(r,N+1));var B=V(-1===R?F:Math.min(F,R));if(s.substr(N+1+B,m)===n){S.push(s.substring(u,N).replace(L,t)),s[u=N+1+B+m]!==t&&(N=s.indexOf(t,u)),F=s.indexOf(n,u),R=s.indexOf(r,u);break}var $=V(R);if(s.substring(N+1+$,N+1+$+_)===r){if(S.push(s.substring(u,N).replace(L,t)),K(N+1+$+_),F=s.indexOf(n,u),N=s.indexOf(t,u),w&&(G(),d))return H();if(a&&v.length>=a)return H(!0);break}x.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:u}),N++}}else N++}return W();function U(e){v.push(e),k=u}function V(e){var t=0;if(-1!==e){var n=s.substring(N+1,e);n&&""===n.trim()&&(t=n.length)}return t}function W(e){return p||(void 0===e&&(e=s.substring(u)),S.push(e),u=g,U(S),w&&G()),H()}function K(e){u=e,U(S),S=[],R=s.indexOf(r,u)}function H(e){return{data:v,errors:x,meta:{delimiter:n,linebreak:r,aborted:d,truncated:!!e,cursor:k+(h||0)}}}function G(){i(H()),v=[],x=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return u}}function m(e){var t=e.data,n=o[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(b(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},i),!r);s++);delete t.results}else b(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&_(t.workerId,t.results)}function _(e,t){var n=o[e];b(n.userComplete)&&n.userComplete(t),n.terminate(),delete o[e]}function y(){throw new Error("Not implemented.")}function w(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=w(e[n]);return t}function v(e,t){return function(){e.apply(t,arguments)}}function b(e){return"function"==typeof e}return r&&(t.onmessage=function(e){var n=e.data;if(void 0===s.WORKER_ID&&n&&(s.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:s.WORKER_ID,results:s.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var r=s.parse(n.input,n.config);r&&t.postMessage({workerId:s.WORKER_ID,results:r,finished:!0})}}),(l.prototype=Object.create(c.prototype)).constructor=l,(u.prototype=Object.create(c.prototype)).constructor=u,(d.prototype=Object.create(d.prototype)).constructor=d,(h.prototype=Object.create(c.prototype)).constructor=h,s},void 0===(r=n.apply(t,[]))||(e.exports=r)},4448:(e,t,n)=>{"use strict";var r=n(7294),o=n(3840);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(e,t,n,r,o,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var _=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function w(e,t,n,r){var o=m.hasOwnProperty(t)?m[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(_,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(_,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(_,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var v=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),j=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function z(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=O&&e[O]||e["@@iterator"])?e:null}var F,R=Object.assign;function L(e){if(void 0===F)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var N=!1;function B(e,t){if(!e||N)return"";N=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),i=r.stack.split("\n"),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(1!==s||1!==a)do{if(s--,0>--a||o[s]!==i[a]){var c="\n"+o[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{N=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function $(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return B(e.type,!1);case 11:return B(e.type.render,!1);case 1:return B(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case S:return"Fragment";case x:return"Portal";case C:return"Profiler";case k:return"StrictMode";case P:return"Suspense";case M:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case j:t=e._payload,e=e._init;try{return U(e(t))}catch(e){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function Q(e,t){Z(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var _e=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(_e[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(i(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Se=null,ke=null;function Ce(e){if(e=vo(e)){if("function"!=typeof xe)throw Error(i(280));var t=e.stateNode;t&&(t=xo(t),xe(e.stateNode,e.type,t))}}function Ee(e){Se?ke?ke.push(e):ke=[e]:Se=e}function Ae(){if(Se){var e=Se,t=ke;if(ke=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ie(e,t){return e(t)}function Pe(){}var Me=!1;function Te(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ie(e,t,n)}finally{Me=!1,(null!==Se||null!==ke)&&(Pe(),Ae())}}function je(e,t){var n=e.stateNode;if(null===n)return null;var r=xo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){De=!1}function ze(e,t,n,r,o,i,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}var Fe=!1,Re=null,Le=!1,Ne=null,Be={onError:function(e){Fe=!0,Re=e}};function $e(e,t,n,r,o,i,s,a,c){Fe=!1,Re=null,ze.apply(Be,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(i(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var s=o.alternate;if(null===s){if(null!==(r=o.return)){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return We(o),e;if(s===r)return We(o),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=o,r=s;else{for(var a=!1,c=o.child;c;){if(c===n){a=!0,n=o,r=s;break}if(c===r){a=!0,r=o,n=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===n){a=!0,n=s,r=o;break}if(c===r){a=!0,r=s,n=o;break}c=c.sibling}if(!a)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=o.unstable_scheduleCallback,qe=o.unstable_cancelCallback,Ye=o.unstable_shouldYield,Xe=o.unstable_requestPaint,Ze=o.unstable_now,Qe=o.unstable_getCurrentPriorityLevel,Je=o.unstable_ImmediatePriority,et=o.unstable_UserBlockingPriority,tt=o.unstable_NormalPriority,nt=o.unstable_LowPriority,rt=o.unstable_IdlePriority,ot=null,it=null,st=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2,lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~o;0!==a?r=dt(a):0!=(i&=s)&&(r=dt(i))}else 0!=(s=n&~o)?r=dt(s):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0==(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&0!=(4194240&i)))return t;if(0!=(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-st(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0==(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _t(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var wt=0;function vt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var bt,xt,St,kt,Ct,Et=!1,At=[],It=null,Pt=null,Mt=null,Tt=new Map,jt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jt.delete(t.pointerId)}}function Ft(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&null!==(t=vo(t))&&xt(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Rt(e){var t=wo(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vo(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ve=r,n.target.dispatchEvent(r),ve=null,t.shift()}return!0}function Nt(e,t,n){Lt(e)&&n.delete(t)}function Bt(){Et=!1,null!==It&&Lt(It)&&(It=null),null!==Pt&&Lt(Pt)&&(Pt=null),null!==Mt&&Lt(Mt)&&(Mt=null),Tt.forEach(Nt),jt.forEach(Nt)}function $t(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Bt)))}function Ut(e){function t(t){return $t(t,e)}if(0<At.length){$t(At[0],e);for(var n=1;n<At.length;n++){var r=At[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&$t(It,e),null!==Pt&&$t(Pt,e),null!==Mt&&$t(Mt,e),Tt.forEach(t),jt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Rt(n),null===n.blockedOn&&Dt.shift()}var Vt=v.ReactCurrentBatchConfig,Wt=!0;function Kt(e,t,n,r){var o=wt,i=Vt.transition;Vt.transition=null;try{wt=1,Gt(e,t,n,r)}finally{wt=o,Vt.transition=i}}function Ht(e,t,n,r){var o=wt,i=Vt.transition;Vt.transition=null;try{wt=4,Gt(e,t,n,r)}finally{wt=o,Vt.transition=i}}function Gt(e,t,n,r){if(Wt){var o=Yt(e,t,n,r);if(null===o)Wr(e,t,r,qt,n),zt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return It=Ft(It,e,t,n,r,o),!0;case"dragenter":return Pt=Ft(Pt,e,t,n,r,o),!0;case"mouseover":return Mt=Ft(Mt,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Tt.set(i,Ft(Tt.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,jt.set(i,Ft(jt.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(zt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==o;){var i=vo(o);if(null!==i&&bt(i),null===(i=Yt(e,t,n,r))&&Wr(e,t,r,qt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var qt=null;function Yt(e,t,n,r){if(qt=null,null!==(e=wo(e=be(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,Qt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Qt,r=n.length,o="value"in Zt?Zt.value:Zt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===o[i-t];t++);return Jt=o.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,o,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(o):o[s]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(ln),dn=R({},ln,{view:0,detail:0}),hn=on(dn),pn=R({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(sn=e.screenX-cn.screenX,an=e.screenY-cn.screenY):an=sn=0,cn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=on(pn),gn=on(R({},pn,{dataTransfer:0})),mn=on(R({},dn,{relatedTarget:0})),_n=on(R({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=R({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=on(yn),vn=on(R({},ln,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Cn(){return kn}var En=R({},dn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=on(En),In=on(R({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=on(R({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Mn=on(R({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=R({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jn=on(Tn),Dn=[9,13,27,32],On=u&&"CompositionEvent"in window,zn=null;u&&"documentMode"in document&&(zn=document.documentMode);var Fn=u&&"TextEvent"in window&&!zn,Rn=u&&(!On||zn&&8<zn&&11>=zn),Ln=String.fromCharCode(32),Nn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $n(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1,Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ee(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function qn(e){Lr(e,0)}function Yn(e){if(G(bo(e)))return e}function Xn(e,t){if("change"===e)return t}var Zn=!1;if(u){var Qn;if(u){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"==typeof er.oninput}Qn=Jn}else Qn=!1;Zn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Gn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Kn(t,Gn,e,be(e)),Te(qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function ir(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var ar="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function cr(e,t){if(ar(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!ar(e[o],t[o]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=ur(n,i);var s=ur(n,r);o&&s&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,_r=null,yr=null,wr=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==mr||mr!==q(r)||(r="selectionStart"in(r=mr)&&pr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Hr(_r,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Sr={},kr={};function Cr(e){if(Sr[e])return Sr[e];if(!xr[e])return e;var t,n=xr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Sr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var Er=Cr("animationend"),Ar=Cr("animationiteration"),Ir=Cr("animationstart"),Pr=Cr("transitionend"),Mr=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(e,t){Mr.set(e,t),c(t,[e])}for(var Dr=0;Dr<Tr.length;Dr++){var Or=Tr[Dr];jr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}jr(Er,"onAnimationEnd"),jr(Ar,"onAnimationIteration"),jr(Ir,"onAnimationStart"),jr("dblclick","onDoubleClick"),jr("focusin","onFocus"),jr("focusout","onBlur"),jr(Pr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(zr));function Rr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,s,a,c,l){if($e.apply(this,arguments),Fe){if(!Fe)throw Error(i(198));var u=Re;Fe=!1,Re=null,Le||(Le=!0,Ne=u)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&o.isPropagationStopped())break e;Rr(o,a,l),i=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,l=a.currentTarget,a=a.listener,c!==i&&o.isPropagationStopped())break e;Rr(o,a,l),i=c}}}if(Le)throw e=Ne,Le=!1,Ne=null,e}function Nr(e,t){var n=t[mo];void 0===n&&(n=t[mo]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var $r="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[$r]){e[$r]=!0,s.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$r]||(t[$r]=!0,Br("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Xt(t)){case 1:var o=Kt;break;case 4:o=Ht;break;default:o=Gt}n=o.bind(null,t,n,e),o=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,o){var i=r;if(0==(1&t)&&0==(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===o||8===a.nodeType&&a.parentNode===o)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;s=s.return}for(;null!==a;){if(null===(s=wo(a)))return;if(5===(c=s.tag)||6===c){r=i=s;continue e}a=a.parentNode}}r=r.return}Te((function(){var r=i,o=be(n),s=[];e:{var a=Mr.get(e);if(void 0!==a){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=An;break;case"focusin":l="focus",c=mn;break;case"focusout":l="blur",c=mn;break;case"beforeblur":case"afterblur":c=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Pn;break;case Er:case Ar:case Ir:c=_n;break;case Pr:c=Mn;break;case"scroll":c=hn;break;case"wheel":c=jn;break;case"copy":case"cut":case"paste":c=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=In}var u=0!=(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=r;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==h&&null!=(g=je(f,h))&&u.push(Kr(f,g,p))),d)break;f=f.return}0<u.length&&(a=new c(a,l,null,n,o),s.push({event:a,listeners:u}))}}if(0==(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ve||!(l=n.relatedTarget||n.fromElement)||!wo(l)&&!l[go])&&(c||a)&&(a=o.window===o?o:(a=o.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?wo(l):null)&&(l!==(d=Ue(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=fn,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,g="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?a:bo(c),p=null==l?a:bo(l),(a=new u(g,f+"leave",c,n,o)).target=d,a.relatedTarget=p,g=null,wo(o)===r&&((u=new u(h,f+"enter",l,n,o)).target=p,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(h=l,f=0,p=u=c;p;p=Gr(p))f++;for(p=0,g=h;g;g=Gr(g))p++;for(;0<f-p;)u=Gr(u),f--;for(;0<p-f;)h=Gr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Gr(u),h=Gr(h)}u=null}else u=null;null!==c&&qr(s,a,c,u,!1),null!==l&&null!==d&&qr(s,d,l,u,!0)}if("select"===(c=(a=r?bo(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var m=Xn;else if(Wn(a))if(Zn)m=sr;else{m=or;var _=rr}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=ir);switch(m&&(m=m(e,r))?Kn(s,m,n,o):(_&&_(e,a,r),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&ee(a,"number",a.value)),_=r?bo(r):window,e){case"focusin":(Wn(_)||"true"===_.contentEditable)&&(mr=_,_r=r,yr=null);break;case"focusout":yr=_r=mr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,vr(s,n,o);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":vr(s,n,o)}var y;if(On)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Un?Bn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Rn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==w?"onCompositionEnd"===w&&Un&&(y=en()):(Qt="value"in(Zt=o)?Zt.value:Zt.textContent,Un=!0)),0<(_=Hr(r,w)).length&&(w=new vn(w,e,null,n,o),s.push({event:w,listeners:_}),(y||null!==(y=$n(n)))&&(w.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return $n(t);case"keypress":return 32!==t.which?null:(Nn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Nn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!On&&Bn(e,t)?(e=en(),Jt=Qt=Zt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(r=Hr(r,"onBeforeInput")).length&&(o=new vn("onBeforeInput","beforeinput",null,n,o),s.push({event:o,listeners:r}),o.data=y)}Lr(s,t)}))}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=je(e,n))&&r.unshift(Kr(e,i,o)),null!=(i=je(e,t))&&r.push(Kr(e,i,o))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,t,n,r,o){for(var i=t._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==l&&(a=l,o?null!=(c=je(n,i))&&s.unshift(Kr(n,c,a)):o||null!=(c=je(n,i))&&s.push(Kr(n,c,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Zr(e){return("string"==typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function Qr(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(i(425))}function Jr(){}var eo=null,to=null;function no(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ro="function"==typeof setTimeout?setTimeout:void 0,oo="function"==typeof clearTimeout?clearTimeout:void 0,io="function"==typeof Promise?Promise:void 0,so="function"==typeof queueMicrotask?queueMicrotask:void 0!==io?function(e){return io.resolve(null).then(e).catch(ao)}:ro;function ao(e){setTimeout((function(){throw e}))}function co(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);Ut(t)}function lo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function uo(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),po="__reactFiber$"+ho,fo="__reactProps$"+ho,go="__reactContainer$"+ho,mo="__reactEvents$"+ho,_o="__reactListeners$"+ho,yo="__reactHandles$"+ho;function wo(e){var t=e[po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[go]||n[po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=uo(e);null!==e;){if(n=e[po])return n;e=uo(e)}return t}n=(e=n).parentNode}return null}function vo(e){return!(e=e[po]||e[go])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xo(e){return e[fo]||null}var So=[],ko=-1;function Co(e){return{current:e}}function Eo(e){0>ko||(e.current=So[ko],So[ko]=null,ko--)}function Ao(e,t){ko++,So[ko]=e.current,e.current=t}var Io={},Po=Co(Io),Mo=Co(!1),To=Io;function jo(e,t){var n=e.type.contextTypes;if(!n)return Io;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Do(e){return null!=e.childContextTypes}function Oo(){Eo(Mo),Eo(Po)}function zo(e,t,n){if(Po.current!==Io)throw Error(i(168));Ao(Po,t),Ao(Mo,n)}function Fo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(i(108,V(e)||"Unknown",o));return R({},n,r)}function Ro(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Io,To=Po.current,Ao(Po,e),Ao(Mo,Mo.current),!0}function Lo(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Fo(e,t,To),r.__reactInternalMemoizedMergedChildContext=e,Eo(Mo),Eo(Po),Ao(Po,e)):Eo(Mo),Ao(Mo,n)}var No=null,Bo=!1,$o=!1;function Uo(e){null===No?No=[e]:No.push(e)}function Vo(){if(!$o&&null!==No){$o=!0;var e=0,t=wt;try{var n=No;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}No=null,Bo=!1}catch(t){throw null!==No&&(No=No.slice(e+1)),Ge(Je,Vo),t}finally{wt=t,$o=!1}}return null}var Wo=[],Ko=0,Ho=null,Go=0,qo=[],Yo=0,Xo=null,Zo=1,Qo="";function Jo(e,t){Wo[Ko++]=Go,Wo[Ko++]=Ho,Ho=e,Go=t}function ei(e,t,n){qo[Yo++]=Zo,qo[Yo++]=Qo,qo[Yo++]=Xo,Xo=e;var r=Zo;e=Qo;var o=32-st(r)-1;r&=~(1<<o),n+=1;var i=32-st(t)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Zo=1<<32-st(t)+o|n<<o|r,Qo=i+e}else Zo=1<<i|n<<o|r,Qo=e}function ti(e){null!==e.return&&(Jo(e,1),ei(e,1,0))}function ni(e){for(;e===Ho;)Ho=Wo[--Ko],Wo[Ko]=null,Go=Wo[--Ko],Wo[Ko]=null;for(;e===Xo;)Xo=qo[--Yo],qo[Yo]=null,Qo=qo[--Yo],qo[Yo]=null,Zo=qo[--Yo],qo[Yo]=null}var ri=null,oi=null,ii=!1,si=null;function ai(e,t){var n=jl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ci(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,oi=lo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,oi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xo?{id:Zo,overflow:Qo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=jl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ri=e,oi=null,!0);default:return!1}}function li(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ui(e){if(ii){var t=oi;if(t){var n=t;if(!ci(e,t)){if(li(e))throw Error(i(418));t=lo(n.nextSibling);var r=ri;t&&ci(e,t)?ai(r,n):(e.flags=-4097&e.flags|2,ii=!1,ri=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ri=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function hi(e){if(e!==ri)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!no(e.type,e.memoizedProps)),t&&(t=oi)){if(li(e))throw pi(),Error(i(418));for(;t;)ai(e,t),t=lo(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){oi=lo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}oi=null}}else oi=ri?lo(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=oi;e;)e=lo(e.nextSibling)}function fi(){oi=ri=null,ii=!1}function gi(e){null===si?si=[e]:si.push(e)}var mi=v.ReactCurrentBatchConfig;function _i(e,t){if(e&&e.defaultProps){for(var n in t=R({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yi=Co(null),wi=null,vi=null,bi=null;function xi(){bi=vi=wi=null}function Si(e){var t=yi.current;Eo(yi),e._currentValue=t}function ki(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t){wi=e,bi=vi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(va=!0),e.firstContext=null)}function Ei(e){var t=e._currentValue;if(bi!==e)if(e={context:e,memoizedValue:t,next:null},null===vi){if(null===wi)throw Error(i(308));vi=e,wi.dependencies={lanes:0,firstContext:e}}else vi=vi.next=e;return t}var Ai=null;function Ii(e){null===Ai?Ai=[e]:Ai.push(e)}function Pi(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Ii(t)):(n.next=o.next,o.next=n),t.interleaved=n,Mi(e,r)}function Mi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ti=!1;function ji(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Di(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!=(2&Pc)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Mi(e,n)}return null===(o=r.interleaved)?(t.next=t,Ii(r)):(t.next=o.next,o.next=t),r.interleaved=t,Mi(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ri(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var o=e.updateQueue;Ti=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(null!==a){o.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?i=l:s.next=l,s=c;var u=e.alternate;null!==u&&(a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c)}if(null!==i){var d=o.baseState;for(s=0,u=l=c=null,a=i;;){var h=a.lane,p=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(h=t,p=n,g.tag){case 1:if("function"==typeof(f=g.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=g.payload)?f.call(p,d,h):f))break e;d=R({},d,h);break e;case 2:Ti=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=o.effects)?o.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=p,c=d):u=u.next=p,s|=h;if(null===(a=a.next)){if(null===(a=o.shared.pending))break;a=(h=a).next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}if(null===u&&(c=d),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{s|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);Rc|=s,e.lanes=s,e.memoizedState=d}}function Ni(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(i(191,o));o.call(r)}}}var Bi=(new r.Component).refs;function $i(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:R({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ui={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),o=nl(e),i=Oi(r,o);i.payload=t,null!=n&&(i.callback=n),null!==(t=zi(e,i,o))&&(rl(t,e,o,r),Fi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),o=nl(e),i=Oi(r,o);i.tag=1,i.payload=t,null!=n&&(i.callback=n),null!==(t=zi(e,i,o))&&(rl(t,e,o,r),Fi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),o=Oi(n,r);o.tag=2,null!=t&&(o.callback=t),null!==(t=zi(e,o,r))&&(rl(t,e,r,n),Fi(t,e,r))}};function Vi(e,t,n,r,o,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!(t.prototype&&t.prototype.isPureReactComponent&&cr(n,r)&&cr(o,i))}function Wi(e,t,n){var r=!1,o=Io,i=t.contextType;return"object"==typeof i&&null!==i?i=Ei(i):(o=Do(t)?To:Po.current,i=(r=null!=(r=t.contextTypes))?jo(e,o):Io),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ui,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ki(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ui.enqueueReplaceState(t,t.state,null)}function Hi(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=Bi,ji(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=Ei(i):(i=Do(t)?To:Po.current,o.context=jo(e,i)),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&($i(e,t,i,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&Ui.enqueueReplaceState(o,o.state,null),Li(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function Gi(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var o=r,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=o.refs;t===Bi&&(t=o.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!=typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yi(e){return(0,e._init)(e._payload)}function Xi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Ol(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Ll(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===j&&Yi(i)===t.type)?((r=o(t,n.props)).ref=Gi(e,t,n),r.return=e,r):((r=zl(n.type,n.key,n.props,null,e.mode,r)).ref=Gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Nl(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Fl(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case b:return(n=zl(t.type,t.key,t.props,null,e.mode,n)).ref=Gi(e,null,t),n.return=e,n;case x:return(t=Nl(t,e.mode,n)).return=e,t;case j:return h(e,(0,t._init)(t._payload),n)}if(te(t)||z(t))return(t=Fl(t,e.mode,n,null)).return=e,t;qi(e,t)}return null}function p(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:c(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===o?l(e,t,n,r):null;case x:return n.key===o?u(e,t,n,r):null;case j:return p(e,t,(o=n._init)(n._payload),r)}if(te(n)||z(n))return null!==o?null:d(e,t,n,r,null);qi(e,n)}return null}function f(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r)return c(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case b:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case j:return f(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||z(r))return d(t,e=e.get(n)||null,r,o,null);qi(t,r)}return null}function g(o,i,a,c){for(var l=null,u=null,d=i,g=i=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var _=p(o,d,a[g],c);if(null===_){null===d&&(d=m);break}e&&d&&null===_.alternate&&t(o,d),i=s(_,i,g),null===u?l=_:u.sibling=_,u=_,d=m}if(g===a.length)return n(o,d),ii&&Jo(o,g),l;if(null===d){for(;g<a.length;g++)null!==(d=h(o,a[g],c))&&(i=s(d,i,g),null===u?l=d:u.sibling=d,u=d);return ii&&Jo(o,g),l}for(d=r(o,d);g<a.length;g++)null!==(m=f(d,o,g,a[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),i=s(m,i,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(o,e)})),ii&&Jo(o,g),l}function m(o,a,c,l){var u=z(c);if("function"!=typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var d=u=null,g=a,m=a=0,_=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(_=g,g=null):_=g.sibling;var w=p(o,g,y.value,l);if(null===w){null===g&&(g=_);break}e&&g&&null===w.alternate&&t(o,g),a=s(w,a,m),null===d?u=w:d.sibling=w,d=w,g=_}if(y.done)return n(o,g),ii&&Jo(o,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=h(o,y.value,l))&&(a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return ii&&Jo(o,m),u}for(g=r(o,g);!y.done;m++,y=c.next())null!==(y=f(g,o,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(o,e)})),ii&&Jo(o,m),u}return function e(r,i,s,c){if("object"==typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var l=s.key,u=i;null!==u;){if(u.key===l){if((l=s.type)===S){if(7===u.tag){n(r,u.sibling),(i=o(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===l||"object"==typeof l&&null!==l&&l.$$typeof===j&&Yi(l)===u.type){n(r,u.sibling),(i=o(u,s.props)).ref=Gi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===S?((i=Fl(s.props.children,r.mode,c,s.key)).return=r,r=i):((c=zl(s.type,s.key,s.props,null,r.mode,c)).ref=Gi(r,i,s),c.return=r,r=c)}return a(r);case x:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=o(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Nl(s,r.mode,c)).return=r,r=i}return a(r);case j:return e(r,i,(u=s._init)(s._payload),c)}if(te(s))return g(r,i,s,c);if(z(s))return m(r,i,s,c);qi(r,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,s)).return=r,r=i):(n(r,i),(i=Ll(s,r.mode,c)).return=r,r=i),a(r)):n(r,i)}}var Zi=Xi(!0),Qi=Xi(!1),Ji={},es=Co(Ji),ts=Co(Ji),ns=Co(Ji);function rs(e){if(e===Ji)throw Error(i(174));return e}function os(e,t){switch(Ao(ns,t),Ao(ts,e),Ao(es,Ji),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Eo(es),Ao(es,t)}function is(){Eo(es),Eo(ts),Eo(ns)}function ss(e){rs(ns.current);var t=rs(es.current),n=ce(t,e.type);t!==n&&(Ao(ts,e),Ao(es,n))}function as(e){ts.current===e&&(Eo(es),Eo(ts))}var cs=Co(0);function ls(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var us=[];function ds(){for(var e=0;e<us.length;e++)us[e]._workInProgressVersionPrimary=null;us.length=0}var hs=v.ReactCurrentDispatcher,ps=v.ReactCurrentBatchConfig,fs=0,gs=null,ms=null,_s=null,ys=!1,ws=!1,vs=0,bs=0;function xs(){throw Error(i(321))}function Ss(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function ks(e,t,n,r,o,s){if(fs=s,gs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?aa:ca,e=n(r,o),ws){s=0;do{if(ws=!1,vs=0,25<=s)throw Error(i(301));s+=1,_s=ms=null,t.updateQueue=null,hs.current=la,e=n(r,o)}while(ws)}if(hs.current=sa,t=null!==ms&&null!==ms.next,fs=0,_s=ms=gs=null,ys=!1,t)throw Error(i(300));return e}function Cs(){var e=0!==vs;return vs=0,e}function Es(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===_s?gs.memoizedState=_s=e:_s=_s.next=e,_s}function As(){if(null===ms){var e=gs.alternate;e=null!==e?e.memoizedState:null}else e=ms.next;var t=null===_s?gs.memoizedState:_s.next;if(null!==t)_s=t,ms=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ms=e).memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},null===_s?gs.memoizedState=_s=e:_s=_s.next=e}return _s}function Is(e,t){return"function"==typeof t?t(e):t}function Ps(e){var t=As(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ms,o=r.baseQueue,s=n.pending;if(null!==s){if(null!==o){var a=o.next;o.next=s.next,s.next=a}r.baseQueue=o=s,n.pending=null}if(null!==o){s=o.next,r=r.baseState;var c=a=null,l=null,u=s;do{var d=u.lane;if((fs&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,a=r):l=l.next=h,gs.lanes|=d,Rc|=d}u=u.next}while(null!==u&&u!==s);null===l?a=r:l.next=c,ar(r,t.memoizedState)||(va=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{s=o.lane,gs.lanes|=s,Rc|=s,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ms(e){var t=As(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,s=t.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{s=e(s,a.action),a=a.next}while(a!==o);ar(s,t.memoizedState)||(va=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ts(){}function js(e,t){var n=gs,r=As(),o=t(),s=!ar(r.memoizedState,o);if(s&&(r.memoizedState=o,va=!0),r=r.queue,Ws(zs.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==_s&&1&_s.memoizedState.tag){if(n.flags|=2048,Ns(9,Os.bind(null,n,r,o,t),void 0,null),null===Mc)throw Error(i(349));0!=(30&fs)||Ds(n,t,o)}return o}function Ds(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Os(e,t,n,r){t.value=n,t.getSnapshot=r,Fs(t)&&Rs(e)}function zs(e,t,n){return n((function(){Fs(t)&&Rs(e)}))}function Fs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(e){return!0}}function Rs(e){var t=Mi(e,1);null!==t&&rl(t,e,1,-1)}function Ls(e){var t=Es();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,gs,e),[t.memoizedState,e]}function Ns(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Bs(){return As().memoizedState}function $s(e,t,n,r){var o=Es();gs.flags|=e,o.memoizedState=Ns(1|t,n,void 0,void 0===r?null:r)}function Us(e,t,n,r){var o=As();r=void 0===r?null:r;var i=void 0;if(null!==ms){var s=ms.memoizedState;if(i=s.destroy,null!==r&&Ss(r,s.deps))return void(o.memoizedState=Ns(t,n,i,r))}gs.flags|=e,o.memoizedState=Ns(1|t,n,i,r)}function Vs(e,t){return $s(8390656,8,e,t)}function Ws(e,t){return Us(2048,8,e,t)}function Ks(e,t){return Us(4,2,e,t)}function Hs(e,t){return Us(4,4,e,t)}function Gs(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qs(e,t,n){return n=null!=n?n.concat([e]):null,Us(4,4,Gs.bind(null,t,e),n)}function Ys(){}function Xs(e,t){var n=As();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ss(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Zs(e,t){var n=As();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ss(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Qs(e,t,n){return 0==(21&fs)?(e.baseState&&(e.baseState=!1,va=!0),e.memoizedState=n):(ar(n,t)||(n=gt(),gs.lanes|=n,Rc|=n,e.baseState=!0),t)}function Js(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=ps.transition;ps.transition={};try{e(!1),t()}finally{wt=n,ps.transition=r}}function ea(){return As().memoizedState}function ta(e,t,n){var r=nl(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ra(e)?oa(t,n):null!==(n=Pi(e,t,n,r))&&(rl(n,e,r,tl()),ia(n,t,r))}function na(e,t,n){var r=nl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ra(e))oa(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,ar(a,s)){var c=t.interleaved;return null===c?(o.next=o,Ii(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(e){}null!==(n=Pi(e,t,o,r))&&(rl(n,e,r,o=tl()),ia(n,t,r))}}function ra(e){var t=e.alternate;return e===gs||null!==t&&t===gs}function oa(e,t){ws=ys=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ia(e,t,n){if(0!=(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var sa={readContext:Ei,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},aa={readContext:Ei,useCallback:function(e,t){return Es().memoizedState=[e,void 0===t?null:t],e},useContext:Ei,useEffect:Vs,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,$s(4194308,4,Gs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $s(4194308,4,e,t)},useInsertionEffect:function(e,t){return $s(4,2,e,t)},useMemo:function(e,t){var n=Es();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Es();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ta.bind(null,gs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Es().memoizedState=e},useState:Ls,useDebugValue:Ys,useDeferredValue:function(e){return Es().memoizedState=e},useTransition:function(){var e=Ls(!1),t=e[0];return e=Js.bind(null,e[1]),Es().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=gs,o=Es();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Mc)throw Error(i(349));0!=(30&fs)||Ds(r,t,n)}o.memoizedState=n;var s={value:n,getSnapshot:t};return o.queue=s,Vs(zs.bind(null,r,s,e),[e]),r.flags|=2048,Ns(9,Os.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Es(),t=Mc.identifierPrefix;if(ii){var n=Qo;t=":"+t+"R"+(n=(Zo&~(1<<32-st(Zo)-1)).toString(32)+n),0<(n=vs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=bs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:Ei,useCallback:Xs,useContext:Ei,useEffect:Ws,useImperativeHandle:qs,useInsertionEffect:Ks,useLayoutEffect:Hs,useMemo:Zs,useReducer:Ps,useRef:Bs,useState:function(){return Ps(Is)},useDebugValue:Ys,useDeferredValue:function(e){return Qs(As(),ms.memoizedState,e)},useTransition:function(){return[Ps(Is)[0],As().memoizedState]},useMutableSource:Ts,useSyncExternalStore:js,useId:ea,unstable_isNewReconciler:!1},la={readContext:Ei,useCallback:Xs,useContext:Ei,useEffect:Ws,useImperativeHandle:qs,useInsertionEffect:Ks,useLayoutEffect:Hs,useMemo:Zs,useReducer:Ms,useRef:Bs,useState:function(){return Ms(Is)},useDebugValue:Ys,useDeferredValue:function(e){var t=As();return null===ms?t.memoizedState=e:Qs(t,ms.memoizedState,e)},useTransition:function(){return[Ms(Is)[0],As().memoizedState]},useMutableSource:Ts,useSyncExternalStore:js,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",r=t;do{n+=$(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var pa="function"==typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Oi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Kc||(Kc=!0,Hc=r),ha(0,t)},n}function ga(e,t,n){(n=Oi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){ha(0,t)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!=typeof r&&(null===Gc?Gc=new Set([this]):Gc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new pa;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=El.bind(null,e,t,n),t.then(e,e))}function _a(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,o){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Oi(-1,1)).tag=2,zi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var wa=v.ReactCurrentOwner,va=!1;function ba(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Zi(t,e.child,n,r)}function xa(e,t,n,r,o){n=n.render;var i=t.ref;return Ci(t,o),r=ks(e,t,n,r,i,o),n=Cs(),null===e||va?(ii&&n&&ti(t),t.flags|=1,ba(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ka(e,t,o))}function Sa(e,t,n,r,o){if(null===e){var i=n.type;return"function"!=typeof i||Dl(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=zl(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ka(e,t,i,r,o))}if(i=e.child,0==(e.lanes&o)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(s,r)&&e.ref===t.ref)return Ka(e,t,o)}return t.flags|=1,(e=Ol(i,r)).ref=t.ref,e.return=t,t.child=e}function ka(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(cr(i,r)&&e.ref===t.ref){if(va=!1,t.pendingProps=r=i,0==(e.lanes&o))return t.lanes=e.lanes,Ka(e,t,o);0!=(131072&e.flags)&&(va=!0)}}return Aa(e,t,n,r,o)}function Ca(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ao(Oc,Dc),Dc|=n;else{if(0==(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ao(Oc,Dc),Dc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ao(Oc,Dc),Dc|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ao(Oc,Dc),Dc|=r;return ba(e,t,o,n),t.child}function Ea(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Aa(e,t,n,r,o){var i=Do(n)?To:Po.current;return i=jo(t,i),Ci(t,o),n=ks(e,t,n,r,i,o),r=Cs(),null===e||va?(ii&&r&&ti(t),t.flags|=1,ba(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ka(e,t,o))}function Ia(e,t,n,r,o){if(Do(n)){var i=!0;Ro(t)}else i=!1;if(Ci(t,o),null===t.stateNode)Wa(e,t),Wi(t,n,r),Hi(t,n,r,o),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;l="object"==typeof l&&null!==l?Ei(l):jo(t,l=Do(n)?To:Po.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||c!==l)&&Ki(t,s,r,l),Ti=!1;var h=t.memoizedState;s.state=h,Li(t,r,s,o),c=t.memoizedState,a!==r||h!==c||Mo.current||Ti?("function"==typeof u&&($i(t,n,u,r),c=t.memoizedState),(a=Ti||Vi(t,n,a,r,h,c,l))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Di(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:_i(t.type,a),s.props=l,d=t.pendingProps,h=s.context,c="object"==typeof(c=n.contextType)&&null!==c?Ei(c):jo(t,c=Do(n)?To:Po.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||h!==c)&&Ki(t,s,r,c),Ti=!1,h=t.memoizedState,s.state=h,Li(t,r,s,o);var f=t.memoizedState;a!==d||h!==f||Mo.current||Ti?("function"==typeof p&&($i(t,n,p,r),f=t.memoizedState),(l=Ti||Vi(t,n,l,r,h,f,c)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,c),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,c)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=c,r=l):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Pa(e,t,n,r,i,o)}function Pa(e,t,n,r,o,i){Ea(e,t);var s=0!=(128&t.flags);if(!r&&!s)return o&&Lo(t,n,!1),Ka(e,t,i);r=t.stateNode,wa.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Zi(t,e.child,null,i),t.child=Zi(t,null,a,i)):ba(e,t,a,i),t.memoizedState=r.state,o&&Lo(t,n,!0),t.child}function Ma(e){var t=e.stateNode;t.pendingContext?zo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&zo(0,t.context,!1),os(e,t.containerInfo)}function Ta(e,t,n,r,o){return fi(),gi(o),t.flags|=256,ba(e,t,n,r),t.child}var ja,Da,Oa,za,Fa={dehydrated:null,treeContext:null,retryLane:0};function Ra(e){return{baseLanes:e,cachePool:null,transitions:null}}function La(e,t,n){var r,o=t.pendingProps,s=cs.current,a=!1,c=0!=(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!=(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ao(cs,1&s),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=o.children,e=o.fallback,a?(o=t.mode,a=t.child,c={mode:"hidden",children:c},0==(1&o)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Rl(c,o,0,null),e=Fl(e,o,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ra(n),t.memoizedState=Fa,e):Na(t,c));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,o,s,a){if(n)return 256&t.flags?(t.flags&=-257,Ba(e,t,a,r=da(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,o=t.mode,r=Rl({mode:"visible",children:r.children},o,0,null),(s=Fl(s,o,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!=(1&t.mode)&&Zi(t,e.child,null,a),t.child.memoizedState=Ra(a),t.memoizedState=Fa,s);if(0==(1&t.mode))return Ba(e,t,a,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var c=r.dgst;return r=c,Ba(e,t,a,r=da(s=Error(i(419)),r,void 0))}if(c=0!=(a&e.childLanes),va||c){if(null!==(r=Mc)){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!=(o&(r.suspendedLanes|a))?0:o)&&o!==s.retryLane&&(s.retryLane=o,Mi(e,o),rl(r,e,o,-1))}return ml(),Ba(e,t,a,r=da(Error(i(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,oi=lo(o.nextSibling),ri=t,ii=!0,si=null,null!==e&&(qo[Yo++]=Zo,qo[Yo++]=Qo,qo[Yo++]=Xo,Zo=e.id,Qo=e.overflow,Xo=t),(t=Na(t,r.children)).flags|=4096,t)}(e,t,c,o,r,s,n);if(a){a=o.fallback,c=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:o.children};return 0==(1&c)&&t.child!==s?((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null):(o=Ol(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?a=Ol(r,a):(a=Fl(a,c,n,null)).flags|=2,a.return=t,o.return=t,o.sibling=a,t.child=o,o=a,a=t.child,c=null===(c=e.child.memoizedState)?Ra(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,o}return e=(a=e.child).sibling,o=Ol(a,{mode:"visible",children:o.children}),0==(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Na(e,t){return(t=Rl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ba(e,t,n,r){return null!==r&&gi(r),Zi(t,e.child,null,n),(e=Na(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function $a(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ki(e.return,t,n)}function Ua(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function Va(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(ba(e,t,r.children,n),0!=(2&(r=cs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$a(e,n,t);else if(19===e.tag)$a(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ao(cs,r),0==(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ls(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ua(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ls(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ua(t,!0,n,null,i);break;case"together":Ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wa(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ka(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Rc|=t.lanes,0==(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ol(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ol(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ha(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ga(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function qa(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(t),null;case 1:case 17:return Do(t.type)&&Oo(),Ga(t),null;case 3:return r=t.stateNode,is(),Eo(Mo),Eo(Po),ds(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==si&&(al(si),si=null))),Da(e,t),Ga(t),null;case 5:as(t);var o=rs(ns.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Ga(t),null}if(e=rs(es.current),hi(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[po]=t,r[fo]=s,e=0!=(1&t.mode),n){case"dialog":Nr("cancel",r),Nr("close",r);break;case"iframe":case"object":case"embed":Nr("load",r);break;case"video":case"audio":for(o=0;o<zr.length;o++)Nr(zr[o],r);break;case"source":Nr("error",r);break;case"img":case"image":case"link":Nr("error",r),Nr("load",r);break;case"details":Nr("toggle",r);break;case"input":X(r,s),Nr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Nr("invalid",r);break;case"textarea":oe(r,s),Nr("invalid",r)}for(var c in ye(n,s),o=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"==typeof l?r.textContent!==l&&(!0!==s.suppressHydrationWarning&&Qr(r.textContent,l,e),o=["children",l]):"number"==typeof l&&r.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&Qr(r.textContent,l,e),o=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Nr("scroll",r)}switch(n){case"input":H(r),J(r,s,!0);break;case"textarea":H(r),se(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=Jr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[po]=t,e[fo]=r,ja(e,t,!1,!1),t.stateNode=e;e:{switch(c=we(n,r),n){case"dialog":Nr("cancel",e),Nr("close",e),o=r;break;case"iframe":case"object":case"embed":Nr("load",e),o=r;break;case"video":case"audio":for(o=0;o<zr.length;o++)Nr(zr[o],e);o=r;break;case"source":Nr("error",e),o=r;break;case"img":case"image":case"link":Nr("error",e),Nr("load",e),o=r;break;case"details":Nr("toggle",e),o=r;break;case"input":X(e,r),o=Y(e,r),Nr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=R({},r,{value:void 0}),Nr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),Nr("invalid",e)}for(s in ye(n,o),l=o)if(l.hasOwnProperty(s)){var u=l[s];"style"===s?me(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Nr("scroll",e):null!=u&&w(e,s,u,c))}switch(n){case"input":H(e),J(e,r,!1);break;case"textarea":H(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ga(t),null;case 6:if(e&&null!=t.stateNode)za(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(i(166));if(n=rs(ns.current),rs(es.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[po]=t,(s=r.nodeValue!==n)&&null!==(e=ri))switch(e.tag){case 3:Qr(r.nodeValue,n,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!=(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[po]=t,t.stateNode=r}return Ga(t),null;case 13:if(Eo(cs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==oi&&0!=(1&t.mode)&&0==(128&t.flags))pi(),fi(),t.flags|=98560,s=!1;else if(s=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[po]=t}else fi(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ga(t),s=!1}else null!==si&&(al(si),si=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=n,t):((r=null!==r)!=(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&cs.current)?0===zc&&(zc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Ga(t),null);case 4:return is(),Da(e,t),null===e&&Ur(t.stateNode.containerInfo),Ga(t),null;case 10:return Si(t.type._context),Ga(t),null;case 19:if(Eo(cs),null===(s=t.memoizedState))return Ga(t),null;if(r=0!=(128&t.flags),null===(c=s.rendering))if(r)Ha(s,!1);else{if(0!==zc||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ls(e))){for(t.flags|=128,Ha(s,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ao(cs,1&cs.current|2),t.child}e=e.sibling}null!==s.tail&&Ze()>Vc&&(t.flags|=128,r=!0,Ha(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ls(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ha(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!ii)return Ga(t),null}else 2*Ze()-s.renderingStartTime>Vc&&1073741824!==n&&(t.flags|=128,r=!0,Ha(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=s.last)?n.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ze(),t.sibling=null,n=cs.current,Ao(cs,r?1&n|2:1&n),t):(Ga(t),null);case 22:case 23:return hl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!=(1&t.mode)?0!=(1073741824&Dc)&&(Ga(t),6&t.subtreeFlags&&(t.flags|=8192)):Ga(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ya(e,t){switch(ni(t),t.tag){case 1:return Do(t.type)&&Oo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),Eo(Mo),Eo(Po),ds(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return as(t),null;case 13:if(Eo(cs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Eo(cs),null;case 4:return is(),null;case 10:return Si(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}ja=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},Oa=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,rs(es.current);var i,s=null;switch(n){case"input":o=Y(e,o),r=Y(e,r),s=[];break;case"select":o=R({},o,{value:void 0}),r=R({},r,{value:void 0}),s=[];break;case"textarea":o=re(e,o),r=re(e,r),s=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=Jr)}for(u in ye(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var c=o[u];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Nr("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},za=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xa=!1,Za=!1,Qa="function"==typeof WeakSet?WeakSet:Set,Ja=null;function ec(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Cl(e,t,n)}else n.current=null}function tc(e,t,n){try{n()}catch(n){Cl(e,t,n)}}var nc=!1;function rc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&tc(t,n,i)}o=o.next}while(o!==r)}}function oc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ic(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[po],delete t[fo],delete t[mo],delete t[_o],delete t[yo]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}var dc=null,hc=!1;function pc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(it&&"function"==typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(ot,n)}catch(e){}switch(n.tag){case 5:Za||ec(n,t);case 6:var r=dc,o=hc;dc=null,pc(e,t,n),hc=o,null!==(dc=r)&&(hc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(hc?(e=dc,n=n.stateNode,8===e.nodeType?co(e.parentNode,n):1===e.nodeType&&co(e,n),Ut(e)):co(dc,n.stateNode));break;case 4:r=dc,o=hc,dc=n.stateNode.containerInfo,hc=!0,pc(e,t,n),dc=r,hc=o;break;case 0:case 11:case 14:case 15:if(!Za&&null!==(r=n.updateQueue)&&null!==(r=r.lastEffect)){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,void 0!==s&&(0!=(2&i)||0!=(4&i))&&tc(n,t,s),o=o.next}while(o!==r)}pc(e,t,n);break;case 1:if(!Za&&(ec(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Cl(n,t,e)}pc(e,t,n);break;case 21:pc(e,t,n);break;case 22:1&n.mode?(Za=(r=Za)||null!==n.memoizedState,pc(e,t,n),Za=r):pc(e,t,n);break;default:pc(e,t,n)}}function gc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qa),t.forEach((function(t){var r=Pl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var s=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,hc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,hc=!0;break e}c=c.return}if(null===dc)throw Error(i(160));fc(s,a,o),dc=null,hc=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(e){Cl(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)_c(t,e),t=t.sibling}function _c(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),yc(e),4&r){try{rc(3,e,e.return),oc(3,e)}catch(t){Cl(e,e.return,t)}try{rc(5,e,e.return)}catch(t){Cl(e,e.return,t)}}break;case 1:mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return);break;case 5:if(mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(t){Cl(e,e.return,t)}}if(4&r&&null!=(o=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===s.type&&null!=s.name&&Z(o,s),we(c,a);var u=we(c,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];"style"===d?me(o,h):"dangerouslySetInnerHTML"===d?de(o,h):"children"===d?he(o,h):w(o,d,h,u)}switch(c){case"input":Q(o,s);break;case"textarea":ie(o,s);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(o,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(o,!!s.multiple,s.defaultValue,!0):ne(o,!!s.multiple,s.multiple?[]:"",!1))}o[fo]=s}catch(t){Cl(e,e.return,t)}}break;case 6:if(mc(t,e),yc(e),4&r){if(null===e.stateNode)throw Error(i(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(t){Cl(e,e.return,t)}}break;case 3:if(mc(t,e),yc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(t){Cl(e,e.return,t)}break;case 4:default:mc(t,e),yc(e);break;case 13:mc(t,e),yc(e),8192&(o=e.child).flags&&(s=null!==o.memoizedState,o.stateNode.isHidden=s,!s||null!==o.alternate&&null!==o.alternate.memoizedState||(Uc=Ze())),4&r&&gc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Za=(u=Za)||d,mc(t,e),Za=u):mc(t,e),yc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!=(1&e.mode))for(Ja=e,d=e.child;null!==d;){for(h=Ja=d;null!==Ja;){switch(f=(p=Ja).child,p.tag){case 0:case 11:case 14:case 15:rc(4,p,p.return);break;case 1:ec(p,p.return);var g=p.stateNode;if("function"==typeof g.componentWillUnmount){r=p,n=p.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){Cl(r,n,e)}}break;case 5:ec(p,p.return);break;case 22:if(null!==p.memoizedState){xc(h);continue}}null!==f?(f.return=p,Ja=f):xc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{o=h.stateNode,u?"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,a=null!=(l=h.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",a))}catch(t){Cl(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(t){Cl(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mc(t,e),yc(e),4&r&&gc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ac(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(he(o,""),r.flags&=-33),uc(e,cc(e),o);break;case 3:case 4:var s=r.stateNode.containerInfo;lc(e,cc(e),s);break;default:throw Error(i(161))}}catch(t){Cl(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wc(e,t,n){Ja=e,vc(e,t,n)}function vc(e,t,n){for(var r=0!=(1&e.mode);null!==Ja;){var o=Ja,i=o.child;if(22===o.tag&&r){var s=null!==o.memoizedState||Xa;if(!s){var a=o.alternate,c=null!==a&&null!==a.memoizedState||Za;a=Xa;var l=Za;if(Xa=s,(Za=c)&&!l)for(Ja=o;null!==Ja;)c=(s=Ja).child,22===s.tag&&null!==s.memoizedState?Sc(o):null!==c?(c.return=s,Ja=c):Sc(o);for(;null!==i;)Ja=i,vc(i,t,n),i=i.sibling;Ja=o,Xa=a,Za=l}bc(e)}else 0!=(8772&o.subtreeFlags)&&null!==i?(i.return=o,Ja=i):bc(e)}}function bc(e){for(;null!==Ja;){var t=Ja;if(0!=(8772&t.flags)){var n=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||oc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Za)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:_i(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Ni(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ni(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ut(h)}}}break;default:throw Error(i(163))}Za||512&t.flags&&ic(t)}catch(e){Cl(t,t.return,e)}}if(t===e){Ja=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ja=n;break}Ja=t.return}}function xc(e){for(;null!==Ja;){var t=Ja;if(t===e){Ja=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ja=n;break}Ja=t.return}}function Sc(e){for(;null!==Ja;){var t=Ja;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{oc(4,t)}catch(e){Cl(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(e){Cl(t,o,e)}}var i=t.return;try{ic(t)}catch(e){Cl(t,i,e)}break;case 5:var s=t.return;try{ic(t)}catch(e){Cl(t,s,e)}}}catch(e){Cl(t,t.return,e)}if(t===e){Ja=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ja=a;break}Ja=t.return}}var kc,Cc=Math.ceil,Ec=v.ReactCurrentDispatcher,Ac=v.ReactCurrentOwner,Ic=v.ReactCurrentBatchConfig,Pc=0,Mc=null,Tc=null,jc=0,Dc=0,Oc=Co(0),zc=0,Fc=null,Rc=0,Lc=0,Nc=0,Bc=null,$c=null,Uc=0,Vc=1/0,Wc=null,Kc=!1,Hc=null,Gc=null,qc=!1,Yc=null,Xc=0,Zc=0,Qc=null,Jc=-1,el=0;function tl(){return 0!=(6&Pc)?Ze():-1!==Jc?Jc:Jc=Ze()}function nl(e){return 0==(1&e.mode)?1:0!=(2&Pc)&&0!==jc?jc&-jc:null!==mi.transition?(0===el&&(el=gt()),el):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rl(e,t,n,r){if(50<Zc)throw Zc=0,Qc=null,Error(i(185));_t(e,n,r),0!=(2&Pc)&&e===Mc||(e===Mc&&(0==(2&Pc)&&(Lc|=n),4===zc&&cl(e,jc)),ol(e,r),1===n&&0===Pc&&0==(1&t.mode)&&(Vc=Ze()+500,Bo&&Vo()))}function ol(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),a=1<<s,c=o[s];-1===c?0!=(a&n)&&0==(a&r)||(o[s]=pt(a,t)):c<=t&&(e.expiredLanes|=a),i&=~a}}(e,t);var r=ht(e,e===Mc?jc:0);if(0===r)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){Bo=!0,Uo(e)}(ll.bind(null,e)):Uo(ll.bind(null,e)),so((function(){0==(6&Pc)&&Vo()})),n=null;else{switch(vt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ml(n,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function il(e,t){if(Jc=-1,el=0,0!=(6&Pc))throw Error(i(327));var n=e.callbackNode;if(Sl()&&e.callbackNode!==n)return null;var r=ht(e,e===Mc?jc:0);if(0===r)return null;if(0!=(30&r)||0!=(r&e.expiredLanes)||t)t=_l(e,r);else{t=r;var o=Pc;Pc|=2;var s=gl();for(Mc===e&&jc===t||(Wc=null,Vc=Ze()+500,pl(e,t));;)try{wl();break}catch(t){fl(e,t)}xi(),Ec.current=s,Pc=o,null!==Tc?t=0:(Mc=null,jc=0,t=zc)}if(0!==t){if(2===t&&0!==(o=ft(e))&&(r=o,t=sl(e,o)),1===t)throw n=Fc,pl(e,0),cl(e,r),ol(e,Ze()),n;if(6===t)cl(e,r);else{if(o=e.current.alternate,0==(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!ar(i(),o))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=_l(e,r))&&0!==(s=ft(e))&&(r=s,t=sl(e,s)),1===t))throw n=Fc,pl(e,0),cl(e,r),ol(e,Ze()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:xl(e,$c,Wc);break;case 3:if(cl(e,r),(130023424&r)===r&&10<(t=Uc+500-Ze())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ro(xl.bind(null,e,$c,Wc),t);break}xl(e,$c,Wc);break;case 4:if(cl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>o&&(o=a),r&=~s}if(r=o,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cc(r/1960))-r)){e.timeoutHandle=ro(xl.bind(null,e,$c,Wc),r);break}xl(e,$c,Wc);break;default:throw Error(i(329))}}}return ol(e,Ze()),e.callbackNode===n?il.bind(null,e):null}function sl(e,t){var n=Bc;return e.current.memoizedState.isDehydrated&&(pl(e,t).flags|=256),2!==(e=_l(e,t))&&(t=$c,$c=n,null!==t&&al(t)),e}function al(e){null===$c?$c=e:$c.push.apply($c,e)}function cl(e,t){for(t&=~Nc,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(0!=(6&Pc))throw Error(i(327));Sl();var t=ht(e,0);if(0==(1&t))return ol(e,Ze()),null;var n=_l(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=sl(e,r))}if(1===n)throw n=Fc,pl(e,0),cl(e,t),ol(e,Ze()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xl(e,$c,Wc),ol(e,Ze()),null}function ul(e,t){var n=Pc;Pc|=1;try{return e(t)}finally{0===(Pc=n)&&(Vc=Ze()+500,Bo&&Vo())}}function dl(e){null!==Yc&&0===Yc.tag&&0==(6&Pc)&&Sl();var t=Pc;Pc|=1;var n=Ic.transition,r=wt;try{if(Ic.transition=null,wt=1,e)return e()}finally{wt=r,Ic.transition=n,0==(6&(Pc=t))&&Vo()}}function hl(){Dc=Oc.current,Eo(Oc)}function pl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,oo(n)),null!==Tc)for(n=Tc.return;null!==n;){var r=n;switch(ni(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Oo();break;case 3:is(),Eo(Mo),Eo(Po),ds();break;case 5:as(r);break;case 4:is();break;case 13:case 19:Eo(cs);break;case 10:Si(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Mc=e,Tc=e=Ol(e.current,null),jc=Dc=t,zc=0,Fc=null,Nc=Lc=Rc=0,$c=Bc=null,null!==Ai){for(t=0;t<Ai.length;t++)if(null!==(r=(n=Ai[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=o,r.next=s}n.pending=r}Ai=null}return e}function fl(e,t){for(;;){var n=Tc;try{if(xi(),hs.current=sa,ys){for(var r=gs.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ys=!1}if(fs=0,_s=ms=gs=null,ws=!1,vs=0,Ac.current=null,null===n||null===n.return){zc=1,Fc=t,Tc=null;break}e:{var s=e,a=n.return,c=n,l=t;if(t=jc,c.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l,d=c,h=d.tag;if(0==(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=_a(a);if(null!==f){f.flags&=-257,ya(f,a,c,0,t),1&f.mode&&ma(s,u,t),l=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0==(1&t)){ma(s,u,t),ml();break e}l=Error(i(426))}else if(ii&&1&c.mode){var _=_a(a);if(null!==_){0==(65536&_.flags)&&(_.flags|=256),ya(_,a,c,0,t),gi(ua(l,c));break e}}s=l=ua(l,c),4!==zc&&(zc=2),null===Bc?Bc=[s]:Bc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ri(s,fa(0,l,t));break e;case 1:c=l;var y=s.type,w=s.stateNode;if(0==(128&s.flags)&&("function"==typeof y.getDerivedStateFromError||null!==w&&"function"==typeof w.componentDidCatch&&(null===Gc||!Gc.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t,Ri(s,ga(s,c,t));break e}}s=s.return}while(null!==s)}bl(n)}catch(e){t=e,Tc===n&&null!==n&&(Tc=n=n.return);continue}break}}function gl(){var e=Ec.current;return Ec.current=sa,null===e?sa:e}function ml(){0!==zc&&3!==zc&&2!==zc||(zc=4),null===Mc||0==(268435455&Rc)&&0==(268435455&Lc)||cl(Mc,jc)}function _l(e,t){var n=Pc;Pc|=2;var r=gl();for(Mc===e&&jc===t||(Wc=null,pl(e,t));;)try{yl();break}catch(t){fl(e,t)}if(xi(),Pc=n,Ec.current=r,null!==Tc)throw Error(i(261));return Mc=null,jc=0,zc}function yl(){for(;null!==Tc;)vl(Tc)}function wl(){for(;null!==Tc&&!Ye();)vl(Tc)}function vl(e){var t=kc(e.alternate,e,Dc);e.memoizedProps=e.pendingProps,null===t?bl(e):Tc=t,Ac.current=null}function bl(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(n=qa(n,t,Dc)))return void(Tc=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Tc=n);if(null===e)return zc=6,void(Tc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tc=t);Tc=t=e}while(null!==t);0===zc&&(zc=5)}function xl(e,t,n){var r=wt,o=Ic.transition;try{Ic.transition=null,wt=1,function(e,t,n,r){do{Sl()}while(null!==Yc);if(0!=(6&Pc))throw Error(i(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-st(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,s),e===Mc&&(Tc=Mc=null,jc=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||qc||(qc=!0,Ml(tt,(function(){return Sl(),null}))),s=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||s){s=Ic.transition,Ic.transition=null;var a=wt;wt=1;var c=Pc;Pc|=4,Ac.current=null,function(e,t){if(eo=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(e){n=null;break e}var a=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==o&&3!==h.nodeType||(c=a+o),h!==s||0!==r&&3!==h.nodeType||(l=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===o&&(c=a),p===s&&++d===r&&(l=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(to={focusedElem:e,selectionRange:n},Wt=!1,Ja=t;null!==Ja;)if(e=(t=Ja).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Ja=e;else for(;null!==Ja;){t=Ja;try{var g=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,_=g.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:_i(t.type,m),_);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(i(163))}}catch(e){Cl(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Ja=e;break}Ja=t.return}g=nc,nc=!1}(e,n),_c(n,e),fr(to),Wt=!!eo,to=eo=null,e.current=n,wc(n,e,o),Xe(),Pc=c,wt=a,Ic.transition=s}else e.current=n;if(qc&&(qc=!1,Yc=e,Xc=o),0===(s=e.pendingLanes)&&(Gc=null),function(e){if(it&&"function"==typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(ot,e,void 0,128==(128&e.current.flags))}catch(e){}}(n.stateNode),ol(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((o=t[n]).value,{componentStack:o.stack,digest:o.digest});if(Kc)throw Kc=!1,e=Hc,Hc=null,e;0!=(1&Xc)&&0!==e.tag&&Sl(),0!=(1&(s=e.pendingLanes))?e===Qc?Zc++:(Zc=0,Qc=e):Zc=0,Vo()}(e,t,n,r)}finally{Ic.transition=o,wt=r}return null}function Sl(){if(null!==Yc){var e=vt(Xc),t=Ic.transition,n=wt;try{if(Ic.transition=null,wt=16>e?16:e,null===Yc)var r=!1;else{if(e=Yc,Yc=null,Xc=0,0!=(6&Pc))throw Error(i(331));var o=Pc;for(Pc|=4,Ja=e.current;null!==Ja;){var s=Ja,a=s.child;if(0!=(16&Ja.flags)){var c=s.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Ja=u;null!==Ja;){var d=Ja;switch(d.tag){case 0:case 11:case 15:rc(8,d,s)}var h=d.child;if(null!==h)h.return=d,Ja=h;else for(;null!==Ja;){var p=(d=Ja).sibling,f=d.return;if(sc(d),d===u){Ja=null;break}if(null!==p){p.return=f,Ja=p;break}Ja=f}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(null!==m)}}Ja=s}}if(0!=(2064&s.subtreeFlags)&&null!==a)a.return=s,Ja=a;else e:for(;null!==Ja;){if(0!=(2048&(s=Ja).flags))switch(s.tag){case 0:case 11:case 15:rc(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Ja=y;break e}Ja=s.return}}var w=e.current;for(Ja=w;null!==Ja;){var v=(a=Ja).child;if(0!=(2064&a.subtreeFlags)&&null!==v)v.return=a,Ja=v;else e:for(a=w;null!==Ja;){if(0!=(2048&(c=Ja).flags))try{switch(c.tag){case 0:case 11:case 15:oc(9,c)}}catch(e){Cl(c,c.return,e)}if(c===a){Ja=null;break e}var b=c.sibling;if(null!==b){b.return=c.return,Ja=b;break e}Ja=c.return}}if(Pc=o,Vo(),it&&"function"==typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(ot,e)}catch(e){}r=!0}return r}finally{wt=n,Ic.transition=t}}return!1}function kl(e,t,n){e=zi(e,t=fa(0,t=ua(n,t),1),1),t=tl(),null!==e&&(_t(e,1,t),ol(e,t))}function Cl(e,t,n){if(3===e.tag)kl(e,e,n);else for(;null!==t;){if(3===t.tag){kl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Gc||!Gc.has(r))){t=zi(t,e=ga(t,e=ua(n,e),1),1),e=tl(),null!==t&&(_t(t,1,e),ol(t,e));break}}t=t.return}}function El(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Mc===e&&(jc&n)===n&&(4===zc||3===zc&&(130023424&jc)===jc&&500>Ze()-Uc?pl(e,0):Nc|=n),ol(e,t)}function Al(e,t){0===t&&(0==(1&e.mode)?t=1:(t=ut,0==(130023424&(ut<<=1))&&(ut=4194304)));var n=tl();null!==(e=Mi(e,t))&&(_t(e,t,n),ol(e,n))}function Il(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Al(e,n)}function Pl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Al(e,n)}function Ml(e,t){return Ge(e,t)}function Tl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jl(e,t,n,r){return new Tl(e,t,n,r)}function Dl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ol(e,t){var n=e.alternate;return null===n?((n=jl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zl(e,t,n,r,o,s){var a=2;if(r=e,"function"==typeof e)Dl(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case S:return Fl(n.children,o,s,t);case k:a=8,o|=8;break;case C:return(e=jl(12,n,t,2|o)).elementType=C,e.lanes=s,e;case P:return(e=jl(13,n,t,o)).elementType=P,e.lanes=s,e;case M:return(e=jl(19,n,t,o)).elementType=M,e.lanes=s,e;case D:return Rl(n,o,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case A:a=9;break e;case I:a=11;break e;case T:a=14;break e;case j:a=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=jl(a,n,t,o)).elementType=e,t.type=r,t.lanes=s,t}function Fl(e,t,n,r){return(e=jl(7,e,r,t)).lanes=n,e}function Rl(e,t,n,r){return(e=jl(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Ll(e,t,n){return(e=jl(6,e,null,t)).lanes=n,e}function Nl(e,t,n){return(t=jl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bl(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function $l(e,t,n,r,o,i,s,a,c){return e=new Bl(e,t,n,a,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=jl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ji(i),e}function Ul(e){if(!e)return Io;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Do(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Do(n))return Fo(e,n,t)}return t}function Vl(e,t,n,r,o,i,s,a,c){return(e=$l(n,r,!0,e,0,i,0,a,c)).context=Ul(null),n=e.current,(i=Oi(r=tl(),o=nl(n))).callback=null!=t?t:null,zi(n,i,o),e.current.lanes=o,_t(e,o,r),ol(e,r),e}function Wl(e,t,n,r){var o=t.current,i=tl(),s=nl(o);return n=Ul(n),null===t.context?t.context=n:t.pendingContext=n,(t=Oi(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zi(o,t,s))&&(rl(e,o,s,i),Fi(e,o,s)),s}function Kl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gl(e,t){Hl(e,t),(e=e.alternate)&&Hl(e,t)}kc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Mo.current)va=!0;else{if(0==(e.lanes&n)&&0==(128&t.flags))return va=!1,function(e,t,n){switch(t.tag){case 3:Ma(t),fi();break;case 5:ss(t);break;case 1:Do(t.type)&&Ro(t);break;case 4:os(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ao(yi,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ao(cs,1&cs.current),t.flags|=128,null):0!=(n&t.child.childLanes)?La(e,t,n):(Ao(cs,1&cs.current),null!==(e=Ka(e,t,n))?e.sibling:null);Ao(cs,1&cs.current);break;case 19:if(r=0!=(n&t.childLanes),0!=(128&e.flags)){if(r)return Va(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ao(cs,cs.current),r)break;return null;case 22:case 23:return t.lanes=0,Ca(e,t,n)}return Ka(e,t,n)}(e,t,n);va=0!=(131072&e.flags)}else va=!1,ii&&0!=(1048576&t.flags)&&ei(t,Go,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wa(e,t),e=t.pendingProps;var o=jo(t,Po.current);Ci(t,n),o=ks(null,t,r,e,o,n);var s=Cs();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Do(r)?(s=!0,Ro(t)):s=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,ji(t),o.updater=Ui,t.stateNode=o,o._reactInternals=t,Hi(t,r,e,n),t=Pa(null,t,r,!0,s,n)):(t.tag=0,ii&&s&&ti(t),ba(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wa(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return Dl(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===T)return 14}return 2}(r),e=_i(r,e),o){case 0:t=Aa(null,t,r,e,n);break e;case 1:t=Ia(null,t,r,e,n);break e;case 11:t=xa(null,t,r,e,n);break e;case 14:t=Sa(null,t,r,_i(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Aa(e,t,r,o=t.elementType===r?o:_i(r,o),n);case 1:return r=t.type,o=t.pendingProps,Ia(e,t,r,o=t.elementType===r?o:_i(r,o),n);case 3:e:{if(Ma(t),null===e)throw Error(i(387));r=t.pendingProps,o=(s=t.memoizedState).element,Di(e,t),Li(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ta(e,t,r,n,o=ua(Error(i(423)),t));break e}if(r!==o){t=Ta(e,t,r,n,o=ua(Error(i(424)),t));break e}for(oi=lo(t.stateNode.containerInfo.firstChild),ri=t,ii=!0,si=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===o){t=Ka(e,t,n);break e}ba(e,t,r,n)}t=t.child}return t;case 5:return ss(t),null===e&&ui(t),r=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,a=o.children,no(r,o)?a=null:null!==s&&no(r,s)&&(t.flags|=32),Ea(e,t),ba(e,t,a,n),t.child;case 6:return null===e&&ui(t),null;case 13:return La(e,t,n);case 4:return os(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Zi(t,null,r,n):ba(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,xa(e,t,r,o=t.elementType===r?o:_i(r,o),n);case 7:return ba(e,t,t.pendingProps,n),t.child;case 8:case 12:return ba(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,s=t.memoizedProps,a=o.value,Ao(yi,r._currentValue),r._currentValue=a,null!==s)if(ar(s.value,a)){if(s.children===o.children&&!Mo.current){t=Ka(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){a=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=Oi(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ki(s.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(i(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),ki(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}ba(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Ci(t,n),r=r(o=Ei(o)),t.flags|=1,ba(e,t,r,n),t.child;case 14:return o=_i(r=t.type,t.pendingProps),Sa(e,t,r,o=_i(r.type,o),n);case 15:return ka(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:_i(r,o),Wa(e,t),t.tag=1,Do(r)?(e=!0,Ro(t)):e=!1,Ci(t,n),Wi(t,r,o),Hi(t,r,o,n),Pa(null,t,r,!0,e,n);case 19:return Va(e,t,n);case 22:return Ca(e,t,n)}throw Error(i(156,t.tag))};var ql="function"==typeof reportError?reportError:function(e){console.error(e)};function Yl(e){this._internalRoot=e}function Xl(e){this._internalRoot=e}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Ql(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(){}function eu(e,t,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if("function"==typeof o){var a=o;o=function(){var e=Kl(s);a.call(e)}}Wl(t,s,e,o)}else s=function(e,t,n,r,o){if(o){if("function"==typeof r){var i=r;r=function(){var e=Kl(s);i.call(e)}}var s=Vl(t,r,e,0,null,!1,0,"",Jl);return e._reactRootContainer=s,e[go]=s.current,Ur(8===e.nodeType?e.parentNode:e),dl(),s}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof r){var a=r;r=function(){var e=Kl(c);a.call(e)}}var c=$l(e,0,!1,null,0,!1,0,"",Jl);return e._reactRootContainer=c,e[go]=c.current,Ur(8===e.nodeType?e.parentNode:e),dl((function(){Wl(t,c,n,r)})),c}(n,t,e,o,r);return Kl(s)}Xl.prototype.render=Yl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wl(e,t,null,null)},Xl.prototype.unmount=Yl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){Wl(null,e,null,null)})),t[go]=null}},Xl.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Rt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ol(t,Ze()),0==(6&Pc)&&(Vc=Ze()+500,Vo()))}break;case 13:dl((function(){var t=Mi(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Gl(e,1)}},xt=function(e){if(13===e.tag){var t=Mi(e,134217728);null!==t&&rl(t,e,134217728,tl()),Gl(e,134217728)}},St=function(e){if(13===e.tag){var t=nl(e),n=Mi(e,t);null!==n&&rl(n,e,t,tl()),Gl(e,t)}},kt=function(){return wt},Ct=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},xe=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=xo(r);if(!o)throw Error(i(90));G(r),Q(r,o)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=ul,Pe=dl;var tu={usingClientEntryPoint:!1,Events:[vo,bo,xo,Ee,Ae,ul]},nu={findFiberByHostInstance:wo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{ot=ou.inject(ru),it=ou}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zl(e))throw Error(i(299));var n=!1,r="",o=ql;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=$l(e,1,!1,null,0,n,0,r,o),e[go]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Yl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Ql(t))throw Error(i(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zl(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,o=!1,s="",a=ql;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Vl(t,null,e,1,null!=n?n:null,o,0,s,a),e[go]=t.current,Ur(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Xl(t)},t.render=function(e,t,n){if(!Ql(t))throw Error(i(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Ql(e))throw Error(i(40));return!!e._reactRootContainer&&(dl((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[go]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ql(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},745:(e,t,n)=>{"use strict";var r=n(3935);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},3935:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(4448)},5251:(e,t,n)=>{"use strict";var r=n(7294),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:a.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},2408:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function _(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=_.prototype;var v=w.prototype=new y;v.constructor=w,g(v,_.prototype),v.isPureReactComponent=!0;var b=Array.isArray,x=Object.prototype.hasOwnProperty,S={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var o,i={},s=null,a=null;if(null!=t)for(o in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)x.call(t,o)&&!k.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:n,type:e,key:s,ref:a,props:i,_owner:S.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,o,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===i?"."+I(c,0):i,b(s)?(o="",null!=e&&(o=e.replace(A,"$&/")+"/"),P(s,t,o,"",(function(e){return e}))):null!=s&&(E(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,o+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",b(e))for(var l=0;l<e.length;l++){var u=i+I(a=e[l],l);c+=P(a,t,o,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=P(a=a.value,t,o,u=i+I(a,l++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function M(e,t,n){if(null==e)return e;var r=[],o=0;return P(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var j={current:null},D={transition:null},O={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=o,t.Profiler=s,t.PureComponent=w,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=g({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=S.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)x.call(t,l)&&!k.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}return{$$typeof:n,type:e.type,key:i,ref:s,props:o,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return j.current.useCallback(e,t)},t.useContext=function(e){return j.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return j.current.useDeferredValue(e)},t.useEffect=function(e,t){return j.current.useEffect(e,t)},t.useId=function(){return j.current.useId()},t.useImperativeHandle=function(e,t,n){return j.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return j.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return j.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return j.current.useMemo(e,t)},t.useReducer=function(e,t,n){return j.current.useReducer(e,t,n)},t.useRef=function(e){return j.current.useRef(e)},t.useState=function(e){return j.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return j.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return j.current.useTransition()},t.version="18.2.0"},7294:(e,t,n)=>{"use strict";e.exports=n(2408)},5893:(e,t,n)=>{"use strict";e.exports=n(5251)},53:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,s=o>>>1;r<s;){var a=2*(r+1)-1,c=e[a],l=a+1,u=e[l];if(0>i(c,n))l<o&&0>i(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[a]=n,r=a);else{if(!(l<o&&0>i(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,g=!1,m=!1,_="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,w="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function b(e){if(m=!1,v(e),!g)if(null!==r(l))g=!0,D(x);else{var t=r(u);null!==t&&O(b,t.startTime-e)}}function x(e,n){g=!1,m&&(m=!1,y(E),E=-1),f=!0;var i=p;try{for(v(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!P());){var s=h.callback;if("function"==typeof s){h.callback=null,p=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?h.callback=a:h===r(l)&&o(l),v(n)}else o(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&O(b,d.startTime-n),c=!1}return c}finally{h=null,p=i,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,k=!1,C=null,E=-1,A=5,I=-1;function P(){return!(t.unstable_now()-I<A)}function M(){if(null!==C){var e=t.unstable_now();I=e;var n=!0;try{n=C(!0,e)}finally{n?S():(k=!1,C=null)}}else k=!1}if("function"==typeof w)S=function(){w(M)};else if("undefined"!=typeof MessageChannel){var T=new MessageChannel,j=T.port2;T.port1.onmessage=M,S=function(){j.postMessage(null)}}else S=function(){_(M,0)};function D(e){C=e,k||(k=!0,S())}function O(e,n){E=_((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,D(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,i){var s=t.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?s+i:s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:a=i+a,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(l)&&e===r(u)&&(m?(y(E),E=-1):m=!0,O(b,i-s))):(e.sortIndex=a,n(l,e),g||f||(g=!0,D(x))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},3840:(e,t,n)=>{"use strict";e.exports=n(53)},3379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},s=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var h=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=o(p,r);r.byIndex=a,t.splice(a,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var a=n(i[s]);t[a].references--}for(var c=r(e,o),l=0;l<i.length;l++){var u=n(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1895:(e,t,n)=>{"use strict";n(2176);var r=n(8749);e.exports=r("Array","at")},4874:(e,t,n)=>{"use strict";n(4564),n(385);var r=n(8749);e.exports=r("Array","flatMap")},9798:(e,t,n)=>{"use strict";n(2795),n(3383);var r=n(8749);e.exports=r("Array","flat")},6397:(e,t,n)=>{"use strict";n(7961);var r=n(8749);e.exports=r("String","at")},2296:(e,t,n)=>{"use strict";n(4043),n(7267),n(6532);var r=n(8749);e.exports=r("String","replaceAll")},509:(e,t,n)=>{"use strict";var r=n(9985),o=n(3691),i=TypeError;e.exports=function(e){if(r(e))return e;throw new i(o(e)+" is not a function")}},7370:(e,t,n)=>{"use strict";var r=n(4201),o=n(5391),i=n(2560).f,s=r("unscopables"),a=Array.prototype;void 0===a[s]&&i(a,s,{configurable:!0,value:o(null)}),e.exports=function(e){a[s][e]=!0}},1514:(e,t,n)=>{"use strict";var r=n(730).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},5027:(e,t,n)=>{"use strict";var r=n(8999),o=String,i=TypeError;e.exports=function(e){if(r(e))return e;throw new i(o(e)+" is not an object")}},4328:(e,t,n)=>{"use strict";var r=n(5290),o=n(7578),i=n(6310),s=function(e){return function(t,n,s){var a,c=r(t),l=i(c),u=o(s,l);if(e&&n!=n){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},5271:(e,t,n)=>{"use strict";var r=n(2297),o=n(9429),i=n(8999),s=n(4201)("species"),a=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(o(t)&&(t===a||r(t.prototype))||i(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?a:t}},7120:(e,t,n)=>{"use strict";var r=n(5271);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},6648:(e,t,n)=>{"use strict";var r=n(8844),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},926:(e,t,n)=>{"use strict";var r=n(3043),o=n(9985),i=n(6648),s=n(4201)("toStringTag"),a=Object,c="Arguments"===i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=a(e),s))?n:c?i(t):"Object"===(r=i(t))&&o(t.callee)?"Arguments":r}},8758:(e,t,n)=>{"use strict";var r=n(6812),o=n(9152),i=n(2474),s=n(2560);e.exports=function(e,t,n){for(var a=o(t),c=s.f,l=i.f,u=0;u<a.length;u++){var d=a[u];r(e,d)||n&&r(n,d)||c(e,d,l(t,d))}}},5773:(e,t,n)=>{"use strict";var r=n(7697),o=n(2560),i=n(5684);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},5684:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1880:(e,t,n)=>{"use strict";var r=n(9985),o=n(2560),i=n(8702),s=n(5014);e.exports=function(e,t,n,a){a||(a={});var c=a.enumerable,l=void 0!==a.name?a.name:t;if(r(n)&&i(n,l,a),a.global)c?e[t]=n:s(t,n);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:o.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},5014:(e,t,n)=>{"use strict";var r=n(9037),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},7697:(e,t,n)=>{"use strict";var r=n(3689);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2659:e=>{"use strict";var t="object"==typeof document&&document.all,n=void 0===t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},6420:(e,t,n)=>{"use strict";var r=n(9037),o=n(8999),i=r.document,s=o(i)&&o(i.createElement);e.exports=function(e){return s?i.createElement(e):{}}},5565:e=>{"use strict";var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},71:e=>{"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},3615:(e,t,n)=>{"use strict";var r,o,i=n(9037),s=n(71),a=i.process,c=i.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(o=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},8749:(e,t,n)=>{"use strict";var r=n(9037),o=n(8844);e.exports=function(e,t){return o(r[e].prototype[t])}},2739:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9989:(e,t,n)=>{"use strict";var r=n(9037),o=n(2474).f,i=n(5773),s=n(1880),a=n(5014),c=n(8758),l=n(5266);e.exports=function(e,t){var n,u,d,h,p,f=e.target,g=e.global,m=e.stat;if(n=g?r:m?r[f]||a(f,{}):(r[f]||{}).prototype)for(u in t){if(h=t[u],d=e.dontCallGetSet?(p=o(n,u))&&p.value:n[u],!l(g?u:f+(m?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&i(h,"sham",!0),s(n,u,h,e)}}},3689:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},8678:(e,t,n)=>{"use strict";n(4043);var r=n(6576),o=n(1880),i=n(6308),s=n(3689),a=n(4201),c=n(5773),l=a("species"),u=RegExp.prototype;e.exports=function(e,t,n,d){var h=a(e),p=!s((function(){var t={};return t[h]=function(){return 7},7!==""[e](t)})),f=p&&!s((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!p||!f||n){var g=r(/./[h]),m=t(h,""[e],(function(e,t,n,o,s){var a=r(e),c=t.exec;return c===i||c===u.exec?p&&!s?{done:!0,value:g(t,n,o)}:{done:!0,value:a(n,t,o)}:{done:!1}}));o(String.prototype,e,m[0]),o(u,h,m[1])}d&&c(u[h],"sham",!0)}},7809:(e,t,n)=>{"use strict";var r=n(2297),o=n(6310),i=n(5565),s=n(4071),a=function(e,t,n,c,l,u,d,h){for(var p,f,g=l,m=0,_=!!d&&s(d,h);m<c;)m in n&&(p=_?_(n[m],m,t):n[m],u>0&&r(p)?(f=o(p),g=a(e,t,p,f,g,u-1)-1):(i(g+1),e[g]=p),g++),m++;return g};e.exports=a},1735:(e,t,n)=>{"use strict";var r=n(7215),o=Function.prototype,i=o.apply,s=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(i):function(){return s.apply(i,arguments)})},4071:(e,t,n)=>{"use strict";var r=n(6576),o=n(509),i=n(7215),s=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?s(e,t):function(){return e.apply(t,arguments)}}},7215:(e,t,n)=>{"use strict";var r=n(3689);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},2615:(e,t,n)=>{"use strict";var r=n(7215),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},1236:(e,t,n)=>{"use strict";var r=n(7697),o=n(6812),i=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=o(i,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&s(i,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},6576:(e,t,n)=>{"use strict";var r=n(6648),o=n(8844);e.exports=function(e){if("Function"===r(e))return o(e)}},8844:(e,t,n)=>{"use strict";var r=n(7215),o=Function.prototype,i=o.call,s=r&&o.bind.bind(i,i);e.exports=r?s:function(e){return function(){return i.apply(e,arguments)}}},6058:(e,t,n)=>{"use strict";var r=n(9037),o=n(9985);e.exports=function(e,t){return arguments.length<2?(n=r[e],o(n)?n:void 0):r[e]&&r[e][t];var n}},4849:(e,t,n)=>{"use strict";var r=n(509),o=n(981);e.exports=function(e,t){var n=e[t];return o(n)?void 0:r(n)}},7017:(e,t,n)=>{"use strict";var r=n(8844),o=n(690),i=Math.floor,s=r("".charAt),a=r("".replace),c=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,h){var p=n+e.length,f=r.length,g=u;return void 0!==d&&(d=o(d),g=l),a(h,g,(function(o,a){var l;switch(s(a,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,p);case"<":l=d[c(a,1,-1)];break;default:var u=+a;if(0===u)return o;if(u>f){var h=i(u/10);return 0===h?o:h<=f?void 0===r[h-1]?s(a,1):r[h-1]+s(a,1):o}l=r[u-1]}return void 0===l?"":l}))}},9037:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},6812:(e,t,n)=>{"use strict";var r=n(8844),o=n(690),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},7248:e=>{"use strict";e.exports={}},2688:(e,t,n)=>{"use strict";var r=n(6058);e.exports=r("document","documentElement")},8506:(e,t,n)=>{"use strict";var r=n(7697),o=n(3689),i=n(6420);e.exports=!r&&!o((function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},4413:(e,t,n)=>{"use strict";var r=n(8844),o=n(3689),i=n(6648),s=Object,a=r("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"===i(e)?a(e,""):s(e)}:s},6738:(e,t,n)=>{"use strict";var r=n(8844),o=n(9985),i=n(4091),s=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return s(e)}),e.exports=i.inspectSource},618:(e,t,n)=>{"use strict";var r,o,i,s=n(9834),a=n(9037),c=n(8999),l=n(5773),u=n(6812),d=n(4091),h=n(2713),p=n(7248),f="Object already initialized",g=a.TypeError,m=a.WeakMap;if(s||d.state){var _=d.state||(d.state=new m);_.get=_.get,_.has=_.has,_.set=_.set,r=function(e,t){if(_.has(e))throw new g(f);return t.facade=e,_.set(e,t),t},o=function(e){return _.get(e)||{}},i=function(e){return _.has(e)}}else{var y=h("state");p[y]=!0,r=function(e,t){if(u(e,y))throw new g(f);return t.facade=e,l(e,y,t),t},o=function(e){return u(e,y)?e[y]:{}},i=function(e){return u(e,y)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw new g("Incompatible receiver, "+e+" required");return n}}}},2297:(e,t,n)=>{"use strict";var r=n(6648);e.exports=Array.isArray||function(e){return"Array"===r(e)}},9985:(e,t,n)=>{"use strict";var r=n(2659),o=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===o}:function(e){return"function"==typeof e}},9429:(e,t,n)=>{"use strict";var r=n(8844),o=n(3689),i=n(9985),s=n(926),a=n(6058),c=n(6738),l=function(){},u=[],d=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,p=r(h.exec),f=!h.test(l),g=function(e){if(!i(e))return!1;try{return d(l,u,e),!0}catch(e){return!1}},m=function(e){if(!i(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(h,c(e))}catch(e){return!0}};m.sham=!0,e.exports=!d||o((function(){var e;return g(g.call)||!g(Object)||!g((function(){e=!0}))||e}))?m:g},5266:(e,t,n)=>{"use strict";var r=n(3689),o=n(9985),i=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n===u||n!==l&&(o(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},981:e=>{"use strict";e.exports=function(e){return null==e}},8999:(e,t,n)=>{"use strict";var r=n(9985),o=n(2659),i=o.all;e.exports=o.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},3931:e=>{"use strict";e.exports=!1},1245:(e,t,n)=>{"use strict";var r=n(8999),o=n(6648),i=n(4201)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"===o(e))}},734:(e,t,n)=>{"use strict";var r=n(6058),o=n(9985),i=n(3622),s=n(9525),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&i(t.prototype,a(e))}},6310:(e,t,n)=>{"use strict";var r=n(3126);e.exports=function(e){return r(e.length)}},8702:(e,t,n)=>{"use strict";var r=n(8844),o=n(3689),i=n(9985),s=n(6812),a=n(7697),c=n(1236).CONFIGURABLE,l=n(6738),u=n(618),d=u.enforce,h=u.get,p=String,f=Object.defineProperty,g=r("".slice),m=r("".replace),_=r([].join),y=a&&!o((function(){return 8!==f((function(){}),"length",{value:8}).length})),w=String(String).split("String"),v=e.exports=function(e,t,n){"Symbol("===g(p(t),0,7)&&(t="["+m(p(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||c&&e.name!==t)&&(a?f(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&s(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return s(r,"source")||(r.source=_(w,"string"==typeof t?t:"")),e};Function.prototype.toString=v((function(){return i(this)&&h(this).source||l(this)}),"toString")},8828:e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},5391:(e,t,n)=>{"use strict";var r,o=n(5027),i=n(8920),s=n(2739),a=n(7248),c=n(2688),l=n(6420),u=n(2713),d="prototype",h="script",p=u("IE_PROTO"),f=function(){},g=function(e){return"<"+h+">"+e+"</"+h+">"},m=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},_=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;_="undefined"!=typeof document?document.domain&&r?m(r):(t=l("iframe"),n="java"+h+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(g("document.F=Object")),e.close(),e.F):m(r);for(var o=s.length;o--;)delete _[d][s[o]];return _()};a[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f[d]=o(e),n=new f,f[d]=null,n[p]=e):n=_(),void 0===t?n:i.f(n,t)}},8920:(e,t,n)=>{"use strict";var r=n(7697),o=n(5648),i=n(2560),s=n(5027),a=n(5290),c=n(300);t.f=r&&!o?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),o=c(t),l=o.length,u=0;l>u;)i.f(e,n=o[u++],r[n]);return e}},2560:(e,t,n)=>{"use strict";var r=n(7697),o=n(8506),i=n(5648),s=n(5027),a=n(8360),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";t.f=r?i?function(e,t,n){if(s(e),t=a(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=u(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(s(e),t=a(t),s(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},2474:(e,t,n)=>{"use strict";var r=n(7697),o=n(2615),i=n(9556),s=n(5684),a=n(5290),c=n(8360),l=n(6812),u=n(8506),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return s(!o(i.f,e,t),e[t])}},2741:(e,t,n)=>{"use strict";var r=n(4948),o=n(2739).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},7518:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},3622:(e,t,n)=>{"use strict";var r=n(8844);e.exports=r({}.isPrototypeOf)},4948:(e,t,n)=>{"use strict";var r=n(8844),o=n(6812),i=n(5290),s=n(4328).indexOf,a=n(7248),c=r([].push);e.exports=function(e,t){var n,r=i(e),l=0,u=[];for(n in r)!o(a,n)&&o(r,n)&&c(u,n);for(;t.length>l;)o(r,n=t[l++])&&(~s(u,n)||c(u,n));return u}},300:(e,t,n)=>{"use strict";var r=n(4948),o=n(2739);e.exports=Object.keys||function(e){return r(e,o)}},9556:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},5899:(e,t,n)=>{"use strict";var r=n(2615),o=n(9985),i=n(8999),s=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&o(n=e.toString)&&!i(a=r(n,e)))return a;if(o(n=e.valueOf)&&!i(a=r(n,e)))return a;if("string"!==t&&o(n=e.toString)&&!i(a=r(n,e)))return a;throw new s("Can't convert object to primitive value")}},9152:(e,t,n)=>{"use strict";var r=n(6058),o=n(8844),i=n(2741),s=n(7518),a=n(5027),c=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=s.f;return n?c(t,n(e)):t}},6100:(e,t,n)=>{"use strict";var r=n(2615),o=n(5027),i=n(9985),s=n(6648),a=n(6308),c=TypeError;e.exports=function(e,t){var n=e.exec;if(i(n)){var l=r(n,e,t);return null!==l&&o(l),l}if("RegExp"===s(e))return r(a,e,t);throw new c("RegExp#exec called on incompatible receiver")}},6308:(e,t,n)=>{"use strict";var r,o,i=n(2615),s=n(8844),a=n(4327),c=n(9633),l=n(7901),u=n(3430),d=n(5391),h=n(618).get,p=n(2100),f=n(6422),g=u("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,_=m,y=s("".charAt),w=s("".indexOf),v=s("".replace),b=s("".slice),x=(o=/b*/g,i(m,r=/a/,"a"),i(m,o,"a"),0!==r.lastIndex||0!==o.lastIndex),S=l.BROKEN_CARET,k=void 0!==/()??/.exec("")[1];(x||k||S||p||f)&&(_=function(e){var t,n,r,o,s,l,u,p=this,f=h(p),C=a(e),E=f.raw;if(E)return E.lastIndex=p.lastIndex,t=i(_,E,C),p.lastIndex=E.lastIndex,t;var A=f.groups,I=S&&p.sticky,P=i(c,p),M=p.source,T=0,j=C;if(I&&(P=v(P,"y",""),-1===w(P,"g")&&(P+="g"),j=b(C,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==y(C,p.lastIndex-1))&&(M="(?: "+M+")",j=" "+j,T++),n=new RegExp("^(?:"+M+")",P)),k&&(n=new RegExp("^"+M+"$(?!\\s)",P)),x&&(r=p.lastIndex),o=i(m,I?n:p,j),I?o?(o.input=b(o.input,T),o[0]=b(o[0],T),o.index=p.lastIndex,p.lastIndex+=o[0].length):p.lastIndex=0:x&&o&&(p.lastIndex=p.global?o.index+o[0].length:r),k&&o&&o.length>1&&i(g,o[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(o[s]=void 0)})),o&&A)for(o.groups=l=d(null),s=0;s<A.length;s++)l[(u=A[s])[0]]=o[u[1]];return o}),e.exports=_},9633:(e,t,n)=>{"use strict";var r=n(5027);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},3477:(e,t,n)=>{"use strict";var r=n(2615),o=n(6812),i=n(3622),s=n(9633),a=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in a||o(e,"flags")||!i(a,e)?t:r(s,e)}},7901:(e,t,n)=>{"use strict";var r=n(3689),o=n(9037).RegExp,i=r((function(){var e=o("a","y");return e.lastIndex=2,null!==e.exec("abcd")})),s=i||r((function(){return!o("a","y").sticky})),a=i||r((function(){var e=o("^r","gy");return e.lastIndex=2,null!==e.exec("str")}));e.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:i}},2100:(e,t,n)=>{"use strict";var r=n(3689),o=n(9037).RegExp;e.exports=r((function(){var e=o(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)}))},6422:(e,t,n)=>{"use strict";var r=n(3689),o=n(9037).RegExp;e.exports=r((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},4684:(e,t,n)=>{"use strict";var r=n(981),o=TypeError;e.exports=function(e){if(r(e))throw new o("Can't call method on "+e);return e}},2713:(e,t,n)=>{"use strict";var r=n(3430),o=n(4630),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},4091:(e,t,n)=>{"use strict";var r=n(9037),o=n(5014),i="__core-js_shared__",s=r[i]||o(i,{});e.exports=s},3430:(e,t,n)=>{"use strict";var r=n(3931),o=n(4091);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.34.0",mode:r?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"})},730:(e,t,n)=>{"use strict";var r=n(8844),o=n(8700),i=n(4327),s=n(4684),a=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(e){return function(t,n){var r,u,d=i(s(t)),h=o(n),p=d.length;return h<0||h>=p?e?"":void 0:(r=c(d,h))<55296||r>56319||h+1===p||(u=c(d,h+1))<56320||u>57343?e?a(d,h):r:e?l(d,h,h+2):u-56320+(r-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},146:(e,t,n)=>{"use strict";var r=n(3615),o=n(3689),i=n(9037).String;e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol("symbol detection");return!i(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},7578:(e,t,n)=>{"use strict";var r=n(8700),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},5290:(e,t,n)=>{"use strict";var r=n(4413),o=n(4684);e.exports=function(e){return r(o(e))}},8700:(e,t,n)=>{"use strict";var r=n(8828);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},3126:(e,t,n)=>{"use strict";var r=n(8700),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},690:(e,t,n)=>{"use strict";var r=n(4684),o=Object;e.exports=function(e){return o(r(e))}},8732:(e,t,n)=>{"use strict";var r=n(2615),o=n(8999),i=n(734),s=n(4849),a=n(5899),c=n(4201),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!o(e)||i(e))return e;var n,c=s(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!o(n)||i(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},8360:(e,t,n)=>{"use strict";var r=n(8732),o=n(734);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},3043:(e,t,n)=>{"use strict";var r={};r[n(4201)("toStringTag")]="z",e.exports="[object z]"===String(r)},4327:(e,t,n)=>{"use strict";var r=n(926),o=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return o(e)}},3691:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},4630:(e,t,n)=>{"use strict";var r=n(8844),o=0,i=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++o+i,36)}},9525:(e,t,n)=>{"use strict";var r=n(146);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5648:(e,t,n)=>{"use strict";var r=n(7697),o=n(3689);e.exports=r&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},9834:(e,t,n)=>{"use strict";var r=n(9037),o=n(9985),i=r.WeakMap;e.exports=o(i)&&/native code/.test(String(i))},4201:(e,t,n)=>{"use strict";var r=n(9037),o=n(3430),i=n(6812),s=n(4630),a=n(146),c=n(9525),l=r.Symbol,u=o("wks"),d=c?l.for||l:l&&l.withoutSetter||s;e.exports=function(e){return i(u,e)||(u[e]=a&&i(l,e)?l[e]:d("Symbol."+e)),u[e]}},2176:(e,t,n)=>{"use strict";var r=n(9989),o=n(690),i=n(6310),s=n(8700),a=n(7370);r({target:"Array",proto:!0},{at:function(e){var t=o(this),n=i(t),r=s(e),a=r>=0?r:n+r;return a<0||a>=n?void 0:t[a]}}),a("at")},4564:(e,t,n)=>{"use strict";var r=n(9989),o=n(7809),i=n(509),s=n(690),a=n(6310),c=n(7120);r({target:"Array",proto:!0},{flatMap:function(e){var t,n=s(this),r=a(n);return i(e),(t=c(n,0)).length=o(t,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},2795:(e,t,n)=>{"use strict";var r=n(9989),o=n(7809),i=n(690),s=n(6310),a=n(8700),c=n(7120);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=i(this),n=s(t),r=c(t,0);return r.length=o(r,t,t,n,0,void 0===e?1:a(e)),r}})},385:(e,t,n)=>{"use strict";n(7370)("flatMap")},3383:(e,t,n)=>{"use strict";n(7370)("flat")},4043:(e,t,n)=>{"use strict";var r=n(9989),o=n(6308);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},7961:(e,t,n)=>{"use strict";var r=n(9989),o=n(8844),i=n(4684),s=n(8700),a=n(4327),c=n(3689),l=o("".charAt);r({target:"String",proto:!0,forced:c((function(){return"\ud842"!=="".at(-2)}))},{at:function(e){var t=a(i(this)),n=t.length,r=s(e),o=r>=0?r:n+r;return o<0||o>=n?void 0:l(t,o)}})},6532:(e,t,n)=>{"use strict";var r=n(9989),o=n(2615),i=n(8844),s=n(4684),a=n(9985),c=n(981),l=n(1245),u=n(4327),d=n(4849),h=n(3477),p=n(7017),f=n(4201),g=n(3931),m=f("replace"),_=TypeError,y=i("".indexOf),w=i("".replace),v=i("".slice),b=Math.max,x=function(e,t,n){return n>e.length?-1:""===t?n:y(e,t,n)};r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,i,f,S,k,C,E,A,I=s(this),P=0,M=0,T="";if(!c(e)){if((n=l(e))&&(r=u(s(h(e))),!~y(r,"g")))throw new _("`.replaceAll` does not allow non-global regexes");if(i=d(e,m))return o(i,e,I,t);if(g&&n)return w(u(I),e,t)}for(f=u(I),S=u(e),(k=a(t))||(t=u(t)),C=S.length,E=b(1,C),P=x(f,S,0);-1!==P;)A=k?u(t(S,P,f)):p(S,f,P,[],void 0,t),T+=v(f,M,P)+A,M=P+C,P=x(f,S,P+E);return M<f.length&&(T+=v(f,M)),T}})},7267:(e,t,n)=>{"use strict";var r=n(1735),o=n(2615),i=n(8844),s=n(8678),a=n(3689),c=n(5027),l=n(9985),u=n(981),d=n(8700),h=n(3126),p=n(4327),f=n(4684),g=n(1514),m=n(4849),_=n(7017),y=n(6100),w=n(4201)("replace"),v=Math.max,b=Math.min,x=i([].concat),S=i([].push),k=i("".indexOf),C=i("".slice),E="$0"==="a".replace(/./,"$0"),A=!!/./[w]&&""===/./[w]("a","$0");s("replace",(function(e,t,n){var i=A?"$":"$0";return[function(e,n){var r=f(this),i=u(e)?void 0:m(e,w);return i?o(i,e,r,n):o(t,p(r),e,n)},function(e,o){var s=c(this),a=p(e);if("string"==typeof o&&-1===k(o,i)&&-1===k(o,"$<")){var u=n(t,s,a,o);if(u.done)return u.value}var f=l(o);f||(o=p(o));var m,w=s.global;w&&(m=s.unicode,s.lastIndex=0);for(var E,A=[];null!==(E=y(s,a))&&(S(A,E),w);)""===p(E[0])&&(s.lastIndex=g(a,h(s.lastIndex),m));for(var I,P="",M=0,T=0;T<A.length;T++){for(var j,D=p((E=A[T])[0]),O=v(b(d(E.index),a.length),0),z=[],F=1;F<E.length;F++)S(z,void 0===(I=E[F])?I:String(I));var R=E.groups;if(f){var L=x([D],z,O,a);void 0!==R&&S(L,R),j=p(r(o,void 0,L))}else j=_(D,a,O,z,R,o);O>=M&&(P+=C(a,M,O)+j,M=O+D.length)}return P+C(a,M)}]}),!!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||A)},9923:(e,t,n)=>{"use strict";var r=n(1895);e.exports=r},5204:(e,t,n)=>{"use strict";var r=n(4874);e.exports=r},2719:(e,t,n)=>{"use strict";var r=n(9798);e.exports=r},6627:(e,t,n)=>{"use strict";var r=n(6397);e.exports=r},2522:(e,t,n)=>{"use strict";var r=n(2296);e.exports=r}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var i=r[e]={id:e,loaded:!1,exports:{}};return n[e].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var i=Object.create(null);o.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,o.d(i,s),i},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.nc=void 0,(()=>{"use strict";var e=o(7294),t=o.t(e,2),n=o(745),r=o(3379),i=o.n(r),s=o(7795),a=o.n(s),c=o(569),l=o.n(c),u=o(3565),d=o.n(u),h=o(9216),p=o.n(h),f=o(4589),g=o.n(f),m=o(1424),_={};_.styleTagTransform=g(),_.setAttributes=d(),_.insert=l().bind(null,"head"),_.domAPI=a(),_.insertStyleElement=p(),i()(m.Z,_),m.Z&&m.Z.locals&&m.Z.locals;class y{arraySize=0;array=Array(8);set=null;get isEmpty(){if(this.array)return 0===this.arraySize;if(this.set)return 0===this.set.size;throw new Error("no set or array")}add(e){if(this.array)return-1===this.array.indexOf(e)&&(this.arraySize<8?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0));if(this.set)return!this.set.has(e)&&(this.set.add(e),!0);throw new Error("no set or array")}remove(e){if(this.array){const t=this.array.indexOf(e);return-1!==t&&(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return!!this.set.has(e)&&(this.set.delete(e),!0);throw new Error("no set or array")}visit(e){if(this.array)for(let t=0;t<this.arraySize;t++){const n=this.array[t];void 0!==n&&e(n)}else{if(!this.set)throw new Error("no set or array");this.set.forEach(e)}}}const w=Symbol("RESET_VALUE");class v{constructor(e){this.capacity=e,this.buffer=new Array(e)}index=0;buffer;pushEntry(e,t,n){void 0!==n&&(n!==w?(this.buffer[this.index]=[e,t,n],this.index=(this.index+1)%this.capacity):this.clear())}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(e){const{index:t,capacity:n,buffer:r}=this;for(let o=0;o<n;o++){const i=(t-1+n-o)%n,s=r[i];if(!s)return w;const[a,c]=s;if(0===o&&e>=c)return[];if(a<=e&&e<c){const e=o+1,t=new Array(e);for(let o=0;o<e;o++)t[o]=r[(i+o)%n][2];return t}}return w}}function b(e){return e&&"object"==typeof e&&"parents"in e}function x(e){for(let t=0,n=e.parents.length;t<n;t++)if(e.parents[t].__unsafe__getWithoutCapture(),e.parents[t].lastChangedEpoch!==e.parentEpochs[t])return!0;return!1}const S=(e,t)=>{if(e.children.remove(t)&&e.children.isEmpty&&b(e))for(let t=0,n=e.parents.length;t<n;t++)S(e.parents[t],e)},k=(e,t)=>{if(e.children.add(t)&&b(e))for(let t=0,n=e.parents.length;t<n;t++)k(e.parents[t],e)};function C(e,t){return e===t||Object.is(e,t)||Boolean(e&&t&&"function"==typeof e.equals&&e.equals(t))}const E=Object.freeze([]),A=Symbol.for("__@tldraw/state__"),I=globalThis;I[A]?console.error('Multiple versions of @tldraw/state detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of @tldraw/state is loaded.'):I[A]=!0;class P{constructor(e,t){this.below=e,this.child=t}offset=0;numNewParents=0;maybeRemoved}let M=null;function T(e){M=new P(M,e)}function j(){const e=M;if(M=e.below,e.numNewParents>0||e.offset!==e.child.parents.length){for(let t=e.offset;t<e.child.parents.length;t++){const n=e.child.parents[t];e.child.parents.indexOf(n)>=e.offset&&S(n,e.child)}if(e.child.parents.length=e.offset,e.child.parentEpochs.length=e.offset,M?.maybeRemoved)for(let t=0;t<M.maybeRemoved.length;t++){const n=M.maybeRemoved[t];-1===e.child.parents.indexOf(n)&&S(n,e.child)}}}function D(e){if(M){const t=M.child.parents.indexOf(e);if(t<0&&(M.numNewParents++,M.child.isActivelyListening&&k(e,M.child)),t<0||t>=M.offset){if(t!==M.offset&&t>0){const e=M.child.parents[M.offset];M.maybeRemoved?-1===M.maybeRemoved.indexOf(e)&&M.maybeRemoved.push(e):M.maybeRemoved=[e]}M.child.parents[M.offset]=e,M.child.parentEpochs[M.offset]=e.lastChangedEpoch,M.offset++}}}const O=-1;let z=0,F=!1;class R{constructor(e){this.parent=e}initialAtomValues=new Map;get isRoot(){return null===this.parent}commit(){if(this.isRoot){const e=this.initialAtomValues;this.initialAtomValues=new Map,L(e.keys())}else this.initialAtomValues.forEach(((e,t)=>{this.parent.initialAtomValues.has(t)||this.parent.initialAtomValues.set(t,e)}))}abort(){z++,this.initialAtomValues.forEach(((e,t)=>{t.set(e),t.historyBuffer?.clear()})),this.commit()}}function L(e){if(F)throw new Error("cannot change atoms during reaction cycle");try{F=!0;const t=new Set,n=e=>{e.lastTraversedEpoch!==z&&(e.lastTraversedEpoch=z,"maybeScheduleEffect"in e?t.add(e):e.children.visit(n))};for(const t of e)t.children.visit(n);for(const e of t)e.maybeScheduleEffect()}finally{F=!1}}let N=null;function B(e){return N?e():function(e){const t=new R(N);N=t;try{let n=!1;const r=e((()=>n=!0));return n?t.abort():t.commit(),r}catch(e){throw t.abort(),e}finally{N=N.parent}}(e)}let $=!1;function U(){$||($=!0,console.warn("Using Signal.value is deprecated and will be removed in the near future. Please use Signal.get() instead."))}let V=!1;class W{constructor(e,t,n){this.name=e,this.current=t,this.isEqual=n?.isEqual??null,n&&(n.historyLength&&(this.historyBuffer=new v(n.historyLength)),this.computeDiff=n.computeDiff)}isEqual;computeDiff;lastChangedEpoch=z;children=new y;historyBuffer;__unsafe__getWithoutCapture(){return this.current}get(){return D(this),this.current}get value(){return U(),this.get()}set(e,t){if(this.isEqual?.(this.current,e)??C(this.current,e))return this.current;z++,this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,z,t??this.computeDiff?.(this.current,e,this.lastChangedEpoch,z)??w),this.lastChangedEpoch=z;const n=this.current;return this.current=e,r=this,o=n,N?N.initialAtomValues.has(r)||N.initialAtomValues.set(r,o):L([r]),e;var r,o}update(e){return this.set(e(this.current))}getDiffSince(e){return D(this),e>=this.lastChangedEpoch?E:this.historyBuffer?.getChangesSince(e)??w}}function K(e,t,n){return new W(e,t,n)}const H=Symbol("UNINITIALIZED"),G=e=>e===H;class q{constructor(e,t){this.value=e,this.diff=t}}function Y(e,t){return new q(e,t)}class X{constructor(e,t,n){this.name=e,this.derive=t,n?.historyLength&&(this.historyBuffer=new v(n.historyLength)),this.computeDiff=n?.computeDiff,this.isEqual=n?.isEqual??C}lastChangedEpoch=O;lastTraversedEpoch=O;lastCheckedEpoch=O;parents=[];parentEpochs=[];children=new y;get isActivelyListening(){return!this.children.isEmpty}historyBuffer;state=H;computeDiff;isEqual;__unsafe__getWithoutCapture(){const e=this.lastChangedEpoch===O;if(!(e||this.lastCheckedEpoch!==z&&x(this)))return this.lastCheckedEpoch=z,this.state;try{T(this);const t=this.derive(this.state,this.lastCheckedEpoch),n=t instanceof q?t.value:t;if(this.state===H||!this.isEqual(n,this.state)){if(this.historyBuffer&&!e){const e=t instanceof q?t.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,z,e??this.computeDiff?.(this.state,n,this.lastCheckedEpoch,z)??w)}this.lastChangedEpoch=z,this.state=n}return this.lastCheckedEpoch=z,this.state}finally{j()}}get(){const e=this.__unsafe__getWithoutCapture();return D(this),e}get value(){return U(),this.get()}getDiffSince(e){return this.get(),e>=this.lastChangedEpoch?E:this.historyBuffer?.getChangesSince(e)??w}}function Z(e={},t,n,r){return r.get?(V||(V=!0,console.warn("Using `@computed` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use `@computed` as a decorator for methods.\n\n// Before\n@computed\nget foo() {\n\treturn 'foo'\n}\n\n// After\n@computed\ngetFoo() {\n\treturn 'foo'\n}\n")),function(e={},t,n,r){const o=r.get,i=Symbol.for("__@tldraw/state__computed__"+n);return r.get=function(){let t=this[i];return t||(t=new X(n,o.bind(this),e),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:t})),t.get()},r}(e,0,n,r)):function(e={},t,n,r){const o=r.value,i=Symbol.for("__@tldraw/state__computed__"+n);return r.value=function(){let t=this[i];return t||(t=new X(n,o.bind(this),e),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:t})),t.get()},r.value[Q]=!0,r}(e,0,n,r)}const Q="@@__isComputedMethod__@@";function J(){if(1===arguments.length){const e=arguments[0];return(t,n,r)=>Z(e,0,n,r)}return"string"==typeof arguments[0]?new X(arguments[0],arguments[1],arguments[2]):Z(void 0,0,arguments[1],arguments[2])}class ee{constructor(e,t,n){this.name=e,this.runEffect=t,this._scheduleEffect=n?.scheduleEffect}_isActivelyListening=!1;get isActivelyListening(){return this._isActivelyListening}lastTraversedEpoch=O;lastReactedEpoch=O;_scheduleCount=0;get scheduleCount(){return this._scheduleCount}parentEpochs=[];parents=[];_scheduleEffect;maybeScheduleEffect(){this._isActivelyListening&&this.lastReactedEpoch!==z&&(!this.parents.length||x(this)?this.scheduleEffect():this.lastReactedEpoch=z)}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}maybeExecute=()=>{this._isActivelyListening&&this.execute()};attach(){this._isActivelyListening=!0;for(let e=0,t=this.parents.length;e<t;e++)k(this.parents[e],this)}detach(){this._isActivelyListening=!1;for(let e=0,t=this.parents.length;e<t;e++)S(this.parents[e],this)}execute(){try{T(this);const e=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=z,e}finally{j()}}}function te(e,t,n){const r=new ee(e,t,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function ne(t,n){const r=e.useRef(n);r.current=n;const[o,i,s]=e.useMemo((()=>{let e=null;const n=new ee(`useStateTracking(${t})`,(()=>r.current?.()),{scheduleEffect(){e?.()}});return[n,t=>(e=t,()=>{e=null}),()=>n.scheduleCount]}),[t]);return e.useSyncExternalStore(i,s,s),e.useEffect((()=>(o.attach(),o.maybeScheduleEffect(),()=>{o.detach()})),[o]),o.execute()}const re={apply:(e,t,n)=>ne(e.displayName??e.name??"tracked(???)",(()=>e.apply(t,n)))},oe=Symbol.for("react.memo"),ie=Symbol.for("react.forward_ref");function se(t){let n=null;const r=t.$$typeof;return r===oe&&(n=(t=t.type).compare),r===ie?(0,e.memo)((0,e.forwardRef)(new Proxy(t.render,re))):(0,e.memo)(new Proxy(t,re),n)}function ae(){const t=arguments[0],n=arguments[1],r=3===arguments.length?void 0:arguments[2],o=3===arguments.length?arguments[2]:arguments[3];return(0,e.useMemo)((()=>J(`useComputed(${t})`,n,r)),o)}function ce(t,n,r=E){(0,e.useEffect)((()=>{const e=new ee(t,n);return e.attach(),e.execute(),()=>{e.detach()}}),r)}function le(){const t=arguments,n=3===t.length?t[2]:[t[0]],r=3===t.length?t[0]:`useValue(${t[0].name})`,o=(0,e.useRef)(!0);o.current=!0;const i=(0,e.useMemo)((()=>1===t.length?t[0]:J(r,(()=>{if(o.current)return t[1]();try{return t[1]()}catch{return{}}}))),n);try{const{subscribe:t,getSnapshot:n}=(0,e.useMemo)((()=>({subscribe:e=>te(`useValue(${r})`,(()=>{i.get(),e()})),getSnapshot:()=>i.get()})),[i]);return(0,e.useSyncExternalStore)(t,n,n)}finally{o.current=!1}}class ue{constructor(e){this.previousValue=e}nextValue;diff;get(){const e=this.diff?.removed?.size??0,t=this.diff?.added?.size??0;if(0!==e||0!==t)return{value:this.nextValue,diff:this.diff}}_add(e,t){this.nextValue??=new Set(this.previousValue),this.nextValue.add(e),this.diff??={},t?this.diff.removed?.delete(e):(this.diff.added??=new Set,this.diff.added.add(e))}add(e){const t=this.previousValue.has(e);if(t){const n=this.diff?.removed?.has(e);if(!n)return;return this._add(e,t)}const n=this.nextValue?.has(e);n||this._add(e,t)}_remove(e,t){this.nextValue??=new Set(this.previousValue),this.nextValue.delete(e),this.diff??={},t?(this.diff.removed??=new Set,this.diff.removed.add(e)):this.diff.added?.delete(e)}remove(e){const t=this.previousValue.has(e);if(!t){const n=this.diff?.added?.has(e);if(!n)return;return this._remove(e,t)}const n=this.diff?.removed?.has(e);n||this._remove(e,t)}}function de(e,t){const n=[];e:for(const r of e){for(const e of n)if(t?t(r,e):r===e)continue e;n.push(r)}return n}function he(e){return e.filter((e=>null!=e))}function pe(e){return e[e.length-1]}function fe(e){const t=(...n)=>{try{return e(...n)}catch(e){throw e instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(e,t),e}};return t}function ge(e,t){const n=t&&e&&"object"==typeof e&&t in e?e[t]:e;throw new Error(`Unknown switch case ${n}`)}const me=fe(((e,t)=>{if(!e)throw new Error(t||"Assertion Error")})),_e=fe(((e,t)=>{if(null==e)throw new Error(t??"value must be defined");return e}));function ye(e,t){let n;const r=(...r)=>(n||(n={},n.promise=new Promise(((e,t)=>{n.resolve=e,n.reject=t}))),clearTimeout(n.timeout),n.latestArgs=r,n.timeout=setTimeout((()=>{const t=n;n=void 0;try{t.resolve(e(...t.latestArgs))}catch(e){t.reject(e)}}),t),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const we=new WeakMap;function ve(e,t){if("object"!=typeof e||null===e)return;let n=we.get(e);n||(n={tags:{},extras:{}},we.set(e,n)),t.tags&&(n.tags={...n.tags,...t.tags}),t.extras&&(n.extras={...n.extras,...t.extras})}function be(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t+""}class xe{static async base64ToFile(e){return fetch(e).then((function(e){return e.arrayBuffer()}))}static async fileToBase64(e){return await new Promise(((t,n)=>{if(e){const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>n(e),r.onabort=e=>n(e)}}))}}let Se=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(Se=new Int32Array(Se));class ke{static isPng(e,t){return 137===e.getUint8(t+0)&&80===e.getUint8(t+1)&&78===e.getUint8(t+2)&&71===e.getUint8(t+3)&&13===e.getUint8(t+4)&&10===e.getUint8(t+5)&&26===e.getUint8(t+6)&&10===e.getUint8(t+7)}static getChunkType(e,t){return[String.fromCharCode(e.getUint8(t)),String.fromCharCode(e.getUint8(t+1)),String.fromCharCode(e.getUint8(t+2)),String.fromCharCode(e.getUint8(t+3))].join("")}static readChunks(e,t=0){const n={};if(!ke.isPng(e,t))throw new Error("Not a PNG");for(t+=8;t<=e.buffer.byteLength;){const r=t,o=e.getInt32(t);t+=4;const i=ke.getChunkType(e,t);if("IDAT"===i&&n[i])t+=o+4+4;else{if("IEND"===i)break;n[i]={start:r,dataOffset:t+4,size:o},t+=o+4+4}}return n}static parsePhys(e,t){return{ppux:e.getUint32(t),ppuy:e.getUint32(t+4),unit:e.getUint8(t+4)}}static findChunk(e,t){return ke.readChunks(e)[t]}static setPhysChunk(e,t=1,n){let r=46,o=0;const i=ke.findChunk(e,"pHYs");i&&(r=i.start,o=i.size);const s=ke.findChunk(e,"IDAT");s&&(r=s.start,o=0);const a=new ArrayBuffer(21),c=new DataView(a);c.setUint32(0,9),c.setUint8(4,"p".charCodeAt(0)),c.setUint8(5,"H".charCodeAt(0)),c.setUint8(6,"Y".charCodeAt(0)),c.setUint8(7,"s".charCodeAt(0));const l=2835.5;c.setInt32(8,l*t),c.setInt32(12,l*t),c.setInt8(16,1);const u=new Uint8Array(a.slice(4,17));c.setInt32(17,((e,t)=>{let n=-1;for(let t=0;t<e.length;t++)n=Se[255&(n^e[t])]^n>>>8;return-1^n})(u));const d=e.buffer.slice(0,r),h=e.buffer.slice(r+o);return new Blob([d,a,h],n)}}class Ce{static async getVideoSizeFromSrc(e){return await new Promise(((t,n)=>{const r=document.createElement("video");r.onloadeddata=()=>t({w:r.videoWidth,h:r.videoHeight}),r.onerror=e=>{console.error(e),n(new Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=e}))}static async getImageSizeFromSrc(e){return await new Promise(((t,n)=>{const r=new Image;r.onload=async()=>{try{const n=await xe.base64ToFile(e),o=new DataView(n);if(ke.isPng(o,0)){const e=ke.findChunk(o,"pHYs");if(e){const n=ke.parsePhys(o,e.dataOffset);if(0===n.unit&&n.ppux===n.ppuy){const e=Math.round(n.ppux/2834.5);return void t({w:r.width/e,h:r.height/e})}}}t({w:r.width,h:r.height})}catch(e){console.error(e),t({w:r.width,h:r.height})}},r.onerror=e=>{console.error(e),n(new Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=e}))}}function Ee(e=""){let t=0,n=0,r=0,o=0;function i(){const e=t^t<<11;return t=n,n=r,r=o,o^=(o>>>19^e^e>>>8)>>>0,o/4294967296*2}for(let n=0;n<e.length+64;n++)t^=0|e.charCodeAt(n),i();return i}function Ae(e,t,n,r=!1){const[o,i]=t,[s,a]=n,c=s+(e-o)/(i-o)*(a-s);return r?s<a?Math.max(Math.min(c,a),s):Math.max(Math.min(c,s),a):c}function Ie(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Pe(e,t){if(Ie(e,t))return e[t]}function Me(e){if(!e)return e;if(Array.isArray(e)){const t=[],n=e.length;for(let r=0;r<n;r++)t.push(Me(e[r]));return t}if("object"==typeof e){const t=Object.keys(e),n=t.length,r={};for(let o=0;o<n;o++){const n=t[o];r[n]=Me(e[n])}return r}return e}function Te(e){return Object.keys(e)}function je(e){return Object.values(e)}function De(e){return Object.entries(e)}function Oe(e){return Object.fromEntries(e)}function ze(e,t){const n={};let r=!1;for(const[o,i]of De(e))t(o,i)?n[o]=i:r=!0;return r?n:e}function Fe(e,t){const n={};for(const[r,o]of De(e)){const e=t(r,o);n[r]=e}return n}const Re=[];let Le;function Ne(){Le||(Le=requestAnimationFrame((()=>{Le=void 0,(()=>{const e=Re.splice(0,Re.length);for(const t of e)t()})()})))}function Be(e,t){return e.id>t.id?1:-1}const $e=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function Ue(e){return $e.test(e)}function Ve(e){return null!==e}const We="undefined"!=typeof window&&window.structuredClone?window.structuredClone:e=>e?JSON.parse(JSON.stringify(e)):e,Ke=new Set;function He(e){Ke.has(e)||(Ke.add(e),console.warn(`Using '${e}' is deprecated and will be removed in the near future. Please refactor to use 'get${e[0].toLocaleUpperCase()}${e.slice(1)}' instead.`))}let Ge=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");class qe{constructor(e,t){this.typeName=e,this.createDefaultProperties=t.createDefaultProperties,this.migrations=t.migrations,this.validator=t.validator??{validate:e=>e},this.scope=t.scope??"document"}createDefaultProperties;migrations;validator;scope;create(e){const t={...this.createDefaultProperties(),id:this.createId()};for(const[n,r]of Object.entries(e))void 0!==r&&(t[n]=r);return t.typeName=this.typeName,t}clone(e){return{...We(e),id:this.createId()}}createId(e){return this.typeName+":"+(e??Ge())}createCustomId(e){return this.typeName+":"+e}parseId(e){if(!this.isId(e))throw new Error(`ID "${e}" is not a valid ID for type "${this.typeName}"`);return e.slice(this.typeName.length+1)}isInstance=e=>e?.typeName===this.typeName;isId(e){if(!e)return!1;for(let t=0;t<this.typeName.length;t++)if(e[t]!==this.typeName[t])return!1;return":"===e[this.typeName.length]}withDefaultProperties(e){return new qe(this.typeName,{createDefaultProperties:e,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(e){return this.validator.validate(e)}}function Ye(e,t){return new qe(e,{createDefaultProperties:()=>({}),migrations:t.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:t.validator,scope:t.scope})}class Xe{items=new WeakMap;get(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}}var Ze=o(2307);function Qe(e,t){for(const[n,r]of Object.entries(e)){const e=r,o=t[n];if("eq"in e&&o!==e.eq)return!1;if("neq"in e&&o===e.neq)return!1;if("gt"in e&&("number"!=typeof o||o<=e.gt))return!1}return!0}function Je(e,t,n){const r=Object.fromEntries(Object.keys(n).map((e=>[e,new Set])));for(const[o,i]of Object.entries(n))if("eq"in i){const n=e.index(t,o).get().get(i.eq);if(n)for(const e of n)r[o].add(e)}else if("neq"in i){const n=e.index(t,o);for(const[e,t]of n.get())if(e!==i.neq)for(const e of t)r[o].add(e)}else if("gt"in i){const n=e.index(t,o);for(const[e,t]of n.get())if(e>i.gt)for(const e of t)r[o].add(e)}return function(e){if(0===e.length)return new Set;const t=e[0],n=e.slice(1),r=new Set;for(const e of t)n.every((t=>t.has(e)))&&r.add(e);return r}(Object.values(r))}class et{constructor(e,t){this.atoms=e,this.history=t}indexCache=new Map;historyCache=new Map;filterHistory(e){if(this.historyCache.has(e))return this.historyCache.get(e);const t=J("filterHistory:"+e,((t,n)=>{if(G(t))return this.history.get();const r=this.history.getDiffSince(n);if(r===w)return this.history.get();const o={added:{},removed:{},updated:{}};let i=0,s=0,a=0;for(const t of r){for(const n of je(t.added))if(n.typeName===e)if(o.removed[n.id]){const e=o.removed[n.id];delete o.removed[n.id],s--,e!==n&&(o.updated[n.id]=[e,n],a++)}else o.added[n.id]=n,i++;for(const[n,r]of je(t.updated))r.typeName===e&&(o.added[r.id]?o.added[r.id]=r:o.updated[r.id]?o.updated[r.id]=[o.updated[r.id][0],r]:(o.updated[r.id]=[n,r],a++));for(const n of je(t.removed))n.typeName===e&&(o.added[n.id]?(delete o.added[n.id],i--):o.updated[n.id]?(o.removed[n.id]=o.updated[n.id][0],delete o.updated[n.id],a--,s++):(o.removed[n.id]=n,s++))}return i||s||a?Y(this.history.get(),o):t}),{historyLength:100});return this.historyCache.set(e,t),t}index(e,t){const n=e+":"+t;if(this.indexCache.has(n))return this.indexCache.get(n);const r=this.__uncached_createIndex(e,t);return this.indexCache.set(n,r),r}__uncached_createIndex(e,t){const n=this.filterHistory(e),r=()=>{n.get();const r=new Map;for(const n of je(this.atoms.get())){const o=n.get();if(o.typeName===e){const e=o[t];r.has(e)||r.set(e,new Set),r.get(e).add(o.id)}}return r};return J("index:"+e+":"+t,((o,i)=>{if(G(o))return r();const s=n.getDiffSince(i);if(s===w)return r();const a=new Map,c=(e,t)=>{let n=a.get(e);n||(n=new ue(o.get(e)??new Set)),n.add(t),a.set(e,n)},l=(e,t)=>{let n=a.get(e);n||(n=new ue(o.get(e)??new Set)),n.remove(t),a.set(e,n)};for(const n of s){for(const r of je(n.added))r.typeName===e&&c(r[t],r.id);for(const[r,o]of je(n.updated))if(o.typeName===e){const e=r[t],n=o[t];e!==n&&(l(e,o.id),c(n,o.id))}for(const r of je(n.removed))r.typeName===e&&l(r[t],r.id)}let u,d;for(const[e,t]of a){const n=t.get();n&&(u||(u=new Map(o)),d||(d=new Map),0===n.value.size?u.delete(e):u.set(e,n.value),d.set(e,n.diff))}return u&&d?Y(u,d):o}),{historyLength:100})}record(e,t=(()=>({})),n="record:"+e+(t?":"+t.toString():"")){const r=this.ids(e,t,n);return J(n,(()=>{for(const e of r.get())return this.atoms.get()[e]?.get()}))}records(e,t=(()=>({})),n="records:"+e+(t?":"+t.toString():"")){const r=this.ids(e,t,"ids:"+n);return J(n,(()=>[...r.get()].map((e=>{const t=this.atoms.get()[e];if(!t)throw new Error("no atom found for record id: "+e);return t.get()}))))}ids(e,t=(()=>({})),n="ids:"+e+(t?":"+t.toString():"")){const r=this.filterHistory(e),o=()=>{r.get();const n=t();return 0===Object.keys(n).length?new Set(je(this.atoms.get()).flatMap((t=>{const n=t.get();return n.typeName===e?n.id:[]}))):Je(this,e,n)},i=e=>{const t=o(),n=function(e,t){const n={};for(const r of t)e.has(r)||(n.added??=new Set,n.added.add(r));for(const r of e)t.has(r)||(n.removed??=new Set,n.removed.add(r));return n.added||n.removed?n:void 0}(e,t);return n?Y(t,n):e},s=J("ids_query:"+n,t,{isEqual:Ze});return J("query:"+n,((t,n)=>{const a=s.get();if(G(t))return o();if(n<s.lastChangedEpoch)return i(t);const c=r.getDiffSince(n);if(c===w)return i(t);const l=new ue(t);for(const t of c){for(const n of je(t.added))n.typeName===e&&Qe(a,n)&&l.add(n.id);for(const[n,r]of je(t.updated))r.typeName===e&&(Qe(a,r)?l.add(r.id):l.remove(r.id));for(const n of je(t.removed))n.typeName===e&&l.remove(n.id)}const u=l.get();return u?Y(u.value,u.diff):t}),{historyLength:50})}exec(e,t){const n=Je(this,e,t);if(0===n.size)return E;const r=this.atoms.get();return[...n].map((e=>r[e].get()))}}class tt{id=Ge();atoms=K("store_atoms",{});history=K("history",0,{historyLength:1e3});query=new et(this.atoms,this.history);listeners=new Set;historyAccumulator=new rt;historyReactor;schema;props;scopedTypes;constructor(e){const{initialData:t,schema:n}=e;this.schema=n,this.props=e.props,t&&this.atoms.set(Oe(De(t).map((([e,t])=>[e,K("atom:"+e,this.schema.validateRecord(this,t,"initialize",null))])))),this.historyReactor=function(e,t,n){const r=new ee("Store.historyReactor",t,n);return{scheduler:r,start:e=>{const t=e?.force??!1;r.attach(),t?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}(0,(()=>{this.history.get(),this._flushHistory()}),{scheduleEffect:e=>{return t=e,void(Re.includes(t)||(Re.push(t),Ne()));var t}}),this.scopedTypes={document:new Set(je(this.schema.types).filter((e=>"document"===e.scope)).map((e=>e.typeName))),session:new Set(je(this.schema.types).filter((e=>"session"===e.scope)).map((e=>e.typeName))),presence:new Set(je(this.schema.types).filter((e=>"presence"===e.scope)).map((e=>e.typeName)))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const e=this.historyAccumulator.flush();for(const{changes:t,source:n}of e){let e=null,r=null,o=null;for(const{onHistory:i,filters:s}of this.listeners)if("all"===s.source||s.source===n)if("all"!==s.scope)if("document"===s.scope){if(r??=this.filterChangesByScope(t,"document"),!r)continue;i({changes:r,source:n})}else if("session"===s.scope){if(e??=this.filterChangesByScope(t,"session"),!e)continue;i({changes:e,source:n})}else{if(o??=this.filterChangesByScope(t,"presence"),!o)continue;i({changes:o,source:n})}else i({changes:t,source:n})}}}filterChangesByScope(e,t){const n={added:ze(e.added,((e,n)=>this.scopedTypes[t].has(n.typeName))),updated:ze(e.updated,((e,n)=>this.scopedTypes[t].has(n[1].typeName))),removed:ze(e.removed,((e,n)=>this.scopedTypes[t].has(n.typeName)))};return 0===Object.keys(n.added).length&&0===Object.keys(n.updated).length&&0===Object.keys(n.removed).length?null:n}updateHistory(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),0===this.listeners.size&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,e)}validate(e){this.allRecords().forEach((t=>this.schema.validateRecord(this,t,e,null)))}onBeforeCreate;onAfterCreate;onBeforeChange;onAfterChange;onBeforeDelete;onAfterDelete;_runCallbacks=!0;put=(e,t)=>{B((()=>{const n={},r={},o=this.atoms.__unsafe__getWithoutCapture();let i,s=null,a=!1;const c=this.onBeforeCreate&&this._runCallbacks?this.onBeforeCreate:null,l=this.onBeforeChange&&this._runCallbacks?this.onBeforeChange:null,u=this.isMergingRemoteChanges?"remote":"user";for(let d=0,h=e.length;d<h;d++){i=e[d];const h=(s??o)[i.id];if(h){l&&(i=l(h.get(),i,u));const e=h.__unsafe__getWithoutCapture();i=this.schema.validateRecord(this,i,t??"updateRecord",e),h.set(i);const r=h.__unsafe__getWithoutCapture();e!==r&&(a=!0,n[i.id]=[e,r])}else c&&(i=c(i,u)),a=!0,i=this.schema.validateRecord(this,i,t??"createRecord",null),r[i.id]=i,s||(s={...o}),s[i.id]=K("atom:"+i.id,i)}if(s&&this.atoms.set(s),a&&(this.updateHistory({added:r,updated:n,removed:{}}),this._runCallbacks)){const{onAfterCreate:e,onAfterChange:t}=this;e&&Object.values(r).forEach((t=>{e(t,u)})),t&&Object.values(n).forEach((([e,n])=>{t(e,n,u)}))}}))};remove=e=>{B((()=>{const t=[],n=this.isMergingRemoteChanges?"remote":"user";if(this.onBeforeDelete&&this._runCallbacks)for(const r of e){const e=this.atoms.__unsafe__getWithoutCapture()[r];e&&!1===this.onBeforeDelete(e.get(),n)&&t.push(r)}let r;if(this.atoms.update((n=>{let o;for(const i of e)t.includes(i)||i in n&&(o||(o={...n}),r||(r={}),delete o[i],r[i]=n[i].get());return o??n})),r&&(this.updateHistory({added:{},updated:{},removed:r}),this.onAfterDelete&&this._runCallbacks)){let t;for(let o=0,i=e.length;o<i;o++)t=r[e[o]],t&&this.onAfterDelete(t,n)}}))};get=e=>this.atoms.get()[e]?.get();unsafeGetWithoutCapture=e=>this.atoms.get()[e]?.__unsafe__getWithoutCapture();serialize=(e="document")=>{const t={};for(const[n,r]of De(this.atoms.get())){const o=r.get();("all"===e||this.scopedTypes[e].has(o.typeName))&&(t[n]=o)}return t};getSnapshot(e="document"){return{store:this.serialize(e),schema:this.schema.serialize()}}migrateSnapshot(e){const t=this.schema.migrateStoreSnapshot(e);if("error"===t.type)throw new Error(`Failed to migrate snapshot: ${t.reason}`);return{store:t.value,schema:this.schema.serialize()}}loadSnapshot(e){const t=this.schema.migrateStoreSnapshot(e);if("error"===t.type)throw new Error(`Failed to migrate snapshot: ${t.reason}`);B((()=>{this.clear(),this.put(Object.values(t.value)),this.ensureStoreIsUsable()}))}allRecords=()=>je(this.atoms.get()).map((e=>e.get()));clear=()=>{this.remove(Te(this.atoms.get()))};update=(e,t)=>{const n=this.atoms.get()[e];n?this.put([t(n.__unsafe__getWithoutCapture())]):console.error(`Record ${e} not found. This is probably an error`)};has=e=>!!this.atoms.get()[e];listen=(e,t)=>{this._flushHistory();const n={onHistory:e,filters:{source:t?.source??"all",scope:t?.scope??"all"}};return this.listeners.add(n),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(n),0===this.listeners.size&&this.historyReactor.stop()}};isMergingRemoteChanges=!1;mergeRemoteChanges=e=>{if(this.isMergingRemoteChanges)return e();try{this.isMergingRemoteChanges=!0,B(e)}finally{this.isMergingRemoteChanges=!1}};extractingChanges(e){const t=[],n=this.historyAccumulator.intercepting((e=>t.push(e.changes)));try{return B(e),nt(t)}finally{n()}}applyDiff(e,t=!0){const n=this._runCallbacks;try{this._runCallbacks=t,B((()=>{const t=je(e.added).concat(je(e.updated).map((([e,t])=>t))),n=Te(e.removed);t.length&&this.put(t),n.length&&this.remove(n)}))}finally{this._runCallbacks=n}}createComputedCache=(e,t,n)=>{const r=new Xe;return{get:o=>{const i=this.atoms.get()[o];if(i)return r.get(i,(()=>{const r=n?J(i.name+":equals",(()=>i.get()),{isEqual:n}):i;return J(e+":"+o,(()=>t(r.get())))})).get()}}};createSelectedComputedCache=(e,t,n)=>{const r=new Xe;return{get:o=>{const i=this.atoms.get()[o];if(!i)return;const s=J(e+":"+o+":selector",(()=>t(i.get())));return r.get(i,(()=>J(e+":"+o,(()=>n(s.get()))))).get()}}};getRecordType=e=>{const t=this.schema.types[e.typeName];if(!t)throw new Error(`Record type ${e.typeName} not found`);return t};_integrityChecker;ensureStoreIsUsable(){this._integrityChecker??=this.schema.createIntegrityChecker(this),this._integrityChecker?.()}_isPossiblyCorrupted=!1;markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function nt(e){const t={added:{},removed:{},updated:{}};for(const n of e){for(const[e,r]of De(n.added))if(t.removed[e]){const n=t.removed[e];delete t.removed[e],n!==r&&(t.updated[e]=[n,r])}else t.added[e]=r;for(const[e,[r,o]]of De(n.updated))t.added[e]?(t.added[e]=o,delete t.updated[e],delete t.removed[e]):t.updated[e]?(t.updated[e][1]=o,delete t.removed[e]):(t.updated[e]=n.updated[e],delete t.removed[e]);for(const[e,r]of De(n.removed))t.added[e]?delete t.added[e]:t.updated[e]?(t.removed[e]=t.updated[e][0],delete t.updated[e]):t.removed[e]=r}return t}class rt{_history=[];_interceptors=new Set;intercepting(e){return this._interceptors.add(e),()=>{this._interceptors.delete(e)}}add(e){this._history.push(e);for(const t of this._interceptors)t(e)}flush(){const e=function(e){const t=[];let n,r=e[0];for(let o=1,i=e.length;o<i;o++)n=e[o],r.source!==n.source?(t.push(r),r=n):r={source:r.source,changes:nt([r.changes,n.changes])};return t.push(r),t}(this._history);return this._history=[],e}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function ot(e){const{currentVersion:t,firstVersion:n,migrators:r={},subTypeKey:o,subTypeMigrations:i}=e;if("number"==typeof t&&"number"==typeof n){if(t===n)throw Error("Current version is equal to initial version.");if(t<n)throw Error("Current version is lower than initial version.")}return{firstVersion:n??0,currentVersion:t??0,migrators:r,subTypeKey:o,subTypeMigrations:i}}var it=(e=>(e.IncompatibleSubtype="incompatible-subtype",e.UnknownType="unknown-type",e.TargetVersionTooNew="target-version-too-new",e.TargetVersionTooOld="target-version-too-old",e.MigrationError="migration-error",e.UnrecognizedSubtype="unrecognized-subtype",e))(it||{});function st({record:e,migrations:t,fromVersion:n,toVersion:r}){let o=n;if(!function(e){return"object"==typeof e&&null!==e&&"id"in e&&"typeName"in e}(e))throw new Error("[migrateRecord] object is not a record");const{typeName:i,id:s,...a}=e;let c=a;for(;o<r;){const e=o+1,n=t.migrators[e];if(!n)return{type:"error",reason:"target-version-too-new"};c=n.up(c),o=e}for(;o>r;){const e=o-1,n=t.migrators[o];if(!n)return{type:"error",reason:"target-version-too-old"};c=n.down(c),o=e}return{type:"success",value:{...c,id:s,typeName:i}}}function at({value:e,migrations:t,fromVersion:n,toVersion:r}){let o=n;for(;o<r;){const n=o+1,r=t.migrators[n];if(!r)return{type:"error",reason:"target-version-too-new"};e=r.up(e),o=n}for(;o>r;){const n=o-1,r=t.migrators[o];if(!r)return{type:"error",reason:"target-version-too-old"};e=r.down(e),o=n}return{type:"success",value:e}}class ct{constructor(e,t){this.types=e,this.options=t}static create(e,t){return new ct(e,t??{})}get currentStoreVersion(){return this.options.snapshotMigrations?.currentVersion??0}validateRecord(e,t,n,r){try{const e=Pe(this.types,t.typeName);if(!e)throw new Error(`Missing definition for record type ${t.typeName}`);return e.validate(t)}catch(o){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:t,phase:n,recordBefore:r,error:o});throw o}}migratePersistedRecord(e,t,n="up"){const r=Pe(this.types,e.typeName),o=t.recordVersions[e.typeName];if(!o||!r)return{type:"error",reason:it.UnknownType};const i=r.migrations.currentVersion,s=o.version;if(i!==s){const t=st("up"===n?{record:e,migrations:r.migrations,fromVersion:s,toVersion:i}:{record:e,migrations:r.migrations,fromVersion:i,toVersion:s});if("error"===t.type)return t;e=t.value}if(!r.migrations.subTypeKey)return{type:"success",value:e};const a=r.migrations.subTypeMigrations?.[e[r.migrations.subTypeKey]],c="subTypeVersions"in o?o.subTypeVersions[e[r.migrations.subTypeKey]]:void 0;if(void 0===a)return{type:"error",reason:it.UnrecognizedSubtype};if(void 0===c)return{type:"error",reason:it.IncompatibleSubtype};const l=st("up"===n?{record:e,migrations:a,fromVersion:c,toVersion:a.currentVersion}:{record:e,migrations:a,fromVersion:a.currentVersion,toVersion:c});return"error"===l.type?l:{type:"success",value:l.value}}migrateStoreSnapshot(e){let{store:t}=e;const n=this.options.snapshotMigrations;if(!n)return{type:"success",value:t};const r=n.currentVersion,o=e.schema.storeVersion??0;if(r<o)return{type:"error",reason:it.TargetVersionTooOld};if(r>o){const e=at({value:t,migrations:n,fromVersion:o,toVersion:r});if("error"===e.type)return e;t=e.value}const i=[];for(const n of je(t)){const t=this.migratePersistedRecord(n,e.schema);if("error"===t.type)return t;t.value&&t.value!==n&&i.push(t.value)}if(i.length){t={...t};for(const e of i)t[e.id]=e}return{type:"success",value:t}}createIntegrityChecker(e){return this.options.createIntegrityChecker?.(e)??void 0}serialize(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.currentVersion??0,recordVersions:Object.fromEntries(je(this.types).map((e=>[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.currentVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map((([e,t])=>[e,t.currentVersion]))):void 0}:{version:e.migrations.currentVersion}])))}}serializeEarliestVersion(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.firstVersion??0,recordVersions:Object.fromEntries(je(this.types).map((e=>[e.typeName,e.migrations.subTypeKey&&e.migrations.subTypeMigrations?{version:e.migrations.firstVersion,subTypeKey:e.migrations.subTypeKey,subTypeVersions:e.migrations.subTypeMigrations?Object.fromEntries(Object.entries(e.migrations.subTypeMigrations).map((([e,t])=>[e,t.firstVersion]))):void 0}:{version:e.migrations.firstVersion}])))}}}class lt extends Error{constructor(e,t=[]){const n=function(e){if(!e.length)return null;let t="";for(const n of e)"number"==typeof n?t+=`.${n}`:n.startsWith("(")?t.endsWith(")")?t=`${t.slice(0,-1)}, ${n.slice(1)}`:t+=n:t+=`.${n}`;return t.startsWith(".")?t.slice(1):t}(t),r=e.split("\n").map(((e,t)=>0===t?e:`  ${e}`)).join("\n");super(t?`At ${n}: ${r}`:r),this.rawMessage=e,this.path=t}name="ValidationError"}function ut(e,t){try{return t()}catch(t){if(t instanceof lt)throw new lt(t.rawMessage,[e,...t.path]);throw new lt(t.toString(),[e])}}function dt(e){if(null===e)return"null";if(Array.isArray(e))return"an array";const t=typeof e;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${t}`;case"object":return`an ${t}`;case"undefined":return"undefined";default:ge(t)}}class ht{constructor(e){this.validationFn=e}validate(e){return this.validationFn(e)}nullable(){return e=this,new ht((t=>null===t?null:e.validate(t)));var e}optional(){return Rt(this)}refine(e){return new ht((t=>e(this.validate(t))))}check(e,t){return"string"==typeof e?this.refine((n=>(ut(`(check ${e})`,(()=>t(n))),n))):this.refine((t=>(e(t),t)))}}class pt extends ht{constructor(e){super((t=>{const n=It.validate(t);for(let t=0;t<n.length;t++)ut(t,(()=>e.validate(n[t])));return n})),this.itemValidator=e}nonEmpty(){return this.check((e=>{if(0===e.length)throw new lt("Expected a non-empty array")}))}lengthGreaterThan1(){return this.check((e=>{if(e.length<=1)throw new lt("Expected an array with length greater than 1")}))}}class ft extends ht{constructor(e,t=!1){super((n=>{if("object"!=typeof n||null===n)throw new lt(`Expected object, got ${dt(n)}`);for(const[t,r]of Object.entries(e))ut(t,(()=>{r.validate(Pe(n,t))}));if(!t)for(const t of Object.keys(n))if(!Ie(e,t))throw new lt("Unexpected property",[t]);return n})),this.config=e,this.shouldAllowUnknownProperties=t}allowUnknownProperties(){return new ft(this.config,!0)}extend(e){return new ft({...this.config,...e})}}class gt extends ht{constructor(e,t,n){super((n=>{if("object"!=typeof n||null===n)throw new lt(`Expected an object, got ${dt(n)}`,[]);const r=Pe(n,e);if("string"!=typeof r)throw new lt(`Expected a string for key "${e}", got ${dt(r)}`);const o=Ie(t,r)?t[r]:void 0;return void 0===o?this.unknownValueValidation(n,r):ut(`(${e} = ${r})`,(()=>o.validate(n)))})),this.key=e,this.config=t,this.unknownValueValidation=n}validateUnknownVariants(e){return new gt(this.key,this.config,e)}}class mt extends ht{constructor(e,t){super((n=>{if("object"!=typeof n||null===n)throw new lt(`Expected object, got ${dt(n)}`);for(const[r,o]of Object.entries(n))ut(r,(()=>{e.validate(r),t.validate(o)}));return n})),this.keyValidator=e,this.valueValidator=t}}function _t(e){return new ht((t=>{if(typeof t!==e)throw new lt(`Expected ${e}, got ${dt(t)}`);return t}))}new ht((e=>e));const yt=new ht((e=>e)),wt=_t("string"),vt=_t("number").check((e=>{if(Number.isNaN(e))throw new lt("Expected a number, got NaN");if(!Number.isFinite(e))throw new lt(`Expected a finite number, got ${e}`)})),bt=vt.check((e=>{if(e<0)throw new lt(`Expected a positive number, got ${e}`)})),xt=vt.check((e=>{if(e<=0)throw new lt(`Expected a non-zero positive number, got ${e}`)})),St=vt.check((e=>{if(!Number.isInteger(e))throw new lt(`Expected an integer, got ${e}`)})),kt=St.check((e=>{if(e<0)throw new lt(`Expected a positive integer, got ${e}`)})),Ct=St.check((e=>{if(e<=0)throw new lt(`Expected a non-zero positive integer, got ${e}`)})),Et=_t("boolean");function At(e){return new ht((t=>{if(t!==e)throw new lt(`Expected ${e}, got ${JSON.stringify(t)}`);return e}))}_t("bigint");const It=new ht((e=>{if(!Array.isArray(e))throw new lt(`Expected an array, got ${dt(e)}`);return e}));function Pt(e){return new pt(e)}function Mt(e){return new ft(e)}function Tt(e){return null===e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(Tt):"object"==typeof e&&Object.values(e).every(Tt))}new ht((e=>{if("object"!=typeof e||null===e)throw new lt(`Expected object, got ${dt(e)}`);return e}));const jt=new ht((e=>{if(Tt(e))return e;throw new lt("Expected json serializable value, got "+typeof e)}));function Dt(e,t){return new mt(e,t)}function Ot(e,t){return new gt(e,t,((n,r)=>{throw new lt(`Expected one of ${Object.keys(t).map((e=>JSON.stringify(e))).join(" or ")}, got ${JSON.stringify(r)}`,[e])}))}function zt(e,t){return new ht((n=>ut(n&&"object"==typeof n&&"id"in n&&"string"==typeof n.id?`${e}(id = ${n.id})`:e,(()=>t.validate(n)))))}function Ft(e){return new ht((t=>{if(!e.has(t)){const n=Array.from(e,(e=>JSON.stringify(e))).join(" or ");throw new lt(`Expected ${n}, got ${t}`)}return t}))}function Rt(e){return new ht((t=>{if(void 0!==t)return e.validate(t)}))}function Lt(...e){return Ft(new Set(e))}function Nt(e){return wt.refine((t=>{if(!t.startsWith(`${e}:`))throw new Error(`${e} ID must start with "${e}:"`);return t}))}const Bt=Nt("asset");function $t(e,t){return Mt({id:Bt,typeName:At("asset"),type:At(e),props:t,meta:jt})}const Ut=Ye("camera",{validator:zt("camera",Mt({typeName:At("camera"),id:Nt("camera"),x:vt,y:vt,z:vt,meta:jt})),migrations:ot({currentVersion:1,migrators:{1:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),scope:"session"}).withDefaultProperties((()=>({x:0,y:0,z:1,meta:{}}))),Vt=Mt({x:vt,y:vt,z:vt.optional()}),Wt=Mt({x:vt,y:vt,w:vt,h:vt}),Kt=Ft(new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"])),Ht=Mt({type:Kt,rotation:vt}),Gt=vt.check((e=>{if(e<0||e>1)throw new lt("Opacity must be between 0 and 1")})),qt=Ft(new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"])),Yt=new Set(["starting","paused","active","stopping"]),Xt=Mt({id:wt,points:Pt(Vt),size:bt,color:qt,opacity:vt,state:Ft(Yt),delay:vt,shrink:vt,taper:Et}),Zt=Nt("page"),Qt=Ye("page",{validator:zt("page",Mt({typeName:At("page"),id:Zt,name:wt,index:wt,meta:jt})),migrations:ot({currentVersion:1,migrators:{1:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),scope:"document"}).withDefaultProperties((()=>({meta:{}})));function Jt(e){return Qt.isId(e)}Nt("instance");const en=ot({currentVersion:22,migrators:{1:{up:e=>({...e,exportBackground:!0}),down:({exportBackground:e,...t})=>t},2:{up:({dialog:e,...t})=>t,down:e=>({...e,dialog:null})},3:{up:e=>({...e,isToolLocked:!1}),down:({isToolLocked:e,...t})=>t},4:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:Object.fromEntries(Object.entries(e).filter((([e])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(e))))}),down:e=>e},5:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:{...e,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:{...n}}}},6:{up:e=>({...e,followingUserId:null}),down:({followingUserId:e,...t})=>t},7:{up:e=>{let t=e.propsForNextShape.align;return"justify"===t&&(t="start"),{...e,propsForNextShape:{...e.propsForNextShape,align:t}}},down:e=>({...e})},8:{up:e=>({...e,zoomBrush:null}),down:({zoomBrush:e,...t})=>t},9:{up:e=>({...e,propsForNextShape:{...e.propsForNextShape,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:n}}},10:{up:e=>null!==e.scribble?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(null!==e.scribble){const{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},11:{up:({userId:e,...t})=>t,down:e=>({...e,userId:"user:none"})},12:{up:e=>({...e,isPenMode:!1,isGridMode:!1}),down:({isPenMode:e,isGridMode:t,...n})=>n},13:{up:({propsForNextShape:{opacity:e,...t},...n})=>({...n,opacityForNextShape:Number(e??"1"),propsForNextShape:t}),down:({opacityForNextShape:e,...t})=>({...t,propsForNextShape:{...t.propsForNextShape,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},14:{up:e=>({...e,chatMessage:"",isChatting:!1}),down:({chatMessage:e,isChatting:t,...n})=>n},15:{up:e=>({...e,highlightedUserIds:[]}),down:({highlightedUserIds:e,...t})=>t},16:{up:({propsForNextShape:e,...t})=>({...t,stylesForNextShape:{}}),down:({stylesForNextShape:e,...t})=>({...t,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})},17:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})},18:{up:e=>{const{color:t,...n}=e.cursor;return{...e,cursor:n}},down:e=>({...e,cursor:{...e.cursor,color:"black"}})},19:{up:e=>({...e,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1}),down:({canMoveCamera:e,isFocused:t,devicePixelRatio:n,isCoarsePointer:r,openMenus:o,isChangingStyle:i,isReadOnly:s,...a})=>({...a})},20:{up:({isReadOnly:e,...t})=>({...t,isReadonly:e}),down:({isReadonly:e,...t})=>({...t,isReadOnly:e})},21:{up:e=>({...e,isHoveringCanvas:null}),down:({isHoveringCanvas:e,...t})=>({...t})},22:{up:({scribble:e,...t})=>({...t,scribbles:[]}),down:({scribbles:e,...t})=>({...t,scribble:null})}}}),tn="instance:instance",nn=wt.refine((e=>{if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return e})),rn=Nt("shape"),on=zt("instance_page_state",Mt({typeName:At("instance_page_state"),id:Nt("instance_page_state"),pageId:Zt,selectedShapeIds:Pt(rn),hintingShapeIds:Pt(rn),erasingShapeIds:Pt(rn),hoveredShapeId:rn.nullable(),editingShapeId:rn.nullable(),croppingShapeId:rn.nullable(),focusedGroupId:rn.nullable(),meta:jt})),sn=Ye("instance_page_state",{migrations:ot({currentVersion:5,migrators:{1:{up:e=>({...e,croppingShapeId:null}),down:({croppingShapeId:e,...t})=>t},2:{up:({instanceId:e,cameraId:t,...n})=>n,down:e=>({...e,instanceId:tn,cameraId:Ut.createId("void")})},3:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})},4:{up:e=>{const{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:i,croppingShapeId:s,focusedGroupId:a,...c}=e;return{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:i,croppingShapeId:s,focusedGroupId:a,...c}},down:e=>{const{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:i,croppingShapeId:s,focusedGroupId:a,...c}=e;return{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:i,croppingShapeId:s,focusedGroupId:a,...c}}},5:{up:e=>{const{selectedIds:t,hintingIds:n,erasingIds:r,hoveredId:o,editingId:i,croppingId:s,focusLayerId:a,...c}=e;return{...c,selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:i,croppingShapeId:s,focusedGroupId:a}},down:e=>{const{selectedShapeIds:t,hintingShapeIds:n,erasingShapeIds:r,hoveredShapeId:o,editingShapeId:i,croppingShapeId:s,focusedGroupId:a,...c}=e;return{...c,selectedIds:t,hintingIds:n,erasingIds:r,hoveredId:o,editingId:i,croppingId:s,focusLayerId:a}}}}}),validator:on,scope:"session"}).withDefaultProperties((()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}}))),an=Ye("pointer",{validator:zt("pointer",Mt({typeName:At("pointer"),id:Nt("pointer"),x:vt,y:vt,lastActivityTimestamp:vt,meta:jt})),migrations:ot({currentVersion:1,migrators:{1:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),scope:"session"}).withDefaultProperties((()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}}))),cn=an.createId("pointer"),ln=zt("instance_presence",Mt({typeName:At("instance_presence"),id:Nt("instance_presence"),userId:wt,userName:wt,lastActivityTimestamp:vt,followingUserId:wt.nullable(),cursor:Mt({x:vt,y:vt,type:Kt,rotation:vt}),color:wt,camera:Mt({x:vt,y:vt,z:vt}),screenBounds:Wt,selectedShapeIds:Pt(Nt("shape")),currentPageId:Nt("page"),brush:Wt.nullable(),scribbles:Pt(Xt),chatMessage:wt,meta:jt})),un=Ye("instance_presence",{migrations:ot({currentVersion:5,migrators:{1:{up:e=>null!==e.scribble?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(null!==e.scribble){const{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},2:{up:({instanceId:e,...t})=>t,down:e=>({...e,instanceId:tn})},3:{up:e=>({...e,chatMessage:""}),down:({chatMessage:e,...t})=>t},4:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})},5:{up:e=>{const{selectedShapeIds:t,...n}=e;return{selectedShapeIds:t,...n}},down:e=>{const{selectedShapeIds:t,...n}=e;return{selectedShapeIds:t,...n}}}}}),validator:ln,scope:"presence"}).withDefaultProperties((()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}}))),dn=zt("document",Mt({typeName:At("document"),id:At("document:document"),gridSize:vt,name:wt,meta:jt})),hn=Ye("document",{migrations:ot({currentVersion:2,migrators:{1:{up:e=>({...e,name:""}),down:({name:e,...t})=>t},2:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),validator:dn,scope:"document"}).withDefaultProperties((()=>({gridSize:10,name:"",meta:{}}))),pn=hn.createId("document");function fn(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function gn(e){"asset"===e.typeName&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}const mn=({error:e,phase:t,record:n,recordBefore:r})=>{throw ve(e,{tags:{origin:"store.validateRecord",storePhase:t,isExistingValidationIssue:"initialize"===t},extras:{recordBefore:r?gn(We(r)):void 0,recordAfter:gn(We(n))}}),e};function _n(e){const t=e.query.ids("page"),n=()=>{if(!e.has(pn))return e.put([hn.create({id:pn,name:e.props.defaultName})]),n();if(!e.has(cn))return e.put([an.create({id:cn})]),n();const r=t.get();if(0===r.size)return e.put([Qt.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]),n();const o=()=>[...r].map((t=>e.get(t))).sort(fn)[0].id,i=e.get(tn);if(!i)return e.put([e.schema.types.instance.create({id:tn,currentPageId:o(),exportBackground:!0})]),n();if(!r.has(i.currentPageId))return e.put([{...i,currentPageId:o()}]),n();const s=new Set,a=new Set;for(const t of r){const n=sn.createId(t);e.has(n)||s.add(n);const r=Ut.createId(t);e.has(r)||a.add(r)}s.size>0&&e.put([...s].map((e=>sn.create({id:e,pageId:sn.parseId(e)})))),a.size>0&&e.put([...a].map((e=>Ut.create({id:e}))))};return n}const yn=$t("bookmark",Mt({title:wt,description:wt,image:wt,src:wt.nullable()})),wn=ot({}),vn=$t("image",Mt({w:vt,h:vt,name:wt,isAnimated:Et,mimeType:wt.nullable(),src:wt.nullable()})),bn=ot({currentVersion:2,migrators:{1:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:t,...n}=e.props;return{...e,props:n}}},2:{up:e=>{const{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{const{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}}}}),xn=$t("video",Mt({w:vt,h:vt,name:wt,isAnimated:Et,mimeType:wt.nullable(),src:wt.nullable()})),Sn=ot({currentVersion:2,migrators:{1:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:t,...n}=e.props;return{...e,props:n}}},2:{up:e=>{const{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{const{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}}}}),kn=zt("asset",Ot("type",{image:vn,video:xn,bookmark:yn})),Cn=Ye("asset",{migrations:ot({subTypeKey:"type",subTypeMigrations:{image:bn,video:Sn,bookmark:wn},currentVersion:1,migrators:{1:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}}),validator:kn,scope:"document"}).withDefaultProperties((()=>({meta:{}})));let En=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");class An{constructor(e,t,n){this.id=e,this.defaultValue=t,this.type=n}static define(e,t){const{defaultValue:n,type:r=yt}=t;return new An(e,n,r)}static defineEnum(e,t){const{defaultValue:n,values:r}=t;return new In(e,n,r)}validate(e){return this.type.validate(e)}}class In extends An{constructor(e,t,n){super(e,t,Lt(...n)),this.values=n}}const Pn=ot({currentVersion:3,migrators:{1:{up:e=>({...e,isLocked:!1}),down:e=>{const{isLocked:t,...n}=e;return{...n}}},2:{up:({props:{opacity:e,...t},...n})=>({...n,opacity:Number(e??"1"),props:t}),down:({opacity:e,...t})=>({...t,props:{...t.props,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})},3:{up:e=>({...e,meta:{}}),down:({meta:e,...t})=>({...t})}}});function Mn(e){return!!e&&"shape"===e.typeName}function Tn(e){return!!e&&e.startsWith("shape:")}function jn(e){return`shape:${e??En()}`}function Dn(e){const t=new Map;for(const[n,r]of Object.entries(e))if(r instanceof An){if(t.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);t.set(r,n)}return t}const On=ot({currentVersion:4,migrators:{1:{up:e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>"shape"!==t.typeName||"icon"!==t.type&&"code"!==t.type))),down:e=>e},2:{up:e=>e,down:e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>"instance_presence"!==t.typeName)))},3:{up:e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>!t.typeName.match(/^(user|user_presence)$/)))),down:e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>"pointer"!==t.typeName)))},4:{up:e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>!t.typeName.match("user_document")))),down:e=>e}}});function zn({shapes:e}){const t=new Map;for(const n of je(e))for(const e of Dn(n.props??{}).keys()){if(t.has(e.id)&&t.get(e.id)!==e)throw new Error(`Multiple StyleProp instances with the same id: ${e.id}`);t.set(e.id,e)}const n=function(e){return Ye("shape",{migrations:ot({currentVersion:Pn.currentVersion,firstVersion:Pn.firstVersion,migrators:Pn.migrators,subTypeKey:"type",subTypeMigrations:Fe(e,((e,t)=>t.migrations??ot({})))}),scope:"document",validator:zt("shape",Ot("type",Fe(e,((e,{props:t,meta:n})=>function(e,t,n){return Mt({id:rn,typeName:At("shape"),x:vt,y:vt,rotation:vt,index:wt,parentId:nn,type:At(e),isLocked:Et,opacity:Gt,props:t?Mt(t):jt,meta:n?Mt(n):jt})}(e,t,n)))))}).withDefaultProperties((()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}})))}(e),r=function(e){const t={};for(const[n,r]of e)t[n]=Rt(r);const n=zt("instance",Mt({typeName:At("instance"),id:Nt("instance"),currentPageId:Zt,followingUserId:wt.nullable(),brush:Wt.nullable(),opacityForNextShape:Gt,stylesForNextShape:Mt(t),cursor:Ht,scribbles:Pt(Xt),isFocusMode:Et,isDebugMode:Et,isToolLocked:Et,exportBackground:Et,screenBounds:Wt,zoomBrush:Wt.nullable(),isPenMode:Et,isGridMode:Et,chatMessage:wt,isChatting:Et,highlightedUserIds:Pt(wt),canMoveCamera:Et,isFocused:Et,devicePixelRatio:vt,isCoarsePointer:Et,isHoveringCanvas:Et.nullable(),openMenus:Pt(wt),isChangingStyle:Et,isReadonly:Et,meta:jt}));return Ye("instance",{migrations:en,validator:n,scope:"session"}).withDefaultProperties((()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],canMoveCamera:!0,isFocused:!1,devicePixelRatio:"undefined"==typeof window?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{}})))}(t);return ct.create({asset:Cn,camera:Ut,document:hn,instance:r,instance_page_state:sn,page:Qt,shape:n,instance_presence:un,pointer:an},{snapshotMigrations:On,onValidationFailure:mn,createIntegrityChecker:_n})}const Fn=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],Rn={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{id:"dark",text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function Ln(e){return e.isDarkMode?Rn.darkMode:Rn.lightMode}const Nn=An.defineEnum("tldraw:color",{defaultValue:"black",values:Fn}),Bn=An.defineEnum("tldraw:labelColor",{defaultValue:"black",values:Fn}),$n=An.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),Un=An.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),Vn=An.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),Wn={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},Kn=An.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),Hn=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],Gn=An.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:Hn}),qn=An.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:Hn}),Yn=Ot("type",{binding:Mt({type:At("binding"),boundShapeId:rn,normalizedAnchor:Vt,isExact:Et}),point:Mt({type:At("point"),x:vt,y:vt})}),Xn={labelColor:Bn,color:Nn,fill:Un,dash:$n,size:Kn,arrowheadStart:Gn,arrowheadEnd:qn,font:Vn,start:Yn,end:Yn,bend:vt,text:wt},Zn=ot({currentVersion:1,migrators:{1:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.props;return{...e,props:n}}}}}),Qn={w:xt,h:xt,assetId:Bt.nullable(),url:wt},Jn=ot({currentVersion:1,migrators:{1:{up:e=>void 0===e.props.assetId?{...e,props:{...e.props,assetId:null}}:e,down:e=>{if(null===e.props.assetId){const{assetId:t,...n}=e.props;return{...e,props:n}}return e}}}}),er=Mt({type:Lt("free","straight"),points:Pt(Vt)}),tr={color:Nn,fill:Un,dash:$n,size:Kn,segments:Pt(er),isComplete:Et,isClosed:Et,isPen:Et},nr=ot({currentVersion:1,migrators:{1:{up:e=>{const{points:t}=e.props.segments[0];if(0===t.length)return{...e,props:{...e.props,isPen:!1}};let n=!(0===t[0].z||.5===t[0].z);return t[1]&&(n=n&&!(0===t[1].z||.5===t[1].z)),{...e,props:{...e.props,isPen:n}}},down:e=>{const{isPen:t,...n}=e.props;return{...e,props:{...n}}}}}}),rr=/(^\/r\/[^/]+\/?$)/,or=e=>{try{return new URL(e)}catch(e){return}},ir=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(rr))return e},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(rr))return e}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${e}`},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/embed\/?$/)){const e=t.searchParams.get("url");if(e)return e}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{if(e.includes("/maps/")){const t=e.match(/@(.*),(.*),(.*)z/);let n;if(t){const[,r,o,i]=t;n=`https://${new URL(e).host.replace("www.","")}/maps/embed/v1/view?key=${process.env.NEXT_PUBLIC_GC_API_KEY}&center=${r},${o}&zoom=${i}`}else n="";return n}},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&t.searchParams.has("center")&&t.searchParams.get("zoom")){const e=t.searchParams.get("zoom"),[n,r]=t.searchParams.get("center").split(",");return`https://www.google.com/maps/@${n},${r},${e}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=or(e),n=t&&t.pathname.match(/\/v\/([^/]+)\/?/);if(n)return`https://www.val.town/embed/${n[1]}`},fromEmbedUrl:e=>{const t=or(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://www.val.town/v/${n[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=or(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:e=>{const t=or(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=e.match(/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/);if(t){const[e,n,r]=t;return`https://codepen.io/${n}/embed/${r}`}},fromEmbedUrl:e=>{const t=e.match(/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/);if(t){const[e,n,r]=t;return`https://codepen.io/${n}/pen/${r}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:e=>{const t=e.match(/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/);if(t){const[e,n]=t;return`https://scratch.mit.edu/projects/embed/${n}`}},fromEmbedUrl:e=>{const t=e.match(/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/);if(t){const[e,n]=t;return`https://scratch.mit.edu/projects/${n}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=or(e);if(!t)return;const n=t.hostname.replace(/^www./,"");return"youtu.be"===n?`https://www.youtube.com/embed/${t.pathname.split("/").filter(Boolean)[0]}`:"youtube.com"!==n&&"m.youtube.com"!==n||!t.pathname.match(/^\/watch/)?void 0:`https://www.youtube.com/embed/${t.searchParams.get("v")}`},fromEmbedUrl:e=>{const t=or(e);if(t&&"youtube.com"===t.hostname.replace(/^www./,"")){const e=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(e)return`https://www.youtube.com/watch?v=${e[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:e=>{const t=or(e),n=t?.searchParams.get("cid");if(t?.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";const e=Array.from(t.searchParams.keys());for(const n of e)t.searchParams.delete(n);return t.searchParams.set("src",n),t.href}},fromEmbedUrl:e=>{const t=or(e),n=t?.searchParams.get("src");if(t?.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";const e=Array.from(t.searchParams.keys());for(const n of e)t.searchParams.delete(n);return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=or(e);if(t?.pathname.match(/^\/presentation/)&&t?.pathname.match(/\/pub\/?$/)){t.pathname=t.pathname.replace(/\/pub$/,"/embed");const e=Array.from(t.searchParams.keys());for(const n of e)t.searchParams.delete(n);return t.href}},fromEmbedUrl:e=>{const t=or(e);if(t?.pathname.match(/^\/presentation/)&&t?.pathname.match(/\/embed\/?$/)){t.pathname=t.pathname.replace(/\/embed$/,"/pub");const e=Array.from(t.searchParams.keys());for(const n of e)t.searchParams.delete(n);return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!e.split("/").pop())return;return e}}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${e}?embed=true`},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/map\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=or(e);if(t&&"vimeo.com"===t.hostname&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+t.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:e=>{const t=or(e);if(t&&"player.vimeo.com"===t.hostname){const e=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(e)return"https://vimeo.com/"+e[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=or(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:e=>{const t=or(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:e=>{const t=or(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${t.origin}/embed${t.pathname}?cell=*`;if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){const e=t.pathname.replace(/^\/d/,"");return`${t.origin}/embed${e}?cell=*`}},fromEmbedUrl:e=>{const t=or(e);return t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/)?`${t.origin}${t.pathname.replace("/embed","")}#cell-*`:t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/)?`${t.origin}${t.pathname.replace("/embed","/d")}#cell-*`:void 0}}],sr={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},ar={w:xt,h:xt,url:wt},cr=ot({currentVersion:4,migrators:{1:{up:e=>{const t=e.props.url,n=new URL(t).host.replace("www.","");let r;for(const e of ir)if(e.hostnames.includes(n))try{r=e.fromEmbedUrl(t)}catch(e){console.warn(e)}return{...e,props:{...e.props,tmpOldUrl:e.props.url,url:r??""}}},down:e=>{let t=e.props.tmpOldUrl;if(!t||""===t){const n=e.props.url,r=new URL(n).host.replace("www.","");for(const e of ir)if(e.hostnames.includes(r))try{t=e.toEmbedUrl(n)}catch(e){console.warn(e)}}const{tmpOldUrl:n,...r}=e.props;return{...e,props:{...r,url:t??""}}}},2:{up:e=>{const{doesResize:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props,doesResize:!0}})},3:{up:e=>{const{tmpOldUrl:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props}})},4:{up:e=>{const{overridePermissions:t,...n}=e.props;return{...e,props:{...n}}},down:e=>({...e,props:{...e.props}})}}}),lr={w:xt,h:xt,name:wt},ur=ot({}),dr=An.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),hr=An.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),pr=An.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),fr={geo:pr,labelColor:Bn,color:Nn,fill:Un,dash:$n,size:Kn,font:Vn,align:dr,verticalAlign:hr,url:wt,w:xt,h:xt,growY:bt,text:wt},gr=ot({currentVersion:7,migrators:{1:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},2:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.props;return{...e,props:n}}},3:{up:e=>{let t=e.props.align;return"justify"===t&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},4:{up:e=>({...e}),down:e=>({...e,props:{...e.props,geo:"check-box"===e.props.geo?"rectangle":e.props.geo}})},5:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.props;return{...e,props:n}}},6:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}},7:{up:e=>e,down:e=>{if("cloud"===e.props.geo)return{...e,props:{...e.props,geo:"rectangle"}}}}}}),mr={},_r=ot({}),yr={color:Nn,size:Kn,segments:Pt(er),isComplete:Et,isPen:Et},wr=ot({}),vr=Mt({topLeft:Vt,bottomRight:Vt}),br={w:xt,h:xt,playing:Et,url:wt,assetId:Bt.nullable(),crop:vr.nullable()},xr=ot({currentVersion:2,migrators:{1:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},2:{up:e=>({...e,props:{...e.props,crop:null}}),down:e=>{const{crop:t,...n}=e.props;return{...e,props:n}}}}}),Sr=Mt({id:wt,type:Ft(new Set(["vertex","virtual","create"])),canBind:Et.optional(),canSnap:Et.optional(),index:wt,x:vt,y:vt}),kr=An.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),Cr={color:Nn,dash:$n,size:Kn,spline:kr,handles:Dt(wt,Sr)},Er=ot({currentVersion:1,migrators:{1:{up:e=>{const t=Me(e.props.handles);for(const e in t)t[e].canSnap=!0;return{...e,props:{...e.props,handles:t}}},down:e=>{const t=Me(e.props.handles);for(const e in t)delete t[e].canSnap;return{...e,props:{...e.props,handles:t}}}}}}),Ar={color:Nn,size:Kn,font:Vn,align:dr,verticalAlign:hr,growY:bt,url:wt,text:wt},Ir=ot({currentVersion:4,migrators:{1:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},2:{up:e=>{let t=e.props.align;return"justify"===t&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},3:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy"}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}},4:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.props;return{...e,props:n}}}}}),Pr={color:Nn,size:Kn,font:Vn,align:dr,w:xt,text:wt,scale:xt,autoSize:Et},Mr=ot({currentVersion:1,migrators:{1:{up:e=>{let t=e.props.align;return"justify"===t&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})}}}),Tr={w:xt,h:xt,time:vt,playing:Et,url:wt,assetId:Bt.nullable()},jr=ot({currentVersion:1,migrators:{1:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}}}}),Dr=[{locale:"ar",label:""},{locale:"ca",label:"Catal"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espaol"},{locale:"fa",label:""},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Franais"},{locale:"gl",label:"Galego"},{locale:"he",label:""},{locale:"it",label:"Italiano"},{locale:"ja",label:""},{locale:"ko-kr",label:""},{locale:"ku",label:""},{locale:"hi-in",label:""},{locale:"hu",label:"Magyar"},{locale:"my",label:""},{locale:"ne",label:""},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugus - Brasil"},{locale:"pt-pt",label:"Portugus - Europeu"},{locale:"ro",label:"Romn"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:""},{locale:"th",label:""},{locale:"tr",label:"Trke"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Ting Vit"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:" ()"}],Or={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function zr(e){const t=Dr.find((t=>t.locale===e.toLowerCase()));if(t)return t.locale;const[n,r]=e.split(/[-_]/).map((e=>e.toLowerCase()));if(r){const e=Dr.find((e=>e.locale===n));if(e)return e.locale}return n in Or?Or[n]:null}var Fr=o(5893),Rr=o(4184);const Lr={},Nr={preventDefaultLogging:Br("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:Br("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:Br("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:Br("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:Br("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:Br("debugSvg",{defaults:{all:!1}}),throwToBlob:Br("throwToBlob",{defaults:{all:!1}}),logMessages:Br("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:Br("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:Br("debugCursors",{defaults:{all:!1}}),forceSrgb:Br("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:Br("debugGeometry",{defaults:{all:!1}}),hideShapes:Br("hideShapes",{defaults:{all:!1}})};if("undefined"!=typeof window&&(window.tldrawLog=e=>{Nr.logMessages.set(Nr.logMessages.get().concat(e))}),"undefined"!=typeof Element){const e=Element.prototype.removeChild;te("element removal logging",(()=>{Nr.elementRemovalLogging.get()?Element.prototype.removeChild=function(t){return console.warn("[tldraw] removing child:",t),e.call(this,t)}:Element.prototype.removeChild=e}))}function Br(e,{defaults:t,shouldStoreForSession:n=!0}){return function(e){const t=function(e){switch($r((()=>process.env.TLDRAW_ENV))??$r((()=>process.env.VERCEL_PUBLIC_TLDRAW_ENV))??$r((()=>process.env.NEXT_PUBLIC_TLDRAW_ENV))??"production"){case"production":return e.defaults.production??e.defaults.all;case"preview":case"staging":return e.defaults.staging??e.defaults.all;default:return e.defaults.development??e.defaults.all}}(e),n=e.shouldStoreForSession?function(e){try{return JSON.parse(window?.sessionStorage.getItem(`tldraw_debug:${e}`)??"null")}catch(e){return null}}(e.name):null,r=K(`debug:${e.name}`,n??t);return"undefined"!=typeof window&&(e.shouldStoreForSession&&te(`debug:${e.name}`,(()=>{const n=r.get();try{n===t?window.sessionStorage.removeItem(`tldraw_debug:${e.name}`):window.sessionStorage.setItem(`tldraw_debug:${e.name}`,JSON.stringify(n))}catch{}})),Object.defineProperty(window,`tldraw${e.name.replace(/^[a-z]/,(e=>e.toUpperCase()))}`,{get:()=>r.get(),set(e){r.set(e)},configurable:!0})),Object.assign(r,e)}({name:e,defaults:t,shouldStoreForSession:n})}function $r(e){try{return e()}catch{return null}}function Ur(e){if(e instanceof HTMLElement)return e;if(e.parentElement)return Ur(e.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Vr(e){e.preventDefault(),Nr.preventDefaultLogging.get()&&console.warn("preventDefault called on event:",e)}function Wr(e,t){if(e.setPointerCapture(t.pointerId),Nr.pointerCaptureTracking.get()){const t=Nr.pointerCaptureTrackingObject.get();t.set(e,(t.get(e)??0)+1)}Nr.pointerCaptureLogging.get()&&console.warn("setPointerCapture called on element:",e,t)}function Kr(e,t){if(e.hasPointerCapture(t.pointerId)){if(e.releasePointerCapture(t.pointerId),Nr.pointerCaptureTracking.get()){const t=Nr.pointerCaptureTrackingObject.get();1===t.get(e)?t.delete(e):t.has(e)?t.set(e,t.get(e)-1):console.warn("Release without capture")}Nr.pointerCaptureLogging.get()&&console.warn("releasePointerCapture called on element:",e,t)}}const Hr=e=>e.stopPropagation();function Gr(e){return e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:"pen"===e.pointerType}}const qr=e.createContext({}),Yr=()=>e.useContext(qr),Xr=(0,e.createContext)(null);function Zr({container:e,children:t}){return(0,Fr.jsx)(Xr.Provider,{value:e,children:t})}function Qr(){return _e((0,e.useContext)(Xr),"useContainer used outside of <Tldraw />")}const Jr=["input","select","button","textarea"];function eo(){const{activeElement:e}=document;return!(!e||!(e.getAttribute("contenteditable")||Jr.indexOf(e.tagName.toLowerCase())>-1))}const to={error:null};class no extends e.Component{static getDerivedStateFromError(e){return{error:e}}state=to;componentDidCatch(e){this.props.onError?.(e)}render(){const{error:e}=this.state;if(null!==e){const{fallback:t}=this.props;return(0,Fr.jsx)(t,{error:e})}return this.props.children}}function ro({children:e,fallback:t,...n}){return null===t?(0,Fr.jsx)(Fr.Fragment,{children:e}):(0,Fr.jsx)(no,{fallback:t,...n,children:e})}class oo{constructor(e){this.shape=e}equals(e){return this.shape?.isLocked===e?.shape?.isLocked&&this.shape?.props===e?.shape?.props&&this.shape?.meta===e?.shape?.meta}}const io=({shape:e,util:t})=>ne("Indicator:"+e.type,(()=>t.indicator(e))),so=({editor:e,id:t})=>{const n=le("shape",(()=>new oo(e.store.get(t))),[e,t]),{ShapeIndicatorErrorFallback:r}=xi();return!n.shape||n.shape.isLocked?null:(0,Fr.jsx)(ro,{fallback:r,onError:t=>e.annotateError(t,{origin:"react.shapeIndicator",willCrashApp:!1}),children:(0,Fr.jsx)(io,{shape:n.shape,util:e.getShapeUtil(n.shape)},n.shape.id)})},ao=e.memo((({id:e,className:t,color:n,opacity:r})=>{const o=Yr(),i=le("transform",(()=>{const t=o.getShapePageTransform(e);return t?t.toCssString():""}),[o,e]);return(0,Fr.jsx)("svg",{className:Rr("tl-overlays__item",t),children:(0,Fr.jsx)("g",{className:"tl-shape-indicator",transform:i,stroke:n??"var(--color-selected)",opacity:r,children:(0,Fr.jsx)(so,{editor:o,id:e})})})}));function co(){return(0,Fr.jsx)("div",{className:"tl-background"})}function lo(t,n,r,o,i,s){(0,e.useLayoutEffect)((()=>{const e=t.current;if(!e)return;if(void 0===n)return;let a=`translate(${n}px, ${r}px)`;void 0!==o&&(a+=` scale(${o})`),void 0!==i&&(a+=` rotate(${i}rad)`),s&&(a+=` translate(${s.x}px, ${s.y}px)`),e.style.transform=a}))}const uo={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>e<=0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e>=1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2};class ho{constructor(e=0,t=0,n=1){this.x=e,this.y=t,this.z=n}get pressure(){return this.z}set(e=this.x,t=this.y,n=this.z){return this.x=e,this.y=t,this.z=n,this}setTo({x:e=0,y:t=0,z:n=1}){return this.x=e,this.y=t,this.z=n,this}rot(e){if(0===e)return this;const{x:t,y:n}=this,r=Math.sin(e),o=Math.cos(e);return this.x=t*o-n*r,this.y=t*r+n*o,this}rotWith(e,t){if(0===t)return this;const n=this.x-e.x,r=this.y-e.y,o=Math.sin(t),i=Math.cos(t);return this.x=e.x+(n*i-r*o),this.y=e.y+(n*o+r*i),this}clone(){const{x:e,y:t,z:n}=this;return new ho(e,t,n)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,t){return this.x-=e,this.y-=t,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,t){return this.x+=e,this.y+=t,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,t){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),void 0!==t&&(this.x=Math.min(this.x,t),this.y=Math.min(this.y,t)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,t){const n=ho.Tan(e,this);return this.add(n.mul(t))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return ho.Dpr(this,e)}cpr(e){return ho.Cpr(this,e)}len2(){return ho.Len2(this)}len(){return ho.Len(this)}pry(e){return ho.Pry(this,e)}per(){const{x:e,y:t}=this;return this.x=t,this.y=-e,this}uni(){return ho.Uni(this)}tan(e){return ho.Tan(this,e)}dist(e){return ho.Dist(this,e)}distanceToLineSegment(e,t){return ho.DistanceToLineSegment(e,t,this)}slope(e){return ho.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return ho.Angle(this,e)}toAngle(){return ho.ToAngle(this)}lrp(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this}equals(e){return ho.Equals(this,e)}equalsXY(e,t){return ho.EqualsXY(this,e,t)}norm(){const e=this.len();return this.x=0===e?0:this.x/e,this.y=0===e?0:this.y/e,this}toFixed(){return ho.ToFixed(this)}toString(){return ho.ToString(ho.ToFixed(this))}toJson(){return ho.ToJson(this)}toArray(){return ho.ToArray(this)}static Add(e,t){return new ho(e.x+t.x,e.y+t.y)}static AddXY(e,t,n){return new ho(e.x+t,e.y+n)}static Sub(e,t){return new ho(e.x-t.x,e.y-t.y)}static SubXY(e,t,n){return new ho(e.x-t,e.y-n)}static AddScalar(e,t){return new ho(e.x+t,e.y+t)}static SubScalar(e,t){return new ho(e.x-t,e.y-t)}static Div(e,t){return new ho(e.x/t,e.y/t)}static Mul(e,t){return new ho(e.x*t,e.y*t)}static DivV(e,t){return new ho(e.x/t.x,e.y/t.y)}static MulV(e,t){return new ho(e.x*t.x,e.y*t.y)}static Neg(e){return new ho(-e.x,-e.y)}static Per(e){return new ho(e.y,-e.x)}static Dist2(e,t){return ho.Sub(e,t).len2()}static Abs(e){return new ho(Math.abs(e.x),Math.abs(e.y))}static Dist(e,t){return Math.hypot(e.y-t.y,e.x-t.x)}static Dpr(e,t){return e.x*t.x+e.y*t.y}static Cross(e,t){return new ho(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z)}static Cpr(e,t){return e.x*t.y-t.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return Math.hypot(e.x,e.y)}static Pry(e,t){return ho.Dpr(e,t)/ho.Len(t)}static Uni(e){return ho.Div(e,ho.Len(e))}static Tan(e,t){return ho.Uni(ho.Sub(e,t))}static Min(e,t){return new ho(Math.min(e.x,t.x),Math.min(e.y,t.y))}static Max(e,t){return new ho(Math.max(e.x,t.x),Math.max(e.y,t.y))}static From({x:e,y:t,z:n=1}){return new ho(e,t,n)}static FromArray(e){return new ho(e[0],e[1])}static Rot(e,t=0){const n=Math.sin(t),r=Math.cos(t);return new ho(e.x*r-e.y*n,e.x*n+e.y*r)}static RotWith(e,t,n){const r=e.x-t.x,o=e.y-t.y,i=Math.sin(n),s=Math.cos(n);return new ho(t.x+(r*s-o*i),t.y+(r*i+o*s))}static NearestPointOnLineThroughPoint(e,t,n){return ho.Mul(t,ho.Sub(n,e).pry(t)).add(e)}static NearestPointOnLineSegment(e,t,n,r=!0){const o=ho.Tan(t,e),i=ho.Add(e,ho.Mul(o,ho.Sub(n,e).pry(o)));if(r){if(i.x<Math.min(e.x,t.x))return ho.Cast(e.x<t.x?e:t);if(i.x>Math.max(e.x,t.x))return ho.Cast(e.x>t.x?e:t);if(i.y<Math.min(e.y,t.y))return ho.Cast(e.y<t.y?e:t);if(i.y>Math.max(e.y,t.y))return ho.Cast(e.y>t.y?e:t)}return i}static DistanceToLineThroughPoint(e,t,n){return ho.Dist(n,ho.NearestPointOnLineThroughPoint(e,t,n))}static DistanceToLineSegment(e,t,n,r=!0){return ho.Dist(n,ho.NearestPointOnLineSegment(e,t,n,r))}static Snap(e,t=1){return new ho(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}static Cast(e){return e instanceof ho?e:ho.From(e)}static Slope(e,t){return e.x===t.y?NaN:(e.y-t.y)/(e.x-t.x)}static Angle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static Lrp(e,t,n){return ho.Sub(t,e).mul(n).add(e)}static Med(e,t){return new ho((e.x+t.x)/2,(e.y+t.y)/2)}static Equals(e,t){return Math.abs(e.x-t.x)<1e-4&&Math.abs(e.y-t.y)<1e-4}static EqualsXY(e,t,n){return e.x===t&&e.y===n}static Clockwise(e,t,n){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)<0}static Rescale(e,t){const n=ho.Len(e);return new ho(t*e.x/n,t*e.y/n)}static ScaleWithOrigin(e,t,n){return ho.Sub(e,n).mul(t).add(n)}static ToFixed(e,t=2){return new ho(+e.x.toFixed(t),+e.y.toFixed(t),+e.z.toFixed(t))}static Nudge(e,t,n){return ho.Add(e,ho.Tan(t,e).mul(n))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let t=Math.atan2(e.y,e.x);return t<0&&(t+=2*Math.PI),t}static FromAngle(e,t=1){return new ho(Math.cos(e)*t,Math.sin(e)*t)}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:t,y:n,z:r}=e;return{x:t,y:n,z:r}}static Average(e){const t=e.length,n=new ho(0,0);for(let r=0;r<t;r++)n.add(e[r]);return n.div(t)}static Clamp(e,t,n){return void 0===n?new ho(Math.min(Math.max(e.x,t)),Math.min(Math.max(e.y,t))):new ho(Math.min(Math.max(e.x,t),n),Math.min(Math.max(e.y,t),n))}static PointsBetween(e,t,n=6){const r=[];for(let o=0;o<n;o++){const i=uo.easeInQuad(o/(n-1)),s=ho.Lrp(e,t,i);s.z=Math.min(1,.5+.65*Math.abs(.5-po(i))),r.push(s)}return r}static SnapToGrid(e,t=8){return new ho(Math.round(e.x/t)*t,Math.round(e.y/t)*t)}}const po=e=>e<.5?2*e*e:(4-2*e)*e-1;class fo{constructor(e=0,t=0,n=0,r=0){this.x=e,this.y=t,this.w=n,this.h=r}x=0;y=0;w=0;h=0;get point(){return new ho(this.x,this.y)}set point(e){this.x=e.x,this.y=e.y}get minX(){return this.x}set minX(e){this.x=e}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(e){this.y=e}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}get aspectRatio(){return this.width/this.height}get center(){return new ho(this.midX,this.midY)}set center(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}get corners(){return[new ho(this.minX,this.minY),new ho(this.maxX,this.minY),new ho(this.maxX,this.maxY),new ho(this.minX,this.maxY)]}get snapPoints(){return[new ho(this.minX,this.minY),new ho(this.maxX,this.minY),new ho(this.maxX,this.maxY),new ho(this.minX,this.maxY),this.center]}get sides(){const{corners:e}=this;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}get size(){return new ho(this.w,this.h)}toFixed(){return this.x=So(this.x),this.y=So(this.y),this.w=So(this.w),this.h=So(this.h),this}setTo(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}set(e=0,t=0,n=0,r=0){return this.x=e,this.y=t,this.w=n,this.h=r,this}expand(e){const t=Math.min(this.minX,e.minX),n=Math.min(this.minY,e.minY),r=Math.max(this.maxX,e.maxX),o=Math.max(this.maxY,e.maxY);return this.x=t,this.y=n,this.w=r-t,this.h=o-n,this}expandBy(e){return this.x-=e,this.y-=e,this.w+=2*e,this.h+=2*e,this}scale(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}clone(){const{x:e,y:t,w:n,h:r}=this;return new fo(e,t,n,r)}translate(e){return this.x+=e.x,this.y+=e.y,this}snapToGrid(e){const t=Math.round(this.minX/e)*e,n=Math.round(this.minY/e)*e,r=Math.round(this.maxX/e)*e,o=Math.round(this.maxY/e)*e;this.minX=t,this.minY=n,this.width=Math.max(1,r-t),this.height=Math.max(1,o-n)}collides(e){return fo.Collides(this,e)}contains(e){return fo.Contains(this,e)}includes(e){return fo.Includes(this,e)}containsPoint(e,t=0){return fo.ContainsPoint(this,e,t)}getHandlePoint(e){switch(e){case"top_left":return new ho(this.minX,this.minY);case"top_right":return new ho(this.maxX,this.minY);case"bottom_left":return new ho(this.minX,this.maxY);case"bottom_right":return new ho(this.maxX,this.maxY);case"top":return new ho(this.midX,this.minY);case"right":return new ho(this.maxX,this.midY);case"bottom":return new ho(this.midX,this.maxY);case"left":return new ho(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(e,t,n){const{minX:r,minY:o,maxX:i,maxY:s}=this;let{minX:a,minY:c,maxX:l,maxY:u}=this;switch(e){case"left":case"top_left":case"bottom_left":a+=t;break;case"right":case"top_right":case"bottom_right":l+=t}switch(e){case"top":case"top_left":case"top_right":c+=n;break;case"bottom":case"bottom_left":case"bottom_right":u+=n}if((l-a)/(i-r)<0){const e=l;l=a,a=e}if((u-c)/(s-o)<0){const e=u;u=c,c=e}this.minX=a,this.minY=c,this.width=Math.abs(l-a),this.height=Math.abs(u-c)}union(e){const t=Math.min(this.minX,e.x),n=Math.min(this.minY,e.y),r=Math.max(this.maxX,e.w+e.x),o=Math.max(this.maxY,e.h+e.y);return this.x=t,this.y=n,this.width=r-t,this.height=o-n,this}static From(e){return new fo(e.x,e.y,e.w,e.h)}static FromPoints(e){if(0===e.length)return new fo;let t,n=1/0,r=1/0,o=-1/0,i=-1/0;for(let s=0,a=e.length;s<a;s++)t=e[s],n=Math.min(t.x,n),r=Math.min(t.y,r),o=Math.max(t.x,o),i=Math.max(t.y,i);return new fo(n,r,o-n,i-r)}static Expand(e,t){const n=Math.min(t.minX,e.minX),r=Math.min(t.minY,e.minY),o=Math.max(t.maxX,e.maxX),i=Math.max(t.maxY,e.maxY);return new fo(n,r,o-n,i-r)}static ExpandBy(e,t){return new fo(e.minX-t,e.minY-t,e.width+2*t,e.height+2*t)}static Collides=(e,t)=>!(e.maxX<t.minX||e.minX>t.maxX||e.maxY<t.minY||e.minY>t.maxY);static Contains=(e,t)=>e.minX<t.minX&&e.minY<t.minY&&e.maxY>t.maxY&&e.maxX>t.maxX;static Includes=(e,t)=>fo.Collides(e,t)||fo.Contains(e,t);static ContainsPoint=(e,t,n=0)=>!(t.x<e.minX-n||t.y<e.minY-n||t.x>e.maxX+n||t.y>e.maxY+n);static Common=e=>{let t=1/0,n=1/0,r=-1/0,o=-1/0;for(let i=0;i<e.length;i++){const s=e[i];t=Math.min(t,s.minX),n=Math.min(n,s.minY),r=Math.max(r,s.maxX),o=Math.max(o,s.maxY)}return new fo(t,n,r-t,o-n)};static Sides=(e,t=0)=>{const{corners:n}=e;return[[n[0],n[1]],[n[1],n[2]],[n[2],n[3]],[n[3],n[0]]]};static Resize(e,t,n,r,o=!1){const{minX:i,minY:s,maxX:a,maxY:c}=e;let{minX:l,minY:u,maxX:d,maxY:h}=e;switch(t){case"left":case"top_left":case"bottom_left":l+=n;break;case"right":case"top_right":case"bottom_right":d+=n}switch(t){case"top":case"top_left":case"top_right":u+=r;break;case"bottom":case"bottom_left":case"bottom_right":h+=r}const p=(d-l)/(a-i),f=(h-u)/(c-s),g=p<0,m=f<0;if(o){const e=(a-i)/(c-s),n=Math.abs(d-l),r=Math.abs(h-u),o=n*(f<0?1:-1)*(1/e),g=r*(p<0?1:-1)*e,m=e<n/r;switch(t){case"top_left":m?u=h+o:l=d+g;break;case"top_right":m?u=h+o:d=l-g;break;case"bottom_right":m?h=u-o:d=l-g;break;case"bottom_left":m?h=u-o:l=d+g;break;case"bottom":case"top":{const t=(l+d)/2,n=r*e;l=t-n/2,d=t+n/2;break}case"left":case"right":{const t=(u+h)/2,r=n/e;u=t-r/2,h=t+r/2;break}}}if(g){const e=d;d=l,l=e}if(m){const e=h;h=u,u=e}const _=new fo(l,u,Math.abs(d-l),Math.abs(h-u));return{box:_,scaleX:+(_.width/e.width*(p>0?1:-1)).toFixed(5),scaleY:+(_.height/e.height*(f>0?1:-1)).toFixed(5)}}equals(e){return fo.Equals(this,e)}static Equals(e,t){return t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(e){return new fo(e.x,e.y,Math.max(1,e.w),Math.max(1,e.h))}}function go(e){return`${No(e.x)},${No(e.y)} `}function mo(e,t){return`${No((e.x+t.x)/2)},${No((e.y+t.y)/2)} `}const _o=Math.PI,yo=_o/2,wo=2*_o,vo=Math.PI/180,bo=Math.sin;function xo(e,t,n){return Math.max(t,void 0!==n?Math.min(e,n):e)}function So(e,t=1e10){return e?Math.round(e*t)/t:0}function ko(e,t,n=1e-6){return Math.abs(e-t)<=n}function Co(e,t){const n=Math.pow(e-t,2)/Math.pow(e+t,2);return _o*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))}function Eo(e){return(e%=wo)<0?e+=wo:0===e&&(e=0),e}function Ao(e,t){return(e=Eo(e))>(t=Eo(t))&&(t+=wo),t-e}function Io(e,t){return wo-Ao(e,t)}function Po(e,t){const n=(t-e)%wo;return 2*n%wo-n}function Mo(e){return(wo+e)%wo}function To(e,t){const n=wo/t;let r=Math.floor((Mo(e)+n/2)/n)*n%wo;return r<_o&&(r+=wo),r>_o&&(r-=wo),r}function jo(e,t){return e===t||ko(e%(Math.PI/2)-t%(Math.PI/2),0)}function Do(e,t,n,r){return new ho(e+n*Math.cos(r),t+n*Math.sin(r))}function Oo(e,t,n){const r=e/2,o=t/2,i=[];let s=1/0,a=1/0;for(let e=0;e<n;e++){const t=e*(wo/n)-yo,c=r+r*Math.cos(t),l=o+o*Math.sin(t);c<s&&(s=c),l<a&&(a=l),i.push(new ho(c,l))}if(0!==s||0!==a)for(let e=0;e<i.length;e++){const t=i[e];t.x-=s,t.y-=a}return i}function zo(e,t,n,r){return e<r&&n<t}function Fo(e,t,n,r){const o=Math.max(e,n),i=Math.min(t,r);return o<=i?[o,i]:null}function Ro(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function Lo(e,t){let n,r,o=0;for(let i=0;i<t.length;i++)n=t[i],r=t[(i+1)%t.length],n.y<=e.y?r.y>e.y&&Ro(n,r,e)>0&&(o+=1):r.y<=e.y&&Ro(n,r,e)<0&&(o-=1);return 0!==o}function No(e){return+e.toFixed(4)}function Bo(e){return+e.toFixed(2)}const $o=e=>Math.abs(e)<Number.MAX_SAFE_INTEGER,Uo=({brush:t,color:n,opacity:r,className:o})=>{const i=(0,e.useRef)(null);lo(i,t.x,t.y);const s=No(Math.max(1,t.w)),a=No(Math.max(1,t.h));return(0,Fr.jsx)("svg",{className:"tl-overlays__item",ref:i,children:n?(0,Fr.jsxs)("g",{className:"tl-brush",opacity:r,children:[(0,Fr.jsx)("rect",{width:s,height:a,fill:n,opacity:.75}),(0,Fr.jsx)("rect",{width:s,height:a,fill:"none",stroke:n,opacity:.1})]}):(0,Fr.jsx)("rect",{className:`tl-brush tl-brush__default ${o}`,width:s,height:a})})},Vo=({className:t,zoom:n,point:r,color:o,viewport:i,opacity:s=1})=>{const a=(0,e.useRef)(null);return lo(a,xo(r.x,i.minX+5/n,i.maxX-5/n),xo(r.y,i.minY+5/n,i.maxY-5/n),1/n,ho.Angle(i.center,r)),(0,Fr.jsxs)("svg",{ref:a,className:Rr("tl-overlays__item",t),children:[(0,Fr.jsx)("use",{href:"#cursor_hint",color:o,strokeWidth:3,stroke:"var(--color-background)"}),(0,Fr.jsx)("use",{href:"#cursor_hint",color:o,opacity:s})]})},Wo=(0,e.memo)((({className:t,zoom:n,point:r,color:o,name:i,chatMessage:s})=>{const a=(0,e.useRef)(null);return lo(a,r?.x,r?.y,1/n),r?(0,Fr.jsxs)("div",{ref:a,className:Rr("tl-overlays__item",t),children:[(0,Fr.jsx)("svg",{className:"tl-cursor",children:(0,Fr.jsx)("use",{href:"#cursor",color:o})}),s?(0,Fr.jsxs)(Fr.Fragment,{children:[i&&(0,Fr.jsx)("div",{className:"tl-nametag-title",style:{color:o},children:i}),(0,Fr.jsx)("div",{className:"tl-nametag-chat",style:{backgroundColor:o},children:s})]}):i&&(0,Fr.jsx)("div",{className:"tl-nametag",style:{backgroundColor:o},children:i})]}):null})),Ko={openWindow:(e,t)=>window.open(e,t,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>await(window.__tldraw__hardReset?.())};function Ho(){Ko.hardReset()}function Go(){}const qo=({error:t,editor:n})=>{const r=(0,e.useRef)(null),[o,i]=(0,e.useState)(!1),[s,a]=(0,e.useState)(!1),[c,l]=(0,e.useState)(!1),u=t instanceof Error?t.message:String(t),d=t instanceof Error?t.stack:null,h=le("isDarkMode",(()=>{try{if(n)return n.user.getIsDarkMode()}catch{}return null}),[n]),[p,f]=(0,e.useState)(null);(0,e.useLayoutEffect)((()=>{null!==h&&f(h);let e=r.current?.parentElement,t=!1;for(;e;){if(e.classList.contains("tl-theme__dark")||e.classList.contains("tl-theme__light")){t=!0;break}e=e.parentElement}f(t?null:window.matchMedia("(prefers-color-scheme: dark)").matches)}),[h]),(0,e.useEffect)((()=>{if(s){const e=setTimeout((()=>{a(!1)}),2e3);return()=>clearTimeout(e)}}),[s]);const g=new URL("https://github.com/tldraw/tldraw/issues/new");return g.searchParams.set("title",u),g.searchParams.set("labels","bug"),g.searchParams.set("body",`Hey, I ran into an error while using tldraw:\n\n\`\`\`js\n${d??u}\n\`\`\`\n\nMy browser: ${navigator.userAgent}`),(0,Fr.jsxs)("div",{ref:r,className:Rr("tl-container tl-error-boundary",null===p?"":p?"tl-theme__dark":"tl-theme__light"),children:[(0,Fr.jsx)("div",{className:"tl-error-boundary__overlay"}),n&&(0,Fr.jsx)(no,{onError:Go,fallback:()=>null,children:(0,Fr.jsx)(qr.Provider,{value:n,children:(0,Fr.jsx)("div",{className:"tl-overlay tl-error-boundary__canvas",children:(0,Fr.jsx)(Ns,{})})})}),(0,Fr.jsx)("div",{className:Rr("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":o&&!c}),children:c?(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("h2",{children:"Are you sure?"}),(0,Fr.jsx)("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),(0,Fr.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,Fr.jsx)("button",{onClick:()=>l(!1),children:"Cancel"}),(0,Fr.jsx)("button",{className:"tl-error-boundary__reset",onClick:async()=>{Ho()},children:"Reset data"})]})]}):(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("h2",{children:"Something's gone wrong."}),(0,Fr.jsxs)("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",(0,Fr.jsx)("a",{href:g.toString(),children:"create a GitHub issue"})," or"," ",(0,Fr.jsx)("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),o&&(0,Fr.jsxs)("div",{className:"tl-error-boundary__content__error",children:[(0,Fr.jsx)("pre",{children:(0,Fr.jsx)("code",{children:d??u})}),(0,Fr.jsx)("button",{onClick:()=>{const e=document.createElement("textarea");e.value=d??u,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove(),a(!0)},children:s?"Copied!":"Copy"})]}),(0,Fr.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,Fr.jsx)("button",{onClick:()=>i(!o),children:o?"Hide details":"Show details"}),(0,Fr.jsxs)("div",{className:"tl-error-boundary__content__actions__group",children:[(0,Fr.jsx)("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),(0,Fr.jsx)("button",{className:"tl-error-boundary__refresh",onClick:()=>{Ko.refreshPage()},children:"Refresh Page"})]})]})]})})]})},Yo=2e3,Xo=320,Zo=[.1,.25,.5,1,2,4,8],Qo=.1,Jo=8,ei=32,ti={};for(let e=1;e<=Math.ceil(Jo);e++)ti[e+"_dark"]=`hash_pattern_zoom_${e}_dark`,ti[e+"_light"]=`hash_pattern_zoom_${e}_light`;const ni={duration:0,easing:uo.easeInOutCubic},ri=.09,oi=[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],ii=({x:e,y:t,z:n,size:r})=>(0,Fr.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[(0,Fr.jsx)("defs",{children:oi.map((({min:o,mid:i,step:s},a)=>{const c=s*r*n,l=.5+e*n,u=.5+t*n,d=l>0?l%c:c+l%c,h=u>0?u%c:c+u%c,p=n<i?Ae(n,[o,i],[0,1]):1;return(0,Fr.jsx)("pattern",{id:`grid-${s}`,width:c,height:c,patternUnits:"userSpaceOnUse",children:(0,Fr.jsx)("circle",{className:"tl-grid-dot",cx:d,cy:h,r:1,opacity:p})},`grid-pattern-${a}`)}))}),oi.map((({step:e},t)=>(0,Fr.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${e})`},`grid-rect-${t}`)))]}),si=({handle:e,isCoarse:t,className:n,zoom:r})=>{const o=(t?20:12)/r,i=("create"===e.type&&t?3:4)/r;return(0,Fr.jsxs)("g",{className:Rr("tl-handle",{"tl-handle__virtual":"virtual"===e.type,"tl-handle__create":"create"===e.type},n),children:[(0,Fr.jsx)("circle",{className:"tl-handle__bg",r:o}),(0,Fr.jsx)("circle",{className:"tl-handle__fg",r:i})]})},ai=({children:e})=>(0,Fr.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:e}),ci=({shapeId:e})=>(0,Fr.jsx)(ao,{className:"tl-user-indicator__hovered",id:e});function li(e,t=!0){const n=e.length;if(n<2)return"";let r=e[0],o=e[1];if(2===n)return`M${go(r)}L${go(o)}`;let i="";for(let t=2,s=n-1;t<s;t++)r=e[t],o=e[t+1],i+=mo(r,o);return t?`M${mo(e[0],e[1])}Q${go(e[1])}${mo(e[1],e[2])}T${i}${mo(e[n-1],e[0])}${mo(e[0],e[1])}Z`:`M${go(e[0])}Q${go(e[1])}${mo(e[1],e[2])}${e.length>3?"T":""}${i}L${go(e[n-1])}`}const ui=({scribble:e,zoom:t,color:n,opacity:r,className:o})=>e.points.length?(0,Fr.jsx)("svg",{className:o?Rr("tl-overlays__item",o):o,children:(0,Fr.jsx)("path",{className:"tl-scribble",d:li(e.points,!1),stroke:n??`var(--color-${e.color})`,fill:"none",strokeWidth:8/t,opacity:r??e.opacity})}):null,di=({bounds:t,rotation:n})=>{const r=e.useRef(null);return lo(r,t.x,t.y,1,n),e.useLayoutEffect((()=>{const e=r.current;e&&(e.style.width=No(Math.max(1,t.width))+"px",e.style.height=No(Math.max(1,t.height))+"px")}),[t.width,t.height]),(0,Fr.jsx)("div",{ref:r,className:"tl-selection__bg",draggable:!1})},hi=({bounds:t,rotation:n})=>{const r=Yr(),o=(0,e.useRef)(null),i=le("only selected shape",(()=>r.getOnlySelectedShape()),[r]),s=i?r.getShapeUtil(i).expandSelectionOutlinePx(i):0;return lo(o,t?.x,t?.y,1,n,{x:-s,y:-s}),t=t.clone().expandBy(s).zeroFix(),(0,Fr.jsx)("svg",{ref:o,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:(0,Fr.jsx)("rect",{className:Rr("tl-selection__fg__outline"),width:No(t.width),height:No(t.height)})})},pi=()=>(0,Fr.jsx)("div",{className:"tl-shape-error-boundary"}),fi=()=>(0,Fr.jsx)("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function gi({points:e,zoom:t}){const n=2.5/t,r=e.reduce(((e,t)=>Math.min(e,t.x)),1/0),o=e.reduce(((e,t)=>Math.max(e,t.x)),-1/0),i=e.reduce(((e,t)=>Math.min(e,t.y)),1/0),s=e.reduce(((e,t)=>Math.max(e,t.y)),-1/0);let a,c,l,u;return e.some((e=>e.x===r&&e.y===i))?(a=r,c=i,l=o,u=s):(a=r,c=s,l=o,u=i),(0,Fr.jsxs)("g",{className:"tl-snap-line",children:[(0,Fr.jsx)("line",{x1:a,y1:c,x2:l,y2:u}),e.map(((e,t)=>(0,Fr.jsx)("g",{transform:`translate(${e.x},${e.y})`,children:(0,Fr.jsx)("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},t)))]})}function mi({gaps:t,direction:n,zoom:r}){const o=3.5/r;let i=[-1/0,1/0],s=null;const a="horizontal"===n;for(const e of t)s=Fo(i[0],i[1],a?e.startEdge[0].y:e.startEdge[0].x,a?e.startEdge[1].y:e.startEdge[1].x),s&&(i=s,s=Fo(i[0],i[1],a?e.endEdge[0].y:e.endEdge[0].x,a?e.endEdge[1].y:e.endEdge[1].x),s&&(i=s));if(null===i)return null;const c=(i[0]+i[1])/2;return(0,Fr.jsx)("g",{className:"tl-snap-line",children:t.map((({startEdge:t,endEdge:n},r)=>(0,Fr.jsx)(e.Fragment,{children:a?(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("line",{x1:t[0].x,y1:c-2*o,x2:t[1].x,y2:c+2*o}),(0,Fr.jsx)("line",{x1:n[0].x,y1:c-2*o,x2:n[1].x,y2:c+2*o}),(0,Fr.jsx)("line",{x1:t[0].x,y1:c,x2:n[0].x,y2:c}),(0,Fr.jsx)("line",{x1:(t[0].x+n[0].x)/2,y1:c-o,x2:(t[0].x+n[0].x)/2,y2:c+o})]}):(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("line",{x1:c-2*o,y1:t[0].y,x2:c+2*o,y2:t[1].y}),(0,Fr.jsx)("line",{x1:c-2*o,y1:n[0].y,x2:c+2*o,y2:n[1].y}),(0,Fr.jsx)("line",{x1:c,y1:t[0].y,x2:c,y2:n[0].y}),(0,Fr.jsx)("line",{x1:c-o,y1:(t[0].y+n[0].y)/2,x2:c+o,y2:(t[0].y+n[0].y)/2})]})},r)))})}const _i=({className:e,line:t,zoom:n})=>(0,Fr.jsx)("svg",{className:Rr("tl-overlays__item",e),children:"points"===t.type?(0,Fr.jsx)(gi,{...t,zoom:n}):"gaps"===t.type?(0,Fr.jsx)(mi,{...t,zoom:n}):null}),yi=()=>(0,Fr.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:(0,Fr.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,Fr.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),(0,Fr.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:(0,Fr.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),wi=()=>null,vi=(0,e.createContext)({});function bi({overrides:t,children:n}){return(0,Fr.jsx)(vi.Provider,{value:(0,e.useMemo)((()=>({Background:co,SvgDefs:wi,Brush:Uo,ZoomBrush:Uo,ScreenshotBrush:Uo,CollaboratorBrush:Uo,Cursor:Wo,CollaboratorCursor:Wo,CollaboratorHint:Vo,CollaboratorShapeIndicator:ao,Grid:ii,Scribble:ui,SnapLine:_i,Handles:ai,Handle:si,CollaboratorScribble:ui,ErrorFallback:qo,ShapeErrorFallback:pi,ShapeIndicatorErrorFallback:fi,Spinner:yi,SelectionBackground:di,SelectionForeground:hi,HoveredShapeIndicator:ci,OnTheCanvas:null,InFrontOfTheCanvas:null,...t})),[t]),children:n})}function xi(){return(0,e.useContext)(vi)}const Si=["textarea","input"],ki={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function Ci(e,t,n){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*n):e*t*n/(t+n*e)}function Ei(e,t,n,r=.15){return 0===r?function(e,t,n){return Math.max(t,Math.min(e,n))}(e,t,n):e<t?-Ci(t-e,n-t,r)+t:e>n?+Ci(e-n,n-t,r)+n:e}function Ai(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){Ai(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Mi={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Ti(e){return e?e[0].toUpperCase()+e.slice(1):""}const ji=["enter","leave"];const Di=["gotpointercapture","lostpointercapture"];function Oi(e){let t=e.substring(2).toLowerCase();const n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));const r=Di.includes(t)?"capturecapture":"capture",o=!!~t.indexOf(r);return o&&(t=t.replace("capture","")),{device:t,capture:o,passive:n}}function zi(e){return"touches"in e}function Fi(e,t){try{const n=t.clientX-e.clientX,r=t.clientY-e.clientY,o=(t.clientX+e.clientX)/2,i=(t.clientY+e.clientY)/2,s=Math.hypot(n,r);return{angle:-180*Math.atan2(n,r)/Math.PI,distance:s,origin:[o,i]}}catch(e){}return null}function Ri(e,t){const[n,r]=Array.from(e.touches).filter((e=>t.includes(e.identifier)));return Fi(n,r)}function Li(e){let{deltaX:t,deltaY:n,deltaMode:r}=e;return 1===r?(t*=40,n*=40):2===r&&(t*=800,n*=800),[t,n]}function Ni(e,...t){return"function"==typeof e?e(...t):e}function Bi(){}function $i(...e){return 0===e.length?Bi:1===e.length?e[0]:function(){let t;for(const n of e)t=n.apply(this,arguments)||t;return t}}function Ui(e,t){return Object.assign({},t,e||{})}class Vi{constructor(e,t,n){this.ctrl=e,this.args=t,this.key=n,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:n,args:r}=this;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?Ni(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:n,shared:r}=this;t.args=this.args;let o=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){const t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){const{shiftKey:n,altKey:r,metaKey:o,ctrlKey:i}=e;Object.assign(t,{shiftKey:n,altKey:r,metaKey:o,ctrlKey:i})}return t}(e)),r.down=r.pressed=r.buttons%2==1||r.touches>0,o=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const e=t._delta.map(Math.abs);ki.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);const[i,s]=t._movement,[a,c]=n.threshold,{_step:l,values:u}=t;if(n.hasCustomTransform?(!1===l[0]&&(l[0]=Math.abs(i)>=a&&u[0]),!1===l[1]&&(l[1]=Math.abs(s)>=c&&u[1])):(!1===l[0]&&(l[0]=Math.abs(i)>=a&&Math.sign(i)*a),!1===l[1]&&(l[1]=Math.abs(s)>=c&&Math.sign(s)*c)),t.intentional=!1!==l[0]||!1!==l[1],!t.intentional)return;const d=[0,0];if(n.hasCustomTransform){const[e,t]=u;d[0]=!1!==l[0]?e-l[0]:0,d[1]=!1!==l[1]?t-l[1]:0}else d[0]=!1!==l[0]?i-l[0]:0,d[1]=!1!==l[1]?s-l[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(d);const h=t.offset,p=t._active&&!t._blocked||t.active;p&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=Ni(n.bounds,t)),this.setup&&this.setup()),t.movement=d,this.computeOffset()));const[f,g]=t.offset,[[m,_],[y,w]]=t._bounds;t.overflow=[f<m?-1:f>_?1:0,g<y?-1:g>w?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);const v=t._active&&n.rubberband||[0,0];if(t.offset=function(e,[t,n],[r,o]){const[[i,s],[a,c]]=e;return[Ei(t,i,s,r),Ei(n,a,c,o)]}(t._bounds,t.offset,v),t.delta=ki.sub(t.offset,h),this.computeMovement(),p&&(!t.last||o>32)){t.delta=ki.sub(t.offset,h);const e=t.delta.map(Math.abs);ki.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&o>0&&(t.velocity=[e[0]/o,e[1]/o],t.timeDelta=o)}}emit(){const e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!n.triggerAllEvents)return;const r=this.handler(Pi(Pi(Pi({},t),e),{},{[this.aliasKey]:e.values}));void 0!==r&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}class Wi extends Vi{constructor(...e){super(...e),Ai(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=ki.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=ki.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,n=this.config;if(!t.axis&&e){const r="object"==typeof n.axisThreshold?n.axisThreshold[function(e){return zi(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}(e)]:n.axisThreshold;t.axis=function([e,t],n){const r=Math.abs(e),o=Math.abs(t);return r>o&&r>n?"x":o>r&&o>n?"y":void 0}(t._movement,r)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}const Ki=e=>e,Hi={enabled:(e=!0)=>e,eventOptions:(e,t,n)=>Pi(Pi({},n.shared.eventOptions),e),preventDefault:(e=!1)=>e,triggerAllEvents:(e=!1)=>e,rubberband(e=0){switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return ki.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?ki.toVector(e):void 0,transform(e,t,n){const r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||Ki},threshold:e=>ki.toVector(e,0)},Gi=Pi(Pi({},Hi),{},{axis(e,t,{axis:n}){if(this.lockDirection="lock"===n,!this.lockDirection)return n},axisThreshold:(e=0)=>e,bounds(e={}){if("function"==typeof e)return t=>Gi.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;const{left:t=-1/0,right:n=1/0,top:r=-1/0,bottom:o=1/0}=e;return[[t,n],[r,o]]}}),qi="undefined"!=typeof window&&window.document&&window.document.createElement;function Yi(){return qi&&"ontouchstart"in window}const Xi={isBrowser:qi,gesture:function(){try{return"constructor"in GestureEvent}catch(e){return!1}}(),touch:Yi(),touchscreen:Yi()||qi&&window.navigator.maxTouchPoints>1,pointer:qi&&"onpointerdown"in window,pointerLock:qi&&"exitPointerLock"in window.document},Zi={mouse:0,touch:0,pen:8};function Qi(e){const[t,n]=e.overflow,[r,o]=e._delta,[i,s]=e._direction;(t<0&&r>0&&i<0||t>0&&r<0&&i>0)&&(e._movement[0]=e._movementBound[0]),(n<0&&o>0&&s<0||n>0&&o<0&&s>0)&&(e._movement[1]=e._movementBound[1])}Pi(Pi({},Gi),{},{device(e,t,{pointer:{touch:n=!1,lock:r=!1,mouse:o=!1}={}}){return this.pointerLock=r&&Xi.pointerLock,Xi.touch&&n?"touch":this.pointerLock?"mouse":Xi.pointer&&!o?"pointer":Xi.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:n}){if(this.preventScrollDelay="number"==typeof n?n:n||void 0===n&&e?250:void 0,Xi.touchscreen&&!1!==n)return e||(void 0!==n?"y":void 0)},pointerCapture(e,t,{pointer:{capture:n=!0,buttons:r=1,keys:o=!0}={}}){return this.pointerButtons=r,this.keys=o,!this.pointerLock&&"pointer"===this.device&&n},threshold(e,t,{filterTaps:n=!1,tapsThreshold:r=3,axis:o}){const i=ki.toVector(e,n?r:o?1:0);return this.filterTaps=n,this.tapsThreshold=r,i},swipe({velocity:e=.5,distance:t=50,duration:n=250}={}){return{velocity:this.transform(ki.toVector(e)),distance:this.transform(ki.toVector(t)),duration:n}},delay(e=0){switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:e=>e?Pi(Pi({},Zi),e):Zi,keyboardDisplacement:(e=10)=>e});const Ji=Pi(Pi({},Hi),{},{device(e,t,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Xi.touch&&Xi.gesture)return"gesture";if(Xi.touch&&r)return"touch";if(Xi.touchscreen){if(Xi.pointer)return"pointer";if(Xi.touch)return"touch"}},bounds(e,t,{scaleBounds:n={},angleBounds:r={}}){const o=e=>{const t=Ui(Ni(n,e),{min:-1/0,max:1/0});return[t.min,t.max]},i=e=>{const t=Ui(Ni(r,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof n&&"function"!=typeof r?[o(),i()]:e=>[o(e),i(e)]},threshold(e,t,n){return this.lockDirection="lock"===n.axis,ki.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey:e=>void 0===e?"ctrlKey":e,pinchOnWheel:(e=!0)=>e});Pi(Pi({},Gi),{},{mouseOnly:(e=!0)=>e});const es=Gi;Pi(Pi({},Gi),{},{mouseOnly:(e=!0)=>e});const ts=new Map,ns=new Map;function rs(e){ts.set(e.key,e.engine),ns.set(e.key,e.resolver)}const os={key:"pinch",engine:class extends Vi{constructor(...e){super(...e),Ai(this,"ingKey","pinching"),Ai(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:t,lastOffset:n}=this.state;this.state.offset="wheel"===e?ki.add(t,n):[(1+t[0])*n[0],t[1]+n[1]]}computeMovement(){const{offset:e,lastOffset:t}=this.state;this.state.movement=[e[0]/t[0],e[1]-t[1]]}axisIntent(){const e=this.state,[t,n]=e._movement;if(!e.axis){const r=30*Math.abs(t)-Math.abs(n);r<0?e.axis="angle":r>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&("scale"===this.state.axis?e[1]=0:"angle"===this.state.axis&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout((()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()}),0)}touchStart(e){this.ctrl.setEventIds(e);const t=this.state,n=this.ctrl.touchIds;if(t._active&&t._touchIds.every((e=>n.has(e))))return;if(n.size<2)return;this.start(e),t._touchIds=Array.from(n).slice(0,2);const r=Ri(e,t._touchIds);r&&this.pinchStart(e,r)}pointerStart(e){if(null!=e.buttons&&e.buttons%2!=1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const t=this.state,n=t._pointerEvents,r=this.ctrl.pointerIds;if(t._active&&Array.from(n.keys()).every((e=>r.has(e))))return;if(n.size<2&&n.set(e.pointerId,e),t._pointerEvents.size<2)return;this.start(e);const o=Fi(...Array.from(n.values()));o&&this.pinchStart(e,o)}pinchStart(e,t){this.state.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const t=Ri(e,this.state._touchIds);t&&this.pinchMove(e,t)}pointerMove(e){const t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),!this.state._active)return;const n=Fi(...Array.from(t.values()));n&&this.pinchMove(e,n)}pinchMove(e,t){const n=this.state,r=n._values[1],o=t.angle-r;let i=0;Math.abs(o)>270&&(i+=Math.sign(o)),this.computeValues([t.distance,t.angle-360*i]),n.origin=t.origin,n.turns=i,n._movement=[n._values[0]/n._initial[0]-1,n._values[1]-n._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some((e=>!this.ctrl.touchIds.has(e)))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(e){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];const n=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=ki.sub(t._movement,n),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const t=this.config.modifierKey;t&&!(Array.isArray(t)?t.find((t=>e[t])):e[t])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const t=this.state;t._delta=[-Li(e)[1]/100*t.offset[0],0],ki.addTo(t._movement,t._delta),Qi(t),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}},resolver:Ji},is={key:"wheel",engine:class extends Wi{constructor(...e){super(...e),Ai(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const t=this.state;t._delta=Li(e),ki.addTo(t._movement,t._delta),Qi(t),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}},resolver:es};const ss={target(e){if(e)return()=>"current"in e?e.current:e},enabled:(e=!0)=>e,window:(e=(Xi.isBrowser?window:void 0))=>e,eventOptions:({passive:e=!0,capture:t=!1}={})=>({passive:e,capture:t}),transform:e=>e},as=["target","eventOptions","window","enabled","transform"];function cs(e={},t){const n={};for(const[r,o]of Object.entries(t))switch(typeof o){case"function":n[r]=o.call(n,e[r],r,e);break;case"object":n[r]=cs(e[r],o);break;case"boolean":o&&(n[r]=e[r])}return n}class ls{constructor(e,t){Ai(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,n,r,o){const i=this._listeners,s=function(e,t=""){const n=Mi[e];return e+(n&&n[t]||t)}(t,n),a=Pi(Pi({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),o);e.addEventListener(s,r,a);const c=()=>{e.removeEventListener(s,r,a),i.delete(c)};return i.add(c),c}clean(){this._listeners.forEach((e=>e())),this._listeners.clear()}}class us{constructor(){Ai(this,"_timeouts",new Map)}add(e,t,n=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,n,...r))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach((e=>{window.clearTimeout(e)})),this._timeouts.clear()}}class ds{constructor(e){var t,n;Ai(this,"gestures",new Set),Ai(this,"_targetEventStore",new ls(this)),Ai(this,"gestureEventStores",{}),Ai(this,"gestureTimeoutStores",{}),Ai(this,"handlers",{}),Ai(this,"config",{}),Ai(this,"pointerIds",new Set),Ai(this,"touchIds",new Set),Ai(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),t=this,(n=e).drag&&hs(t,"drag"),n.wheel&&hs(t,"wheel"),n.scroll&&hs(t,"scroll"),n.move&&hs(t,"move"),n.pinch&&hs(t,"pinch"),n.hover&&hs(t,"hover")}setEventIds(e){return zi(e)?(this.touchIds=new Set(function(e){return function(e){return Array.from(e.touches).filter((t=>{var n,r;return t.target===e.currentTarget||(null===(n=e.currentTarget)||void 0===n||null===(r=n.contains)||void 0===r?void 0:r.call(n,t.target))}))}(e).map((e=>e.identifier))}(e)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=function(e,t,n={}){const r=e,{target:o,eventOptions:i,window:s,enabled:a,transform:c}=r,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(r,as);if(n.shared=cs({target:o,eventOptions:i,window:s,enabled:a,transform:c},ss),t){const e=ns.get(t);n[t]=cs(Pi({shared:n.shared},l),e)}else for(const e in l){const t=ns.get(e);t&&(n[e]=cs(Pi({shared:n.shared},l[e]),t))}return n}(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,n={};let r;if(!t.target||(r=t.target(),r)){if(t.enabled){for(const t of this.gestures){const o=this.config[t],i=ps(n,o.eventOptions,!!r);o.enabled&&new(ts.get(t))(this,e,t).bind(i)}const o=ps(n,t.eventOptions,!!r);for(const t in this.nativeHandlers)o(t,"",(n=>this.nativeHandlers[t](Pi(Pi({},this.state.shared),{},{event:n,args:e}))),void 0,!0)}for(const e in n)n[e]=$i(...n[e]);if(!r)return n;for(const e in n){const{device:t,capture:o,passive:i}=Oi(e);this._targetEventStore.add(r,t,"",n[e],{capture:o,passive:i})}}}}function hs(e,t){e.gestures.add(t),e.gestureEventStores[t]=new ls(e,t),e.gestureTimeoutStores[t]=new us}const ps=(e,t,n)=>(r,o,i,s={},a=!1)=>{var c,l;const u=null!==(c=s.capture)&&void 0!==c?c:t.capture,d=null!==(l=s.passive)&&void 0!==l?l:t.passive;let h=a?r:function(e,t="",n=!1){const r=Mi[e],o=r&&r[t]||t;return"on"+Ti(e)+Ti(o)+(function(e=!1,t){return e&&!ji.includes(t)}(n,o)?"Capture":"")}(r,o,u);n&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(i)},fs=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function gs(e,t,n,r,o,i){if(!e.has(n))return;if(!ts.has(r))return;const s=n+"Start",a=n+"End";o[r]=e=>{let r;return e.first&&s in t&&t[s](e),n in t&&(r=t[n](e)),e.last&&a in t&&t[a](e),r},i[r]=i[r]||{}}const ms=10,_s=/Mac|iPod|iPhone|iPad/.test("undefined"==typeof window?"node":window.navigator.platform);function ys(e){let{deltaY:t,deltaX:n}=e,r=0;if(e.ctrlKey||e.altKey||e.metaKey){const n=Math.sign(e.deltaY);let o=t;Math.abs(e.deltaY)>ms&&(o=ms*n),r=o/100}else e.shiftKey&&!_s&&(n=t,t=0);return{x:-n,y:-t,z:-r}}const ws=([is,os].forEach(rs),function(t,n){const{handlers:r,nativeHandlers:o,config:i}=function(e,t){const[n,r,o]=function(e){const t={},n={},r=new Set;for(let o in e)fs.test(o)?(r.add(RegExp.lastMatch),n[o]=e[o]):t[o]=e[o];return[n,t,r]}(e),i={};return gs(o,n,"onDrag","drag",i,t),gs(o,n,"onWheel","wheel",i,t),gs(o,n,"onScroll","scroll",i,t),gs(o,n,"onPinch","pinch",i,t),gs(o,n,"onMove","move",i,t),gs(o,n,"onHover","hover",i,t),{handlers:i,config:t,nativeHandlers:r}}(t,n||{});return function(t,n={},r,o){const i=e.useMemo((()=>new ds(t)),[]);if(i.applyHandlers(t,o),i.applyConfig(n,r),e.useEffect(i.effect.bind(i)),e.useEffect((()=>i.clean.bind(i)),[]),void 0===n.target)return i.bind.bind(i)}(r,i,void 0,o)});let vs;const bs=e=>void 0===vs?(vs=e,!1):e-vs>120&&e-vs<160?(vs=e,!0):(vs=e,!1);function xs(e,t,n){const r=e.getShape(t);return{shape:r,handle:e.getShapeHandles(r).find((e=>e.id===n))}}var Ss=o(3096);class ks{constructor(e,t,n,r,o,i){this.a=e,this.b=t,this.c=n,this.d=r,this.e=o,this.f=i}a=1;b=0;c=0;d=1;e=0;f=0;equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(e){const t=e,{a:n,b:r,c:o,d:i,e:s,f:a}=this;return this.a=n*t.a+o*t.b,this.c=n*t.c+o*t.d,this.e=n*t.e+o*t.f+s,this.b=r*t.a+i*t.b,this.d=r*t.c+i*t.d,this.f=r*t.e+i*t.f+a,this}rotate(e,t,n){return 0===e?this:void 0===t?this.multiply(ks.Rotate(e)):this.translate(t,n).multiply(ks.Rotate(e)).translate(-t,-n)}translate(e,t){return this.multiply(ks.Translate(e,t))}scale(e,t){return this.multiply(ks.Scale(e,t))}invert(){const{a:e,b:t,c:n,d:r,e:o,f:i}=this,s=e*r-t*n;return this.a=r/s,this.b=t/-s,this.c=n/-s,this.d=e/s,this.e=(r*o-n*i)/-s,this.f=(t*o-e*i)/s,this}applyToPoint(e){return ks.applyToPoint(this,e)}applyToPoints(e){return ks.applyToPoints(this,e)}rotation(){return ks.Rotation(this)}point(){return ks.Point(this)}decomposed(){return ks.Decompose(this)}toCssString(){return ks.toCssString(this)}setTo(e){return Object.assign(this,e),this}decompose(){return ks.Decompose(this)}clone(){return new ks(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new ks(1,0,0,1,0,0)}static Translate(e,t){return new ks(1,0,0,1,e,t)}static Rotate(e,t,n){if(0===e)return ks.Identity();const r=Math.cos(e),o=Math.sin(e),i=new ks(r,o,-o,r,0,0);return void 0===t?i:ks.Compose(ks.Translate(t,n),i,ks.Translate(-t,-n))}static Scale=(e,t,n,r)=>{const o=new ks(e,0,0,0,t,0);return void 0===n?o:ks.Compose(ks.Translate(n,r),o,ks.Translate(-n,-r))};static Multiply(e,t){return{a:e.a*t.a+e.c*t.b,c:e.a*t.c+e.c*t.d,e:e.a*t.e+e.c*t.f+e.e,b:e.b*t.a+e.d*t.b,d:e.b*t.c+e.d*t.d,f:e.b*t.e+e.d*t.f+e.f}}static Inverse(e){const t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/-t,f:(e.b*e.e-e.a*e.f)/t}}static Absolute(e){const t=e.a*e.d-e.b*e.c;return{a:e.d/t,b:e.b/-t,c:e.c/-t,d:e.a/t,e:(e.d*e.e-e.c*e.f)/t,f:(e.b*e.e-e.a*e.f)/-t}}static Compose(...e){const t=ks.Identity();for(let n=0,r=e.length;n<r;n++)t.multiply(e[n]);return t}static Point(e){return new ho(e.e,e.f)}static Rotation(e){let t;if(0!==e.a||0!==e.c){const n=Math.hypot(e.a,e.c);t=Math.acos(e.a/n)*(e.c>0?-1:1)}else if(0!==e.b||0!==e.d){const n=Math.hypot(e.b,e.d);t=yo+Math.acos(e.b/n)*(e.d>0?-1:1)}else t=0;return Mo(t)}static Decompose(e){let t,n,r;if(0!==e.a||0!==e.c){const o=Math.hypot(e.a,e.c);t=o,n=(e.a*e.d-e.b*e.c)/o,r=Math.acos(e.a/o)*(e.c>0?-1:1)}else if(0!==e.b||0!==e.d){const o=Math.hypot(e.b,e.d);t=(e.a*e.d-e.b*e.c)/o,n=o,r=yo+Math.acos(e.b/o)*(e.d>0?-1:1)}else t=0,n=0,r=0;return{x:e.e,y:e.f,scaleX:t,scaleY:n,rotation:Mo(r)}}static Smooth(e,t=1e10){return e.a=Math.round(e.a*t)/t,e.b=Math.round(e.b*t)/t,e.c=Math.round(e.c*t)/t,e.d=Math.round(e.d*t)/t,e.e=Math.round(e.e*t)/t,e.f=Math.round(e.f*t)/t,e}static toCssString(e){return`matrix(${No(e.a)}, ${No(e.b)}, ${No(e.c)}, ${No(e.d)}, ${No(e.e)}, ${No(e.f)})`}static applyToPoint(e,t){return new ho(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)}static applyToXY(e,t,n){return[e.a*t+e.c*n+e.e,e.b*t+e.d*n+e.f]}static applyToPoints(e,t){return t.map((t=>new ho(e.a*t.x+e.c*t.y+e.e,e.b*t.x+e.d*t.y+e.f,t.z)))}static applyToBounds(e,t){return new fo(e.e+t.minX,e.f+t.minY,t.width,t.height)}static From(e){return new ks(e.a,e.b,e.c,e.d,e.e,e.f)}static Cast(e){return e instanceof ks?e:ks.From(e)}}const Cs=se((function({showStroke:t=!0,showVertices:n=!0,showClosestPointOnOutline:r=!0}){const o=Yr();!function(t=!0){const[n,r]=(0,e.useState)(0),o=Yr();(0,e.useEffect)((()=>{if(!t)return;const e=()=>r((e=>e+1));return o.on("tick",e),()=>{o.off("tick",e)}}),[o,t])}(r);const i=o.getZoomLevel(),s=o.getRenderingShapes(),{inputs:{currentPagePoint:a}}=o;return(0,Fr.jsx)("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:s.map((e=>{const s=o.getShape(e.id);if("group"===s.type)return null;const c=o.getShapeGeometry(s),l=o.getShapePageTransform(s),u=o.getPointInShapeSpace(s,a),d=c.nearestPoint(u),h=c.distanceToPoint(u,!0),p=Math.abs(h)*i,f=h<0,{vertices:g}=c;return(0,Fr.jsxs)("g",{transform:l.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[t&&(0,Fr.jsx)("path",{stroke:"red",strokeWidth:"2",fill:"none",opacity:"1",d:c.toSimpleSvgPath()}),n&&g.map(((e,t)=>(0,Fr.jsx)("circle",{cx:e.x,cy:e.y,r:"2",fill:`hsl(${Ae(t,[0,g.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:"1"},`v${t}`))),r&&p<150&&(0,Fr.jsx)("line",{x1:d.x,y1:d.y,x2:u.x,y2:u.y,opacity:1-p/150,stroke:f?"goldenrod":"dodgerblue",strokeWidth:"2"})]},e.id+"_outline")}))})}));var Es=o(7644);function As(e){return Es(e)}function Is(t){const n=Yr(),r=(0,e.useMemo)((()=>n.store.query.records("instance_presence",(()=>({userId:{eq:t}})))),[n,t]);return le(`latestPresence:${t}`,(()=>r.get().slice().sort(((e,t)=>t.lastActivityTimestamp-e.lastActivityTimestamp))[0]),[])??null}const Ps=se((function(){const t=function(){const t=Yr(),n=(0,e.useMemo)((()=>t.store.query.records("instance_presence",(()=>({userId:{neq:t.user.getId()}})))),[t]);return le(ae("userIds",(()=>As(n.get().map((e=>e.userId))).sort()),{isEqual:(e,t)=>e.join(",")===t.join?.(",")},[n]))}();return(0,Fr.jsx)(Fr.Fragment,{children:t.map((e=>(0,Fr.jsx)(Ms,{collaboratorId:e},e)))})})),Ms=se((function({collaboratorId:t}){const n=Yr(),r=Is(t),o=function(t){const n=(0,e.useRef)(t?.lastActivityTimestamp??-1),[r,o]=(0,e.useState)((()=>js(Date.now()-n.current)));return(0,e.useEffect)((()=>{const e=setInterval((()=>{o(js(Date.now()-n.current))}),1200);return()=>clearInterval(e)}),[]),t&&(n.current=t.lastActivityTimestamp),r}(r);if(!r||r.currentPageId!==n.getCurrentPageId())return null;switch(o){case"inactive":{const{followingUserId:e,highlightedUserIds:t}=n.getInstanceState();if(e!==r.userId&&!t.includes(r.userId))return null;break}case"idle":{const{highlightedUserIds:e}=n.getInstanceState();if(r.followingUserId===n.user.getId()&&!r.chatMessage&&!e.includes(r.userId))return null;break}}return(0,Fr.jsx)(Ts,{latestPresence:r})})),Ts=se((function({latestPresence:e}){const t=Yr(),{CollaboratorBrush:n,CollaboratorScribble:r,CollaboratorCursor:o,CollaboratorHint:i,CollaboratorShapeIndicator:s}=xi(),a=t.getZoomLevel(),c=t.getViewportPageBounds(),{userId:l,chatMessage:u,brush:d,scribbles:h,selectedShapeIds:p,userName:f,cursor:g,color:m}=e,_=!(g.x<c.minX-12/a||g.y<c.minY-16/a||g.x>c.maxX-12/a||g.y>c.maxY-16/a);return(0,Fr.jsxs)(Fr.Fragment,{children:[d&&n?(0,Fr.jsx)(n,{className:"tl-collaborator__brush",brush:d,color:m,opacity:.1},l+"_brush"):null,_&&o?(0,Fr.jsx)(o,{className:"tl-collaborator__cursor",point:g,color:m,zoom:a,name:"New User"!==f?f:null,chatMessage:u},l+"_cursor"):i?(0,Fr.jsx)(i,{className:"tl-collaborator__cursor-hint",point:g,color:m,zoom:a,viewport:c},l+"_cursor_hint"):null,r&&h.length?(0,Fr.jsx)(Fr.Fragment,{children:h.map((e=>(0,Fr.jsx)(r,{className:"tl-collaborator__scribble",scribble:e,color:m,zoom:a,opacity:"laser"===e.color?.5:.1},l+"_scribble_"+e.id)))}):null,s&&p.map((e=>(0,Fr.jsx)(s,{className:"tl-collaborator__shape-indicator",id:e,color:m,opacity:.5},l+"_"+e)))]})}));function js(e){return e>6e4?"inactive":e>3e3?"idle":"active"}function Ds(e,t){return 0===t?e:Ds(t,e%t)}function Os(e){const t=e.toString().split(".")[1];if(!t)return 1;const n=Math.pow(10,t.length);return n/Ds(parseInt(t,10),n)}const zs=se((function({id:t,shape:n,util:r,index:o,backgroundIndex:i,opacity:s,isCulled:a}){const c=Yr(),{ShapeErrorFallback:l}=xi(),u=e.useRef(null),d=e.useRef(null),h=e.useCallback(((e,t)=>{u.current?.style.setProperty(e,t),d.current?.style.setProperty(e,t)}),[]);ce("set shape container transform position",(()=>{if(!c.getShape(t))return;const e=c.getShapePageTransform(t),n=ks.toCssString(e);h("transform",n)}),[c,h]),ce("set shape container clip path",(()=>{if(!c.getShape(t))return null;const e=c.getShapeClipPath(t);h("clip-path",e??"none")}),[c,h]),ce("set shape height and width",(()=>{const e=c.getShape(t);if(!e)return null;const n=c.getShapeGeometry(e).bounds,r=Os(Math.floor(100*c.getInstanceState().devicePixelRatio)/100),o=n.w%r,i=0===o?n.w:n.w+(r-o),s=n.h%r,a=0===s?n.h:n.h+(r-s);h("width",Math.max(i,r)+"px"),h("height",Math.max(a,r)+"px")}),[c]),e.useLayoutEffect((()=>{h("opacity",s+""),u.current?.style.setProperty("z-index",o+""),d.current?.style.setProperty("z-index",i+"")}),[s,o,i,h]);const p=e.useCallback((e=>{c.annotateError(e,{origin:"react.shape",willCrashApp:!1})}),[c]);return n?(0,Fr.jsxs)(Fr.Fragment,{children:[r.backgroundComponent&&(0,Fr.jsx)("div",{ref:d,className:"tl-shape tl-shape-background","data-shape-type":n.type,draggable:!1,children:!a&&(0,Fr.jsx)(ro,{fallback:l,onError:p,children:(0,Fr.jsx)(Rs,{shape:n,util:r})})}),(0,Fr.jsx)("div",{ref:u,className:"tl-shape","data-shape-type":n.type,draggable:!1,children:a?(0,Fr.jsx)(Ls,{shape:n}):(0,Fr.jsx)(ro,{fallback:l,onError:p,children:(0,Fr.jsx)(Fs,{shape:n,util:r})})})]}):null})),Fs=e.memo((function({shape:e,util:t}){return ne("InnerShape:"+e.type,(()=>t.component(e)))}),((e,t)=>e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta)),Rs=e.memo((function({shape:e,util:t}){return ne("InnerShape:"+e.type,(()=>t.backgroundComponent?.(e)))}),((e,t)=>e.shape.props===t.shape.props&&e.shape.meta===t.shape.meta)),Ls=e.memo((function({shape:e}){const t=Yr().getShapeGeometry(e).bounds;return(0,Fr.jsx)("div",{className:"tl-shape__culled",style:{transform:`translate(${No(t.minX)}px, ${No(t.minY)}px)`,width:Math.max(1,No(t.width)),height:Math.max(1,No(t.height))}})}),(()=>!0));function Ns({className:t}){const n=Yr(),{Background:r,SvgDefs:o}=xi(),i=e.useRef(null),s=e.useRef(null),a=e.useRef(null);!function(){const t=Yr();(0,e.useLayoutEffect)((()=>{const e=Ss((()=>{t.updateViewportScreenBounds()}),200,{trailing:!0});t.updateViewportScreenBounds();const n=setInterval(e,1e3);return window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{clearInterval(n),window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}}),[t])}(),function(){const t=Yr(),n=Qr(),r=le("isFocused",(()=>t.getInstanceState().isFocused),[t]);(0,e.useEffect)((()=>{if(void 0===typeof matchMedia)return;let e=null;const n=()=>{null!=e&&e();const r=`(resolution: ${window.devicePixelRatio}dppx)`,o=matchMedia(r),i=e=>{"change"===e.type&&n()};o.addEventListener?o.addEventListener("change",n):o.addListener&&o.addListener(i),e=()=>{o.removeEventListener?o.removeEventListener("change",n):o.removeListener&&o.removeListener(i)},t.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return n(),()=>{e?.()}}),[t]),(0,e.useEffect)((()=>{if(!r)return;const e=e=>{if(!e.altKey||!t.isIn("zoom")&&t.getPath().endsWith(".idle")||eo()||Vr(e),e.isKilled)return;switch(e.isKilled=!0,e.key){case"=":case"-":case"0":if(e.metaKey||e.ctrlKey)return void Vr(e);break;case"Tab":default:if(eo()||t.getIsMenuOpen())return;break;case",":if(!eo()&&(Vr(e),!t.inputs.keys.has("Comma"))){const{x:n,y:r,z:o}=t.inputs.currentScreenPoint;t.inputs.keys.add("Comma");const i={type:"pointer",name:"pointer_down",point:{x:n,y:r,z:o},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};return void t.dispatch(i)}break;case"Escape":if((t.getEditingShape()||t.getSelectedShapeIds().length>0)&&e.preventDefault(),t.getOpenMenus().length>0)return;return void(t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),n.focus()))}const r={type:"keyboard",name:e.repeat?"key_repeat":"key_down",key:e.key,code:e.code,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey};t.dispatch(r)},o=e=>{if(e.isKilled)return;if(e.isKilled=!0,eo()||t.getIsMenuOpen())return;if(","===e.key&&(document.activeElement?.ELEMENT_NODE&&Vr(e),t.inputs.keys.has(e.code))){const{x:n,y:r,z:o}=t.inputs.currentScreenPoint;t.inputs.keys.delete(e.code);const i={type:"pointer",name:"pointer_up",point:{x:n,y:r,z:o},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};return void t.dispatch(i)}const n={type:"keyboard",name:"key_up",key:e.key,code:e.code,shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey};t.dispatch(n)};function i(e){if(n.contains(e.target)){const n=e.touches[0].pageX,r=e.touches[0].radiusX||0;(n-r<10||n+r>t.getViewportScreenBounds().width-10)&&("BUTTON"===e.target?.tagName&&e.target?.click(),Vr(e))}}const s=e=>{n.contains(e.target)&&(e.ctrlKey||e.metaKey)&&Vr(e)};return n.addEventListener("touchstart",i,{passive:!1}),n.addEventListener("wheel",s,{passive:!1}),document.addEventListener("gesturestart",Vr),document.addEventListener("gesturechange",Vr),document.addEventListener("gestureend",Vr),n.addEventListener("keydown",e),n.addEventListener("keyup",o),()=>{n.removeEventListener("touchstart",i),n.removeEventListener("wheel",s),document.removeEventListener("gesturestart",Vr),document.removeEventListener("gesturechange",Vr),document.removeEventListener("gestureend",Vr),n.removeEventListener("keydown",e),n.removeEventListener("keyup",o)}}),[t,n,r])}(),function(){const t=Yr();(0,e.useEffect)((()=>{if(!t.environment.isFirefox||t.environment.isAndroid||t.environment.isIos){if(window.matchMedia){const e=window.matchMedia("(pointer: coarse)"),n=()=>{t.updateInstanceState({isCoarsePointer:!!e.matches})};if(n(),e)return e.addEventListener("change",n),()=>e.removeEventListener("change",n)}}else t.updateInstanceState({isCoarsePointer:!1})}),[t])}(),function(t){const n=Yr(),r=e.useMemo((()=>{let e="not sure",r=1,o=1,i=1,s=0;const a=new ho,c=new ho;return{onWheel:({event:t})=>{if(!n.getInstanceState().isFocused)return;if(e="not sure",bs(Date.now()))return;const r=n.getEditingShapeId();if(r){const e=n.getShape(r);if(e&&n.getShapeUtil(e).canScroll(e)){const e=n.getShapePageBounds(r);if(e?.containsPoint(n.inputs.currentPagePoint))return}}Vr(t);const o=ys(t);if(0===o.x&&0===o.y)return;const i=n.getContainer().getBoundingClientRect(),s={type:"wheel",name:"wheel",delta:o,point:new ho(t.clientX,t.clientY).sub({x:i.left,y:i.top}),shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};n.dispatch(s)},onPinchStart:i=>{const s=t.current;e="not sure";const{event:l,origin:u,da:d}=i;l instanceof WheelEvent||(l.target===s||s?.contains(l.target))&&(c.x=u[0],c.y=u[1],a.x=u[0],a.y=u[1],r=d[0],o=n.getZoomLevel(),n.dispatch({type:"pinch",name:"pinch_start",point:{x:u[0],y:u[1],z:n.getZoomLevel()},delta:{x:0,y:0},shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey}))},onPinchEnd:r=>{const o=t.current,{event:i,origin:s,offset:a}=r;if(i instanceof WheelEvent)return;if(i.target!==o&&!o?.contains(i.target))return;const c=a[0];e="not sure",requestAnimationFrame((()=>{n.dispatch({type:"pinch",name:"pinch_end",point:{x:s[0],y:s[1],z:c},delta:{x:s[0],y:s[1]},shiftKey:i.shiftKey,altKey:i.altKey,ctrlKey:i.metaKey||i.ctrlKey})}))},onPinch:l=>{const u=t.current,{event:d,origin:h,offset:p,da:f}=l;if(d instanceof WheelEvent)return;if(d.target!==u&&!u?.contains(d.target))return;const g="gesturechange"===l.type||"gestureend"===l.type;s=f[0];const m=h[0]-c.x,_=h[1]-c.y;switch(c.x=h[0],c.y=h[1],(t=>{if(t&&(e="zooming"),"zooming"===e)return;const n=Math.abs(s-r),o=ho.Dist(a,c);switch(e){case"not sure":n>24?e="zooming":o>16&&(e="panning");break;case"panning":n>64&&(e="zooming")}})(g),e){case"zooming":i=p[0],n.dispatch({type:"pinch",name:"pinch",point:{x:h[0],y:h[1],z:i},delta:{x:m,y:_},shiftKey:d.shiftKey,altKey:d.altKey,ctrlKey:d.metaKey||d.ctrlKey});break;case"panning":n.dispatch({type:"pinch",name:"pinch",point:{x:h[0],y:h[1],z:o},delta:{x:m,y:_},shiftKey:d.shiftKey,altKey:d.altKey,ctrlKey:d.metaKey||d.ctrlKey})}}}}),[n,t]);ws(r,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[n.getZoomLevel(),0],scaleBounds:()=>({from:n.getZoomLevel(),max:8,min:.05})}})}(i),function(t){const n=Yr();(0,e.useEffect)((()=>{const e=t.current;if(!e)return;const r=e=>{if(e instanceof PointerEvent&&"pen"===e.pointerType){e.isKilled=!0;const{target:t}=e;if(Si.includes(t.tagName?.toLocaleLowerCase())||n.isIn("select.editing_shape"))return;Vr(e)}};return e.addEventListener("touchstart",r),e.addEventListener("touchend",r),()=>{e.removeEventListener("touchstart",r),e.addEventListener("touchend",r)}}),[n,t])}(i),ce("position layers",(()=>{const e=s.current;if(!e)return;const t=a.current;if(!t)return;const{x:r,y:o,z:i}=n.getCamera(),c=i>=1?Ae(i,[1,8],[.125,.5],!0):Ae(i,[.1,1],[-2,.125],!0),l=`scale(${No(i)}) translate(${No(r+c)}px,${No(o+c)}px)`;e.style.setProperty("transform",l),t.style.setProperty("transform",l)}),[n]);const c=function(){const t=Yr();return(0,e.useMemo)((function(){let e,n;return{onPointerDown:function(e){e.isKilled||(2!==e.button?0!==e.button&&1!==e.button&&5!==e.button||(Wr(e.currentTarget,e),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...Gr(e)}),t.getOpenMenus().length>0&&(t.updateInstanceState({openMenus:[]}),document.body.click(),t.getContainer().focus())):t.dispatch({type:"pointer",target:"canvas",name:"right_click",...Gr(e)}))},onPointerMove:function(r){r.isKilled||r.clientX===e&&r.clientY===n||(e=r.clientX,n=r.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...Gr(r)}))},onPointerUp:function(r){r.isKilled||0!==r.button&&1!==r.button&&2!==r.button&&5!==r.button||(e=r.clientX,n=r.clientY,Kr(r.currentTarget,r),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...Gr(r)}))},onPointerEnter:function(e){if(e.isKilled)return;if(t.getInstanceState().isPenMode&&"pen"!==e.pointerType)return;const n="mouse"===e.pointerType||"pen"===e.pointerType;t.updateInstanceState({isHoveringCanvas:!!n||null})},onPointerLeave:function(e){if(e.isKilled)return;if(t.getInstanceState().isPenMode&&"pen"!==e.pointerType)return;const n="mouse"===e.pointerType||"pen"===e.pointerType;t.updateInstanceState({isHoveringCanvas:!n&&null})},onDragOver:function(e){Vr(e)},onDrop:async function(e){if(Vr(e),!e.dataTransfer?.files?.length)return;const n=Array.from(e.dataTransfer.files);await t.putExternalContent({type:"files",files:n,point:t.screenToPage({x:e.clientX,y:e.clientY}),ignoreParent:!1})},onTouchStart:function(e){e.isKilled=!0,document.body.click(),Vr(e)},onTouchEnd:function(e){e.isKilled=!0,"A"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&Vr(e)},onClick:function(e){Hr(e)}}}),[t])}(),l=le("shapeSvgDefs",(()=>{const e=new Map;for(const t of je(n.shapeUtils)){if(!t)return;const n=t.getCanvasSvgDefs();for(const{key:t,component:r}of n)e.has(t)||e.set(t,(0,Fr.jsx)(r,{},t))}return[...e.values()]}),[n]),u=le("debug_shapes",(()=>Nr.hideShapes.get()),[Nr]),d=le("debug_svg",(()=>Nr.debugSvg.get()),[Nr]),h=le("debug_geometry",(()=>Nr.debugGeometry.get()),[Nr]);return(0,Fr.jsxs)("div",{ref:i,draggable:!1,className:Rr("tl-canvas",t),"data-testid":"canvas",...c,children:[r&&(0,Fr.jsx)(r,{}),(0,Fr.jsx)(Bs,{}),(0,Fr.jsx)(oa,{}),(0,Fr.jsx)("svg",{className:"tl-svg-context",children:(0,Fr.jsxs)("defs",{children:[l,Js&&(0,Fr.jsx)(Js,{}),(0,Fr.jsx)(ea,{}),(0,Fr.jsx)(ta,{}),(0,Fr.jsx)(na,{}),o&&(0,Fr.jsx)(o,{})]})}),(0,Fr.jsxs)("div",{ref:s,className:"tl-html-layer tl-shapes",draggable:!1,children:[(0,Fr.jsx)(aa,{}),(0,Fr.jsx)(sa,{}),u?null:d?(0,Fr.jsx)(qs,{}):(0,Fr.jsx)(Ys,{})]}),(0,Fr.jsxs)("div",{className:"tl-fixed-layer tl-overlays",children:[(0,Fr.jsxs)("div",{ref:a,className:"tl-html-layer",children:[h?(0,Fr.jsx)(Cs,{}):null,(0,Fr.jsx)(Hs,{}),(0,Fr.jsx)(Us,{}),(0,Fr.jsx)($s,{}),(0,Fr.jsx)(Vs,{}),(0,Fr.jsx)(Xs,{}),(0,Fr.jsx)(Zs,{}),(0,Fr.jsx)(Qs,{}),(0,Fr.jsx)(Ws,{}),(0,Fr.jsx)(ia,{}),(0,Fr.jsx)(Ps,{})]}),(0,Fr.jsx)(ca,{})]})]})}function Bs(){const e=Yr(),t=le("gridSize",(()=>e.getDocumentSettings().gridSize),[e]),{x:n,y:r,z:o}=le("camera",(()=>e.getCamera()),[e]),i=le("isGridMode",(()=>e.getInstanceState().isGridMode),[e]),{Grid:s}=xi();return s&&i?(0,Fr.jsx)(s,{x:n,y:r,z:o,size:t}):null}function $s(){const e=Yr(),t=le("scribbles",(()=>e.getInstanceState().scribbles),[e]),n=le("zoomLevel",(()=>e.getZoomLevel()),[e]),{Scribble:r}=xi();return r&&t.length?(0,Fr.jsx)(Fr.Fragment,{children:t.map((e=>(0,Fr.jsx)(r,{className:"tl-user-scribble",scribble:e,zoom:n},e.id)))}):null}function Us(){const e=Yr(),t=le("brush",(()=>e.getInstanceState().brush),[e]),{Brush:n}=xi();return n&&t?(0,Fr.jsx)(n,{className:"tl-user-brush",brush:t}):null}function Vs(){const e=Yr(),t=le("zoomBrush",(()=>e.getInstanceState().zoomBrush),[e]),{ZoomBrush:n}=xi();return n&&t?(0,Fr.jsx)(n,{className:"tl-user-brush tl-zoom-brush",brush:t}):null}function Ws(){const e=Yr(),t=le("snapLines",(()=>e.snaps.getLines()),[e]),n=le("zoomLevel",(()=>e.getZoomLevel()),[e]),{SnapLine:r}=xi();return r&&t.length>0?(0,Fr.jsx)(Fr.Fragment,{children:t.map((e=>(0,Fr.jsx)(r,{className:"tl-user-snapline",line:e,zoom:n},e.id)))}):null}const Ks=48;function Hs(){const e=Yr(),{Handles:t}=xi(),n=le("zoomLevel",(()=>e.getZoomLevel()),[e]),r=le("coarse pointer",(()=>e.getInstanceState().isCoarsePointer),[e]),o=le("onlySelectedShape",(()=>e.getOnlySelectedShape()),[e]),i=le("isChangingStyle",(()=>e.getInstanceState().isChangingStyle),[e]),s=le("isChangingStyle",(()=>e.getInstanceState().isReadonly),[e]),a=le("handles",(()=>{const t=e.getOnlySelectedShape();if(t)return e.getShapeHandles(t)}),[e]),c=le("transform",(()=>{const t=e.getOnlySelectedShape();if(t)return e.getShapePageTransform(t)}),[e]);if(!t||!o||i||s)return null;if(!a)return null;if(!c)return null;const l=[];for(let e=0,t=a[e];e<a.length;e++,t=a[e]){if("vertex"!==t.type){const t=a[e-1],r=a[e+1];if(t&&r&&Math.hypot(t.y-r.y,t.x-r.x)<Ks/n)continue}l.push(t)}return l.sort((e=>"vertex"===e.type?1:-1)),(0,Fr.jsx)(t,{children:(0,Fr.jsx)("g",{transform:ks.toCssString(c),children:l.map((e=>(0,Fr.jsx)(Gs,{shapeId:o.id,handle:e,zoom:n,isCoarse:r},e.id)))})})}function Gs({shapeId:t,handle:n,zoom:r,isCoarse:o}){const i=function(t,n){const r=Yr();return e.useMemo((()=>{let e,o;return{onPointerDown:e=>{if(e.isKilled)return;Wr(Ur(e.currentTarget),e);const{shape:o,handle:i}=xs(r,t,n);i&&r.dispatch({type:"pointer",target:"handle",handle:i,shape:o,name:"pointer_down",...Gr(e)})},onPointerMove:i=>{if(i.isKilled)return;if(i.clientX===e&&i.clientY===o)return;e=i.clientX,o=i.clientY;const{shape:s,handle:a}=xs(r,t,n);a&&r.dispatch({type:"pointer",target:"handle",handle:a,shape:s,name:"pointer_move",...Gr(i)})},onPointerUp:e=>{if(e.isKilled)return;Kr(Ur(e.currentTarget),e);const{shape:o,handle:i}=xs(r,t,n);i&&r.dispatch({type:"pointer",target:"handle",handle:i,shape:o,name:"pointer_up",...Gr(e)})}}}),[r,t,n])}(t,n.id),{Handle:s}=xi();return s?(0,Fr.jsx)("g",{"aria-label":"handle",transform:`translate(${n.x}, ${n.y})`,...i,children:(0,Fr.jsx)(s,{shapeId:t,handle:n,zoom:r,isCoarse:o})}):null}function qs(){const t=Yr(),n=le("rendering shapes",(()=>t.getRenderingShapes()),[t]);return(0,Fr.jsx)(Fr.Fragment,{children:n.map((t=>(0,Fr.jsxs)(e.Fragment,{children:[(0,Fr.jsx)(zs,{...t}),(0,Fr.jsx)(ra,{id:t.id})]},t.id+"_fragment")))})}function Ys(){const e=Yr(),t=le("rendering shapes",(()=>e.getRenderingShapes()),[e]);return(0,Fr.jsx)(Fr.Fragment,{children:t.map((e=>(0,Fr.jsx)(zs,{...e},e.id+"_shape")))})}function Xs(){const e=Yr(),t=le("selectedShapeIds",(()=>e.getCurrentPageState().selectedShapeIds),[e]);return le("should display selected ids",(()=>e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.getInstanceState().isChangingStyle),[e])?(0,Fr.jsx)(Fr.Fragment,{children:t.map((e=>(0,Fr.jsx)(ao,{className:"tl-user-indicator__selected",id:e},e+"_indicator")))}):null}const Zs=function(){const e=Yr(),{HoveredShapeIndicator:t}=xi(),n=le("coarse pointer",(()=>e.getInstanceState().isCoarsePointer),[e]),r=le("hovering canvas",(()=>e.getInstanceState().isHoveringCanvas),[e]),o=le("hovered id",(()=>e.getCurrentPageState().hoveredShapeId),[e]);return!n&&r&&o&&t?(0,Fr.jsx)(t,{shapeId:o}):null},Qs=se((function(){const e=de(Yr().getHintingShapeIds());return e.length?(0,Fr.jsx)(Fr.Fragment,{children:e.map((e=>(0,Fr.jsx)(ao,{className:"tl-user-indicator__hint",id:e},e+"_hinting")))}):null}));function Js(){return(0,Fr.jsxs)("g",{id:"cursor",children:[(0,Fr.jsxs)("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[(0,Fr.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,Fr.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,Fr.jsxs)("g",{fill:"white",transform:"translate(-12,-12)",children:[(0,Fr.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,Fr.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,Fr.jsxs)("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[(0,Fr.jsx)("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),(0,Fr.jsx)("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function ea(){return(0,Fr.jsx)("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function ta(){return(0,Fr.jsx)("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:(0,Fr.jsx)("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function na(){return(0,Fr.jsxs)("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[(0,Fr.jsx)("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),(0,Fr.jsx)("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const ra=se((function({id:t}){const n=Yr(),r=n.getShape(t),[o,i]=e.useState(""),s=r?.parentId===n.getCurrentPageId();return e.useEffect((()=>{if(!s)return;let e=null;const r=te("shape to svg",(async()=>{const r=Math.random();e=r;const o=n.getShapePageBounds(t),s=await n.getSvg([t],{padding:0});s&&o&&e===r&&(s.style.setProperty("overflow","visible"),s.setAttribute("preserveAspectRatio","xMidYMin slice"),s.style.setProperty("transform",`translate(${o.x}px, ${o.y+o.h+12}px)`),s.style.setProperty("border","1px solid black"),i(s?.outerHTML))}));return()=>{e=null,r()}}),[n,t,s]),s?(0,Fr.jsx)("div",{style:{paddingTop:12,position:"absolute"},children:(0,Fr.jsx)("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:o}})}):null}));function oa(){const e=le("debugging ui log",(()=>Nr.logMessages.get()),[Nr]);return e.length?(0,Fr.jsx)("div",{className:"debug__ui-logger",children:e.map(((e,t)=>{const n="string"==typeof e?e:JSON.stringify(e);return(0,Fr.jsx)("div",{className:"debug__ui-logger__line",children:n},t)}))}):null}function ia(){const e=Yr(),t=le("selection rotation",(()=>e.getSelectionRotation()),[e]),n=le("selection bounds",(()=>e.getSelectionRotatedPageBounds()),[e]),{SelectionForeground:r}=xi();return n&&r?(0,Fr.jsx)(r,{bounds:n,rotation:t}):null}function sa(){const e=Yr(),t=le("selection rotation",(()=>e.getSelectionRotation()),[e]),n=le("selection bounds",(()=>e.getSelectionRotatedPageBounds()),[e]),{SelectionBackground:r}=xi();return n&&r?(0,Fr.jsx)(r,{bounds:n,rotation:t}):null}function aa(){const{OnTheCanvas:e}=xi();return e?(0,Fr.jsx)(e,{}):null}function ca(){const{InFrontOfTheCanvas:e}=xi();return e?(0,Fr.jsx)(e,{}):null}let la=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");function ua(){return la()}const da="TLDRAW_USER_DATA_v3",ha=Mt({id:wt,name:wt.nullable().optional(),locale:wt.nullable().optional(),color:wt.nullable().optional(),isDarkMode:Et.nullable().optional(),animationSpeed:vt.nullable().optional(),isSnapMode:Et.nullable().optional()}),pa=ot({currentVersion:3,migrators:{1:{up:e=>({...e,animationSpeed:1}),down:({animationSpeed:e,...t})=>t},2:{up:e=>({...e,isSnapMode:!1}),down:({isSnapMode:e,...t})=>t},3:{up:e=>e,down:e=>({id:e.id,name:e.name??ga.name,locale:e.locale??ga.locale,color:e.color??ga.color,isDarkMode:e.isDarkMode??ga.isDarkMode,animationSpeed:e.animationSpeed??ga.animationSpeed,isSnapMode:e.isSnapMode??ga.isSnapMode})}}}),fa=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"],ga=Object.freeze({name:"New User",locale:function(e){for(const t of e){const e=zr(t);if(e)return e}return"en"}("undefined"!=typeof window?window.navigator.languages??["en"]:["en"]),color:fa[Math.floor(Math.random()*fa.length)],isDarkMode:!1,animationSpeed:"undefined"!=typeof window&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches?0:1,isSnapMode:!1});function ma(){return{id:ua()}}function _a(e){if(null===e||"object"!=typeof e)return ma();if(!("version"in e)||!("user"in e)||"number"!=typeof e.version)return ma();const t=at({value:e.user,fromVersion:e.version,toVersion:pa.currentVersion??0,migrations:pa});if("error"===t.type)return ma();try{ha.validate(t.value)}catch(e){return ma()}return t.value}const ya=K("globalUserData",_a("undefined"==typeof window?null:JSON.parse(window?.localStorage?.getItem(da)||"null")??null));function wa(e){ha.validate(e),ya.set(e),"undefined"!=typeof window&&window.localStorage&&window.localStorage.setItem(da,JSON.stringify({version:pa.currentVersion,user:ya.get()})),ba?.postMessage({type:Sa,origin:xa,data:{user:ya.get(),version:pa.currentVersion}})}const va="undefined"!=typeof process&&!1,ba="undefined"==typeof BroadcastChannel||va?null:new BroadcastChannel("tldraw-user-sync");ba?.addEventListener("message",(e=>{const t=e.data;t?.type===Sa&&t?.origin!==xa&&ya.set(_a(t.data))}));const xa=ua(),Sa="tldraw-user-preferences-change";function ka(e={}){return{derivePresenceState:e.derivePresenceState??(()=>J("presence",(()=>null))),userPreferences:e.userPreferences??J("userPreferences",(()=>ya.get())),setUserPreferences:e.setUserPreferences??wa}}var Ca=o(6729);function Ea({children:e,className:t="",...n}){return(0,Fr.jsx)("svg",{...n,className:`tl-svg-container ${t}`,children:e})}class Aa{isFilled=!1;isClosed=!0;isLabel=!1;isSnappable=!0;constructor(e){this.isFilled=e.isFilled,this.isClosed=e.isClosed,this.isSnappable=e.isSnappable??!1,this.isLabel=e.isLabel??!1}hitTestPoint(e,t=0,n=!1){return this.distanceToPoint(e,n)<=t}distanceToPoint(e,t=!1){const n=e.dist(this.nearestPoint(e));return this.isClosed&&(this.isFilled||t)&&Lo(e,this.vertices)?-n:n}distanceToLineSegment(e,t){const n=this.nearestPointOnLineSegment(e,t),r=ho.DistanceToLineSegment(e,t,n);return this.isClosed&&this.isFilled&&Lo(n,this.vertices)?-r:r}hitTestLineSegment(e,t,n=0){return this.distanceToLineSegment(e,t)<=n}nearestPointOnLineSegment(e,t){let n,r=1/0;for(let o=0;o<this.vertices.length;o++){const i=this.vertices[o],s=ho.DistanceToLineSegment(e,t,i);s<r&&(r=s,n=i)}if(!n)throw Error("nearest point not found");return n}isPointInBounds(e,t=0){const{bounds:n}=this;return!(e.x<n.minX-t||e.y<n.minY-t||e.x>n.maxX+t||e.y>n.maxY+t)}_vertices;get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return fo.FromPoints(this.vertices)}_bounds;get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}_snapPoints;get snapPoints(){return this._snapPoints||(this._snapPoints=this.bounds.snapPoints),this._snapPoints}get center(){return this.bounds.center}_area;get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:e}=this;let t=0;for(let n=0,r=e.length;n<r;n++){const o=e[n],i=e[(n+1)%r];t+=o.x*i.y-i.x*o.y}return t/2}toSimpleSvgPath(){let e="";const{vertices:t}=this,n=t.length;if(0===n)return e;e+=`M${t[0].x},${t[0].y}`;for(let r=1;r<n;r++)e+=`L${t[r].x},${t[r].y}`;return this.isClosed&&(e+="Z"),e}}class Ia extends Aa{children;constructor(e){super({...e,isClosed:!0,isFilled:!1});const{children:t}=e;if(0===t.length)throw Error("Group2d must have at least one child");this.children=t}getVertices(){return this.children.filter((e=>!e.isLabel)).flatMap((e=>e.vertices))}nearestPoint(e){let t,n=1/0;const{children:r}=this;if(0===r.length)throw Error("no children");for(const o of r){const r=o.nearestPoint(e),i=r.dist(e);i<n&&(n=i,t=r)}if(!t)throw Error("nearest point not found");return t}distanceToPoint(e,t=!1){return Math.min(...this.children.map(((n,r)=>n.distanceToPoint(e,t||r>0))))}hitTestPoint(e,t,n){return!!this.children.filter((e=>!e.isLabel)).find((r=>r.hitTestPoint(e,t,n)))}hitTestLineSegment(e,t,n){return!!this.children.filter((e=>!e.isLabel)).find((r=>r.hitTestLineSegment(e,t,n)))}getArea(){return this.children[0].area}toSimpleSvgPath(){let e="";for(const t of this.children)e+=t.toSimpleSvgPath();const t=fo.FromPoints(this.vertices).corners;for(let n=0,r=t.length;n<r;n++){const o=t[n],i=t[(n-1+r)%r],s=o.dist(i),a=t[(n+1)%r],c=o.dist(a),l=o.clone().lrp(i,4/s),u=o,d=o.clone().lrp(a,4/c);e+=`M${l.x},${l.y} L${u.x},${u.y} L${d.x},${d.y} `}return e}}function Pa(e,t,n,r){const o=e.x-n.x,i=e.y-n.y,s=r.x-n.x,a=r.y-n.y,c=t.x-e.x,l=t.y-e.y,u=s*i-a*o,d=c*i-l*o,h=a*c-s*l;if(0===u||0===d)return null;if(0===h)return null;if(0!==h){const t=u/h,n=d/h;if(0<=t&&t<=1&&0<=n&&n<=1)return ho.AddXY(e,t*c,t*l)}return null}function Ma(e,t,n,r){const o=(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y),i=2*((t.x-e.x)*(e.x-n.x)+(t.y-e.y)*(e.y-n.y)),s=i*i-4*o*(n.x*n.x+n.y*n.y+e.x*e.x+e.y*e.y-2*(n.x*e.x+n.y*e.y)-r*r);if(s<0)return null;if(0===s)return null;const a=Math.sqrt(s),c=(-i+a)/(2*o),l=(-i-a)/(2*o);if((c<0||c>1)&&(l<0||l>1))return null;const u=[];return 0<=c&&c<=1&&u.push(ho.Lrp(e,t,c)),0<=l&&l<=1&&u.push(ho.Lrp(e,t,l)),0===u.length?null:u}function Ta(e,t,n){const r=[];let o;for(let i=0,s=n.length-1;i<s;i++)o=Pa(e,t,n[i],n[i+1]),o&&r.push(o);return 0===r.length?null:r}function ja(e,t,n){const r=[];let o;for(let i=1,s=n.length;i<s+1;i++)o=Pa(e,t,n[i-1],n[i%n.length]),o&&r.push(o);return 0===r.length?null:r}function Da(e,t,n){const r=[];let o,i,s;for(let a=0,c=n.length;a<c;a++)o=n[a],i=n[(a+1)%n.length],s=Ma(o,i,e,t),s&&r.push(...s);return 0===r.length?null:r}function Oa(e,t,n){const r=[];let o,i,s;for(let a=1,c=n.length;a<c;a++)o=n[a-1],i=n[a],s=Ma(o,i,e,t),s&&r.push(...s);return 0===r.length?null:r}function za(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function Fa(e,t,n,r){return za(e,n,r)!==za(t,n,r)&&za(e,t,n)!==za(e,t,r)}function Ra(e,t){const n=[];let r,o,i,s;for(let o=0,i=e.length;o<i;o++)r=e[o],Lo(r,t)&&n.push(r);for(let o=0,i=t.length;o<i;o++)r=t[o],Lo(r,e)&&n.push(r);for(let a=0,c=e.length;a<c;a++){r=e[a],o=e[(a+1)%e.length];for(let e=0,a=t.length;e<a;e++){i=t[e],s=t[(e+1)%t.length];const a=Pa(r,o,i,s);null!==a&&n.push(a)}}return 0===n.length?null:function(e){const t=ho.Average(e);return e.sort(((e,n)=>ho.Angle(t,e)-ho.Angle(t,n)))}(n)}class La extends Aa{start;end;d;u;ul;constructor(e){super({...e,isClosed:!1,isFilled:!1});const{start:t,end:n}=e;this.start=t,this.end=n,this.d=t.clone().sub(n),this.u=this.d.clone().uni(),this.ul=this.u.len()}_length;get length(){return this._length?this._length:this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(e){const{start:t,end:n,u:r,ul:o}=this;if(0===o)return t;const i=ho.Sub(e,t).dpr(r)/o,s=t.x+r.x*i;if(s<Math.min(t.x,n.x))return t.x<n.x?t:n;if(s>Math.max(t.x,n.x))return t.x>n.x?t:n;const a=t.y+r.y*i;return a<Math.min(t.y,n.y)?t.y<n.y?t:n:a>Math.max(t.y,n.y)?t.y>n.y?t:n:new ho(s,a)}hitTestLineSegment(e,t,n){return Fa(e,t,this.start,this.end)}}class Na extends Aa{points;constructor(e){super({isClosed:!1,isFilled:!1,...e});const{points:t}=e;this.points=t}_segments;get segments(){if(!this._segments){this._segments=[];const{vertices:e}=this;for(let t=0,n=e.length-1;t<n;t++){const n=e[t],r=e[t+1];this._segments.push(new La({start:n,end:r}))}this.isClosed&&this._segments.push(new La({start:e[e.length-1],end:e[0]}))}return this._segments}_length;get length(){return this._length||(this._length=this.segments.reduce(((e,t)=>e+t.length),0)),this._length}getVertices(){return this.points}nearestPoint(e){const{segments:t}=this;let n,r,o=this.points[0],i=1/0;for(let s=0;s<t.length;s++)n=t[s].nearestPoint(e),r=n.dist(e),r<i&&(o=n,i=r);return o}hitTestLineSegment(e,t,n){return this.segments.some((r=>r.hitTestLineSegment(e,t,n)))}}class Ba extends Na{constructor(e){super({...e}),this.isClosed=!0}}class $a extends Ba{x;y;w;h;constructor(e){const{x:t=0,y:n=0,width:r,height:o}=e;super({...e,points:[new ho(t,n),new ho(t+r,n),new ho(t+r,n+o),new ho(t,n+o)]}),this.x=t,this.y=n,this.w=r,this.h=o}getBounds(){return new fo(this.x,this.y,this.w,this.h)}}class Ua{constructor(e){this.editor=e}static props;static migrations;static type;canSnap=()=>!0;canScroll=()=>!1;canUnmount=()=>!0;canBind=(e,t)=>!0;canEdit=()=>!1;canResize=()=>!0;canEditInReadOnly=()=>!1;canCrop=()=>!1;providesBackgroundForChildren(e){return!1}hideResizeHandles=()=>!1;hideRotateHandle=()=>!1;hideSelectionBoundsBg=()=>!1;hideSelectionBoundsFg=()=>!1;isAspectRatioLocked=()=>!1;getOutlineSegments(e){return[this.editor.getShapeGeometry(e).vertices]}canReceiveNewChildrenOfType(e,t){return!1}canDropShapes(e,t){return!1}expandSelectionOutlinePx(e){return 0}getCanvasSvgDefs(){return[]}onBeforeCreate;onBeforeUpdate;onDragShapesOver;onDragShapesOut;onDropShapesOver;onResizeStart;onResize;onResizeEnd;onTranslateStart;onTranslate;onTranslateEnd;onRotateStart;onRotate;onRotateEnd;onHandleChange;onBindingChange;onChildrenChange;onDoubleClickHandle;onDoubleClickEdge;onDoubleClick;onClick;onEditEnd}function Va({bounds:e,className:t}){const n=Yr(),r=le("zoom level",(()=>n.getZoomLevel()),[n]);return(0,Fr.jsx)("g",{className:t,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:e.sides.map(((e,t)=>{const{strokeDasharray:n,strokeDashoffset:o}=function(e,t,n={}){const{closed:r=!1,snap:o=1,start:i="outset",end:s="outset",lengthRatio:a=2,style:c="dashed"}=n;let l=0,u=0,d=1,h=0,p=0;switch(c){case"dashed":d=1,l=Math.min(t*a,e/4);break;case"dotted":d=100,l=t/d;break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||("outset"===i?(e+=l/2,p+=l/2):"skip"===i&&(e-=l,p-=l),"outset"===s?e+=l/2:"skip"===s&&(e-=l)),u=Math.floor(e/l/(2*d)),u-=u%o,u<3&&"dashed"===c?e/t<5?(l=e,u=1,h=0):(l=.333*e,h=.333*e):(u=Math.max(u,3),l=e/u/(2*d),r?(p=l/2,h=(e-u*l)/u):h=(e-u*l)/Math.max(1,u-1)),{strokeDasharray:[l,h].join(" "),strokeDashoffset:p.toString()}}(e[0].dist(e[1]),1/r,{style:"dashed",lengthRatio:4});return(0,Fr.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,strokeDasharray:n,strokeDashoffset:o},t)}))})}const Wa=[class extends Ua{static type="group";static props=mr;static migrations=_r;hideSelectionBoundsFg=()=>!0;canBind=()=>!1;getDefaultProps(){return{}}getGeometry(e){const t=this.editor.getSortedChildIdsForParent(e.id);return 0===t.length?new $a({width:1,height:1,isFilled:!1}):new Ia({children:t.map((e=>{const t=this.editor.getShape(e),n=this.editor.getShapeGeometry(e),r=this.editor.getShapeLocalTransform(t).applyToPoints(n.vertices);return n.isClosed?new Ba({points:r,isFilled:!0}):new Na({points:r})}))})}component(e){const t=this.editor.getErasingShapeIds().includes(e.id),{hintingShapeIds:n}=this.editor.getCurrentPageState(),r=n.length>0&&n.some((t=>t!==e.id&&this.editor.isShapeOfType(this.editor.getShape(t),"group"))),o=this.editor.getCurrentPageState().focusedGroupId!==e.id;if(!t&&(o||r))return null;const i=this.editor.getShapeGeometry(e).bounds;return(0,Fr.jsx)(Ea,{id:e.id,children:(0,Fr.jsx)(Va,{className:"tl-group",bounds:i})})}indicator(e){const t=this.editor.getShapeGeometry(e).bounds;return(0,Fr.jsx)(Va,{className:"",bounds:t})}onChildrenChange=e=>{const t=this.editor.getSortedChildIdsForParent(e.id);return 0===t.length?(this.editor.getCurrentPageState().focusedGroupId===e.id&&this.editor.popFocusedGroupId(),void this.editor.deleteShapes([e.id])):1===t.length?(this.editor.getCurrentPageState().focusedGroupId===e.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(t,e.parentId),void this.editor.deleteShapes([e.id])):void 0}}],Ka=new Set(Wa.map((e=>e.type)));function Ha(e){const t=[...Wa],n=new Set;for(const r of e){if(Ka.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(n.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);t.push(r),n.add(r.type)}return t}function Ga(e,t){if(!t)return!1;switch(e.type){case"mixed":return"mixed"===t.type;case"shared":return"shared"===t.type&&e.value===t.value;default:throw ge(e)}}class qa{map;constructor(e){this.map=new Map(e)}get(e){return this.map.get(e)}getAsKnownValue(e){const t=this.get(e);if(t&&"mixed"!==t.type)return t.value}get size(){return this.map.size}equals(e){if(this.size!==e.size)return!1;const t=new Set;for(const[n,r]of this){if(!Ga(r,e.get(n)))return!1;t.add(n)}for(const[n,r]of e)if(!t.has(n)&&!Ga(r,this.get(n)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class Ya extends qa{set(e,t){this.map.set(e,t)}applyValue(e,t){const n=this.get(e);if(n)switch(n.type){case"mixed":return;case"shared":return void(n.value!==t&&this.set(e,{type:"mixed"}));default:ge(n,"type")}else this.set(e,{type:"shared",value:t})}}class Xa{items=new WeakMap;get(e,t){return this.items.has(e)||this.items.set(e,t(e)),this.items.get(e)}access(e){return this.items.get(e)}set(e,t){this.items.set(e,t)}has(e){return this.items.has(e)}invalidate(e){this.items.delete(e)}bust(){this.items=new WeakMap}}const Za="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Qa="a0",Ja="A00000000000000000000000000";function ec(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-"a".charCodeAt(0)+2;if(e>="A"&&e<="Z")return"Z".charCodeAt(0)-e.charCodeAt(0)+2;throw new Error("Invalid index key head: "+e)}function tc(e){if(e.length!==ec(e.charAt(0)))throw new Error("invalid integer part of index key: "+e)}function nc(e){if(void 0===e)throw Error("n is undefined")}function rc(e){tc(e);const[t,...n]=e.split("");let r=!0;for(let e=n.length-1;r&&e>=0;e--){const t=Za.indexOf(n[e])+1;t===Za.length?n[e]="0":(n[e]=Za.charAt(t),r=!1)}if(r){if("Z"===t)return"a0";if("z"===t)return;const e=String.fromCharCode(t.charCodeAt(0)+1);return e>"a"?n.push("0"):n.pop(),e+n.join("")}return t+n.join("")}function oc(e,t){if(void 0!==t&&e>=t)throw new Error(e+" >= "+t);if("0"===e.slice(-1)||t&&"0"===t.slice(-1))throw new Error("trailing zero");if(t){let n=0;for(;(e.charAt(n)||"0")===t.charAt(n);)n++;if(n>0)return t.slice(0,n)+oc(e.slice(n),t.slice(n))}const n=e?Za.indexOf(e.charAt(0)):0,r=void 0!==t?Za.indexOf(t.charAt(0)):Za.length;if(r-n>1){const e=Math.round(.5*(n+r));return Za.charAt(e)}return t&&t.length>1?t.slice(0,1):Za.charAt(n)+oc(e.slice(1),void 0)}function ic(e){const t=ec(e.charAt(0));if(t>e.length)throw new Error("invalid index: "+e);return e.slice(0,t)}function sc(e){if(e===Ja)throw new Error("invalid index: "+e);const t=ic(e);if("0"===e.slice(t.length).slice(-1))throw new Error("invalid index: "+e)}function ac(e,t){if(void 0!==e&&sc(e),void 0!==t&&sc(t),void 0!==e&&void 0!==t&&e>=t)throw new Error(e+" >= "+t);if(void 0===e&&void 0===t)return Qa;if(void 0===e){if(void 0===t)throw Error("b is undefined");const e=ic(t),n=t.slice(e.length);if(e===Ja)return e+oc("",n);if(e<t)return e;const r=function(e){tc(e);const[t,...n]=e.split("");let r=!0;for(let e=n.length-1;r&&e>=0;e--){const t=Za.indexOf(n[e])-1;-1===t?n[e]=Za.slice(-1):(n[e]=Za.charAt(t),r=!1)}if(r){if("a"===t)return"Z"+Za.slice(-1);if("A"===t)return;const e=String.fromCharCode(t.charCodeAt(0)-1);return e<"Z"?n.push(Za.slice(-1)):n.pop(),e+n.join("")}return t+n.join("")}(e);return nc(r),r}if(void 0===t){const t=ic(e),n=e.slice(t.length),r=rc(t);return void 0===r?t+oc(n,void 0):r}const n=ic(e),r=e.slice(n.length),o=ic(t),i=t.slice(o.length);if(n===o)return n+oc(r,i);const s=rc(n);return nc(s),s<t?s:n+oc(r,void 0)}function cc(e,t,n){if(0===n)return[];if(1===n)return[ac(e,t)];if(void 0===t){let r=ac(e,t);const o=[r];for(let e=0;e<n-1;e++)r=ac(r,t),o.push(r);return o}if(void 0===e){let r=ac(e,t);const o=[r];for(let t=0;t<n-1;t++)r=ac(e,r),o.push(r);return o.reverse(),o}const r=Math.floor(n/2),o=ac(e,t);return[...cc(e,o,r),o,...cc(o,t,n-r-1)]}function lc(e,t,n){return cc(e,t,n)}function uc(e,t){return cc(e,void 0,t)}function dc(e,t){return cc(e,t,1)[0]}function hc(e){return cc(e,void 0,1)[0]}function pc(e,t="a1"){return[t,...cc(t,void 0,e)]}function fc(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function gc(e,t,n){if(0===n.length)return[];const r=new Map;for(const t of he(n.map((t=>e.getShape(t))))){const{parentId:n}=t;r.has(n)||r.set(n,{children:he(e.getSortedChildIdsForParent(n).map((t=>e.getShape(t)))),moving:new Set}),r.get(n).moving.add(t)}const o=[];switch(t){case"toBack":r.forEach((({moving:e,children:t})=>function(e,t,n){const r=t.length;if(e.size===r)return;let o,i;for(let n=0;n<r;n++){const r=t[n];if(!e.has(r)){i=r.index;break}o=r.index,e.delete(r)}if(0!==e.size){const t=lc(o,i,e.size);n.push(...Array.from(e.values()).sort(fc).map(((e,n)=>({...e,index:t[n]}))))}}(e,t,o)));break;case"toFront":r.forEach((({moving:e,children:t})=>function(e,t,n){const r=t.length;if(e.size===r)return;let o,i;for(let n=r-1;n>-1;n--){const r=t[n];if(!e.has(r)){o=r.index;break}i=r.index,e.delete(r)}if(0!==e.size){const t=lc(o,i,e.size);n.push(...Array.from(e.values()).sort(fc).map(((e,n)=>({...e,index:t[n]}))))}}(e,t,o)));break;case"forward":r.forEach((({moving:e,children:t})=>function(e,t,n){const r=t.length;if(e.size===r)return;let o={name:"skipping"};for(let i=0;i<r;i++){const r=e.has(t[i]);switch(o.name){case"skipping":if(!r)continue;o={name:"selecting",selectIndex:i};break;case"selecting":{if(r)continue;const{selectIndex:e}=o;lc(t[i].index,t[i+1]?.index,i-e).forEach(((r,o)=>n.push({...t[e+o],index:r}))),o={name:"skipping"};break}}}}(e,t,o)));break;case"backward":r.forEach((({moving:e,children:t})=>function(e,t,n){const r=t.length;if(e.size===r)return;let o={name:"skipping"};for(let i=r-1;i>-1;i--){const r=e.has(t[i]);switch(o.name){case"skipping":if(!r)continue;o={name:"selecting",selectIndex:i};break;case"selecting":if(r)continue;lc(t[i-1]?.index,t[i].index,o.selectIndex-i).forEach(((e,r)=>{n.push({...t[i+r+1],index:e})})),o={name:"skipping"}}}}(e,t,o)))}return o}function mc({editor:e}){const t=e.getSelectedShapes(),n=e.getSelectionRotation(),r=e.getSelectionRotatedPageBounds(),{inputs:{originPagePoint:o}}=e;if(!r)return null;const i=r.center.clone().rotWith(r.point,n);return{selectionPageCenter:i,initialCursorAngle:i.angle(o),initialSelectionRotation:n,shapeSnapshots:t.map((t=>({shape:We(t),initialPagePoint:e.getShapePageTransform(t.id).point()})))}}function _c({delta:e,editor:t,snapshot:n,stage:r}){const{selectionPageCenter:o,shapeSnapshots:i}=n;t.updateShapes(i.map((({shape:n,initialPagePoint:r})=>{const i=Tn(n.parentId)?t.getShapePageTransform(n.parentId):ks.Identity(),s=ho.RotWith(r,o,e),a=ks.applyToPoint(ks.Inverse(i),s),c=Eo(n.rotation+e);return{id:n.id,type:n.type,x:a.x,y:a.y,rotation:c}})));const s=[];i.forEach((({shape:e})=>{const n=t.getShape(e.id);if(!n)return;const o=t.getShapeUtil(e);if("start"===r||"one-off"===r){const t=o.onRotateStart?.(e);t&&s.push(t)}const i=o.onRotate?.(e,n);if(i&&s.push(i),"end"===r||"one-off"===r){const t=o.onRotateEnd?.(e,n);t&&s.push(t)}})),s.length>0&&t.updateShapes(s)}const yc=(e,t,n)=>{for(;!Jt(n.parentId);){const t=e.get(n.parentId);if(!t)return!1;n=t}return n.parentId===t};class wc{constructor(e){this.editor=e}_clickId="";_clickTimeout;_clickScreenPoint;_previousScreenPoint;_getClickTimeout=(e,t=ua())=>{this._clickId=t,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout((()=>{if(this._clickState===e&&this._clickId===t){switch(this._clickState){case"pendingTriple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break;case"pendingQuadruple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break;case"pendingOverflow":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"})}this._clickState="idle"}}),"idle"===e||"pendingDouble"===e?450:200)};_clickState="idle";get clickState(){return this._clickState}lastPointerInfo={};transformPointerDownEvent=e=>{if(!this._clickState)return e;switch(this._clickScreenPoint=ho.From(e.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>40&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=e,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),e;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),e;default:return this._clickTimeout=this._getClickTimeout(this._clickState),e}};transformPointerUpEvent=e=>{if(!this._clickState)return e;switch(this._clickScreenPoint=ho.From(e.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return e}};cancelDoubleClickTimeout=()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"};handleMove=()=>{"idle"!==this._clickState&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?6:4)&&this.cancelDoubleClickTimeout()}}class vc{constructor(e){this.editor=e,"undefined"!=typeof window&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}isSafari;isIos;isChromeForIos;isFirefox;isAndroid}function bc(e){if(e){let t=Sc;for(;e.length;)t=t.push(e.pop());return t}return Sc}class xc{length=0;head=null;tail=this;push(e){return new kc(e,this)}toArray(){return E}[Symbol.iterator](){return{next:()=>({value:void 0,done:!0})}}}const Sc=new xc;class kc{constructor(e,t){this.head=e,this.tail=t,this.length=t.length+1}length;push(e){return new kc(e,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let e=this;return{next(){if(e.length){const t=e.head;return e=e.tail,{value:t,done:!1}}return{value:void 0,done:!0}}}}}class Cc{constructor(e,t){this.ctx=e,this.annotateError=t}_undos=K("HistoryManager.undos",bc());_redos=K("HistoryManager.redos",bc());_batchDepth=0;onBatchComplete=()=>{};_commands={};getNumUndos(){return this._undos.get().length}get numUndos(){return He("numUndos"),this.getNumUndos()}getNumRedos(){return this._redos.get().length}get numRedos(){return He("numRedos"),this.getNumRedos()}createCommand=(e,t,n)=>{if(this._commands[e])throw new Error(`Duplicate command: ${e}`);this._commands[e]=n;const r=(...o)=>{if(!this._batchDepth)return this.batch((()=>r(...o))),this.ctx;const i=t(...o);if(!i)return this.ctx;const{data:s,ephemeral:a,squashing:c,preservesRedoStack:l}=i;if(this.ignoringUpdates(((e,t)=>(n.do(s),{undos:e,redos:t}))),!a){const t=this._undos.get().head;c&&t&&"command"===t.type&&t.name===e&&t.preservesRedoStack===l?this._undos.update((e=>e.tail.push({...t,id:ua(),data:n.squash(t.data,s)}))):this._undos.update((t=>t.push({type:"command",name:e,data:s,id:ua(),preservesRedoStack:l}))),i.preservesRedoStack||this._redos.set(bc()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return r};batch=e=>{try{this._batchDepth++,1===this._batchDepth?B((()=>{const t=this._undos.get().head?.id;e(),t!==this._undos.get().head?.id&&this.onBatchComplete()})):e()}catch(e){throw this.annotateError(e),e}finally{this._batchDepth--}return this};ignoringUpdates=e=>{let t=this._undos.get(),n=this._redos.get();this._undos.set(bc()),this._redos.set(bc());try{({undos:t,redos:n}=B((()=>e(t,n))))}finally{this._undos.set(t),this._redos.set(n)}};_undo=({pushToRedoStack:e,toMark:t})=>(this.ignoringUpdates(((n,r)=>{if(0===n.length)return{undos:n,redos:r};for(;"STOP"===n.head?.type;){const o=n.head;if(n=n.tail,e&&(r=r.push(o)),o.id===t)return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r}}if(0===n.length)return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r};for(;n.head;){const o=n.head;if(n=n.tail,e&&(r=r.push(o)),"STOP"===o.type){if(o.onUndo&&(!t||o.id===t))return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r}}else this._commands[o.name].undo(o.data)}return this.ctx.emit("change-history",e?{reason:"undo"}:{reason:"bail",markId:t}),{undos:n,redos:r}})),this);undo=()=>(this._undo({pushToRedoStack:!0}),this);redo=()=>(this.ignoringUpdates(((e,t)=>{if(0===t.length)return{undos:e,redos:t};for(;"STOP"===t.head?.type;)e=e.push(t.head),t=t.tail;if(0===t.length)return this.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t};for(;t.head;){const n=t.head;if(e=e.push(t.head),t=t.tail,"STOP"===n.type){if(n.onRedo)break}else{const e=this._commands[n.name];e.redo?e.redo(n.data):e.do(n.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:e,redos:t}})),this);bail=()=>(this._undo({pushToRedoStack:!1}),this);bailToMark=e=>(this._undo({pushToRedoStack:!1,toMark:e}),this);mark=(e=ua(),t=!0,n=!0)=>{const r=this._undos.get().head;return r&&"STOP"===r.type&&r.id===e&&r.onUndo===t&&r.onRedo===n?r.id:(this._undos.update((r=>r.push({type:"STOP",id:e,onUndo:t,onRedo:n}))),this.ctx.emit("mark-history",{id:e}),e)};clear(){this._undos.set(bc()),this._redos.set(bc())}}class Ec{constructor(e){this.editor=e}scribbleItems=new Map;state="paused";addScribble=(e,t=ua())=>{const n={id:t,scribble:{id:t,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...e,state:"starting"},timeoutMs:0,delayRemaining:e.delay??0,prev:null,next:null};return this.scribbleItems.set(t,n),"paused"===this.state&&this.resume(),n};resume(){this.state="running",this.editor.addListener("tick",this.tick)}pause(){this.editor.removeListener("tick",this.tick),this.state="paused"}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear(),this.pause()}stop=e=>{const t=this.scribbleItems.get(e);if(!t)throw Error(`Scribble with id ${e} not found`);return t.delayRemaining=Math.min(t.delayRemaining,200),t.scribble.state="stopping",t};addPoint=(e,t,n)=>{const r=this.scribbleItems.get(e);if(!r)throw Error(`Scribble with id ${e} not found`);const{prev:o}=r,i={x:t,y:n,z:.5};return(!o||ho.Dist(o,i)>=1)&&(r.next=i),r};tick=e=>{this.editor.batch((()=>{this.scribbleItems.forEach((t=>{if("starting"===t.scribble.state){const{next:e,prev:n}=t;return e&&e!==n&&(t.prev=e,t.scribble.points.push(e)),void(t.scribble.points.length>8&&(t.scribble.state="active"))}t.delayRemaining>0&&(t.delayRemaining=Math.max(0,t.delayRemaining-e)),t.timeoutMs+=e,t.timeoutMs>=16&&(t.timeoutMs=0);const{delayRemaining:n,timeoutMs:r,prev:o,next:i,scribble:s}=t;switch(s.state){case"active":i&&i!==o?(t.prev=i,s.points.push(i),0===n&&s.points.length>8&&s.points.shift()):0===r&&(s.points.length>1?s.points.shift():t.delayRemaining=s.delay);break;case"stopping":if(0===t.delayRemaining&&0===r){if(1===s.points.length)return void this.scribbleItems.delete(t.id);s.shrink&&(s.size=Math.max(1,s.size*(1-s.shrink))),s.points.shift()}}})),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map((({scribble:e})=>({...e,points:[...e.points]}))).slice(-5)}),0===this.scribbleItems.size&&this.pause()}))}}class Ac{constructor(e){this.editor=e,e.store.onBeforeCreate=(e,t)=>{const n=this._beforeCreateHandlers[e.typeName];if(n){let r=e;for(const e of n)r=e(r,t);return r}return e},e.store.onAfterCreate=(e,t)=>{const n=this._afterCreateHandlers[e.typeName];if(n)for(const r of n)r(e,t)},e.store.onBeforeChange=(e,t,n)=>{const r=this._beforeChangeHandlers[t.typeName];if(r){let o=t;for(const t of r)o=t(e,o,n);return o}return t};let t=0;e.store.onAfterChange=(e,n,r)=>{if(t++,t>1e3)console.error("[CleanupManager.onAfterChange] Maximum update depth exceeded, bailing out.");else{const t=this._afterChangeHandlers[n.typeName];if(t)for(const o of t)o(e,n,r)}t--},e.store.onBeforeDelete=(e,t)=>{const n=this._beforeDeleteHandlers[e.typeName];if(n)for(const r of n)if(!1===r(e,t))return!1},e.store.onAfterDelete=(e,t)=>{const n=this._afterDeleteHandlers[e.typeName];if(n)for(const r of n)r(e,t)},e.history.onBatchComplete=()=>{this._batchCompleteHandlers.forEach((e=>e()))}}_beforeCreateHandlers={};_afterCreateHandlers={};_beforeChangeHandlers={};_afterChangeHandlers={};_beforeDeleteHandlers={};_afterDeleteHandlers={};_batchCompleteHandlers=[];registerBeforeCreateHandler(e,t){return this._beforeCreateHandlers[e]||(this._beforeCreateHandlers[e]=[]),this._beforeCreateHandlers[e].push(t),()=>Ic(this._beforeCreateHandlers[e],t)}registerAfterCreateHandler(e,t){return this._afterCreateHandlers[e]||(this._afterCreateHandlers[e]=[]),this._afterCreateHandlers[e].push(t),()=>Ic(this._afterCreateHandlers[e],t)}registerBeforeChangeHandler(e,t){return this._beforeChangeHandlers[e]||(this._beforeChangeHandlers[e]=[]),this._beforeChangeHandlers[e].push(t),()=>Ic(this._beforeChangeHandlers[e],t)}registerAfterChangeHandler(e,t){return this._afterChangeHandlers[e]||(this._afterChangeHandlers[e]=[]),this._afterChangeHandlers[e].push(t),()=>Ic(this._afterChangeHandlers[e],t)}registerBeforeDeleteHandler(e,t){return this._beforeDeleteHandlers[e]||(this._beforeDeleteHandlers[e]=[]),this._beforeDeleteHandlers[e].push(t),()=>Ic(this._beforeDeleteHandlers[e],t)}registerAfterDeleteHandler(e,t){return this._afterDeleteHandlers[e]||(this._afterDeleteHandlers[e]=[]),this._afterDeleteHandlers[e].push(t),()=>Ic(this._afterDeleteHandlers[e],t)}registerBatchCompleteHandler(e){return this._batchCompleteHandlers.push(e),()=>Ic(this._batchCompleteHandlers,e)}}function Ic(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}var Pc=Object.defineProperty,Mc=Object.getOwnPropertyDescriptor,Tc=(e,t,n,r)=>{for(var o,i=r>1?void 0:r?Mc(t,n):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(r?o(t,n,i):o(i))||i);return r&&i&&Pc(t,n,i),i};const jc=e=>Math.round(e*10**8)/10**8;function Dc(e,t,n,r,o){const i=e.filter((e=>("forward"===r?e.startNode.id===t:e.endNode.id===t)&&jc(e.length)===jc(n)&&Fo(e.breadthIntersection[0],e.breadthIntersection[1],o[0],o[1])));if(0===i.length)return[];const s=new Set;return i.forEach((t=>{const a="forward"===r?t.endNode.id:t.startNode.id;if(!s.has(a)){s.add(a);const c=Dc(e,a,n,r,Fo(t.breadthIntersection[0],t.breadthIntersection[1],o[0],o[1]));i.push(...c)}})),i}class Oc{constructor(e){this.editor=e}_snapLines=K("snapLines",void 0);getLines(){return this._snapLines.get()??E}get lines(){return He("lines"),this.getLines()}clear(){this.getLines().length&&this._snapLines.set(void 0)}setLines(e){this._snapLines.set(e)}getSnapPointsCache(){const{editor:e}=this;return e.store.createComputedCache("snapPoints",(t=>{const n=e.getShapePageTransform(t.id);if(n)return this.editor.getShapeGeometry(t).snapPoints.map(((e,r)=>{const{x:o,y:i}=ks.applyToPoint(n,e);return{x:o,y:i,id:`${t.id}:${r}`}}))}))}get snapPointsCache(){return He("snapPointsCache"),this.getSnapPointsCache()}getSnapThreshold(){return 8/this.editor.getZoomLevel()}get snapThreshold(){return He("snapThreshold"),this.getSnapThreshold()}getSnappableShapes(){const{editor:e}=this,t=e.getRenderingBounds(),n=e.getSelectedShapeIds(),r=[],o=i=>{const s=e.getSortedChildIdsForParent(i);for(const i of s){if(n.includes(i))continue;const s=e.getShape(i);if(!s)continue;if(!e.getShapeUtil(s).canSnap(s))continue;const a=e.getShapePageBounds(i);a&&t.includes(a)&&(e.isShapeOfType(s,"group")?o(i):r.push({id:i,pageBounds:a,isClosed:e.getShapeGeometry(s).isClosed}))}};return o(this.getCurrentCommonAncestor()??e.getCurrentPageId()),r}get snappableShapes(){return He("snappableShapes"),this.getSnappableShapes()}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}get currentCommonAncestor(){return He("currentCommonAncestor"),this.getCurrentCommonAncestor()}getSnappablePoints(){const e=this.getSnapPointsCache(),t=this.getSnappableShapes(),n=[];return t.forEach((t=>{const r=e.get(t.id);r&&n.push(...r)})),n}get snappablePoints(){return He("snappablePoints"),this.getSnappablePoints()}getVisibleGaps(){const e=[],t=[];let n,r;const o=this.getSnappableShapes().sort(((e,t)=>e.pageBounds.minX-t.pageBounds.minX));for(let t=0;t<o.length;t++){n=o[t];for(let i=t+1;i<o.length;i++)r=o[i],n.pageBounds.maxX<r.pageBounds.minX&&zo(n.pageBounds.minY,n.pageBounds.maxY,r.pageBounds.minY,r.pageBounds.maxY)&&e.push({startNode:n,endNode:r,startEdge:[new ho(n.pageBounds.maxX,n.pageBounds.minY),new ho(n.pageBounds.maxX,n.pageBounds.maxY)],endEdge:[new ho(r.pageBounds.minX,r.pageBounds.minY),new ho(r.pageBounds.minX,r.pageBounds.maxY)],length:r.pageBounds.minX-n.pageBounds.maxX,breadthIntersection:Fo(n.pageBounds.minY,n.pageBounds.maxY,r.pageBounds.minY,r.pageBounds.maxY)})}const i=o.sort(((e,t)=>e.pageBounds.minY-t.pageBounds.minY));for(let e=0;e<i.length;e++){n=i[e];for(let o=e+1;o<i.length;o++)r=i[o],n.pageBounds.maxY<r.pageBounds.minY&&zo(n.pageBounds.minX,n.pageBounds.maxX,r.pageBounds.minX,r.pageBounds.maxX)&&t.push({startNode:n,endNode:r,startEdge:[new ho(n.pageBounds.minX,n.pageBounds.maxY),new ho(n.pageBounds.maxX,n.pageBounds.maxY)],endEdge:[new ho(r.pageBounds.minX,r.pageBounds.minY),new ho(r.pageBounds.maxX,r.pageBounds.minY)],length:r.pageBounds.minY-n.pageBounds.maxY,breadthIntersection:Fo(n.pageBounds.minX,n.pageBounds.maxX,r.pageBounds.minX,r.pageBounds.maxX)})}return{horizontal:e,vertical:t}}get visibleGaps(){return He("visibleGaps"),this.getVisibleGaps()}snapTranslate({lockedAxis:e,initialSelectionPageBounds:t,initialSelectionSnapPoints:n,dragDelta:r}){const o=this.getSnapThreshold(),i=this.getSnappablePoints(),s=t.clone().translate(r),a=n.map((({x:e,y:t},n)=>({id:"selection:"+n,x:e+r.x,y:t+r.y}))),c=i,l=[],u=[],d=new ho(o,o);this.collectPointSnaps({minOffset:d,nearestSnapsX:l,nearestSnapsY:u,otherNodeSnapPoints:c,selectionSnapPoints:a}),this.collectGapSnaps({selectionPageBounds:s,nearestSnapsX:l,nearestSnapsY:u,minOffset:d});const h=new ho("x"===e?0:l[0]?.nudge??0,"y"===e?0:u[0]?.nudge??0);d.x=0,d.y=0,l.length=0,u.length=0,a.forEach((e=>{e.x+=h.x,e.y+=h.y})),s.translate(h),this.collectPointSnaps({minOffset:d,nearestSnapsX:l,nearestSnapsY:u,otherNodeSnapPoints:c,selectionSnapPoints:a}),this.collectGapSnaps({selectionPageBounds:s,nearestSnapsX:l,nearestSnapsY:u,minOffset:d});const p=this.getPointSnapLines({nearestSnapsX:l,nearestSnapsY:u}),f=this.getGapSnapLines({selectionPageBounds:s,nearestSnapsX:l,nearestSnapsY:u});return this._snapLines.set([...f,...p]),{nudge:h}}getOutlinesInPageSpace(){return this.getSnappableShapes().map((({id:e,isClosed:t})=>{const n=Me(this.editor.getShapeGeometry(e).vertices);t&&n.push(n[0]);const r=this.editor.getShapePageTransform(e);if(!r)throw Error("No page transform");return ks.applyToPoints(r,n)}))}get outlinesInPageSpace(){return He("outlinesInPageSpace"),this.getOutlinesInPageSpace()}getSnappingHandleDelta({handlePoint:e,additionalSegments:t}){let n,r,o,i,s=this.getSnapThreshold(),a=null;const c=[...this.getOutlinesInPageSpace(),...t];for(const t of c)for(let c=0;c<t.length-1;c++)n=t[c],r=t[c+1],o=ho.NearestPointOnLineSegment(n,r,e),i=ho.Dist(e,o),isNaN(i)||i<s&&(s=i,a=o);return a?(this._snapLines.set([{id:ua(),type:"points",points:[a]}]),ho.Sub(a,e)):null}snapResize({initialSelectionPageBounds:e,dragDelta:t,handle:n,isAspectRatioLocked:r,isResizingFromCenter:o}){const i=this.getSnapThreshold(),{box:s,scaleX:a,scaleY:c}=fo.Resize(e,n,o?2*t.x:t.x,o?2*t.y:t.y,r);let l=n;a<0&&(l=function(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}(l)),c<0&&(l=function(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}(l)),o&&(s.center=e.center);const u="top"===l||"bottom"===l,d="left"===l||"right"===l,h=zc(l,s),p=this.getSnappablePoints(),f=[],g=[],m=new ho(i,i);this.collectPointSnaps({minOffset:m,nearestSnapsX:f,nearestSnapsY:g,otherNodeSnapPoints:p,selectionSnapPoints:h});const _=new ho(u?0:f[0]?.nudge??0,d?0:g[0]?.nudge??0);if(r&&("top_left"===(y=l)||"top_right"===y||"bottom_right"===y||"bottom_left"===y)&&0!==_.len()){const t=f.length&&g.length?Math.abs(_.x)<Math.abs(_.y)?"x":"y":f.length?"x":"y",n=e.aspectRatio;"x"===t?(g.length=0,_.y=_.x/n,"bottom_left"!==l&&"top_right"!==l||(_.y=-_.y)):(f.length=0,_.x=_.y*n,"bottom_left"!==l&&"top_right"!==l||(_.x=-_.x))}var y;const w=ho.Add(t,_),{box:v}=fo.Resize(e,n,o?2*w.x:w.x,o?2*w.y:w.y,r);o&&(v.center=e.center);const b=zc("any",v);f.length=0,g.length=0,m.x=0,m.y=0,this.collectPointSnaps({minOffset:m,nearestSnapsX:f,nearestSnapsY:g,otherNodeSnapPoints:p,selectionSnapPoints:b});const x=this.getPointSnapLines({nearestSnapsX:f,nearestSnapsY:g});return this._snapLines.set([...x]),{nudge:_}}collectPointSnaps({selectionSnapPoints:e,otherNodeSnapPoints:t,minOffset:n,nearestSnapsX:r,nearestSnapsY:o}){for(const i of e)for(const e of t){const t=ho.Sub(i,e),s=Math.abs(t.x),a=Math.abs(t.y);jc(s)<=jc(n.x)&&(jc(s)<jc(n.x)&&(r.length=0),r.push({type:"points",points:{thisPoint:i,otherPoint:e},nudge:e.x-i.x}),n.x=s),jc(a)<=jc(n.y)&&(jc(a)<jc(n.y)&&(o.length=0),o.push({type:"points",points:{thisPoint:i,otherPoint:e},nudge:e.y-i.y}),n.y=a)}}collectGapSnaps({selectionPageBounds:e,minOffset:t,nearestSnapsX:n,nearestSnapsY:r}){const{horizontal:o,vertical:i}=this.getVisibleGaps();for(const r of o){if(!zo(r.breadthIntersection[0],r.breadthIntersection[1],e.minY,e.maxY))continue;const o=r.startEdge[0].x+r.length/2-e.center.x;if(r.length>e.width&&jc(Math.abs(o))<=jc(t.x)){jc(Math.abs(o))<jc(t.x)&&(n.length=0),t.x=Math.abs(o);const e={type:"gap_center",gap:r,nudge:o},i=n.find((({type:e})=>"gap_center"===e)),s=i&&Fo(r.breadthIntersection[0],r.breadthIntersection[1],i.gap.breadthIntersection[0],i.gap.breadthIntersection[1]);i&&i.gap.length>r.length&&s?n[n.indexOf(i)]=e:i&&s||n.push(e)}const i=r.startNode.pageBounds.minX-r.length-e.maxX;jc(Math.abs(i))<=jc(t.x)&&(jc(Math.abs(i))<jc(t.x)&&(n.length=0),t.x=Math.abs(i),n.push({type:"gap_duplicate",gap:r,protrusionDirection:"left",nudge:i}));const s=r.endNode.pageBounds.maxX+r.length-e.minX;jc(Math.abs(s))<=jc(t.x)&&(jc(Math.abs(s))<jc(t.x)&&(n.length=0),t.x=Math.abs(s),n.push({type:"gap_duplicate",gap:r,protrusionDirection:"right",nudge:s}))}for(const n of i){if(!zo(n.breadthIntersection[0],n.breadthIntersection[1],e.minX,e.maxX))continue;const o=n.startEdge[0].y+n.length/2-e.center.y;if(n.length>e.height&&jc(Math.abs(o))<=jc(t.y)){jc(Math.abs(o))<jc(t.y)&&(r.length=0),t.y=Math.abs(o);const e={type:"gap_center",gap:n,nudge:o},i=r.find((({type:e})=>"gap_center"===e)),s=i&&zo(i.gap.breadthIntersection[0],i.gap.breadthIntersection[1],n.breadthIntersection[0],n.breadthIntersection[1]);i&&i.gap.length>n.length&&s?r[r.indexOf(i)]=e:i&&s||r.push(e);continue}const i=n.startNode.pageBounds.minY-n.length-e.maxY;jc(Math.abs(i))<=jc(t.y)&&(jc(Math.abs(i))<jc(t.y)&&(r.length=0),t.y=Math.abs(i),r.push({type:"gap_duplicate",gap:n,protrusionDirection:"top",nudge:i}));const s=n.endNode.pageBounds.maxY+n.length-e.minY;jc(Math.abs(s))<=jc(t.y)&&(jc(Math.abs(s))<jc(t.y)&&(r.length=0),t.y=Math.abs(s),r.push({type:"gap_duplicate",gap:n,protrusionDirection:"bottom",nudge:s}))}}getPointSnapLines({nearestSnapsX:e,nearestSnapsY:t}){const n={},r={};if(e.length>0)for(const t of e)if("points"===t.type){const e=jc(t.points.otherPoint.x);n[e]||(n[e]=[]),n[e].push(t.points)}if(t.length>0)for(const e of t)if("points"===e.type){const t=jc(e.points.otherPoint.y);r[t]||(r[t]=[]),r[t].push(e.points)}return Object.values(n).concat(Object.values(r)).map((e=>({id:ua(),type:"points",points:de(e.map((e=>ho.From(e.otherPoint))).concat(e.map((e=>ho.From(e.thisPoint)))),((e,t)=>e.equals(t)))})))}getGapSnapLines({selectionPageBounds:e,nearestSnapsX:t,nearestSnapsY:n}){const{vertical:r,horizontal:o}=this.getVisibleGaps(),i={top:e.sides[0],right:e.sides[1],bottom:[e.corners[3],e.corners[2]],left:[e.corners[0],e.corners[3]]},s=[];if(t.length>0)for(const n of t){if("points"===n.type)continue;const{gap:{breadthIntersection:t,startEdge:r,startNode:a,endNode:c,length:l,endEdge:u}}=n;switch(n.type){case"gap_center":{const n=(l-e.width)/2,d=Fo(t[0],t[1],e.minY,e.maxY);s.push({type:"gaps",direction:"horizontal",id:ua(),gaps:[...Dc(o,a.id,n,"backward",d),{startEdge:r,endEdge:i.left},{startEdge:i.right,endEdge:u},...Dc(o,c.id,n,"forward",d)]});break}case"gap_duplicate":{const d=Fo(t[0],t[1],e.minY,e.maxY);s.push({type:"gaps",direction:"horizontal",id:ua(),gaps:"left"===n.protrusionDirection?[{startEdge:i.right,endEdge:r.map((e=>e.clone().addXY(-a.pageBounds.width,0)))},{startEdge:r,endEdge:u},...Dc(o,c.id,l,"forward",d)]:[...Dc(o,a.id,l,"backward",d),{startEdge:r,endEdge:u},{startEdge:u.map((e=>e.clone().addXY(n.gap.endNode.pageBounds.width,0))),endEdge:i.left}]});break}}}if(n.length>0)for(const t of n){if("points"===t.type)continue;const{gap:{breadthIntersection:n,startEdge:o,startNode:a,endNode:c,length:l,endEdge:u}}=t;switch(t.type){case"gap_center":{const c=(l-e.height)/2,d=Fo(n[0],n[1],e.minX,e.maxX);s.push({type:"gaps",direction:"vertical",id:ua(),gaps:[...Dc(r,a.id,c,"backward",d),{startEdge:o,endEdge:i.top},{startEdge:i.bottom,endEdge:u},...Dc(r,t.gap.endNode.id,c,"forward",d)]});break}case"gap_duplicate":{const d=Fo(n[0],n[1],e.minX,e.maxX);s.push({type:"gaps",direction:"vertical",id:ua(),gaps:"top"===t.protrusionDirection?[{startEdge:i.bottom,endEdge:o.map((e=>e.clone().addXY(0,-a.pageBounds.height)))},{startEdge:o,endEdge:u},...Dc(r,c.id,l,"forward",d)]:[...Dc(r,a.id,l,"backward",d),{startEdge:o,endEdge:u},{startEdge:u.map((e=>e.clone().addXY(0,c.pageBounds.height))),endEdge:i.top}]})}}}return function(e){e.sort(((e,t)=>t.gaps.length-e.gaps.length));for(let t=e.length-1;t>0;t--){const n=e[t];for(let r=t-1;r>=0;r--){const o=e[r];if(o.direction===n.direction&&n.gaps.every((e=>o.gaps.some((t=>jc(e.startEdge[0].x)===jc(t.startEdge[0].x)&&jc(e.startEdge[0].y)===jc(t.startEdge[0].y)&&jc(e.startEdge[1].x)===jc(t.startEdge[1].x)&&jc(e.startEdge[1].y)===jc(t.startEdge[1].y)))&&o.gaps.some((t=>jc(e.endEdge[0].x)===jc(t.endEdge[0].x)&&jc(e.endEdge[0].y)===jc(t.endEdge[0].y)&&jc(e.endEdge[1].x)===jc(t.endEdge[1].x)&&jc(e.endEdge[1].y)===jc(t.endEdge[1].y)))))){e.splice(t,1);break}}}}(s),s}}function zc(e,t){const{minX:n,maxX:r,minY:o,maxY:i}=t,s=[];switch(e){case"top":case"left":case"top_left":case"any":s.push({id:"top_left",handle:"top_left",x:n,y:o})}switch(e){case"top":case"right":case"top_right":case"any":s.push({id:"top_right",handle:"top_right",x:r,y:o})}switch(e){case"bottom":case"right":case"bottom_right":case"any":s.push({id:"bottom_right",handle:"bottom_right",x:r,y:i})}switch(e){case"bottom":case"left":case"bottom_left":case"any":s.push({id:"bottom_left",handle:"bottom_left",x:n,y:i})}return s}Tc([J],Oc.prototype,"getSnapPointsCache",1),Tc([J],Oc.prototype,"getSnapThreshold",1),Tc([J],Oc.prototype,"getSnappableShapes",1),Tc([J],Oc.prototype,"getCurrentCommonAncestor",1),Tc([J],Oc.prototype,"getSnappablePoints",1),Tc([J],Oc.prototype,"getVisibleGaps",1),Tc([J],Oc.prototype,"getOutlinesInPageSpace",1);const Fc=/\r?\n|\r/g;function Rc(e){return e.replace(Fc,"\n").split("\n").map((e=>e||" ")).join("\n")}const Lc={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},Nc=/\s/;class Bc{constructor(e){this.editor=e}getTextElement(){const e=document.querySelector(".tl-text-measure");e?.remove();const t=document.createElement("div");return this.editor.getContainer().appendChild(t),t.id=`__textMeasure_${ua()}`,t.classList.add("tl-text"),t.classList.add("tl-text-measure"),t.tabIndex=-1,t}measureText=(e,t)=>{const n=this.getTextElement();n.setAttribute("dir","ltr"),n.style.setProperty("font-family",t.fontFamily),n.style.setProperty("font-style",t.fontStyle),n.style.setProperty("font-weight",t.fontWeight),n.style.setProperty("font-size",t.fontSize+"px"),n.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),n.style.setProperty("max-width",null===t.maxWidth?null:t.maxWidth+"px"),n.style.setProperty("min-width",t.minWidth??null),n.style.setProperty("padding",t.padding),n.textContent=Rc(e);const r=n.getBoundingClientRect();return{x:0,y:0,w:r.width,h:r.height}};measureElementTextNodeSpans(e,{shouldTruncateToFirstLine:t=!1}={}){const n=[],r=e.getBoundingClientRect(),o=-r.left,i=-r.top,s=new Range,a=e.childNodes[0];let c=0,l=null,u=null,d=0,h=!1;for(const r of e.childNodes)if(r.nodeType===Node.TEXT_NODE)for(const e of r.textContent??""){s.setStart(a,c),s.setEnd(a,c+e.length);const r=s.getClientRects(),p=r[r.length-1],f=p.top+i,g=p.left+o,m=p.right+o,_=Nc.test(e);if(_===u&&f===d&&l)l.box.w=m-l.box.x,l.text+=e;else{if(l){if(t&&f!==d){h=!0;break}n.push(l)}l={box:{x:g,y:f,w:p.width,h:p.height},text:e}}u=_,d=f,c+=e.length}return l&&n.push(l),{spans:n,didTruncate:h}}measureTextSpans(e,t){if(""===e)return[];const n="truncate-ellipsis"===t.overflow||"truncate-clip"===t.overflow,r=this.getTextElement(),o=Math.ceil(t.width-2*t.padding);r.style.setProperty("width",`${o}px`),r.style.setProperty("height","min-content"),r.style.setProperty("dir","ltr"),r.style.setProperty("font-size",`${t.fontSize}px`),r.style.setProperty("font-family",t.fontFamily),r.style.setProperty("font-weight",t.fontWeight),r.style.setProperty("line-height",t.lineHeight*t.fontSize+"px"),r.style.setProperty("text-align",Lc[t.textAlign]),n&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all")),e=Rc(e),r.textContent=e;const{spans:i,didTruncate:s}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:n});if("truncate-ellipsis"===t.overflow&&s){r.textContent="";const n=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",o-n+"px"),r.textContent=e;const i=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,s=i[i.length-1];return i.push({text:"",box:{x:Math.min(s.box.x+s.box.w,t.width-t.padding-n),y:s.box.y,w:n,h:s.box.h}}),i}return r.remove(),i}}class $c{constructor(e){this.editor=e,this.editor.disposables.add(this.dispose),this.start()}raf;isPaused=!0;last=0;t=0;start=()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()};tick=()=>{if(this.isPaused)return;const e=Date.now(),t=e-this.last;this.last=e,this.t+=t,this.editor.emit("frame",t),this.t<16||(this.t-=16,this.updatePointerVelocity(t),this.editor.emit("tick",t)),this.raf=requestAnimationFrame(this.tick)};dispose=()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)};prevPoint=new ho;updatePointerVelocity=e=>{const{prevPoint:t,editor:{inputs:{currentScreenPoint:n,pointerVelocity:r}}}=this;if(0===e)return;const o=ho.Sub(n,t);this.prevPoint=n.clone();const i=o.len(),s=i?o.div(i):new ho(0,0),a=r.clone().lrp(s.mul(i/e),.5);Math.abs(a.x)<.01&&(a.x=0),Math.abs(a.y)<.01&&(a.y=0),r.equals(a)||(this.editor.inputs.pointerVelocity=a)}}var Uc=Object.defineProperty,Vc=Object.getOwnPropertyDescriptor,Wc=(e,t,n,r)=>{for(var o,i=r>1?void 0:r?Vc(t,n):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(r?o(t,n,i):o(i))||i);return r&&i&&Uc(t,n,i),i};class Kc{constructor(e,t){this.user=e,this.inferDarkMode=t}updateUserPreferences=e=>{this.user.setUserPreferences({...this.user.userPreferences.get(),...e})};getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),isDarkMode:this.getIsDarkMode(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode()}}get userPreferences(){return He("userPreferences"),this.getUserPreferences()}getIsDarkMode(){return this.user.userPreferences.get().isDarkMode??(!!this.inferDarkMode&&"undefined"!=typeof window&&(window.matchMedia?.("(prefers-color-scheme: dark)")?.matches??!1))}get isDarkMode(){return He("isDarkMode"),this.getIsDarkMode()}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??ga.animationSpeed}get animationSpeed(){return He("animationSpeed"),this.getAnimationSpeed()}getId(){return this.user.userPreferences.get().id}get id(){return He("id"),this.getId()}getName(){return this.user.userPreferences.get().name??ga.name}get name(){return He("name"),this.getName()}getLocale(){return this.user.userPreferences.get().locale??ga.locale}get locale(){return He("locale"),this.getLocale()}getColor(){return this.user.userPreferences.get().color??ga.color}get color(){return He("color"),this.getColor()}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??ga.isSnapMode}get isSnapMode(){return He("isSnapMode"),this.getIsSnapMode()}}function Hc(e){return Math.abs(e.props.bend)<8}function Gc(e,t){if("point"===t.type)return;const n=e.getShape(t.boundShapeId),r=e.getShapePageTransform(n),o=e.getShapeGeometry(n),i=o instanceof Ia?o.children[0].vertices:o.vertices;return{shape:n,transform:r,isClosed:o.isClosed,isExact:t.isExact,didIntersect:!1,outline:i}}function qc(e,t,n){if("point"===n.type)return ho.From(n);const r=e.getShape(n.boundShapeId);if(r){const{point:o,size:i}=e.getShapeGeometry(r).bounds,s=ho.Add(o,ho.MulV(n.normalizedAnchor,i)),a=ks.applyToPoint(e.getShapePageTransform(r),s);return ks.applyToPoint(ks.Inverse(t),a)}return new ho(0,0)}function Yc(e,t){const n=e.getShapePageTransform(t);return{start:qc(e,n,t.props.start),end:qc(e,n,t.props.end)}}Wc([J],Kc.prototype,"getUserPreferences",1),Wc([J],Kc.prototype,"getIsDarkMode",1),Wc([J],Kc.prototype,"getAnimationSpeed",1),Wc([J],Kc.prototype,"getId",1),Wc([J],Kc.prototype,"getName",1),Wc([J],Kc.prototype,"getLocale",1),Wc([J],Kc.prototype,"getColor",1),Wc([J],Kc.prototype,"getIsSnapMode",1);const Xc=32,Zc=10,Qc={s:2,m:3.5,l:5,xl:10};function Jc(e,t){const{start:n,end:r,arrowheadStart:o,arrowheadEnd:i}=t.props,s=Yc(e,t),a=s.start.clone(),c=s.end.clone(),l=ho.Med(a,c);if(ho.Equals(a,c))return{isStraight:!0,start:{handle:a,point:a,arrowhead:t.props.arrowheadStart},end:{handle:c,point:c,arrowhead:t.props.arrowheadEnd},middle:l,isValid:!1,length:0};const u=ho.Sub(c,a).uni(),d=Gc(e,n),h=Gc(e,r),p=e.getShapePageTransform(t);el(c,s.start,p,h),el(a,s.end,p,d);let f=0,g=0;const m=d&&h&&d.shape===h.shape;!d||!h||m||d.isExact||h.isExact||(h.didIntersect&&!d.didIntersect?d.isClosed&&a.setTo(c.clone().add(u.clone().mul(Xc))):h.didIntersect||h.isClosed&&c.setTo(a.clone().sub(u.clone().mul(Xc))));const _=ho.Sub(c,a).uni(),y=!ho.Equals(_,u);m||(d&&"none"!==o&&!d.isExact&&(f=Zc+Qc[t.props.size]/2+("size"in d.shape.props?Qc[d.shape.props.size]/2:0)),h&&"none"!==i&&!h.isExact&&(g=Zc+Qc[t.props.size]/2+("size"in h.shape.props?Qc[h.shape.props.size]/2:0)));const w=a.clone().add(_.clone().mul(f*(y?-1:1))),v=c.clone().sub(_.clone().mul(g*(y?-1:1))),b=ho.Dist(w,v);b<Xc&&(0!==f&&0!==g?(f*=-1.5,g*=-1.5):0!==f?f*=-2:0!==g?g*=-2:b<10&&(d?f=-(10-b):h&&(g=-(10-b)))),a.add(_.clone().mul(f*(y?-1:1))),c.sub(_.clone().mul(g*(y?-1:1))),y?(d&&h&&c.setTo(ho.Add(a,_.clone().mul(-Xc))),l.setTo(ho.Med(s.start,s.end))):l.setTo(ho.Med(a,c));const x=ho.Dist(a,c);return{isStraight:!0,start:{handle:s.start,point:a,arrowhead:t.props.arrowheadStart},end:{handle:s.end,point:c,arrowhead:t.props.arrowheadEnd},middle:l,isValid:x>0,length:x}}function el(e,t,n,r){if(void 0===r)return;if(r.isExact)return;const o=ks.applyToPoint(n,t),i=ks.applyToPoint(n,e),s=ks.applyToPoint(ks.Inverse(r.transform),o),a=ks.applyToPoint(ks.Inverse(r.transform),i),c=r.isClosed,l=(c?ja:Ta)(s,a,r.outline);let u;if(null!==l&&(u=l.sort(((e,t)=>ho.Dist(e,s)-ho.Dist(t,s)))[0]??(c?void 0:a)),void 0===u)return;const d=ks.applyToPoint(r.transform,u),h=ks.applyToPoint(ks.Inverse(n),d);e.setTo(h),r.didIntersect=!0}function tl(e){return rl(e.start.handle,e.end.handle)}function nl(e){return rl(e.start.point,e.end.point)}function rl(e,t){return`M${e.x},${e.y}L${t.x},${t.y}`}function ol(e,t,n=0){const{arrowheadEnd:r,arrowheadStart:o}=t.props,i=t.props.bend+n;if(Math.abs(i)>Math.abs(10*t.props.bend))return Jc(e,t);const s=Yc(e,t),a=ho.Med(s.start,s.end),c=ho.Sub(s.end,s.start).uni(),l=ho.Add(a,c.per().mul(-i)),u=Gc(e,t.props.start),d=Gc(e,t.props.end),h=s.start.clone(),p=s.end.clone(),f=l.clone();if(ho.Equals(h,p))return{isStraight:!0,start:{handle:h,point:h,arrowhead:t.props.arrowheadStart},end:{handle:p,point:p,arrowhead:t.props.arrowheadEnd},middle:f,isValid:!1,length:0};const g=t.props.bend<0,m=g?Ao:Io,_=al(h,p,f),y=ho.Angle(_.center,h),w=ho.Angle(_.center,p),v=m(y,w);if(0===_.length||0===_.size||!$o(_.length)||!$o(_.size))return Jc(e,t);const b=h.clone(),x=p.clone(),S=f.clone(),k=e.getShapePageTransform(t);let C=0,E=0;if(u&&!u.isExact){const n=ks.applyToPoint(k,b),r=ks.applyToPoint(k,_.center),i=ks.applyToPoint(k,x),s=ks.Inverse(u.transform),a=ks.applyToPoint(s,n),c=ks.applyToPoint(s,r),l=ks.applyToPoint(s,i),{isClosed:d}=u;let h,p=(d?Da:Oa)(c,_.radius,u.outline);if(p){const e=c.angle(a),t=c.angle(l),n=m(e,t);p=p.filter((t=>m(e,c.angle(t))<=n));const r=.25*n;p.sort(d?(t,n)=>Math.abs(m(e,c.angle(t))-r)<Math.abs(m(e,c.angle(n))-r)?-1:1:(t,n)=>m(e,c.angle(t))<m(e,c.angle(n))?-1:1),h=p[0]??(d?void 0:a)}else h=d?void 0:a;h&&(b.setTo(e.getPointInShapeSpace(t,ks.applyToPoint(u.transform,h))),u.didIntersect=!0,"none"!==o&&(C=Zc+Qc[t.props.size]/2+("size"in u.shape.props?Qc[u.shape.props.size]/2:0)))}if(d&&!d.isExact){const n=ks.applyToPoint(k,b),o=ks.applyToPoint(k,x),i=ks.applyToPoint(k,_.center),s=ks.Inverse(d.transform),a=ks.applyToPoint(s,n),c=ks.applyToPoint(s,i),l=ks.applyToPoint(s,o),u=d.isClosed;let h,p=(u?Da:Oa)(c,_.radius,d.outline);if(p){const e=c.angle(a),t=c.angle(l),n=m(e,t),r=.75*n;p=p.filter((t=>m(e,c.angle(t))<=n)),p.sort(u?(t,n)=>Math.abs(m(e,c.angle(t))-r)<Math.abs(m(e,c.angle(n))-r)?-1:1:(t,n)=>m(e,c.angle(t))<m(e,c.angle(n))?-1:1),h=p[0]?p[0]:u?void 0:l}else h=u?void 0:l;h&&(x.setTo(e.getPointInShapeSpace(t,ks.applyToPoint(d.transform,h))),d.didIntersect=!0,"none"!==r&&(E=Zc+Qc[t.props.size]/2+("size"in d.shape.props?Qc[d.shape.props.size]/2:0)))}let A=ho.Angle(_.center,b),I=ho.Angle(_.center,x),P=m(A,I),M=P*_.radius;const T=b.clone(),j=x.clone();if(0!==C){const e=C/M*(g?1:-1),t=ho.FromAngle(A+P*e);T.setTo(_.center).add(t.mul(_.radius))}if(0!==E){const e=E/M*(g?-1:1),t=ho.FromAngle(I+P*e);j.setTo(_.center).add(t.mul(_.radius))}const D=ho.Dist(T,j);if(D<Xc&&(0!==C&&0!==E?(C*=-1.5,E*=-1.5):0!==C?C*=-2:0!==E?E*=-2:D<10&&(u?C=-(10-D):d&&(E=-(10-D)))),0!==C){const e=C/M*(g?1:-1),t=ho.FromAngle(A+P*e);b.setTo(_.center).add(t.mul(_.radius))}if(0!==E){const e=E/M*(g?-1:1),t=ho.FromAngle(I+P*e);x.setTo(_.center).add(t.mul(_.radius))}if(u&&d&&!u.isExact&&!d.isExact)if(A=ho.Angle(_.center,b),I=ho.Angle(_.center,x),P=m(A,I),M=P*_.radius,u.shape===d.shape)M<100&&(b.setTo(h),x.setTo(p),S.setTo(f));else if(u&&!u.didIntersect&&b.setTo(h),d&&!d.didIntersect||m(y,A)>m(y,I)){const e=Math.min(.9,Xc/M)*(g?1:-1),t=ho.FromAngle(A+P*e);x.setTo(_.center).add(t.mul(_.radius))}!function(e,t,n,r,o,i,s){const a=ho.Angle(e,n);let c=Ao(a,ho.Angle(e,r));s||(c=wo-c);const l=.5*(s?1:-1),u=ho.FromAngle(a+c*l);if(o.setTo(e).add(u.mul(t)),c>i){o.rotWith(e,_o);const t=r.clone();r.setTo(n),n.setTo(t)}}(_.center,_.radius,b,x,S,v,g),b.equals(x)&&(b.setTo(S.clone().addXY(1,1)),x.setTo(S.clone().subXY(1,1))),h.setTo(b),p.setTo(x),f.setTo(S);const O=al(h,p,f);return{isStraight:!1,start:{point:h,handle:s.start,arrowhead:t.props.arrowheadStart},end:{point:p,handle:s.end,arrowhead:t.props.arrowheadEnd},middle:f,handleArc:_,bodyArc:O,isValid:0!==O.length&&isFinite(O.center.x)&&isFinite(O.center.y)}}function il(e){const{start:t,end:n,handleArc:{radius:r,largeArcFlag:o,sweepFlag:i}}=e;return`M${t.handle.x},${t.handle.y} A${r} ${r} 0 ${o} ${i} ${n.handle.x},${n.handle.y}`}function sl(e){const{start:t,end:n,bodyArc:{radius:r,largeArcFlag:o,sweepFlag:i}}=e;return`M${t.point.x},${t.point.y} A${r} ${r} 0 ${o} ${i} ${n.point.x},${n.point.y}`}function al(e,t,n){const r=-2*(e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y),o={x:((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/r,y:((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/r},i=ho.Dist(o,e),s=+ho.Clockwise(e,n,t),a=Math.hypot(e.y-t.y,e.x-t.x),c=Math.hypot(t.y-n.y,t.x-n.x),l=Math.hypot(n.y-e.y,n.x-e.x),u=2*Math.acos((c*c+l*l-a*a)/(2*c*l)),d=(wo-u)*(s?1:-1);return{center:o,radius:i,size:d,length:d*i,largeArcFlag:+(_o>u),sweepFlag:s}}const cl={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"};class ll{constructor(e,t){this.editor=e;const{id:n,children:r,initial:o}=this.constructor;this.id=n,this._isActive=K("toolIsActive"+this.id,!1),this._current=K("toolState"+this.id,void 0),this._path=J("toolPath"+this.id,(()=>{const e=this.getCurrent();return this.id+(e?`.${e.getPath()}`:"")})),this.parent=t??{},this.parent?r&&o?(this.type="branch",this.initial=o,this.children=Object.fromEntries(r().map((e=>[e.id,new e(this.editor,this)]))),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",r&&o&&(this.initial=o,this.children=Object.fromEntries(r().map((e=>[e.id,new e(this.editor,this)]))),this._current.set(this.children[this.initial])))}static id;static initial;static children;id;type;shapeType;initial;children;parent;getPath(){return this._path.get()}_path;getCurrent(){return this._current.get()}_current;getIsActive(){return this._isActive.get()}_isActive;transition=(e,t={})=>{const n=e.split(".");let r=this;for(let e=0;e<n.length;e++){const o=n[e],i=r.getCurrent(),s=r.children?.[o];if(!s)throw Error(`${r.id} - no child state exists with the id ${o}.`);if(i?.id!==s.id&&(i?.exit(t,o),r._current.set(s),s.enter(t,i?.id||"initial"),!s.getIsActive()))break;r=s}return this};handleEvent=e=>{const t=cl[e.name],n=this.getCurrent();this[t]?.(e),this.getCurrent()===n&&this.getIsActive()&&n?.handleEvent(e)};enter=(e,t)=>{if(this._isActive.set(!0),this.onEnter?.(e,t),this.children&&this.initial&&this.getIsActive()){const n=this.children[this.initial];this._current.set(n),n.enter(e,t)}};exit=(e,t)=>{this._isActive.set(!1),this.onExit?.(e,t),this.getIsActive()||this.getCurrent()?.exit(e,t)};_currentToolIdMask=K("curent tool id mask",void 0);get currentToolIdMask(){return He("currentToolIdMask"),this._currentToolIdMask.get()}set currentToolIdMask(e){He("currentToolIdMask"),this._currentToolIdMask.set(e)}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(e){this._currentToolIdMask.set(e)}onWheel;onPointerDown;onPointerMove;onPointerUp;onDoubleClick;onTripleClick;onQuadrupleClick;onRightClick;onMiddleClick;onKeyDown;onKeyUp;onKeyRepeat;onCancel;onComplete;onInterrupt;onEnter;onExit}class ul extends ll{static id="root";static initial="";static children=()=>[];onKeyDown=e=>{if("KeyZ"===e.code&&!e.shiftKey&&!e.ctrlKey){const t=this.getCurrent();t&&"idle"===t.getCurrent()?.id&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...e,onInteractionEnd:t.id})}}}var dl=Object.defineProperty,hl=Object.getOwnPropertyDescriptor,pl=(e,t,n,r)=>{for(var o,i=r>1?void 0:r?hl(t,n):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(r?o(t,n,i):o(i))||i);return r&&i&&dl(t,n,i),i};class fl extends Ca.EventEmitter{constructor({store:e,user:t,shapeUtils:n,tools:r,getContainer:o,initialState:i,inferDarkMode:s}){super(),this.store=e,this.snaps=new Oc(this),this.user=new Kc(t??ka(),s??!1),this.getContainer=o??(()=>document.body),this.textMeasure=new Bc(this),this.root=new class extends ul{static initial=i??""}(this),this.root.children={};const a=Ha(n),c=new Set(Object.keys(e.schema.types.shape.migrations.subTypeMigrations));for(const e of a){if(!c.has(e.type))throw Error(`Editor and store have different shapes: "${e.type}" was passed into the editor but not the schema`);c.delete(e.type)}if(c.size>0)throw Error(`Editor and store have different shapes: "${[...c][0]}" is present in the store schema but not provided to the editor`);const l={},u={},d=new Map;for(const e of a){const t=new e(this);l[e.type]=t;const n=Dn(e.props??{});u[e.type]=n;for(const e of n.keys())if(d.has(e.id)){if(d.get(e.id)!==e)throw Error(`Multiple style props with id "${e.id}" in use. Style prop IDs must be unique.`)}else d.set(e.id,e)}this.shapeUtils=l,this.styleProps=u;for(const e of[...r]){if(Ie(this.root.children,e.id))throw Error(`Can't override tool with id "${e.id}"`);this.root.children[e.id]=new e(this,this.root)}this.environment=new vc(this),this.scribbles=new Ec(this);const h=new Set,p=e=>{const t=this.getShape(e);if(!t)return;const{start:n,end:r}=t.props,o="binding"===n.type?this.getShape(n.boundShapeId):void 0,i="binding"===r.type?this.getShape(r.boundShapeId):void 0,s=this.getAncestorPageId(t);if(!s)return;let a;if(o&&i)a=this.findCommonAncestor([o,i])??s;else{if(!o&&!i)return;{const e=(o||i)?.parentId;a=e&&e===t.parentId?t.parentId:s}}a&&a!==t.parentId&&this.reparentShapes([e],a);const c=this.getShape(e);if(!c)throw Error("no reparented arrow");const l=this.getShapeNearestSibling(c,o),u=this.getShapeNearestSibling(c,i);let d,h;if(l&&u)d=l.index>u.index?l:u;else if(l&&!u)d=l;else{if(!u||l)return;d=u}const p=this.getSortedChildIdsForParent(d.parentId).map((e=>this.getShape(e))).filter((e=>e.index>d.index));if(p.length){const e=p.find((e=>"arrow"!==e.type));if(c.index>d.index&&(!e||c.index<e.index))return;h=dc(d.index,p[0].index)}else h=hc(d.index);h!==c.index&&this.updateShapes([{id:e,type:"arrow",index:h}])},f=(e,t)=>{const{x:n,y:r}=Yc(this,e)[t];this.store.put([{...e,props:{...e.props,[t]:{type:"point",x:n,y:r}}}])},g=e=>{for(const t of["start","end"]){const n=e.props[t];if("binding"!==n.type)continue;const r=this.getShape(n.boundShapeId),o=this.getAncestorPageId(e)===this.getAncestorPageId(r);r&&o||f(e,t)}p(e.id)},m=(e,t)=>{let n=null;const r=e.selectedShapeIds.filter((e=>!t.has(e)));r.length!==e.selectedShapeIds.length&&(n||(n={...e}),n.selectedShapeIds=r);const o=e.erasingShapeIds.filter((e=>!t.has(e)));o.length!==e.erasingShapeIds.length&&(n||(n={...e}),n.erasingShapeIds=o),e.hoveredShapeId&&t.has(e.hoveredShapeId)&&(n||(n={...e}),n.hoveredShapeId=null),e.editingShapeId&&t.has(e.editingShapeId)&&(n||(n={...e}),n.editingShapeId=null);const i=e.hintingShapeIds.filter((e=>!t.has(e)));return i.length!==e.hintingShapeIds.length&&(n||(n={...e}),n.hintingShapeIds=i),e.focusedGroupId&&t.has(e.focusedGroupId)&&(n||(n={...e}),n.focusedGroupId=null),n};if(this.sideEffects=new Ac(this),this.sideEffects.registerBatchCompleteHandler((()=>{for(const e of h){h.delete(e);const t=this.getShape(e);if(!t)continue;const n=this.getShapeUtil(t),r=n.onChildrenChange?.(t);r?.length&&this.updateShapes(r,{squashing:!0})}this.emit("update")})),this.sideEffects.registerBeforeDeleteHandler("shape",(e=>{e.parentId&&Tn(e.parentId)&&h.add(e.parentId);const t=this._getArrowBindingsIndex().get()[e.id];if(t?.length)for(const{arrowId:e,handleId:n}of t){const t=this.getShape(e);t&&f(t,n)}const n=new Set([e.id]),r=he(this.getPageStates().map((e=>m(e,n))));r.length&&this.store.put(r)})),this.sideEffects.registerBeforeDeleteHandler("page",(e=>{if(this.getInstanceState().currentPageId!==e.id)return;const t=this.getPages().find((t=>t.id!==e.id))?.id;if(!t)return;this.store.put([{...this.getInstanceState(),currentPageId:t}]);const n=Ut.createId(e.id),r=sn.createId(e.id);this.store.remove([n,r])})),this.sideEffects.registerAfterChangeHandler("shape",((e,t)=>{if(this.isShapeOfType(t,"arrow")&&g(t),e.parentId!==t.parentId){const e=e=>{const t=this._getArrowBindingsIndex().get()[e];if(t?.length)for(const e of t)p(e.arrowId)};e(t.id),this.visitDescendants(t.id,e)}if(e.parentId!==t.parentId&&Jt(t.parentId)){const n=new Set([e.id]);this.visitDescendants(e.id,(e=>{n.add(e)}));for(const e of this.getPageStates()){if(e.pageId===t.parentId)continue;const r=m(e,n);r&&this.store.put([r])}}e.parentId&&Tn(e.parentId)&&h.add(e.parentId),t.parentId!==e.parentId&&Tn(t.parentId)&&h.add(t.parentId)})),this.sideEffects.registerAfterChangeHandler("instance_page_state",((e,t)=>{if(e?.selectedShapeIds!==t?.selectedShapeIds){const e=t.selectedShapeIds.filter((e=>{let n=this.getShape(e)?.parentId;for(;Tn(n);){if(t.selectedShapeIds.includes(n))return!1;n=this.getShape(n)?.parentId}return!0}));let n=null;if(e.length>0){const t=this.findCommonAncestor(he(e.map((e=>this.getShape(e)))),(e=>this.isShapeOfType(e,"group")));t&&(n=t)}else t?.focusedGroupId&&(n=t.focusedGroupId);e.length===t.selectedShapeIds.length&&n===t.focusedGroupId||this.store.put([{...t,selectedShapeIds:e,focusedGroupId:n??null}])}})),this.sideEffects.registerAfterCreateHandler("shape",(e=>{this.isShapeOfType(e,"arrow")&&g(e)})),this.sideEffects.registerAfterCreateHandler("page",(e=>{const t=Ut.createId(e.id),n=sn.createId(e.id);this.store.has(t)||this.store.put([Ut.create({id:t})]),this.store.has(n)||this.store.put([sn.create({id:n,pageId:e.id})])})),this._currentPageShapeIds=((e,t)=>{const n=e.query.ids("shape");let r=null;function o(){const o=t();return r=o,new Set([...n.get()].filter((t=>yc(e,o,e.get(t)))))}return J("_shapeIdsInCurrentPage",((n,i)=>{if(G(n))return o();const s=t();if(s!==r)return o();const a=e.history.getDiffSince(i);if(a===w)return o();const c=new ue(n);for(const t of a){for(const n of Object.values(t.added))Mn(n)&&yc(e,s,n)&&c.add(n.id);for(const[n,r]of Object.values(t.updated))Mn(r)&&(yc(e,s,r)?c.add(r.id):c.remove(r.id));for(const e of Object.keys(t.removed))Tn(e)&&c.remove(e)}const l=c.get();return l?Y(l.value,l.diff):n}))})(this.store,(()=>this.getCurrentPageId())),this._parentIdsToChildIds=(e=>{const t=e.query.ids("shape");function n(){const n={},r=t.get(),o=Array(r.size);return r.forEach((t=>o.push(e.get(t)))),o.sort(fc),o.forEach((e=>{n[e.parentId]||(n[e.parentId]=[]),n[e.parentId].push(e.id)})),n}return J("parentsToChildrenWithIndexes",((t,r)=>{if(G(t))return n();const o=e.history.getDiffSince(r);if(o===w)return n();if(0===o.length)return t;let i=null;const s=e=>{i||(i={...t}),i[e]?i[e]===t[e]&&(i[e]=[...i[e]]):i[e]=[]},a=new Set;let c;for(let e=0,t=o.length;e<t;e++){c=o[e];for(const e of Object.values(c.added))Mn(e)&&(s(e.parentId),i[e.parentId].push(e.id),a.add(i[e.parentId]));for(const[e,t]of Object.values(c.updated))if(Mn(t)&&Mn(e))if(e.parentId!==t.parentId)s(e.parentId),s(t.parentId),i[e.parentId].splice(i[e.parentId].indexOf(t.id),1),i[t.parentId].push(t.id),a.add(i[t.parentId]);else if(e.index!==t.index){s(t.parentId);const e=i[t.parentId].indexOf(t.id);i[t.parentId][e]=t.id,a.add(i[t.parentId])}for(const e of Object.values(c.removed))Mn(e)&&(s(e.parentId),i[e.parentId].splice(i[e.parentId].indexOf(e.id),1))}for(const t of a){const n=he(t.map((t=>e.get(t))));n.sort(fc),t.splice(0,t.length,...n.map((e=>e.id)))}return i??t}))})(this.store),this.disposables.add(this.store.listen((e=>{this.emit("change",e)}))),this.store.ensureStoreIsUsable(),this._setInstancePageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]},{ephemeral:!0}),i&&void 0===this.root.children[i])throw Error(`No state found for initialState "${i}".`);this.root.enter(void 0,"initial"),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.updateRenderingBounds(),requestAnimationFrame((()=>{this._tickManager.start()}))}store;root;disposables=new Set;_tickManager=new $c(this);snaps;user;textMeasure;environment;scribbles;getContainer;sideEffects;dispose(){this.disposables.forEach((e=>e())),this.disposables.clear()}shapeUtils;styleProps;getShapeUtil(e){const t="string"==typeof e?e:e.type,n=Pe(this.shapeUtils,t);return me(n,`No shape util found for type "${t}"`),n}history=new Cc(this,(e=>{this.annotateError(e,{origin:"history.batch",willCrashApp:!0}),this.crash(e)}));undo(){return this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}get canUndo(){return He("canUndo"),this.getCanUndo()}redo(){return this.history.redo(),this}getCanRedo(){return this.history.getNumRedos()>0}get canRedo(){return He("canRedo"),this.getCanRedo()}mark(e,t,n){return this.history.mark(e,t,n),this}bail(){return this.history.bail(),this}bailToMark(e){return this.history.bailToMark(e),this}batch(e){return this.history.batch(e),this}_getArrowBindingsIndex(){return(e=>{const{store:t}=e,n=t.query.filterHistory("shape"),r=t.query.records("shape",(()=>({type:{eq:"arrow"}})));function o(){const e=r.get(),t={};for(const n of e){const{start:e,end:r}=n.props;if("binding"===e.type){const r=t[e.boundShapeId];r?r.push({arrowId:n.id,handleId:"start"}):t[e.boundShapeId]=[{arrowId:n.id,handleId:"start"}]}if("binding"===r.type){const e=t[r.boundShapeId];e?e.push({arrowId:n.id,handleId:"end"}):t[r.boundShapeId]=[{arrowId:n.id,handleId:"end"}]}}return t}return J("arrowBindingsIndex",((t,r)=>{if(G(t))return o();const i=t,s=n.getDiffSince(r);if(s===w)return o();let a;function c(e){a||(a={...i}),a[e]?a[e]===i[e]&&(a[e]=[...a[e]]):a[e]=[]}function l(e,t,n){c(e),a[e]=a[e].filter((e=>e.arrowId!==t||e.handleId!==n)),0===a[e].length&&delete a[e]}function u(e,t,n){c(e),a[e].push({arrowId:t,handleId:n})}for(const t of s){for(const n of Object.values(t.added))if(e.isShapeOfType(n,"arrow")){const{start:e,end:t}=n.props;"binding"===e.type&&u(e.boundShapeId,n.id,"start"),"binding"===t.type&&u(t.boundShapeId,n.id,"end")}for(const[n,r]of Object.values(t.updated))if(e.isShapeOfType(n,"arrow")&&e.isShapeOfType(r,"arrow"))for(const e of["start","end"]){const t=n.props[e],o=r.props[e];"binding"===t.type&&"point"===o.type?l(t.boundShapeId,n.id,e):"point"===t.type&&"binding"===o.type?u(o.boundShapeId,r.id,e):"binding"===t.type&&"binding"===o.type&&t.boundShapeId!==o.boundShapeId&&(l(t.boundShapeId,n.id,e),u(o.boundShapeId,r.id,e))}for(const n of Object.values(t.removed))if(e.isShapeOfType(n,"arrow")){const{start:e,end:t}=n.props;"binding"===e.type&&l(e.boundShapeId,n.id,"start"),"binding"===t.type&&l(t.boundShapeId,n.id,"end")}}return a??i}))})(this)}getArrowsBoundTo(e){return this._getArrowBindingsIndex().get()[e]||E}getArrowInfoCache(){return this.store.createComputedCache("arrow infoCache",(e=>Hc(e)?Jc(this,e):ol(this,e)))}getArrowInfo(e){const t="string"==typeof e?e:e.id;return this.getArrowInfoCache().get(t)}annotateError(e,{origin:t,willCrashApp:n,tags:r,extras:o}){const i=this.createErrorAnnotations(t,n);return ve(e,{tags:{...i.tags,...r},extras:{...i.extras,...o}}),n&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(e,t){try{const n=this.getEditingShapeId();return{tags:{origin:e,willCrashApp:t},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes(),editingShape:n?this.getShape(n):void 0,inputs:this.inputs}}}catch{return{tags:{origin:e,willCrashApp:t},extras:{}}}}_crashingError=null;getCrashingError(){return this._crashingError}crash(e){return this._crashingError=e,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:e}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(e){const t=e.split(".").reverse();let n=this.root;for(;t.length>0;){const e=t.pop();if(!e)return!0;const r=n.getCurrent();if(r?.id!==e)return!1;if(0===t.length)return!0;n=r}return!1}isInAny(...e){return e.some((e=>this.isIn(e)))}setCurrentTool(e,t={}){return this.root.transition(e,t),this}getCurrentTool(){return this.root.getCurrent()}get currentTool(){return He("currentTool"),this.getCurrentTool()}getCurrentToolId(){const e=this.getCurrentTool();return e?e.getCurrentToolIdMask()??e.id:""}get currentToolId(){return He("currentToolId"),this.getCurrentToolId()}getStateDescendant(e){const t=e.split(".").reverse();let n=this.root;for(;t.length>0;){const e=t.pop();if(!e)return n;const r=n.children?.[e];if(!r)return;n=r}return n}getDocumentSettings(){return this.store.get(pn)}get documentSettings(){return He("documentSettings"),this.getDocumentSettings()}updateDocumentSettings(e){return this.store.put([{...this.getDocumentSettings(),...e}]),this}getInstanceState(){return this.store.get(tn)}get instanceState(){return He("instanceState"),this.getInstanceState()}updateInstanceState(e,t){return this._updateInstanceState(e,{ephemeral:!0,squashing:!0,...t}),void 0!==e.isChangingStyle&&(clearTimeout(this._isChangingStyleTimeout),!0===e.isChangingStyle&&(this._isChangingStyleTimeout=setTimeout((()=>{this.updateInstanceState({isChangingStyle:!1})}),2e3))),this}_updateInstanceState=this.history.createCommand("updateInstanceState",((e,t)=>{const n=this.store.get(this.getInstanceState().id);return{data:{prev:n,next:{...n,...e}},ephemeral:!1,squashing:!1,...t}}),{do:({next:e})=>{this.store.put([e])},undo:({prev:e})=>{this.store.put([e])},squash:({prev:e},{next:t})=>({prev:e,next:t})});_isChangingStyleTimeout=-1;getOpenMenus(){return this.getInstanceState().openMenus}get openMenus(){return He("openMenus"),this.getOpenMenus()}addOpenMenu(e){const t=new Set(this.getOpenMenus());return t.has(e)||(t.add(e),this.updateInstanceState({openMenus:[...t]})),this}deleteOpenMenu(e){const t=new Set(this.getOpenMenus());return t.has(e)&&(t.delete(e),this.updateInstanceState({openMenus:[...t]})),this}getIsMenuOpen(){return this.getOpenMenus().length>0}get isMenuOpen(){return He("isMenuOpen"),this.getIsMenuOpen()}setCursor=e=>(this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...e}},{ephemeral:!0}),this);getPageStates(){return this._getPageStatesQuery().get()}get pageStates(){return He("pageStates"),this.getPageStates()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}get currentPageState(){return He("currentPageState"),this.getCurrentPageState()}_getCurrentPageStateId(){return sn.createId(this.getCurrentPageId())}updateCurrentPageState(e,t){return this._setInstancePageState(e,t),this}_setInstancePageState=this.history.createCommand("setInstancePageState",((e,t)=>({data:{prev:this.store.get(e.id??this.getCurrentPageState().id),partial:e},...t})),{do:({prev:e,partial:t})=>{this.store.update(e.id,(e=>({...e,...t})))},undo:({prev:e})=>{this.store.update(e.id,(()=>e))}});getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}get selectedShapeIds(){return He("selectedShapeIds"),this.getSelectedShapeIds()}getSelectedShapes(){const{selectedShapeIds:e}=this.getCurrentPageState();return he(e.map((e=>this.store.get(e))))}get selectedShapes(){return He("selectedShapes"),this.getSelectedShapes()}setSelectedShapes(e,t){const n=e.map((e=>"string"==typeof e?e:e.id));return this._setSelectedShapes(n,t),this}_setSelectedShapes=this.history.createCommand("setSelectedShapes",((e,t)=>{const{selectedShapeIds:n}=this.getCurrentPageState(),r=new Set(n);return e.length===r.size&&e.every((e=>r.has(e)))?null:{data:{selectedShapeIds:e,prevSelectedShapeIds:n},preservesRedoStack:!0,...t}}),{do:({selectedShapeIds:e})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:e}])},undo:({prevSelectedShapeIds:e})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:e}])},squash:({prevSelectedShapeIds:e},{selectedShapeIds:t})=>({selectedShapeIds:t,prevSelectedShapeIds:e})});isAncestorSelected(e){const t="string"==typeof e?e:e?.id??null,n=this.getShape(t);if(!n)return!1;const r=this.getSelectedShapeIds();return!!this.findShapeAncestor(n,(e=>r.includes(e.id)))}select(...e){const t="string"==typeof e[0]?e:e.map((e=>e.id));return this.setSelectedShapes(t),this}deselect(...e){const t="string"==typeof e[0]?e:e.map((e=>e.id)),n=this.getSelectedShapeIds();return n.length>0&&t.length>0&&this.setSelectedShapes(n.filter((e=>!t.includes(e)))),this}selectAll(){const e=this.getSortedChildIdsForParent(this.getCurrentPageId());return e.length<=0||this.setSelectedShapes(this._getUnlockedShapeIds(e)),this}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShape(){const e=this.getSelectedShapes();return 1===e.length?e[0]:null}get onlySelectedShape(){return He("onlySelectedShape"),this.getOnlySelectedShape()}getSelectionPageBounds(){const e=this.getCurrentPageState().selectedShapeIds;return 0===e.length?null:fo.Common(he(e.map((e=>this.getShapePageBounds(e)))))}get selectionPageBounds(){return He("selectionPageBounds"),this.getSelectionPageBounds()}getSelectionRotation(){const e=this.getSelectedShapeIds();if(0===e.length)return 0;if(1===e.length)return this.getShapePageTransform(this.getSelectedShapeIds()[0]).rotation();const t=e.map((e=>this.getShapePageTransform(e).rotation()));return t.every((e=>Math.abs(e-t[0])<Math.PI/180))?this.getShapePageTransform(e[0]).rotation():0}get selectionRotation(){return He("selectionRotation"),this.getSelectionRotation()}getSelectionRotatedPageBounds(){const e=this.getSelectedShapeIds();if(0===e.length)return;const t=this.getSelectionRotation();if(0===t)return this.getSelectionPageBounds();if(1===e.length){const t=this.getShapeGeometry(e[0]).bounds.clone(),n=this.getShapePageTransform(e[0]);return t.point=n.applyToPoint(t.point),t}const n=fo.FromPoints(this.getSelectedShapeIds().flatMap((e=>{const t=this.getShapePageTransform(e);return t?t.applyToPoints(this.getShapeGeometry(e).vertices):[]})).map((e=>ho.Rot(e,-t))));return n.point=n.point.rot(t),n}get selectionRotatedPageBounds(){return He("selectionRotatedPageBounds"),this.getSelectionRotatedPageBounds()}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}get focusedGroupId(){return He("focusedGroupId"),this.getFocusedGroupId()}getFocusedGroup(){const e=this.getFocusedGroupId();return e?this.getShape(e):void 0}get focusedGroup(){return He("focusedGroup"),this.getFocusedGroup()}setFocusedGroup(e){const t="string"==typeof e?e:e?.id??null;if(null!==t){const e=this.getShape(t);if(!e)throw Error(`Editor.setFocusedGroup: Shape with id ${t} does not exist`);if(!this.isShapeOfType(e,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${e.type}`)}return t===this.getFocusedGroupId()||this._setFocusedGroupId(t),this}_setFocusedGroupId=this.history.createCommand("setFocusedGroupId",(e=>{const t=this.getCurrentPageState().focusedGroupId;if(t!==e)return{data:{prev:t,next:e},preservesRedoStack:!0,squashing:!0}}),{do:({next:e})=>{this.store.update(this.getCurrentPageState().id,(t=>({...t,focusedGroupId:e})))},undo:({prev:e})=>{this.store.update(this.getCurrentPageState().id,(t=>({...t,focusedGroupId:e})))},squash:({prev:e},{next:t})=>({prev:e,next:t})});popFocusedGroupId(){const e=this.getFocusedGroup();if(e){const t=this.findShapeAncestor(e,(e=>this.isShapeOfType(e,"group")));this.setFocusedGroup(t?.id??null),this.select(e.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}get editingShapeId(){return He("editingShapeId"),this.getEditingShapeId()}getEditingShape(){const e=this.getEditingShapeId();return e?this.getShape(e):void 0}get editingShape(){return He("editingShape"),this.getEditingShape()}setEditingShape(e){const t="string"==typeof e?e:e?.id??null;if(t!==this.getEditingShapeId()){if(t){const e=this.getShape(t);if(e&&this.getShapeUtil(e).canEdit(e))return this._setInstancePageState({editingShapeId:t}),this}this._setInstancePageState({editingShapeId:null})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}get hoveredShapeId(){return He("hoveredShapeId"),this.getHoveredShapeId()}getHoveredShape(){const e=this.getHoveredShapeId();return e?this.getShape(e):void 0}get hoveredShape(){return He("hoveredShape"),this.getHoveredShape()}setHoveredShape(e){const t="string"==typeof e?e:e?.id??null;return t===this.getHoveredShapeId()||this.updateCurrentPageState({hoveredShapeId:t},{ephemeral:!0}),this}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}get hintingShapeIds(){return He("hintingShapeIds"),this.getHintingShapeIds()}getHintingShape(){return he(this.getHintingShapeIds().map((e=>this.getShape(e))))}get hintingShape(){return He("hintingShape"),this.getHintingShape()}setHintingShapes(e){const t="string"==typeof e[0]?e:e.map((e=>e.id));return this.updateCurrentPageState({hintingShapeIds:de(t)},{ephemeral:!0}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}get erasingShapeIds(){return He("erasingShapeIds"),this.getErasingShapeIds()}getErasingShapes(){return he(this.getErasingShapeIds().map((e=>this.getShape(e))))}get erasingShapes(){return He("erasingShapes"),this.getErasingShapes()}setErasingShapes(e){const t="string"==typeof e[0]?e:e.map((e=>e.id));t.sort();const n=this.getErasingShapeIds();if(t.length===n.length){for(let e=0;e<t.length;e++)if(t[e]!==n[e]){this._setInstancePageState({erasingShapeIds:t},{ephemeral:!0});break}}else this._setInstancePageState({erasingShapeIds:t},{ephemeral:!0});return this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}get croppingShapeId(){return He("croppingShapeId"),this.getCroppingShapeId()}setCroppingShape(e){const t="string"==typeof e?e:e?.id??null;if(t!==this.getCroppingShapeId())if(t){const e=this.getShape(t),n=this.getShapeUtil(e);e&&n.canCrop(e)&&this.updateCurrentPageState({croppingShapeId:t})}else this.updateCurrentPageState({croppingShapeId:null});return this}getCameraId(){return Ut.createId(this.getCurrentPageId())}getCamera(){return this.store.get(this.getCameraId())}getZoomLevel(){return this.getCamera().z}get zoomLevel(){return He("zoomLevel"),this.getZoomLevel()}_setCamera(e){const t=this.getCamera();return t.x===e.x&&t.y===e.y&&t.z===e.z||this.batch((()=>{this.store.put([{...t,...e}]);const{currentScreenPoint:n}=this.inputs;this.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:n,pointerId:-10,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.getInstanceState().isPenMode??!1}),this._tickCameraState()})),this}setCamera(e,t){const n=Number.isFinite(e.x)?e.x:0,r=Number.isFinite(e.y)?e.y:0,o=Number.isFinite(e.z)?e.z:this.getZoomLevel();if(this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),t){const{width:e,height:i}=this.getViewportScreenBounds();return this._animateToViewport(new fo(-n,-r,e/o,i/o),t)}return this._setCamera({x:n,y:r,z:o}),this}centerOnPoint(e,t){if(!this.getInstanceState().canMoveCamera)return this;const{width:n,height:r}=this.getViewportPageBounds();return this.setCamera({x:-(e.x-n/2),y:-(e.y-r/2),z:this.getCamera().z},t),this}zoomToContent(){const e=this.getSelectionPageBounds()??this.getCurrentPageBounds();return e&&this.zoomToBounds(e,Math.min(1,this.getZoomLevel()),{duration:220}),this}zoomToFit(e){if(!this.getInstanceState().canMoveCamera)return this;const t=[...this.getCurrentPageShapeIds()];if(t.length<=0)return this;const n=fo.Common(he(t.map((e=>this.getShapePageBounds(e)))));return this.zoomToBounds(n,void 0,e),this}resetZoom(e=this.getViewportScreenCenter(),t){if(!this.getInstanceState().canMoveCamera)return this;const{x:n,y:r,z:o}=this.getCamera(),{x:i,y:s}=e;return this.setCamera({x:n+(i/1-i)-(i/o-i),y:r+(s/1-s)-(s/o-s),z:1},t),this}zoomIn(e=this.getViewportScreenCenter(),t){if(!this.getInstanceState().canMoveCamera)return this;const{x:n,y:r,z:o}=this.getCamera();let i=Jo;for(let e=1;e<Zo.length;e++){const t=Zo[e];if(!(t-o<=(t-Zo[e-1])/2)){i=t;break}}const{x:s,y:a}=e;return this.setCamera({x:n+(s/i-s)-(s/o-s),y:r+(a/i-a)-(a/o-a),z:i},t),this}zoomOut(e=this.getViewportScreenCenter(),t){if(!this.getInstanceState().canMoveCamera)return this;const{x:n,y:r,z:o}=this.getCamera();let i=Qo;for(let e=Zo.length-1;e>0;e--){const t=Zo[e-1],n=Zo[e];if(!(n-o>=(n-t)/2)){i=t;break}}const{x:s,y:a}=e;return this.setCamera({x:n+(s/i-s)-(s/o-s),y:r+(a/i-a)-(a/o-a),z:i},t),this}zoomToSelection(e){if(!this.getInstanceState().canMoveCamera)return this;const t=this.getSelectionPageBounds();return t?(this.zoomToBounds(t,Math.max(1,this.getZoomLevel()),e),this):this}panZoomIntoView(e,t){if(!this.getInstanceState().canMoveCamera)return this;if(e.length<=0)return this;const n=fo.Common(he(e.map((e=>this.getShapePageBounds(e))))),r=this.getViewportPageBounds();if(r.h<n.h||r.w<n.w)return this.zoomToBounds(n,this.getCamera().z,t),this;{const e=this.getViewportPageBounds().clone().expandBy(-32/this.getZoomLevel());let r=0,o=0;e.maxY<n.maxY?o=e.maxY-n.maxY:e.minY>n.minY&&(o=e.minY-n.minY),e.maxX<n.maxX?r=e.maxX-n.maxX:e.minX>n.minX&&(r=e.minX-n.minX);const i=this.getCamera();this.setCamera({x:i.x+r,y:i.y+o,z:i.z},t)}return this}zoomToBounds(e,t,n){if(!this.getInstanceState().canMoveCamera)return this;const r=this.getViewportScreenBounds(),o=Math.min(256,.28*r.width);let i=xo(Math.min((r.width-o)/e.width,(r.height-o)/e.height),Qo,Jo);return void 0!==t&&(i=Math.min(t,i)),this.setCamera({x:-e.minX+(r.width-e.width*i)/2/i,y:-e.minY+(r.height-e.height*i)/2/i,z:i},n),this}pan(e,t){if(!this.getInstanceState().canMoveCamera)return this;const{x:n,y:r,z:o}=this.getCamera();return this.setCamera({x:n+e.x/o,y:r+e.y/o,z:o},t),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_viewportAnimation=null;_animateViewport(e){if(!this._viewportAnimation)return;const t=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",t),this._viewportAnimation=null};this.once("stop-camera-animation",t),this._viewportAnimation.elapsed+=e;const{elapsed:n,easing:r,duration:o,start:i,end:s}=this._viewportAnimation;if(n>o)return this._setCamera({x:-s.x,y:-s.y,z:this.getViewportScreenBounds().width/s.width}),void t();const a=r(1-(o-n)/o),c=i.minX+(s.minX-i.minX)*a,l=i.minY+(s.minY-i.minY)*a,u=i.maxX+(s.maxX-i.maxX)*a;this._setCamera({x:-c,y:-l,z:this.getViewportScreenBounds().width/(u-c)})}_animateToViewport(e,t={}){const{duration:n=0,easing:r=uo.easeInOutCubic}=t,o=this.user.getAnimationSpeed(),i=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),0===n||0===o?this._setCamera({x:-e.x,y:-e.y,z:this.getViewportScreenBounds().width/e.width}):(this._viewportAnimation={elapsed:0,duration:n/o,easing:r,start:i.clone(),end:e.clone()},this.addListener("tick",this._animateViewport),this)}slideCamera(e={}){if(!this.getInstanceState().canMoveCamera)return this;if(this.stopCameraAnimation(),0===this.user.getAnimationSpeed())return this;const{speed:t,friction:n,direction:r,speedThreshold:o=.01}=e;let i=Math.min(t,1);const s=()=>{this.removeListener("tick",a),this.removeListener("stop-camera-animation",s)};this.once("stop-camera-animation",s);const a=e=>{const{x:t,y:a,z:c}=this.getCamera(),l=ho.Mul(r,i*e/c);i*=1-n,i<o?s():this._setCamera({x:t+l.x,y:a+l.y,z:c})};return this.addListener("tick",a),this}animateToUser(e){const t=[...this.store.query.records("instance_presence",(()=>({userId:{eq:e}}))).get()].sort(((e,t)=>e.lastActivityTimestamp-t.lastActivityTimestamp)).pop();return t?(this.batch((()=>{null!==this.getInstanceState().followingUserId&&this.stopFollowingUser();const n=t.currentPageId===this.getCurrentPageId();n||this.setCurrentPage(t.currentPageId);const r=n?{duration:500}:void 0;this.centerOnPoint(t.cursor,r);const{highlightedUserIds:o}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...o,e]}),setTimeout((()=>{const t=[...this.getInstanceState().highlightedUserIds],n=t.indexOf(e);n<0||(t.splice(n,1),this.updateInstanceState({highlightedUserIds:t}))}),3e3)})),this):this}animateToShape(e,t=ni){if(!this.getInstanceState().canMoveCamera)return this;const n=this.getViewportScreenBounds().clone().expandBy(-32),r=n.width/n.height,o=this.getShapePageBounds(e);if(!o)return this;const i=o.width/o.height,s=o.clone(),a=o.width/n.width;return s.width+=(n.minX+n.maxX)*a,s.height+=(n.minY+n.maxY)*a,s.x-=n.minX*a,s.y-=n.minY*a,i>r?(s.height=o.width/r,s.y-=(s.height-o.height)/2):(s.width=o.height*r,s.x-=(s.width-o.width)/2),this._animateToViewport(s,t)}_willSetInitialBounds=!0;updateViewportScreenBounds(e=!1){const t=this.getContainer();if(!t)return this;const n=t.getBoundingClientRect(),r=new fo(n.left||n.x,n.top||n.y,Math.max(n.width,1),Math.max(n.height,1)),o=r.equals(this.getViewportScreenBounds()),{_willSetInitialBounds:i}=this;if(o)this._willSetInitialBounds=!1;else if(i)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:r.toJson()},{squashing:!0,ephemeral:!0});else if(e&&!this.getInstanceState().followingUserId){const e=this.getViewportPageCenter();this.updateInstanceState({screenBounds:r.toJson()},{squashing:!0,ephemeral:!0}),this.centerOnPoint(e)}else this.updateInstanceState({screenBounds:r.toJson()},{squashing:!0,ephemeral:!0});return this._tickCameraState(),this.updateRenderingBounds(),this}getViewportScreenBounds(){const{x:e,y:t,w:n,h:r}=this.getInstanceState().screenBounds;return new fo(e,t,n,r)}get viewportScreenBounds(){return He("viewportScreenBounds"),this.getViewportScreenBounds()}getViewportScreenCenter(){return this.getViewportScreenBounds().center}get viewportScreenCenter(){return He("viewportScreenCenter"),this.getViewportScreenCenter()}getViewportPageBounds(){const{w:e,h:t}=this.getViewportScreenBounds(),{x:n,y:r,z:o}=this.getCamera();return new fo(-n,-r,e/o,t/o)}get viewportPageBounds(){return He("viewportPageBounds"),this.getViewportPageBounds()}getViewportPageCenter(){return this.getViewportPageBounds().center}get viewportPageCenter(){return He("viewportPageCenter"),this.getViewportPageCenter()}screenToPage(e){const{screenBounds:t}=this.store.unsafeGetWithoutCapture(tn),{x:n,y:r,z:o=1}=this.getCamera();return{x:(e.x-t.x)/o-n,y:(e.y-t.y)/o-r,z:e.z??.5}}pageToScreen(e){const{screenBounds:t}=this.store.unsafeGetWithoutCapture(tn),{x:n,y:r,z:o=1}=this.getCamera();return{x:(e.x+n)*o+t.x,y:(e.y+r)*o+t.y,z:e.z??.5}}startFollowingUser(e){const t=this.store.query.records("instance_presence",(()=>({userId:{eq:e}}))),n=this.user.getId();if(n||console.warn("You should set the userId for the current instance before following a user"),t.get().some((e=>e.followingUserId===n)))return this;B((()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:e},{ephemeral:!0})}));const r=()=>{this.removeListener("frame",i),this.removeListener("stop-following",r)};let o=!1;const i=()=>{const r=[...t.get()].sort(((e,t)=>e.lastActivityTimestamp-t.lastActivityTimestamp)).pop();if(!r)return void this.stopFollowingUser();const i=r.currentPageId===this.getCurrentPageId(),s=i?.5:1;if(!i)return this.stopFollowingUser(),this.setCurrentPage(r.currentPageId),void this.startFollowingUser(e);const{center:a,width:c,height:l}=this.getViewportPageBounds(),u=fo.From(r.screenBounds),d=u.width/r.camera.z,h=u.height/r.camera.z,p=new ho(d/2-r.camera.x,h/2-r.camera.y),f=c+(d-c)*s,g=l+(h-l)*s,m=r.followingUserId===n?l/g:Math.min(c/f,l/g),_=xo(this.getCamera().z*m,Qo,Jo),y=this.getViewportScreenBounds().w/_,w=this.getViewportScreenBounds().h/_,v=p.sub(a),b=ho.Add(a,ho.Mul(v,s)),x=ho.Sub(b,a).len(),S=Math.abs(_-this.getCamera().z);x<.1&&S<.005?o=!0:o&&x<.2&&S<.05||(o=!1,this.stopCameraAnimation(),this._setCamera({x:-(b.x-y/2),y:-(b.y-w/2),z:_}))};return this.once("stop-following",r),this.addListener("frame",i),this}stopFollowingUser(){return this.updateInstanceState({followingUserId:null},{ephemeral:!0}),this.emit("stop-following"),this}_cameraState=K("camera state","idle");getCameraState(){return this._cameraState.get()}get cameraState(){return He("cameraState"),this.getCameraState()}_cameraStateTimeoutRemaining=0;_lastUpdateRenderingBoundsTimestamp=Date.now();_decayCameraStateTimeout=e=>{this._cameraStateTimeoutRemaining-=e,this._cameraStateTimeoutRemaining<=0&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"),this.updateRenderingBounds())};_tickCameraState=()=>{this._cameraStateTimeoutRemaining=64;const e=Date.now();"idle"===this._cameraState.__unsafe__getWithoutCapture()?(this._lastUpdateRenderingBoundsTimestamp=e,this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout)):e-this._lastUpdateRenderingBoundsTimestamp>620&&this.updateRenderingBounds()};getUnorderedRenderingShapes(e){const t=[];let n=4e3,r=Yo;const o=this.getEditingShapeId(),i=this.getSelectedShapeIds(),s=this.getErasingShapeIds(),a=this.getRenderingBoundsExpanded(),c=Number.isFinite(this.renderingBoundsMargin),l=(u,d,h)=>{const p=this.getShape(u);if(!p)return;d*=p.opacity;let f=!1,g=!1;const m=this.getShapeUtil(p),_=this.getShapeMaskedPageBounds(u);e&&(g=!h&&s.includes(u),g&&(d*=.32),f=c&&m.canUnmount(p)&&o!==u&&(void 0===_||!a.includes(_)&&!i.includes(u))),t.push({id:u,shape:p,util:m,index:n,backgroundIndex:r,opacity:d,isCulled:f,maskedPageBounds:_}),n+=1,r+=1;const y=this.getSortedChildIdsForParent(u);if(!y.length)return;let w=null;m.providesBackgroundForChildren(p)&&(w=r,r=n,n+=Yo);for(const e of y)l(e,d,h||g);null!==w&&(r=w)};for(const e of this.getSortedChildIdsForParent(this.getCurrentPageId()))l(e,1,!1);return t}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(Be)}get renderingShapes(){return He("renderingShapes"),this.getRenderingShapes()}getRenderingBounds(){return this._renderingBounds.get()}get renderingBounds(){return He("renderingBounds"),this.getRenderingBounds()}_renderingBounds=K("rendering viewport",new fo);getRenderingBoundsExpanded(){return this._renderingBoundsExpanded.get()}get renderingBoundsExpanded(){return He("renderingBoundsExpanded"),this.getRenderingBoundsExpanded()}_renderingBoundsExpanded=K("rendering viewport expanded",new fo);updateRenderingBounds(){const e=this.getViewportPageBounds();return e.equals(this._renderingBounds.__unsafe__getWithoutCapture())||(this._renderingBounds.set(e.clone()),Number.isFinite(this.renderingBoundsMargin)?this._renderingBoundsExpanded.set(e.clone().expandBy(this.renderingBoundsMargin/this.getZoomLevel())):this._renderingBoundsExpanded.set(e)),this}renderingBoundsMargin=100;_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return this._getAllPagesQuery().get().sort(fc)}get pages(){return He("pages"),this.getPages()}getCurrentPage(){return this.getPage(this.getCurrentPageId())}get currentPage(){return He("currentPage"),this.getCurrentPage()}getCurrentPageId(){return this.getInstanceState().currentPageId}get currentPageId(){return He("currentPageId"),this.getCurrentPageId()}getPage(e){return this.store.get("string"==typeof e?e:e.id)}_currentPageShapeIds;getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}get currentPageShapeIds(){return He("currentPageShapeIds"),this.getCurrentPageShapeIds()}getPageShapeIds(e){const t="string"==typeof e?e:e.id,n=this.store.query.exec("shape",{parentId:{eq:t}});return this.getShapeAndDescendantIds(n.map((e=>e.id)))}setCurrentPage(e,t){const n="string"==typeof e?e:e.id;return this._setCurrentPageId(n,t),this}_setCurrentPageId=this.history.createCommand("setCurrentPage",((e,t)=>{if(this.store.has(e))return this.stopFollowingUser(),{data:{toId:e,fromId:this.getCurrentPageId()},squashing:!0,preservesRedoStack:!0,...t};console.error("Tried to set the current page id to a page that doesn't exist.")}),{do:({toId:e})=>{if(this.store.has(e)){if(!this.getPageStates().find((t=>t.pageId===e))){const t=Ut.create({id:Ut.createId(e)});this.store.put([t,sn.create({id:sn.createId(e),pageId:e})])}this.store.put([{...this.getInstanceState(),currentPageId:e}]),this.updateRenderingBounds()}},undo:({fromId:e})=>{this.store.has(e)&&(this.store.put([{...this.getInstanceState(),currentPageId:e}]),this.updateRenderingBounds())},squash:({fromId:e},{toId:t})=>({toId:t,fromId:e})});updatePage(e,t){return this._updatePage(e,t),this}_updatePage=this.history.createCommand("updatePage",((e,t)=>{if(this.getInstanceState().isReadonly)return null;const n=this.getPage(e.id);return n?{data:{prev:n,partial:e},...t}:null}),{do:({partial:e})=>{this.store.update(e.id,(t=>({...t,...e})))},undo:({prev:e,partial:t})=>{this.store.update(t.id,(()=>e))},squash:(e,t)=>({prev:{...e.prev,...t.prev},partial:t.partial})});createPage(e){return this._createPage(e),this}_createPage=this.history.createCommand("createPage",(e=>{if(this.getInstanceState().isReadonly)return null;if(this.getPages().length>=40)return null;const t=this.getPages(),n=function(e,t){let n=e;const r=new Set(t);for(;r.has(n);)n=/^.*(\d+)$/.exec(n)?.[1]?n.replace(/(\d+)(?=\D?)$/,(e=>(+e+1).toString())):`${n} 1`;return n}(e.name??"Page",t.map((e=>e.name)));let r=e.index;r&&!t.some((e=>e.index===r))||(r=hc(t[t.length-1].index));const o=Qt.create({meta:{},...e,name:n,index:r}),i=Ut.create({id:Ut.createId(o.id)});return{data:{newPage:o,newTabPageState:sn.create({id:sn.createId(o.id),pageId:o.id}),newCamera:i}}}),{do:({newPage:e,newTabPageState:t,newCamera:n})=>{this.store.put([e,n,t])},undo:({newPage:e,newTabPageState:t,newCamera:n})=>{1!==this.getPages().length&&this.store.remove([t.id,e.id,n.id])}});deletePage(e){const t="string"==typeof e?e:e.id;return this._deletePage(t),this}_deletePage=this.history.createCommand("delete_page",(e=>{if(this.getInstanceState().isReadonly)return null;const t=this.getPages();if(1===t.length)return null;const n=this.getPage(e),r=this.getPageStates().filter((t=>t.pageId===e));if(!n)return null;if(e===this.getCurrentPageId()){const n=t.findIndex((t=>t.id===e)),r=t[n-1]??t[n+1];this.setCurrentPage(r.id)}return{data:{id:e,deletedPage:n,deletedPageStates:r}}}),{do:({deletedPage:e,deletedPageStates:t})=>{const n=this.getPages();if(1!==n.length){if(e.id===this.getCurrentPageId()){const t=n.findIndex((t=>t.id===e.id)),r=n[t-1]??n[t+1];this.setCurrentPage(r.id)}this.store.remove(t.map((e=>e.id))),this.store.remove([e.id]),this.updateRenderingBounds()}},undo:({deletedPage:e,deletedPageStates:t})=>{this.store.put([e]),this.store.put(t),this.updateRenderingBounds()}});duplicatePage(e,t=Qt.createId()){if(this.getPages().length>=40)return this;const n="string"==typeof e?e:e.id,r=this.getPage(n);if(!r)return this;const o={...this.getCamera()},i=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(r.id));return this.batch((()=>{const e=this.getPages(),n=dc(r.index,e[e.indexOf(r)+1]?.index);if(this.createPage({name:r.name+" Copy",id:t,index:n}),this.setCurrentPage(t),this.setCamera(o),i)return this.putContentOntoCurrentPage(i)})),this}renamePage(e,t,n){const r="string"==typeof e?e:e.id;return this.getInstanceState().isReadonly||this.updatePage({id:r,name:t},n),this}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}get assets(){return He("assets"),this.getAssets()}createAssets(e){return this._createAssets(e),this}_createAssets=this.history.createCommand("createAssets",(e=>this.getInstanceState().isReadonly||e.length<=0?null:{data:{assets:e}}),{do:({assets:e})=>{this.store.put(e)},undo:({assets:e})=>{this.store.remove(e.map((e=>e.id)))}});updateAssets(e){return this._updateAssets(e),this}_updateAssets=this.history.createCommand("updateAssets",(e=>{if(!(this.getInstanceState().isReadonly||e.length<=0))return{data:{snapshots:{},assets:e}}}),{do:({assets:e,snapshots:t})=>{this.store.put(e.map((e=>{const n=this.store.get(e.id);return t[e.id]=n,{...n,...e}})))},undo:({snapshots:e})=>{this.store.put(Object.values(e))}});deleteAssets(e){const t="string"==typeof e[0]?e:e.map((e=>e.id));return this._deleteAssets(t),this}_deleteAssets=this.history.createCommand("deleteAssets",(e=>{if(this.getInstanceState().isReadonly)return;if(e.length<=0)return;const t=he(e.map((e=>this.store.get(e))));return{data:{ids:e,prev:t}}}),{do:({ids:e})=>{this.store.remove(e)},undo:({prev:e})=>{this.store.put(e)}});getAsset(e){return this.store.get("string"==typeof e?e:e.id)}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",(e=>this.getShapeUtil(e).getGeometry(e)),((e,t)=>e.props===t.props))}getShapeGeometry(e){return this._getShapeGeometryCache().get("string"==typeof e?e:e.id)}_getShapeOutlineSegmentsCache(){return this.store.createComputedCache("outline-segments",(e=>this.getShapeUtil(e).getOutlineSegments(e)))}getShapeOutlineSegments(e){return this._getShapeOutlineSegmentsCache().get("string"==typeof e?e:e.id)??E}_getShapeHandlesCache(){return this.store.createComputedCache("handles",(e=>this.getShapeUtil(e).getHandles?.(e)))}getShapeHandles(e){return this._getShapeHandlesCache().get("string"==typeof e?e:e.id)}getShapeLocalTransform(e){const t="string"==typeof e?e:e.id,n=this.getShape(t);if(!n)throw Error("Editor.getTransform: shape not found");return ks.Identity().translate(n.x,n.y).rotate(n.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",(e=>{if(Jt(e.parentId))return this.getShapeLocalTransform(e);const t=this._getShapePageTransformCache().get(e.parentId)??ks.Identity();return ks.Compose(t,this.getShapeLocalTransform(e))}))}getShapeParentTransform(e){const t="string"==typeof e?e:e.id,n=this.getShape(t);return!n||Jt(n.parentId)?ks.Identity():this._getShapePageTransformCache().get(n.parentId)??ks.Identity()}getShapePageTransform(e){const t="string"==typeof e?e:this.getShape(e).id;return this._getShapePageTransformCache().get(t)??ks.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",(e=>{const t=this._getShapePageTransformCache().get(e.id);return t?fo.FromPoints(ks.applyToPoints(t,this.getShapeGeometry(e).vertices)):new fo}))}getShapePageBounds(e){return this._getShapePageBoundsCache().get("string"==typeof e?e:e.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",(e=>{const t=this._getShapeMaskCache().get(e.id);if(!t)return;if(0===t.length)return"polygon(0px 0px, 0px 0px, 0px 0px)";const n=this._getShapePageTransformCache().get(e.id);return n?`polygon(${ks.applyToPoints(ks.Inverse(n),t).map((e=>`${e.x}px ${e.y}px`)).join(",")})`:void 0}))}getShapeClipPath(e){return this._getShapeClipPathCache().get("string"==typeof e?e:e.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",(e=>{if(Jt(e.parentId))return;const t=this.getShapeAncestors(e.id).filter((e=>this.isShapeOfType(e,"frame")));return 0!==t.length?t.map((e=>this._getShapePageTransformCache().get(e.id).applyToPoints(this.getShapeGeometry(e).vertices))).reduce(((e,t)=>{if(!t||!e)return;const n=Ra(e,t);return n?n.map(ho.Cast):[]})):void 0}))}getShapeMask(e){return this._getShapeMaskCache().get("string"==typeof e?e:e.id)}getShapeMaskedPageBounds(e){"string"!=typeof e&&(e=e.id);const t=this._getShapePageBoundsCache().get(e);if(!t)return;const n=this._getShapeMaskCache().get(e);if(n){if(0===n.length)return;const{corners:e}=t;if(e.every(((e,t)=>ho.Equals(e,n[t]))))return t.clone();const r=Ra(n,e);if(!r)return;return fo.FromPoints(r)}return t}getShapeAncestors(e,t=[]){const n="string"==typeof e?e:e.id,r=this.getShape(n);if(!r)return t;const o=r.parentId;if(Jt(o))return t.reverse(),t;const i=this.store.get(o);return i?(t.push(i),this.getShapeAncestors(i,t)):t}findShapeAncestor(e,t){const n="string"==typeof e?e:e.id,r=this.getShape(n);if(!r)return;const o=r.parentId;if(Jt(o))return;const i=this.getShape(o);return i?t(i)?i:this.findShapeAncestor(i,t):void 0}hasAncestor(e,t){const n="string"==typeof e?e:e?.id,r=n&&this.getShape(n);return!!r&&(r.parentId===t||this.hasAncestor(this.getShapeParent(r),t))}findCommonAncestor(e,t){if(0===e.length)return;const n=he(("string"==typeof e[0]?e:e.map((e=>e.id))).map((e=>this.getShape(e))));if(1===n.length){const e=n[0].parentId;if(Jt(e))return;return t?this.findShapeAncestor(n[0],t)?.id:e}const[r,...o]=n;let i=this.getShapeParent(r);for(;i;)if(!t||t(i)){if(o.every((e=>this.hasAncestor(e,i.id))))return i.id;i=this.getShapeParent(i)}else i=this.getShapeParent(i)}isShapeOrAncestorLocked(e){const t="string"==typeof e?this.getShape(e):e;return void 0!==t&&(!!t.isLocked||this.isShapeOrAncestorLocked(this.getShapeParent(t)))}getCurrentPageBounds(){let e;return this.getCurrentPageShapeIds().forEach((t=>{const n=this.getShapeMaskedPageBounds(t);n&&(e=e?e.expand(n):n.clone())})),e}get currentPageBounds(){return He("currentPageBounds"),this.getCurrentPageBounds()}getSelectedShapeAtPoint(e){const t=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter((e=>"group"!==e.type&&t.includes(e.id))).reverse().find((t=>this.isPointInShape(t,e,{hitInside:!0,margin:0})))}getShapeAtPoint(e,t={}){const n=this.getZoomLevel(),r=this.getViewportPageBounds(),{filter:o,margin:i=0,hitLabels:s=!1,hitInside:a=!1,hitFrameInside:c=!1}=t;let l=1/0,u=null,d=1/0,h=null;const p=(t.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter((t=>{if(this.isShapeOfType(t,"group"))return!1;const n=this.getShapeMask(t);return!(n&&!Lo(e,n))&&(!o||o(t))}));for(let t=p.length-1;t>=0;t--){const o=p[t],f=this.getShapeGeometry(o),g=f instanceof Ia,m=this.getPointInShapeSpace(o,e);if((this.isShapeOfType(o,"arrow")||this.isShapeOfType(o,"geo")&&"none"===o.props.fill)&&o.props.text.trim())for(const e of f.children)if(e.isLabel&&e.isPointInBounds(m))return o;if(this.isShapeOfType(o,"frame")){const e=f.distanceToPoint(m,a);if(Math.abs(e)<=i)return h||o;if(f.hitTestPoint(m,0,!0))return h||u||(c?o:void 0);continue}let _;if(g){let e=1/0;for(const t of f.children){if(t.isLabel&&!s)continue;const n=t.distanceToPoint(m,a);n<e&&(e=n)}_=e}else _=0===i&&(f.bounds.w<1||f.bounds.h<1)||f.bounds.containsPoint(m,i)?f.distanceToPoint(m,a):1/0;if(f.isClosed){if(_<=i){if(f.isFilled||g&&f.children[0].isFilled)return h||o;if(this.getShapePageBounds(o).contains(r))continue;if(Math.abs(_)<i)Math.abs(_)<d&&(d=Math.abs(_),h=o);else if(!h){const{area:e}=f;e<l&&(l=e,u=o)}}}else if(_<8/n)return o}return h||u||void 0}getShapesAtPoint(e,t={}){return this.getCurrentPageShapes().filter((n=>this.isPointInShape(n,e,t)))}isPointInShape(e,t,n={}){const{hitInside:r=!1,margin:o=0}=n,i="string"==typeof e?e:e.id,s=this.getShapeMask(i);return!(s&&!Lo(t,s))&&this.getShapeGeometry(i).hitTestPoint(this.getPointInShapeSpace(e,t),o,r)}getPointInShapeSpace(e,t){const n="string"==typeof e?e:e.id;return this._getShapePageTransformCache().get(n).clone().invert().applyToPoint(t)}getPointInParentSpace(e,t){const n="string"==typeof e?e:e.id,r=this.getShape(n);if(!r)return new ho(0,0);if(Jt(r.parentId))return ho.From(t);const o=this.getShapePageTransform(r.parentId);return o?o.clone().invert().applyToPoint(t):ho.From(t)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),(e=>this.store.get(e)))}get currentPageShapes(){return He("currentPageShapes"),this.getCurrentPageShapes()}getCurrentPageShapesSorted(){const e=new Set(this.getCurrentPageShapes().sort(fc)),t=[];function n(r){t.push(r),e.delete(r),e.forEach((e=>{e.parentId===r.id&&n(e)}))}return e.forEach((e=>{Mn(this.getShape(e.parentId))||n(e)})),t}get currentPageShapesSorted(){return He("currentPageShapesSorted"),this.getCurrentPageShapesSorted()}getCurrentPageRenderingShapesSorted(){return this.getRenderingShapes().filter((({isCulled:e})=>!e)).sort(((e,t)=>e.index-t.index)).map((({shape:e})=>e))}get currentPageRenderingShapesSorted(){return He("currentPageRenderingShapesSorted"),this.getCurrentPageRenderingShapesSorted()}isShapeOfType(e,t){return("string"==typeof e?this.getShape(e):e).type===t}getShape(e){const t="string"==typeof e?e:e.id;if(Tn(t))return this.store.get(t)}getShapeParent(e){const t="string"==typeof e?e:e?.id;if(!t)return;const n=this.getShape(t);return void 0!==n&&Tn(n.parentId)?this.store.get(n.parentId):void 0}getShapeNearestSibling(e,t){if(t)return t.parentId===e.parentId?t:this.findShapeAncestor(t,(t=>t.parentId===e.parentId))}isShapeInPage(e,t=this.getCurrentPageId()){const n="string"==typeof e?e:e.id,r=this.getShape(n);if(!r)return!1;let o=!1;if(r.parentId===t)o=!0;else{let e=this.getShape(r.parentId);e:for(;e;){if(e.parentId===t){o=!0;break e}e=this.getShape(e.parentId)}}return o}getAncestorPageId(e){const t="string"==typeof e?e:e?.id,n=t&&this.getShape(t);if(n)return Jt(n.parentId)?n.parentId:this.getAncestorPageId(this.getShape(n.parentId))}_parentIdsToChildIds;reparentShapes(e,t,n){const r="string"==typeof e[0]?e:e.map((e=>e.id)),o=[],i=Jt(t)?ks.Identity():this.getShapePageTransform(t),s=i.rotation();let a=[];const c=he(this.getSortedChildIdsForParent(t).map((e=>this.getShape(e))));if(n){const e=c.find((e=>e.index===n));if(e){const t=c[c.indexOf(e)+1];a=t?lc(n,t.index,r.length):uc(n,r.length)}else{const e=c.sort(fc).find((e=>e.index>n));a=e?lc(n,e.index,r.length):uc(n,r.length)}}else{const e=c.length&&c[c.length-1];a=e?uc(e.index,r.length):pc(r.length)}const l=i.clone().invert(),u=he(r.map((e=>this.getShape(e)))),d=u.filter((e=>e.isLocked));d.length&&this.updateShapes(d.map((({id:e,type:t})=>({id:e,type:t,isLocked:!1}))));for(let e=0;e<u.length;e++){const n=u[e],r=this.getShapePageTransform(n);if(!r)continue;const i=r.point();if(!i)continue;const c=l.applyToPoint(i),d=r.rotation()-s;o.push({id:n.id,type:n.type,parentId:t,x:c.x,y:c.y,rotation:d,index:a[e],isLocked:n.isLocked})}return this.updateShapes(o),this}getHighestIndexForParent(e){const t="string"==typeof e?e:e.id,n=this._parentIdsToChildIds.get()[t];return n&&0!==n.length?hc(this.getShape(n[n.length-1]).index):"a1"}_childIdsCache=new Xa;getSortedChildIdsForParent(e){const t="string"==typeof e?e:e.id,n=this._parentIdsToChildIds.get()[t];return n?this._childIdsCache.get(n,(()=>n)):E}visitDescendants(e,t){const n="string"==typeof e?e:e.id,r=this.getSortedChildIdsForParent(n);for(const e of r)!1!==t(e)&&this.visitDescendants(e,t);return this}getShapeAndDescendantIds(e){const t=new Set,n=[...e];for(;n.length>0;){const e=n.pop();if(!e)break;if(!t.has(e)){t.add(e);for(const t of this.getSortedChildIdsForParent(e))n.push(t)}}return t}getDroppingOverShape(e,t=[]){const n=this.getCurrentPageShapesSorted();for(let r=n.length-1;r>=0;r--){const o=n[r];if(!this.getShapeUtil(o).canDropShapes(o,t)||t.find((e=>e.id===o.id||this.hasAncestor(o,e.id))))continue;const i=this.getShapeMaskedPageBounds(o.id);if(i&&i.containsPoint(e)&&this.getShapeGeometry(o).hitTestPoint(this.getPointInShapeSpace(o,e),0,!0))return o}}getOutermostSelectableShape(e,t){const n="string"==typeof e?e:e.id,r=this.getShape(n);let o=r,i=r;const s=this.getFocusedGroup();for(;i;){if(this.isShapeOfType(i,"group")&&s?.id!==i.id&&!this.hasAncestor(s,i.id)&&(t?.(i)??1))o=i;else if(s?.id===i.id)break;i=this.getShapeParent(i)}return o}rotateShapesBy(e,t){if(("string"==typeof e[0]?e:e.map((e=>e.id))).length<=0)return this;const n=mc({editor:this});return n?(_c({delta:t,snapshot:n,editor:this,stage:"one-off"}),this):this}nudgeShapes(e,t,n){const r="string"==typeof e[0]?e:e.map((e=>e.id));if(r.length<=0)return this;const o=[];for(const e of r){const n=this.getShape(e);if(!n)throw Error(`Could not find a shape with the id ${e}.`);const r=ho.Cast(t),i=this.getShapeParentTransform(n);i&&r.rot(-i.rotation());const s=this.getShapeUtil(n).onTranslateStart?.(n);o.push(s?{...s,x:n.x+r.x,y:n.y+r.y}:{id:e,x:n.x+r.x,y:n.y+r.y,type:n.type})}return this.updateShapes(o,{squashing:!0,...n}),this}duplicateShapes(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(n.length<=0)return this;const r=new Set(n),o=[],i=[...n];for(;i.length>0;){const e=i.pop();if(!e)break;o.push(e),this.getSortedChildIdsForParent(e).forEach((e=>i.push(e)))}o.reverse();const s=new Map(o.map((e=>[e,jn()]))),a=he(o.map((e=>{const n=this.getShape(e);if(!n)return null;const o=s.get(e);let i=0,a=0;if(t&&r.has(e)){const e=this.getShapeParentTransform(n),r=new ho(t.x,t.y).rot(-e.rotation());i=r.x,a=r.y}const c=n.parentId??this.getCurrentPageId(),l=this.getSortedChildIdsForParent(c),u=l.indexOf(n.id),d=l[u+1],h=d?this.getShape(d):null,p=h?dc(n.index,h.index):hc(n.index);let f=Me(n);if(this.isShapeOfType(n,"arrow")&&this.isShapeOfType(f,"arrow")){const e=this.getArrowInfo(n);let t,r;if("binding"===n.props.start.type&&(t=s.get(n.props.start.boundShapeId),!t))if(e?.isValid){const{x:t,y:n}=e.start.point;f.props.start={type:"point",x:t,y:n}}else{const{start:e}=Yc(this,n);f.props.start={type:"point",x:e.x,y:e.y}}if("binding"===n.props.end.type&&(r=s.get(n.props.end.boundShapeId),!r))if(e?.isValid){const{x:t,y:n}=e.end.point;f.props.end={type:"point",x:t,y:n}}else{const{end:e}=Yc(this,n);f.props.start={type:"point",x:e.x,y:e.y}}const o=Hc(f)?Jc(this,f):ol(this,f);if(e?.isValid&&o?.isValid&&!Hc(n)){const t=ho.Med(e.start.handle,e.end.handle),n=ho.Dist(e.middle,t),r=ho.Dist(o.middle,t);f.props.bend<0?f.props.bend+=r-n:f.props.bend-=r-n}"binding"===f.props.start.type&&t&&(f.props.start.boundShapeId=t),"binding"===f.props.end.type&&r&&(f.props.end.boundShapeId=r)}return f={...f,id:o,x:n.x+i,y:n.y+a,index:p},f})));return a.forEach((e=>{Tn(e.parentId)&&s.has(e.parentId)&&(e.parentId=s.get(e.parentId))})),this.history.batch((()=>{const e=a.length+this.getCurrentPageShapeIds().size>Yo;e&&gl(this);const n=e?a.slice(0,Yo-this.getCurrentPageShapeIds().size):a,r=n.map((e=>e.id));if(this.createShapes(n),this.setSelectedShapes(r),void 0!==t){const e=this.getSelectionPageBounds(),t=this.getViewportPageBounds();e&&!t.contains(e)&&this.centerOnPoint(e.center,{duration:Xo})}})),this}moveShapesToPage(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(0===n.length)return this;if(this.getInstanceState().isReadonly)return this;const r=this.getCurrentPageId();if(t===r)return this;if(!this.store.has(t))return this;const o=this.getContentFromCurrentPage(n);if(!o)return this;if(this.getPageShapeIds(t).size+o.shapes.length>Yo)return gl(this,t),this;const i=this.getCamera().z;return this.history.batch((()=>{this.deleteShapes(n),this.setCurrentPage(t),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(o,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:i}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)})),this}toggleLock(e){const t="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly||0===t.length)return this;let n=!0,r=!0;const o=[];for(const e of t){const t=this.getShape(e);t&&(o.push(t),t.isLocked?r=!1:n=!1)}return this.batch((()=>{r?(this.updateShapes(o.map((e=>({id:e.id,type:e.type,isLocked:!0})))),this.setSelectedShapes([])):n?this.updateShapes(o.map((e=>({id:e.id,type:e.type,isLocked:!1})))):this.updateShapes(o.map((e=>({id:e.id,type:e.type,isLocked:!0}))))})),this}sendToBack(e){const t=gc(this,"toBack","string"==typeof e[0]?e:e.map((e=>e.id)));return t&&this.updateShapes(t),this}sendBackward(e){const t=gc(this,"backward","string"==typeof e[0]?e:e.map((e=>e.id)));return t&&this.updateShapes(t),this}bringForward(e){const t=gc(this,"forward","string"==typeof e[0]?e:e.map((e=>e.id)));return t&&this.updateShapes(t),this}bringToFront(e){const t=gc(this,"toFront","string"==typeof e[0]?e:e.map((e=>e.id)));return t&&this.updateShapes(t),this}flipShapes(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;let r=he(n.map((e=>this.getShape(e))));if(!r.length)return this;r=he(r.map((e=>this.isShapeOfType(e,"group")?this.getSortedChildIdsForParent(e.id).map((e=>this.getShape(e))):e)).flat());const o=fo.Common(he(r.map((e=>this.getShapePageBounds(e))))).center;return this.batch((()=>{for(const e of r){const n=this.getShapeGeometry(e).bounds,r=this.getShapePageTransform(e.id);r&&this.resizeShape(e.id,{x:"horizontal"===t?-1:1,y:"vertical"===t?-1:1},{initialBounds:n,initialPageTransform:r,initialShape:e,mode:"scale_shape",scaleOrigin:o,scaleAxisRotation:0})}})),this}stackShapes(e,t,n){const r="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;const o=he(r.map((e=>this.getShape(e))).filter((e=>!!e&&(!this.isShapeOfType(e,"arrow")||"binding"!==e.props.start.type&&"binding"!==e.props.end.type)))),i=o.length;if(0===n&&i<3||i<2)return this;const s=Object.fromEntries(o.map((e=>[e.id,this.getShapePageBounds(e)])));let a,c,l,u,d;if("horizontal"===t?(a="x",c="minX",l="maxX",u="width"):(a="y",c="minY",l="maxY",u="height"),0===n){const e=[];o.sort(((e,t)=>s[e.id][c]-s[t.id][c]));for(let t=0;t<i-1;t++){const n=o[t],r=o[t+1],i=s[n.id],a=s[r.id][c]-i[l],u=e.find((e=>e.gap===a));u?u.count++:e.push({gap:a,count:1})}let t=0;e.forEach((e=>{e.count>t&&(t=e.count,d=e.gap)})),1===t&&(d=Math.max(0,e.reduce(((e,t)=>e+t.gap*t.count),0)/(i-1)))}else d=n;const h=[];let p=s[o[0].id][l];return o.forEach(((e,t)=>{if(0===t)return;const n={x:0,y:0};n[a]=p+d-s[e.id][a];const r=this.getShapeParent(e),o=r?ho.Rot(n,-this.getShapePageTransform(r).decompose().rotation):n,i=this.getShapeUtil(e).onTranslateStart?.(e);h.push(i?{...i,[a]:e[a]+o[a]}:{id:e.id,type:e.type,[a]:e[a]+o[a]}),p+=s[e.id][u]+d})),this.updateShapes(h),this}packShapes(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;if(n.length<2)return this;const r=he(n.map((e=>this.getShape(e))).filter((e=>!!e&&(!this.isShapeOfType(e,"arrow")||"binding"!==e.props.start.type&&"binding"!==e.props.end.type)))),o={},i={};let s,a,c=0;for(let e=0;e<r.length;e++)s=r[e],a=this.getShapePageBounds(s),o[s.id]=a,i[s.id]=a.clone(),c+=a.width*a.height;const l=fo.Common(he(Object.values(o))),u=l.width;r.sort(((e,t)=>o[t.id].height-o[e.id].height));const d=Math.max(Math.ceil(Math.sqrt(c/.95)),u),h=[new fo(l.x,l.y,d,1/0)];let p,f,g=0,m=0;for(let e=0;e<r.length;e++){s=r[e],a=i[s.id];for(let e=h.length-1;e>=0;e--)if(p=h[e],!(a.width>p.width||a.height>p.height)){a.x=p.x,a.y=p.y,m=Math.max(m,a.maxY),g=Math.max(g,a.maxX),a.width===p.width&&a.height===p.height?(f=h.pop(),e<h.length&&(h[e]=f)):a.height===p.height?(p.x+=a.width+t,p.width-=a.width+t):a.width===p.width?(p.y+=a.height+t,p.height-=a.height+t):(h.push(new fo(p.x+(a.width+t),p.y,p.width-(a.width+t),a.height)),p.y+=a.height+t,p.height-=a.height+t);break}}const _=fo.Common(Object.values(i)),y=ho.Sub(l.center,_.center);let w;const v=[];for(let e=0;e<r.length;e++){s=r[e],a=o[s.id],w=i[s.id];const t=ho.Sub(w.point,a.point).add(y),n=this.getShapeParentTransform(s);n&&t.rot(-n.rotation());const c={id:s.id,type:s.type,x:s.x+t.x,y:s.y+t.y},l=this.getShapeUtil(s).onTranslateStart?.({...s,...c});l?v.push({...c,...l}):v.push(c)}return v.length&&this.updateShapes(v),this}alignShapes(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;if(n.length<2)return this;const r=he(n.map((e=>this.getShape(e)))),o=Object.fromEntries(r.map((e=>[e.id,this.getShapePageBounds(e)]))),i=fo.Common(he(Object.values(o))),s=[];return r.forEach((e=>{const n=o[e.id];if(!n)return;const r={x:0,y:0};switch(t){case"top":r.y=i.minY-n.minY;break;case"center-vertical":r.y=i.midY-n.minY-n.height/2;break;case"bottom":r.y=i.maxY-n.minY-n.height;break;case"left":r.x=i.minX-n.minX;break;case"center-horizontal":r.x=i.midX-n.minX-n.width/2;break;case"right":r.x=i.maxX-n.minX-n.width}const a=this.getShapeParent(e),c=a?ho.Rot(r,-this.getShapePageTransform(a).decompose().rotation):r,l=this.getShapeUtil(e).onTranslateStart?.(e);s.push(l?{...l,x:e.x+c.x,y:e.y+c.y}:{id:e.id,type:e.type,x:e.x+c.x,y:e.y+c.y})})),this.updateShapes(s),this}distributeShapes(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;if(n.length<3)return this;const r=n.length,o=he(n.map((e=>this.getShape(e)))),i=Object.fromEntries(o.map((e=>[e.id,this.getShapePageBounds(e)])));let s,a,c,l,u;"horizontal"===t?(s="x",a="minX",c="maxX",l="midX",u="width"):(s="y",a="minY",c="maxY",l="midY",u="height");const d=[],h=o.sort(((e,t)=>i[e.id][a]-i[t.id][a]))[0],p=o.sort(((e,t)=>i[t.id][c]-i[e.id][c]))[0],f=i[h.id][l],g=(i[p.id][l]-f)/(r-1),m=f+g;return o.filter((e=>e!==h&&e!==p)).sort(((e,t)=>i[e.id][l]-i[t.id][l])).forEach(((e,t)=>{const n={x:0,y:0};n[s]=m+g*t-i[e.id][u]/2-i[e.id][s];const r=this.getShapeParent(e),o=r?ho.Rot(n,-this.getShapePageTransform(r).rotation()):n,a=this.getShapeUtil(e).onTranslateStart?.(e);d.push(a?{...a,[s]:e[s]+o[s]}:{id:e.id,type:e.type,[s]:e[s]+o[s]})})),this.updateShapes(d),this}stretchShapes(e,t){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;if(n.length<2)return this;const r=he(n.map((e=>this.getShape(e)))),o=Object.fromEntries(n.map((e=>[e,this.getShapeGeometry(e).bounds]))),i=Object.fromEntries(n.map((e=>[e,this.getShapePageBounds(e)]))),s=fo.Common(he(Object.values(i)));switch(t){case"vertical":this.batch((()=>{for(const e of r){if(this.getShapePageTransform(e).rotation()%wo)continue;const t=o[e.id],n=i[e.id],r=new ho(0,s.minY-n.minY),a=this.getShapeParentTransform(e);a&&r.rot(-a.rotation());const{x:c,y:l}=ho.Add(r,e);this.updateShapes([{id:e.id,type:e.type,x:c,y:l}],{squashing:!0});const u=new ho(1,s.height/n.height);this.resizeShape(e.id,u,{initialBounds:t,scaleOrigin:new ho(n.center.x,s.minY),scaleAxisRotation:0})}}));break;case"horizontal":this.batch((()=>{for(const e of r){const t=o[e.id],n=i[e.id];if(this.getShapePageTransform(e).rotation()%wo)continue;const r=new ho(s.minX-n.minX,0),a=this.getShapeParentTransform(e);a&&r.rot(-a.rotation());const{x:c,y:l}=ho.Add(r,e);this.updateShapes([{id:e.id,type:e.type,x:c,y:l}],{squashing:!0});const u=new ho(s.width/n.width,1);this.resizeShape(e.id,u,{initialBounds:t,scaleOrigin:new ho(s.minX,n.center.y),scaleAxisRotation:0})}}))}return this}resizeShape(e,t,n={}){const r="string"==typeof e?e:e.id;if(this.getInstanceState().isReadonly)return this;Number.isFinite(t.x)||(t=new ho(1,t.y)),Number.isFinite(t.y)||(t=new ho(t.x,1));const o=n.initialShape??this.getShape(r);if(!o)return this;const i=n.scaleOrigin??this.getShapePageBounds(r)?.center;if(!i)return this;const s=n.initialPageTransform?ks.Cast(n.initialPageTransform):this.getShapePageTransform(r);if(!s)return this;const a=s.rotation();if(null==a)return this;const c=n.scaleAxisRotation??a,l=n.initialBounds??this.getShapeGeometry(r).bounds;if(!l)return this;if(!jo(a,c))return this._resizeUnalignedShape(r,t,{...n,initialBounds:l,scaleOrigin:i,scaleAxisRotation:c,initialPageTransform:s,initialShape:o});const u=this.getShapeUtil(o);if(u.isAspectRatioLocked(o)&&(t=Math.abs(t.x)>Math.abs(t.y)?new ho(t.x,Math.sign(t.y)*Math.abs(t.x)):new ho(Math.sign(t.x)*Math.abs(t.y),t.y)),u.onResize&&u.canResize(o)){const e=this._scalePagePoint(ks.applyToPoint(s,new ho(0,0)),i,t,c),d=this.getPointInParentSpace(o.id,e),h=new ho(t.x,t.y),p=ko((a-c)%Math.PI,0);h.x=p?t.x:t.y,h.y=p?t.y:t.x;const f=ks.applyToPoint(s,new ho),{x:g,y:m}=this.getPointInParentSpace(o.id,f);this.updateShapes([{id:r,type:o.type,x:d.x,y:d.y,...u.onResize({...o,x:g,y:m},{newPoint:d,handle:n.dragHandle??"bottom_right",mode:n.mode??"scale_shape",scaleX:h.x,scaleY:h.y,initialBounds:l,initialShape:o})}],{squashing:!0})}else{const e=ks.applyToPoint(s,l.center),n=this._scalePagePoint(e,i,t,c),a=this.getPointInParentSpace(o.id,e),u=this.getPointInParentSpace(o.id,n),d=ho.Sub(u,a);this.updateShapes([{id:r,type:o.type,x:o.x+d.x,y:o.y+d.y}],{squashing:!0})}return this}_scalePagePoint(e,t,n,r){const o=ho.RotWith(e,t,-r).sub(t),i=ho.MulV(o,n);return ho.Add(i,t).rotWith(t,r)}_resizeUnalignedShape(e,t,n){const{type:r}=n.initialShape,o=new ho(t.x,t.y);if(Math.abs(t.x)>Math.abs(t.y)?o.x=Math.sign(t.x)*Math.abs(t.y):o.y=Math.sign(t.y)*Math.abs(t.x),this.resizeShape(e,o,{initialShape:n.initialShape,initialBounds:n.initialBounds}),Math.sign(t.x)*Math.sign(t.y)<0){let{rotation:t}=ks.Decompose(n.initialPageTransform);t-=2*t,this.updateShapes([{id:e,type:r,rotation:t}],{squashing:!0})}const i=ks.applyToPoint(n.initialPageTransform,n.initialBounds.center),s=this._scalePagePoint(i,n.scaleOrigin,t,n.scaleAxisRotation),a=this.getShapePageBounds(e),c=this.getShapePageTransform(e),l=a.center,u=c.point();if(!l||!u)return this;const d=ho.Sub(s,l),h=ho.Add(u,d),{x:p,y:f}=this.getPointInParentSpace(e,h);return this.updateShapes([{id:e,type:r,x:p,y:f}],{squashing:!0}),this}getInitialMetaForShape(e){return{}}createShape(e){return this._createShapes([e]),this}createShapes(e){if(!Array.isArray(e))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");return this._createShapes(e),this}_createShapes=this.history.createCommand("createShapes",(e=>{if(this.getInstanceState().isReadonly)return null;if(e.length<=0)return null;const t=this.getCurrentPageShapeIds();if(!(e.length+t.size>Yo))return 0===e.length?null:{data:{currentPageId:this.getCurrentPageId(),partials:e.map((e=>e.id?e:{...e,id:jn()}))}};gl(this)}),{do:({partials:e})=>{const t=this.getFocusedGroupId(),n=this.getCurrentPageShapesSorted();e=e.map((r=>{if(!r.parentId||!this.store.has(r.parentId)&&!e.some((e=>e.id===r.parentId))){let e=this.getFocusedGroupId();for(let t=n.length-1;t>=0;t--){const o=n[t];if(this.getShapeUtil(o).canReceiveNewChildrenOfType(o,r.type)&&this.isPointInShape(o,{x:r.x??0,y:r.y??0},{margin:0,hitInside:!0})){e=o.id;break}}const o=r.parentId;if(e===r.id&&(e=t),e!==o&&((r={...r}).parentId=e,Tn(e))){const t=this.getPointInShapeSpace(this.getShape(e),{x:r.x??0,y:r.y??0});r.x=t.x,r.y=t.y,r.rotation=-this.getShapePageTransform(e).rotation()+(r.rotation??0)}}return r}));const r=new Map,o=[];for(const n of e){const e=this.getShapeUtil(n);let i=n.index;if(!i){const e=n.parentId??t;r.has(e)||r.set(e,this.getHighestIndexForParent(e)),i=r.get(e),r.set(e,hc(i))}const s=e.getDefaultProps();for(const[e,t]of this.styleProps[n.type])s[t]=this.getStyleForNextShape(e);let a=this.store.schema.types.shape.create({...n,index:i,opacity:n.opacity??this.getInstanceState().opacityForNextShape,parentId:n.parentId??t,props:"props"in n?{...s,...n.props}:s});if(void 0===a.index)throw Error("no index!");const c=this.getShapeUtil(a).onBeforeCreate?.(a);c&&(a=c),o.push(a)}o.forEach((e=>{e.meta={...this.getInitialMetaForShape(e),...e.meta}})),this.store.put(o)},undo:({partials:e})=>{this.store.remove(e.map((e=>e.id)))}});animatingShapes=new Map;animateShape(e,t){return this.animateShapes([e],t)}animateShapes(e,t={}){const{duration:n=500,easing:r=uo.linear}=t,o=ua();let i,s=n;const a=[];let c;e.forEach((e=>{if(!e)return;const t={partial:e,values:[]},n=this.getShape(e.id);if(n){for(const r of["x","y","rotation"])void 0!==e[r]&&n[r]!==e[r]&&t.values.push({prop:r,from:n[r],to:e[r]});a.push(t),this.animatingShapes.set(n.id,o)}}));const l=t=>{if(s-=t,s<0){const{animatingShapes:t}=this,n=e.filter((e=>e&&t.get(e.id)===o));return n.length&&this.updateShapes(n,{squashing:!1}),void this.removeListener("tick",l)}i=r(1-s/n);const{animatingShapes:u}=this;try{const e=[];for(let t=0;t<a.length;t++)c=a[t],u.get(c.partial.id)===o&&e.push({id:c.partial.id,type:c.partial.type,...c.values.reduce(((e,{prop:t,from:n,to:r})=>(e[t]=n+(r-n)*i,e)),{})});this._updateShapes(e,{squashing:!0})}catch(e){}};return this.addListener("tick",l),this}groupShapes(e,t=jn()){if(!Array.isArray(e))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getInstanceState().isReadonly)return this;const n="string"==typeof e[0]?e:e.map((e=>e.id));if(n.length<=1)return this;const r=he(this._getUnlockedShapeIds(n).map((e=>this.getShape(e)))),o=r.sort(fc).map((e=>e.id)),i=fo.Common(he(r.map((e=>this.getShapePageBounds(e))))),{x:s,y:a}=i.point,c=this.findCommonAncestor(r)??this.getCurrentPageId();if("select"!==this.getCurrentToolId())return this;this.isIn("select.idle")||this.cancel();const l=r.filter((e=>e.parentId===c)).sort(fc),u=l[l.length-1]?.index;return this.batch((()=>{this.createShapes([{id:t,type:"group",parentId:c,index:u,x:s,y:a,opacity:1,props:{}}]),this.reparentShapes(o,t),this.select(t)})),this}ungroupShapes(e){const t="string"==typeof e[0]?e:e.map((e=>e.id));if(this.getInstanceState().isReadonly)return this;if(0===t.length)return this;if("select"!==this.getCurrentToolId())return this;this.isIn("select.idle")||this.cancel();const n=new Set,r=he(t.map((e=>this.getShape(e)))),o=[];return r.forEach((e=>{this.isShapeOfType(e,"group")?o.push(e):n.add(e.id)})),0===o.length||this.batch((()=>{let e;for(let t=0,r=o.length;t<r;t++){e=o[t];const r=this.getSortedChildIdsForParent(e.id);for(let e=0,t=r.length;e<t;e++)n.add(r[e]);this.reparentShapes(r,e.parentId,e.index)}this.deleteShapes(o.map((e=>e.id))),this.select(...n)})),this}updateShape(e,t){return this.updateShapes([e],t),this}updateShapes(e,t){let n=he(e);return this.animatingShapes.size>0&&n.forEach((e=>this.animatingShapes.delete(e.id))),n=n.filter((e=>{const t=this.getShape(e.id);return!(!t||this.isShapeOrAncestorLocked(t)&&!Object.hasOwn(e,"isLocked"))})),this._updateShapes(n,t),this}_updateShapes=this.history.createCommand("updateShapes",((e,t)=>{if(this.getInstanceState().isReadonly)return null;const n=he(e),r=Object.fromEntries(he(n.map((({id:e})=>this.getShape(e)))).map((e=>[e.id,e])));if(n.length<=0)return null;const o=he(n.map((e=>{const t=r[e.id];if(!t)return null;let n=null;for(const[r,o]of Object.entries(e))if(void 0!==o)switch(r){case"id":case"type":continue;default:if(o!==t[r])if(n||(n={...t}),"props"===r){const e={...t.props};for(const[t,n]of Object.entries(o))void 0!==n&&(e[t]=n);n.props=e}else if("meta"===r){const e={...t.meta};for(const[t,n]of Object.entries(o))void 0!==n&&(e[t]=n);n.meta=e}else n[r]=o}return n??t}))),i=Object.fromEntries(o.map((e=>[e.id,e])));return{data:{snapshots:r,updates:i},...t}}),{do:({updates:e})=>{const t=Object.values(e);for(let e=0;e<t.length;e++){const n=t[e],r=this.store.get(n.id);if(!r)continue;const o=this.getShapeUtil(n).onBeforeUpdate?.(r,n);o&&(t[e]=o)}this.store.put(t)},undo:({snapshots:e})=>{this.store.put(Object.values(e))},squash:(e,t)=>({snapshots:{...t.snapshots,...e.snapshots},updates:{...e.updates,...t.updates}})});_getUnlockedShapeIds(e){return e.filter((e=>!this.getShape(e)?.isLocked))}deleteShapes(e){if(!Array.isArray(e))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");return this._deleteShapes(this._getUnlockedShapeIds("string"==typeof e[0]?e:e.map((e=>e.id)))),this}deleteShape(e){return this.deleteShapes(["string"==typeof e?e:e.id]),this}_deleteShapes=this.history.createCommand("delete_shapes",(e=>{if(this.getInstanceState().isReadonly)return null;if(0===e.length)return null;const t=[...this.getCurrentPageState().selectedShapeIds],n=new Set(e);for(const t of e)this.visitDescendants(t,(e=>{n.add(e)}));const r=[...n],o=this._getArrowBindingsIndex().get(),i=he(r.flatMap((e=>{const t=this.getShape(e),n=o[e];return n&&n.length>0?n.map((({arrowId:e})=>this.getShape(e))).concat(t):t}))),s=t.filter((e=>!n.has(e)));return{data:{deletedIds:r,snapshots:i,prevSelectedShapeIds:t,postSelectedShapeIds:s}}}),{do:({deletedIds:e,postSelectedShapeIds:t})=>{this.store.remove(e),this.store.update(this.getCurrentPageState().id,(e=>({...e,selectedShapeIds:t})))},undo:({snapshots:e,prevSelectedShapeIds:t})=>{this.store.put(e),this.store.update(this.getCurrentPageState().id,(e=>({...e,selectedShapeIds:t})))}});_extractSharedStyles(e,t){if(this.isShapeOfType(e,"group")){const n=this._parentIdsToChildIds.get()[e.id];if(!n)return;for(let e=0,r=n.length;e<r;e++)this._extractSharedStyles(this.getShape(n[e]),t)}else for(const[n,r]of this.styleProps[e.type])t.applyValue(n,Pe(e.props,r))}_selectionSharedStyles=J("_selectionSharedStyles",(()=>{const e=this.getSelectedShapes(),t=new Ya;for(const n of e)this._extractSharedStyles(n,t);return t}));getStyleForNextShape(e){const t=this.getInstanceState().stylesForNextShape[e.id];return void 0===t?e.defaultValue:t}getShapeStyleIfExists(e,t){const n=this.styleProps[e.type].get(t);if(void 0!==n)return Pe(e.props,n)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._selectionSharedStyles.get();const e=this.root.getCurrent(),t=new Ya;if(!e)return t;if(e.shapeType)for(const n of this.styleProps[e.shapeType].keys())t.applyValue(n,this.getStyleForNextShape(n));return t}get sharedStyles(){return He("sharedStyles"),this.getSharedStyles()}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const e=[],t=n=>{const r=this.getShape(n);if(r)if(this.isShapeOfType(r,"group"))for(const e of this.getSortedChildIdsForParent(r.id))t(e);else e.push(r)};for(const e of this.getSelectedShapeIds())t(e);let n=null;for(const t of e)if(null===n)n=t.opacity;else if(n!==t.opacity)return{type:"mixed"};if(null!==n)return{type:"shared",value:n}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}get sharedOpacity(){return He("sharedOpacity"),this.getSharedOpacity()}setOpacityForNextShapes(e,t){return this.updateInstanceState({opacityForNextShape:e},t),this}setOpacityForSelectedShapes(e,t){const n=this.getSelectedShapes();if(n.length>0){const r=[],o=e=>{if(this.isShapeOfType(e,"group")){const t=this.getSortedChildIdsForParent(e);for(const e of t)o(this.getShape(e))}else r.push(e)};for(const e of n)o(e);this.updateShapes(r.map((t=>({id:t.id,type:t.type,opacity:e}))),t)}return this}setStyleForNextShapes(e,t,n){const r=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...r,[e.id]:t}},n),this}setStyleForSelectedShapes(e,t,n){const r=this.getSelectedShapes();if(r.length>0){const o=[],i=n=>{if(this.isShapeOfType(n,"group")){const e=this.getSortedChildIdsForParent(n.id);for(const t of e)i(this.getShape(t))}else{const r=this.getShapeUtil(n),i=this.styleProps[n.type].get(e);if(i){const e={id:n.id,type:n.type,props:{[i]:t}};o.push({util:r,originalShape:n,updatePartial:e})}}};for(const e of r)i(e);this.updateShapes(o.map((({updatePartial:e})=>e)),n)}return this}externalAssetContentHandlers={file:null,url:null};registerExternalAssetHandler(e,t){return this.externalAssetContentHandlers[e]=t,this}async getAssetForExternalContent(e){return await(this.externalAssetContentHandlers[e.type]?.(e))}externalContentHandlers={text:null,files:null,embed:null,"svg-text":null,url:null};registerExternalContentHandler(e,t){return this.externalContentHandlers[e]=t,this}async putExternalContent(e){return this.externalContentHandlers[e.type]?.(e)}getContentFromCurrentPage(e){const t="string"==typeof e[0]?e:e.map((e=>e.id));if(!t)return;if(0===t.length)return;const n={};let r=de(t.map((e=>this.getShape(e))).sort(fc).flatMap((e=>{const t=[e];return this.visitDescendants(e.id,(e=>{t.push(this.getShape(e))})),t})));r=r.map((e=>{if(n[e.id]=this.getShapePageTransform(e.id),e=We(e),this.isShapeOfType(e,"arrow")){const t="binding"===e.props.start.type?e.props.start.boundShapeId:void 0,n="binding"===e.props.end.type?e.props.end.boundShapeId:void 0,o=this.getArrowInfo(e);if("binding"===e.props.start.type&&!r.some((e=>e.id===t)))if(o?.isValid){const{x:t,y:n}=o.start.point;e.props.start={type:"point",x:t,y:n}}else{const{start:t}=Yc(this,e);e.props.start={type:"point",x:t.x,y:t.y}}if("binding"===e.props.end.type&&!r.some((e=>e.id===n)))if(o?.isValid){const{x:t,y:n}=o.end.point;e.props.end={type:"point",x:t,y:n}}else{const{end:t}=Yc(this,e);e.props.end={type:"point",x:t.x,y:t.y}}const i=Hc(e)?Jc(this,e):ol(this,e);if(o?.isValid&&i?.isValid&&!Hc(e)){const t=ho.Med(o.start.handle,o.end.handle),n=ho.Dist(o.middle,t),r=ho.Dist(i.middle,t);e.props.bend<0?e.props.bend+=r-n:e.props.bend-=r-n}return e}return e}));const o=[];r.forEach((e=>{if(void 0===r.find((t=>t.id===e.parentId))){const t=this.getShapePageTransform(e.id),n=t.point(),r=t.rotation();e.x=n.x,e.y=n.y,e.rotation=r,e.parentId=this.getCurrentPageId(),o.push(e.id)}}));const i=new Set;return r.forEach((e=>{"assetId"in e.props&&null!==e.props.assetId&&i.add(e.props.assetId)})),{shapes:r,rootShapeIds:o,schema:this.store.schema.serialize(),assets:he(Array.from(i).map((e=>this.getAsset(e))))}}putContentOntoCurrentPage(e,t={}){if(this.getInstanceState().isReadonly)return this;if(!e.schema)throw Error("Could not put content:\ncontent is missing a schema.");const{select:n=!1,preserveIds:r=!1,preservePosition:o=!1}=t;let{point:i}=t;const s=this.getCurrentPageId(),{assets:a,shapes:c,rootShapeIds:l}=e,u=new Map(c.map((e=>[e.id,jn()])));let d=this.getCurrentPageId(),h=1/0,p=[];for(const e of this.getSelectedShapes()){if(0===h)break;const t=this.isShapeOfType(e,"frame"),n=this.getShapeAncestors(e);t&&n.push(e);const r=t?n.length+1:n.length;if(r<h)h=r,p=n,d=t?e.id:e.parentId;else if(r===h){if(p.length!==n.length)throw Error(`Ancestors: ${p.length} !== ${n.length}`);if(0===p.length){d=s;break}d=s;for(let e=0;e<p.length&&n[e]===p[e];e++)d=n[e].id}}let f=!1;if(!Jt(d)){const e=this.getShape(d);if(e)if(this.getViewportPageBounds().includes(this.getShapePageBounds(e))){if(1===l.length){const t=c.find((e=>e.id===l[0]));this.isShapeOfType(e,"frame")&&this.isShapeOfType(t,"frame")&&t.props.w===e?.props.w&&t.props.h===e?.props.h&&(f=!0)}}else d=s;else d=s}f||(f=u.has(d)),f&&(d=this.getShape(d).parentId);let g=this.getHighestIndexForParent(d);const m=[],_=c.map((e=>{let t;if(r)t=Me(e),u.set(e.id,e.id);else{const n=u.get(e.id);t=Me({...e,id:n})}if(l.includes(e.id)&&(t.parentId=s,m.push(t)),u.has(t.parentId)?t.parentId=u.get(e.parentId):(l.push(t.id),t.index=g,g=hc(g)),this.isShapeOfType(t,"arrow")){if("binding"===t.props.start.type){const e=u.get(t.props.start.boundShapeId);t.props.start=e?{...t.props.start,boundShapeId:e}:{type:"point",x:0,y:0}}if("binding"===t.props.end.type){const e=u.get(t.props.end.boundShapeId);t.props.end=e?{...t.props.end,boundShapeId:e}:{type:"point",x:0,y:0}}}return t}));if(_.length+this.getCurrentPageShapeIds().size>Yo)return gl(this),this;let y=[];if(a){for(let t=0;t<a.length;t++){const n=a[t],r=this.store.schema.migratePersistedRecord(n,e.schema);if("success"!==r.type)throw Error(`Could not put content:\ncould not migrate content for asset:\n${n.id}\n${n.type}\nreason:${r.reason}`);a[t]=r.value}const t=[];y=a.filter((e=>!this.store.has(e.id))).map((e=>("image"!==e.type&&"video"!==e.type||(e.props.src&&e.props.src?.startsWith("data:image")?(t.push(We(e)),e.props.src=null):t.push(We(e))),e))),Promise.allSettled(t.map((async e=>{const t=await(n=e.props.src,r=e.props.name,o=e.props.mimeType??"image/png",fetch(n).then((function(e){return e.arrayBuffer()})).then((function(e){return new File([e],r,{type:o})})));var n,r,o;const i=await this.getAssetForExternalContent({type:"file",file:t});return i?[e,i]:null}))).then((e=>{this.updateAssets(he(e.map((e=>"fulfilled"===e.status&&e.value?{...e.value[1],id:e.value[0].id}:void 0))))}))}for(let t=0;t<_.length;t++){const n=_[t],r=this.store.schema.migratePersistedRecord(n,e.schema);if("success"!==r.type)throw Error(`Could not put content:\ncould not migrate content for shape:\n${n.id}, ${n.type}\nreason:${r.reason}`);_[t]=r.value}return this.batch((()=>{y.length>0&&this.createAssets(y),this.createShapes(_),n&&this.select(...m.map((e=>e.id))),d!==s&&this.reparentShapes(m.map((e=>e.id)),d);const e=_.map((e=>this.getShape(e.id))),t=fo.Common(e.map((e=>this.getShapePageBounds(e))));if(void 0===i)if(Jt(d)){const e=this.getViewportPageBounds();i=o||e.includes(fo.From(t))?t.center:e.center}else{const e=this.getShape(d);i=ks.applyToPoint(this.getShapePageTransform(e),this.getShapeGeometry(e).bounds.center)}if(1===m.length){const e=m[0];if(this.isShapeOfType(e,"frame"))for(;this.getShapesAtPoint(i).some((t=>this.isShapeOfType(t,"frame")&&t.props.w===e.props.w&&t.props.h===e.props.h));)i.x+=t.w+16}const r=fo.Common(he(m.map((({id:e})=>this.getShapePageBounds(e))))).center,a=ho.Sub(i,r);this.updateShapes(m.map((({id:e})=>{const t=this.getShape(e),n=this.getShapeParentTransform(e).decompose().rotation,r=ho.Rot(a,-n);return{id:t.id,type:t.type,x:t.x+r.x,y:t.y+r.y}})))})),this}async getSvg(e,t={}){const n="string"==typeof e[0]?e:e.map((e=>e.id));if(0===n.length)return;if(!window.document)throw Error("No document");const{scale:r=1,background:o=!1,padding:i=ei,preserveAspectRatio:s=!1}=t,a=Ln({isDarkMode:this.user.getIsDarkMode()}),c=this.getShapeAndDescendantIds(n),l=this.getUnorderedRenderingShapes(!1).filter((({id:e})=>c.has(e)));let u=null;if(t.bounds)u=t.bounds;else for(const{maskedPageBounds:e}of l)e&&(u?u.union(e):u=e.clone());if(!u)return;const d=1===n.length&&this.isShapeOfType(this.getShape(n[0]),"frame")?n[0]:null;d||u.expandBy(i);const h=u.width*r,p=u.height*r,f=window.document.createElementNS("http://www.w3.org/2000/svg","svg");s&&f.setAttribute("preserveAspectRatio",s),f.setAttribute("direction","ltr"),f.setAttribute("width",h+""),f.setAttribute("height",p+""),f.setAttribute("viewBox",`${u.minX} ${u.minY} ${u.width} ${u.height}`),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),o?d?f.style.setProperty("background",a.solid):f.style.setProperty("background-color",a.background):f.style.setProperty("background-color","transparent");try{document.body.focus?.()}catch(e){}const g=window.document.createElementNS("http://www.w3.org/2000/svg","defs");f.append(g);const m=new Map,_={addExportDef:e=>{if(m.has(e.key))return;const t=(async()=>{const t=await e.getElement();if(!t)return;const n=document.createComment(`def: ${e.key}`);g.appendChild(n);for(const e of Array.isArray(t)?t:[t])g.appendChild(e)})();m.set(e.key,t)}},y=(await Promise.all(l.map((async({id:e,opacity:t,index:n,backgroundIndex:r})=>{if(e===d)return[];const o=this.getShape(e);if(this.isShapeOfType(o,"group"))return[];const i=this.getShapeUtil(o);let s=await(i.toSvg?.(o,_)),c=await(i.toBackgroundSvg?.(o,_));if(s){const e=document.createElementNS("http://www.w3.org/2000/svg","g");e.appendChild(s),s=e}if(c){const e=document.createElementNS("http://www.w3.org/2000/svg","g");e.appendChild(c),c=e}if(!s&&!c){const e=this.getShapePageBounds(o),t=window.document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("width",e.width+""),t.setAttribute("height",e.height+""),t.setAttribute("fill",a.solid),t.setAttribute("stroke",a.grey.pattern),t.setAttribute("stroke-width","1"),s=t}let l=this.getShapePageTransform(o).toCssString();"scale"in o.props&&1!==o.props.scale&&(l=`${l} scale(${o.props.scale}, ${o.props.scale})`),s?.setAttribute("transform",l),c?.setAttribute("transform",l),s?.setAttribute("opacity",t+""),c?.setAttribute("opacity",t+"");const u=this.getShapeMask(o.id);if(u){const e=document.createElementNS("http://www.w3.org/2000/svg","clipPath");g.appendChild(e);const t=ua();e.id=t;const n=document.createElementNS("http://www.w3.org/2000/svg","path");if(n.setAttribute("d",`M${u.map((({x:e,y:t})=>`${e},${t}`)).join("L")}Z`),e.appendChild(n),s){const e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttribute("clip-path",`url(#${t})`),e.appendChild(s),s=e}if(c){const e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttribute("clip-path",`url(#${t})`),e.appendChild(c),c=e}}const h=[];return s&&h.push({zIndex:n,element:s}),c&&h.push({zIndex:r,element:c}),h})))).flat();await Promise.all(m.values());for(const{element:e}of y.sort(((e,t)=>e.zIndex-t.zIndex)))f.appendChild(e);return f}inputs={originPagePoint:new ho,originScreenPoint:new ho,previousPagePoint:new ho,previousScreenPoint:new ho,currentPagePoint:new ho,currentScreenPoint:new ho,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new ho};_updateInputsFromEvent(e){const{previousScreenPoint:t,previousPagePoint:n,currentScreenPoint:r,currentPagePoint:o}=this.inputs,{screenBounds:i}=this.store.unsafeGetWithoutCapture(tn),{x:s,y:a,z:c}=e.point,{x:l,y:u,z:d}=this.getCamera();t.setTo(r),n.setTo(o),r.set(s,a),o.set((s-i.x)/d-l,(a-i.y)/d-u,c??.5),this.inputs.isPen="pointer"===e.type&&e.isPen,"pointer_down"===e.name&&this.inputs.pointerVelocity.set(0,0),this.store.put([{id:cn,typeName:"pointer",x:o.x,y:o.y,lastActivityTimestamp:"pointer"===e.type&&-10===e.pointerId?this.store.get(cn)?.lastActivityTimestamp??Date.now():Date.now(),meta:{}}])}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}_clickManager=new wc(this);cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}_prevCursor="default";_shiftKeyTimeout=-1;_setShiftKeyTimeout=()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})};_altKeyTimeout=-1;_setAltKeyTimeout=()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})};_ctrlKeyTimeout=-1;_setCtrlKeyTimeout=()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})};_restoreToolId="select";_pinchStart=1;_didPinch=!1;_selectedShapeIdsAtPointerDown=[];capturedPointerId=null;dispatch=e=>{if(this.getCrashingError())return this;const{inputs:t}=this,{type:n}=e;return this.batch((()=>{if("misc"===e.type)return"cancel"!==e.name&&"complete"!==e.name||(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}}))),void this.root.handleEvent(e);e.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,t.shiftKey=!0):!e.shiftKey&&t.shiftKey&&-1===this._shiftKeyTimeout&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),e.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,t.altKey=!0):!e.altKey&&t.altKey&&-1===this._altKeyTimeout&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),e.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,t.ctrlKey=!0):!e.ctrlKey&&t.ctrlKey&&-1===this._ctrlKeyTimeout&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:r,originScreenPoint:o,currentPagePoint:i,currentScreenPoint:s}=t;switch(t.isPointing||(t.isDragging=!1),n){case"pinch":if(!this.getInstanceState().canMoveCamera)return;switch(this._updateInputsFromEvent(e),e.name){case"pinch_start":if(t.isPinching)return;return void(t.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds()),this._didPinch=!0,t.isPinching=!0,this.interrupt()));case"pinch":{if(!t.isPinching)return;const{point:{x:n,y:r,z:o=1},delta:{x:i,y:s}}=e,{x:a,y:c,z:l}=this.getCamera(),u=Math.min(Jo,Math.max(Qo,o));return void this.setCamera({x:a+i/l-n/l+n/u,y:c+s/l-r/l+r/u,z:u})}case"pinch_end":{if(!t.isPinching)return this;t.isPinching=!1;const{_selectedShapeIdsAtPointerDown:e}=this;return this.setSelectedShapes(this._selectedShapeIdsAtPointerDown,{squashing:!0}),this._selectedShapeIdsAtPointerDown=[],void(this._didPinch&&(this._didPinch=!1,requestAnimationFrame((()=>{this._didPinch||this.setSelectedShapes(e,{squashing:!0})}))))}}case"wheel":if(!this.getInstanceState().canMoveCamera)return;if(this._updateInputsFromEvent(e),this.getIsMenuOpen());else{if(t.ctrlKey){const{x:t,y:n}=this.inputs.currentScreenPoint,{x:r,y:o,z:i}=this.getCamera(),s=Math.min(Jo,Math.max(Qo,i+(e.delta.z??0)*i));return void this.setCamera({x:r+(t/s-t)-(t/i-t),y:o+(n/s-n)-(n/i-n),z:s})}this.pan(e.delta),!t.isDragging&&t.isPointing&&r.dist(i)>(this.getInstanceState().isCoarsePointer?6:4)/this.getZoomLevel()&&(t.isDragging=!0)}break;case"pointer":{if(t.isPinching)return;this._updateInputsFromEvent(e);const{isPen:n}=e;switch(e.name){case"pointer_down":if(this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),0===e.button&&(this.capturedPointerId=e.pointerId),t.buttons.add(e.button),t.isPointing=!0,t.isDragging=!1,this.getInstanceState().isPenMode){if(!n)return}else n&&this.updateInstanceState({isPenMode:!0});if(5===e.button?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):1===e.button&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.updateInstanceState({cursor:{type:"grabbing",rotation:0}}),this;o.setTo(s),r.setTo(i);break;case"pointer_move":if(!n&&this.getInstanceState().isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:e,previousScreenPoint:t}=this.inputs;return void this.pan(ho.Sub(e,t))}!t.isDragging&&t.isPointing&&r.dist(i)>(this.getInstanceState().isCoarsePointer?6:4)/this.getZoomLevel()&&(t.isDragging=!0);break;case"pointer_up":if(t.buttons.delete(e.button),t.isPointing=!1,t.isDragging=!1,this.getIsMenuOpen())return;if(!n&&this.getInstanceState().isPenMode)return;this.capturedPointerId===e.pointerId&&(this.capturedPointerId=null,e.button=0),t.isPanning?1===e.button?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:ri}),this.updateInstanceState({cursor:{type:"grab",rotation:0}})):(t.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:ri}),this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}})):0===e.button&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:ri}),this.updateInstanceState({cursor:{type:"grab",rotation:0}})):5===e.button&&(this.complete(),this.setCurrentTool(this._restoreToolId))}break}case"keyboard":switch("ShiftRight"===e.key&&(e.key="ShiftLeft"),"AltRight"===e.key&&(e.key="AltLeft"),"ControlRight"===e.code&&(e.code="ControlLeft"),e.name){case"key_down":t.keys.add(e.code),e.ctrlKey||"Space"!==e.code||(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,this.updateInstanceState({cursor:{type:this.inputs.isPointing?"grabbing":"grab",rotation:0}}));break;case"key_up":t.keys.delete(e.code),"Space"!==e.code||this.inputs.buttons.has(1)||(this.inputs.isPanning=!1,this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}}))}}if("pointer"===e.type&&(1===e.button?e.name="middle_click":2===e.button&&(e.name="right_click"),e.isPen===this.getInstanceState().isPenMode))switch(e.name){case"pointer_down":{const t=this._clickManager.transformPointerDownEvent(e);if(e.name!==t.name)return this.root.handleEvent(e),this.emit("event",e),this.root.handleEvent(t),void this.emit("event",t);break}case"pointer_up":{const t=this._clickManager.transformPointerUpEvent(e);if(e.name!==t.name)return this.root.handleEvent(e),this.emit("event",e),this.root.handleEvent(t),void this.emit("event",t);break}case"pointer_move":this._clickManager.handleMove()}this.root.handleEvent(e),this.emit("event",e)})),this}}function gl(e,t=e.getCurrentPageId()){const n=e.getPage(t).name;e.emit("max-shapes",{name:n,pageId:t,count:Yo})}function ml(){const e=Yr();return le("isDarkMode",(()=>e.user.getIsDarkMode()),[e])}pl([J],fl.prototype,"getCanUndo",1),pl([J],fl.prototype,"getCanRedo",1),pl([J],fl.prototype,"_getArrowBindingsIndex",1),pl([J],fl.prototype,"getArrowInfoCache",1),pl([J],fl.prototype,"getPath",1),pl([J],fl.prototype,"getCurrentTool",1),pl([J],fl.prototype,"getCurrentToolId",1),pl([J],fl.prototype,"getDocumentSettings",1),pl([J],fl.prototype,"getInstanceState",1),pl([J],fl.prototype,"getOpenMenus",1),pl([J],fl.prototype,"getIsMenuOpen",1),pl([J],fl.prototype,"getPageStates",1),pl([J],fl.prototype,"_getPageStatesQuery",1),pl([J],fl.prototype,"getCurrentPageState",1),pl([J],fl.prototype,"_getCurrentPageStateId",1),pl([J],fl.prototype,"getSelectedShapeIds",1),pl([J],fl.prototype,"getSelectedShapes",1),pl([J],fl.prototype,"getOnlySelectedShape",1),pl([J],fl.prototype,"getSelectionPageBounds",1),pl([J],fl.prototype,"getSelectionRotation",1),pl([J],fl.prototype,"getSelectionRotatedPageBounds",1),pl([J],fl.prototype,"getFocusedGroupId",1),pl([J],fl.prototype,"getFocusedGroup",1),pl([J],fl.prototype,"getEditingShapeId",1),pl([J],fl.prototype,"getEditingShape",1),pl([J],fl.prototype,"getHoveredShapeId",1),pl([J],fl.prototype,"getHoveredShape",1),pl([J],fl.prototype,"getHintingShapeIds",1),pl([J],fl.prototype,"getHintingShape",1),pl([J],fl.prototype,"getErasingShapeIds",1),pl([J],fl.prototype,"getErasingShapes",1),pl([J],fl.prototype,"getCameraId",1),pl([J],fl.prototype,"getCamera",1),pl([J],fl.prototype,"getZoomLevel",1),pl([J],fl.prototype,"getViewportScreenBounds",1),pl([J],fl.prototype,"getViewportScreenCenter",1),pl([J],fl.prototype,"getViewportPageBounds",1),pl([J],fl.prototype,"getViewportPageCenter",1),pl([J],fl.prototype,"getRenderingShapes",1),pl([J],fl.prototype,"_getAllPagesQuery",1),pl([J],fl.prototype,"getPages",1),pl([J],fl.prototype,"_getAllAssetsQuery",1),pl([J],fl.prototype,"_getShapeGeometryCache",1),pl([J],fl.prototype,"_getShapeOutlineSegmentsCache",1),pl([J],fl.prototype,"_getShapeHandlesCache",1),pl([J],fl.prototype,"_getShapePageTransformCache",1),pl([J],fl.prototype,"_getShapePageBoundsCache",1),pl([J],fl.prototype,"_getShapeClipPathCache",1),pl([J],fl.prototype,"_getShapeMaskCache",1),pl([J],fl.prototype,"getCurrentPageBounds",1),pl([J],fl.prototype,"getCurrentPageShapes",1),pl([J],fl.prototype,"getCurrentPageShapesSorted",1),pl([J],fl.prototype,"getCurrentPageRenderingShapesSorted",1),pl([J({isEqual:(e,t)=>e.equals(t)})],fl.prototype,"getSharedStyles",1),pl([J],fl.prototype,"getSharedOpacity",1);const _l="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",yl="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",wl='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function vl(e,t,n,r,o,i=16,s=16){const a=_o/180*(-n-t),c=Math.sin(a),l=Math.cos(a);return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${o};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${1*l-1*c}' dy='${1*c+1*l}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${t+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+e.replaceAll('"',"'")+`</g></svg>") ${i} ${s}, pointer`}const bl={none:()=>"none",default:(e,t,n)=>vl('<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',e,0,t,n,12,8),pointer:(e,t,n)=>vl('<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',e,0,t,n,14,10),cross:(e,t,n)=>vl('<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',e,0,t,n),move:(e,t,n)=>vl('<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',e,0,t,n),grab:(e,t,n)=>vl('<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',e,0,t,n),grabbing:(e,t,n)=>vl("<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",e,0,t,n),text:(e,t,n)=>vl('<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',e,0,t,n,4,10),"ew-resize":(e,t,n)=>vl(yl,e,0,t,n),"ns-resize":(e,t,n)=>vl(yl,e,90,t,n),"nesw-resize":(e,t,n)=>vl(_l,e,0,t,n),"nwse-resize":(e,t,n)=>vl(_l,e,90,t,n),"nwse-rotate":(e,t,n)=>vl(wl,e,0,t,n),"nesw-rotate":(e,t,n)=>vl(wl,e,90,t,n),"senw-rotate":(e,t,n)=>vl(wl,e,180,t,n),"swne-rotate":(e,t,n)=>vl(wl,e,270,t,n),"zoom-in":(e,t,n)=>vl('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n),"zoom-out":(e,t,n)=>vl('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',e,0,t,n)};function xl(e,t=0,n="black"){return bl[e](180*t/_o,!1,n)}const Sl=["default","pointer","cross","move","grab","grabbing","text"],kl="TLDRAW_TAB_ID_v2",Cl=globalThis.window,El=Cl?.[kl]??Cl?.sessionStorage[kl]??"TLDRAW_INSTANCE_STATE_V1_"+ua();Cl&&(Cl[kl]=El,Cl&&(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(Cl.navigator.platform)||Cl.navigator.userAgent.includes("Mac")&&"ontouchend"in document)?Cl.sessionStorage[kl]=El:delete Cl.sessionStorage[kl]),Cl?.addEventListener("beforeunload",(()=>{Cl.sessionStorage[kl]=El}));const Al=Mt({version:vt,currentPageId:Zt,isFocusMode:Et,exportBackground:Et,isDebugMode:Et,isToolLocked:Et,isGridMode:Et,pageStates:Pt(Mt({pageId:Zt,camera:Mt({x:vt,y:vt,z:vt}),selectedShapeIds:Pt(rn),focusedGroupId:rn.nullable()}))}),Il=ot({currentVersion:0});const Pl=(e,t)=>t.some((t=>e instanceof t));let Ml,Tl;const jl=new WeakMap,Dl=new WeakMap,Ol=new WeakMap,zl=new WeakMap,Fl=new WeakMap;let Rl={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Dl.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ol.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nl(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Ll(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Tl||(Tl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Bl(this),e),Nl(jl.get(this))}:function(...e){return Nl(t.apply(Bl(this),e))}:function(e,...n){const r=t.call(Bl(this),e,...n);return Ol.set(r,e.sort?e.sort():[e]),Nl(r)}:(e instanceof IDBTransaction&&function(e){if(Dl.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));Dl.set(e,t)}(e),Pl(e,Ml||(Ml=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Rl):e);var t}function Nl(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(Nl(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&jl.set(t,e)})).catch((()=>{})),Fl.set(t,e),t}(e);if(zl.has(e))return zl.get(e);const t=Ll(e);return t!==e&&(zl.set(e,t),Fl.set(t,e)),t}const Bl=e=>Fl.get(e),$l=["get","getKey","getAll","getAllKeys","count"],Ul=["put","add","delete","clear"],Vl=new Map;function Wl(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Vl.get(t))return Vl.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=Ul.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!$l.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let s=i.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),o&&i.done]))[0]};return Vl.set(t,i),i}var Kl;Kl=Rl,Rl={...Kl,get:(e,t,n)=>Wl(e,t)||Kl.get(e,t,n),has:(e,t)=>!!Wl(e,t)||Kl.has(e,t)};const Hl="TLDRAW_DOCUMENT_v2",Gl="TLDRAW_DB_NAME_INDEX_v2",ql={Records:"records",Schema:"schema",SessionState:"session_state"};async function Yl(e,t){!function(e){const t=new Set(Xl());t.add(e),window?.localStorage.setItem(Gl,JSON.stringify([...t]))}(e);const n=await function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=Nl(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Nl(s.result),e.oldVersion,e.newVersion,Nl(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(e,3,{upgrade(e){e.objectStoreNames.contains(ql.Records)||e.createObjectStore(ql.Records),e.objectStoreNames.contains(ql.Schema)||e.createObjectStore(ql.Schema),e.objectStoreNames.contains(ql.SessionState)||e.createObjectStore(ql.SessionState)}});try{return await t(n)}finally{n.close()}}function Xl(){const e=JSON.parse(window?.localStorage.getItem(Gl)||"[]")??[];return Array.isArray(e)?e:[]}const Zl=Symbol("UPDATE_INSTANCE_STATE"),Ql="undefined"==typeof BroadcastChannel?class{onmessage;constructor(e){}postMessage(e){}close(){}}:BroadcastChannel;class Jl{constructor(e,{persistenceKey:t,sessionId:n=El,onLoad:r,onLoadError:o},i=new Ql(`tldraw-tab-sync-${t}`)){this.store=e,this.channel=i,"undefined"!=typeof window&&(window.tlsync=this),this.persistenceKey=t,this.sessionId=n,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=function(e){const t=e.query.ids("page");return J("sessionStateSnapshot",(()=>{const n=e.get(tn);if(!n)return null;const r=[...t.get()];return{version:0,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map((t=>{const n=e.get(sn.createId(t)),r=e.get(Ut.createId(t));return{pageId:t,camera:{x:r?.x??0,y:r?.y??0,z:r?.z??1},selectedShapeIds:n?.selectedShapeIds??[],focusedGroupId:n?.focusedGroupId??null}}))}}))}(this.store),this.disposables.add(e.listen((({changes:e})=>{this.diffQueue.push(e),this.channel.postMessage({type:"diff",storeId:this.store.id,changes:e,schema:this.serializedSchema}),this.schedulePersist()}),{source:"user",scope:"document"})),this.disposables.add(e.listen((()=>{this.diffQueue.push(Zl),this.schedulePersist()}),{scope:"session"})),this.connect(r,o),this.documentTypes=new Set(Object.values(this.store.schema.types).filter((e=>"document"===e.scope)).map((e=>e.typeName)))}disposables=new Set;diffQueue=[];didDispose=!1;shouldDoFullDBWrite=!0;isReloading=!1;persistenceKey;sessionId;serializedSchema;isDebugging=!1;documentTypes;$sessionStateSnapshot;initTime=Date.now();debug(...e){this.isDebugging&&console.debug(...e)}async connect(e,t){let n;this.debug("connecting");try{n=await async function({persistenceKey:e,sessionId:t,didCancel:n}){const r=Hl+e;if(Xl().includes(r))return await async function({persistenceKey:e,didCancel:t}){await Yl(Hl+e,(async e=>{const n=e.transaction([ql.SessionState],"readwrite"),r=n.objectStore(ql.SessionState),o=(await r.getAll()).sort(((e,t)=>e.updatedAt-t.updatedAt));if(o.length<10)return void await n.done;const i=o.slice(0,o.length-10);for(const{id:e}of i)await r.delete(e);if(t?.())return n.abort();await n.done}))}({persistenceKey:e,didCancel:n}),await Yl(r,(async e=>{if(n?.())return;const r=e.transaction([ql.Records,ql.Schema,ql.SessionState],"readonly"),o=r.objectStore(ql.Records),i=r.objectStore(ql.Schema),s=r.objectStore(ql.SessionState);let a=t?(await s.get(t))?.snapshot:null;if(!a){const e=await s.getAll();a=e.sort(((e,t)=>e.updatedAt-t.updatedAt)).pop()?.snapshot}const c={records:await o.getAll(),schema:await i.get(ql.Schema),sessionStateSnapshot:a};if(!n?.())return await r.done,c;r.abort()}))}({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(e){return t(e),window.alert("Oops! We could not access your browser's storageand the app won't work correctly without that. We now need to reload the page and try again.\n\nKeep seeing this message?\n If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser."),void("undefined"!=typeof window&&window.location.reload())}if(this.debug("loaded data from store",n,"didDispose",this.didDispose),!this.didDispose)try{if(n){const e=Object.fromEntries(n.records.map((e=>[e.id,e]))),r=n.sessionStateSnapshot??function(e){const t=[];for(const n of Object.values(e))n.typeName?.match(/^(instance.*|pointer|camera)$/)&&t.push(n);const n=t.filter((e=>"instance"===e.typeName&&e.id!==tn))[0];if(!n)return null;const r={version:0,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:t.filter((e=>"instance_page_state"===e.typeName&&e.instanceId===n.id)).map((t=>{const n=e[t.cameraId]??{x:0,y:0,z:1};return{pageId:t.pageId,camera:{x:n.x,y:n.y,z:n.z},selectedShapeIds:t.selectedShapeIds,focusedGroupId:t.focusedGroupId}}))};try{return Al.validate(r),r}catch(e){return null}}(e),o=this.store.schema.migrateStoreSnapshot({store:e,schema:n.schema??this.store.schema.serializeEarliestVersion()});if("error"===o.type)return console.error("failed to migrate store",o),void t(new Error(`Failed to migrate store: ${o.reason}`));this.store.mergeRemoteChanges((()=>{this.store.put(Object.values(o.value).filter((e=>this.documentTypes.has(e.typeName))),"initialize")})),r&&function(e,t){const n=function(e){if(!e||"object"!=typeof e)return console.warn("Invalid instance state"),null;if(!("version"in e)||"number"!=typeof e.version)return console.warn("No version in instance state"),null;const t=at({value:e,fromVersion:e.version,toVersion:0,migrations:Il});if("error"===t.type)return console.warn(t.reason),null;const n={...t.value,version:0};try{Al.validate(n)}catch(e){return console.warn(e),null}return n}(t);if(!n)return;const r={added:{},updated:{},removed:{...Oe(e.allRecords().filter((e=>"instance_page_state"===e.typeName||"camera"===e.typeName)).map((e=>[e.id,e])))}};e.has(tn)&&(r.removed[tn]=e.get(tn));const o={removed:{},updated:{},added:{[tn]:e.schema.types.instance.create({id:tn,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground})}};for(const e of n.pageStates){const t=Ut.createId(e.pageId),n=sn.createId(e.pageId);o.added[t]=Ut.create({id:Ut.createId(e.pageId),x:e.camera.x,y:e.camera.y,z:e.camera.z}),o.added[n]=sn.create({id:sn.createId(e.pageId),pageId:e.pageId,selectedShapeIds:e.selectedShapeIds,focusedGroupId:e.focusedGroupId})}B((()=>{e.applyDiff(nt([r,o])),e.ensureStoreIsUsable()}))}(this.store,r)}this.channel.onmessage=({data:e})=>{this.debug("got message",e);const n=e,r=((e,t)=>{if(e.schemaVersion>t.schemaVersion)return 1;if(e.schemaVersion<t.schemaVersion)return-1;if(e.storeVersion>t.storeVersion)return 1;if(e.storeVersion<t.storeVersion)return-1;for(const n of Object.keys(e.recordVersions)){const r=e.recordVersions[n],o=t.recordVersions[n];if(r.version>o.version)return 1;if(r.version<o.version)return-1;if("subTypeVersions"in r&&!("subTypeVersions"in o))return 1;if(!("subTypeVersions"in r)&&"subTypeVersions"in o)return-1;if("subTypeVersions"in r&&"subTypeVersions"in o)for(const e of Object.keys(r.subTypeVersions)){const t=r.subTypeVersions[e],n=o.subTypeVersions[e];if(t>n)return 1;if(t<n)return-1}}return 0})(this.serializedSchema,n.schema??this.store.schema.serializeEarliestVersion());return-1===r?Date.now()-this.initTime<5e3?void t(new Error("Schema mismatch, please close other tabs and reload the page")):(this.debug("reloading"),this.isReloading=!0,void window?.location?.reload?.()):1===r?(this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,void this.persistIfNeeded()):void("diff"===n.type&&(this.debug("applying diff"),B((()=>{this.store.mergeRemoteChanges((()=>{this.store.applyDiff(n.changes),this.store.ensureStoreIsUsable()}))}))))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add((()=>{this.channel.close()})),e(this)}catch(e){if(this.debug("error loading data from store",e),this.didDispose)return;return void t(e)}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach((e=>e()))}isPersisting=!1;didLastWriteError=!1;scheduledPersistTimeout=null;schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),this.scheduledPersistTimeout||(this.scheduledPersistTimeout=setTimeout((()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()}),this.didLastWriteError?1e4:350))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),this.isPersisting||this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist()}async doPersist(){me(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const e=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await async function({persistenceKey:e,schema:t,snapshot:n,sessionId:r,sessionStateSnapshot:o,didCancel:i}){const s=Hl+e;await Yl(s,(async e=>{const s=e.transaction([ql.Records,ql.Schema,ql.SessionState],"readwrite"),a=s.objectStore(ql.Records),c=s.objectStore(ql.Schema),l=s.objectStore(ql.SessionState);await a.clear();for(const[e,t]of Object.entries(n))await a.put(t,e);if(c.put(t.serialize(),ql.Schema),o&&r?l.put({snapshot:o,updatedAt:Date.now(),id:r},r):(o||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),i?.())return s.abort();await s.done}))}({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const t=nt(e.filter((e=>e!==Zl)));await async function({persistenceKey:e,schema:t,changes:n,sessionId:r,sessionStateSnapshot:o,didCancel:i}){const s=Hl+e;await Yl(s,(async e=>{const s=e.transaction([ql.Records,ql.Schema,ql.SessionState],"readwrite"),a=s.objectStore(ql.Records),c=s.objectStore(ql.Schema),l=s.objectStore(ql.SessionState);for(const[e,t]of Object.entries(n.added))await a.put(t,e);for(const[e,t]of Object.values(n.updated))await a.put(t,t.id);for(const e of Object.keys(n.removed))await a.delete(e);if(c.put(t.serialize(),ql.Schema),o&&r?l.put({snapshot:o,updatedAt:Date.now(),id:r},r):(o||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),i?.())return s.abort();await s.done}))}({persistenceKey:this.persistenceKey,changes:t,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(e){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",e),window.alert("Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.\n\nKeep seeing this message?\n If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser.\n If your hard disk is full, try clearing up some space and then reload the page."),"undefined"!=typeof window&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function eu({initialData:e,defaultName:t="",...n}){const r="schema"in n&&n.schema?n.schema:zn({shapes:(o=Ha("shapeUtils"in n&&n.shapeUtils?n.shapeUtils:[]),Object.fromEntries(o.map((e=>[e.type,{props:e.props,migrations:e.migrations}]))))});var o;return new tt({schema:r,initialData:e,props:{defaultName:t}})}let tu=!1;if("undefined"!=typeof window){const e=window.navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),n=!!e.match(/WebKit/i);tu=t&&n&&!e.match(/CriOS/i)}const nu=[],ru=[],ou=(0,e.memo)((function({store:t,components:n,className:r,user:o,...i}){const[s,a]=e.useState(null),c=(0,e.useMemo)((()=>o??ka()),[o]),l=void 0===n?.ErrorFallback?qo:n?.ErrorFallback,u={...i,shapeUtils:i.shapeUtils??nu,tools:i.tools??ru};return(0,Fr.jsx)("div",{ref:a,draggable:!1,className:Rr("tl-container tl-theme__light",r),onPointerDown:Hr,tabIndex:-1,children:(0,Fr.jsx)(ro,{fallback:l,onError:e=>ve(e,{tags:{origin:"react.tldraw-before-app"}}),children:s&&(0,Fr.jsx)(Zr,{container:s,children:(0,Fr.jsx)(bi,{overrides:n,children:t?t instanceof tt?(0,Fr.jsx)(au,{...u,store:t,user:c}):(0,Fr.jsx)(su,{...u,store:t,user:c}):(0,Fr.jsx)(iu,{...u,store:t,user:c})})})})})}));function iu(t){const{defaultName:n,snapshot:r,initialData:o,shapeUtils:i,persistenceKey:s,sessionId:a,user:c}=t,l=function({persistenceKey:t,sessionId:n,...r}){const[o,i]=(0,e.useState)(null),s=function(t){const[n,r]=(0,e.useState)((()=>{const e=eu(t);return t.snapshot&&e.loadSnapshot(t.snapshot),e})),o=(0,e.useRef)(t);if((0,e.useEffect)((()=>{o.current=t})),Object.keys(o.current).some((e=>o.current[e]!==t[e]))){const e=eu(t);return t.snapshot&&e.loadSnapshot(t.snapshot),r(e),e}return n}(r);return(0,e.useEffect)((()=>{const e=ua();if(!t)return void i({id:e,storeWithStatus:{status:"not-synced",store:s}});i({id:e,storeWithStatus:{status:"loading"}});const r=t=>{i((n=>n?.id===e?{id:e,storeWithStatus:t}:n))},o=new Jl(s,{sessionId:n,persistenceKey:t,onLoad(){r({store:s,status:"synced-local"})},onLoadError(e){r({status:"error",error:e})}});return()=>{i((t=>t?.id===e?null:t)),o.close()}}),[t,s,n]),o?.storeWithStatus??{status:"loading"}}({shapeUtils:i,initialData:o,persistenceKey:s,sessionId:a,defaultName:n,snapshot:r});return(0,Fr.jsx)(su,{...t,store:l,user:c})}const su=(0,e.memo)((function({store:t,user:n,...r}){const o=Qr();switch((0,e.useLayoutEffect)((()=>{n.userPreferences.get().isDarkMode&&(o.classList.remove("tl-theme__light"),o.classList.add("tl-theme__dark"))}),[o,n]),t.status){case"error":throw t.error;case"loading":return(0,Fr.jsx)(uu,{children:"Connecting..."})}return(0,Fr.jsx)(au,{...r,store:t.store,user:n})}));function au({onMount:t,children:n,store:r,tools:o,shapeUtils:i,user:s,initialState:a,autoFocus:c=!0,inferDarkMode:l}){const{ErrorFallback:u}=xi(),d=Qr(),[h,p]=(0,e.useState)(null);(0,e.useLayoutEffect)((()=>{const e=new fl({store:r,shapeUtils:i,tools:o,getContainer:()=>d,user:s,initialState:a,inferDarkMode:l});return window.app=e,window.editor=e,p(e),()=>{e.dispose()}}),[d,i,o,r,s,a,l]);const f=(0,e.useSyncExternalStore)((0,e.useCallback)((e=>h?(h.on("crash",e),()=>h.off("crash",e)):()=>{}),[h]),(()=>h?.getCrashingError()??null));return h?(0,Fr.jsx)(ro,{fallback:u,onError:e=>h.annotateError(e,{origin:"react.tldraw",willCrashApp:!0}),children:f?(0,Fr.jsx)(lu,{crashingError:f}):(0,Fr.jsx)(qr.Provider,{value:h,children:(0,Fr.jsx)(cu,{autoFocus:c,onMount:t,children:n})})}):null}function cu({children:t,onMount:n,autoFocus:r}){return function(){const t=Yr(),n=Qr();e.useEffect((()=>{const e=e=>n.style.setProperty("--tl-zoom",e.toString()),r=ye(e,100),o=new ee("useZoomCss",(()=>{t.getCurrentPageShapeIds().size<300?e(t.getZoomLevel()):r(t.getZoomLevel())}));return o.attach(),o.execute(),()=>{o.detach()}}),[t,n])}(),function(){const e=Yr(),t=Qr(),n=ml();ce("useCursor",(()=>{const{type:r,rotation:o}=e.getInstanceState().cursor;Sl.includes(r)?t.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`):t.style.setProperty("--tl-cursor",xl(r,o,n?"white":"black"))}),[e,t,n])}(),function(){const t=Yr(),n=Qr(),r=ml(),o=le(Nr.forceSrgb);e.useEffect((()=>{r?(n.setAttribute("data-color-mode","dark"),n.classList.remove("tl-theme__light"),n.classList.add("tl-theme__dark")):(n.setAttribute("data-color-mode","light"),n.classList.remove("tl-theme__dark"),n.classList.add("tl-theme__light")),o?n.classList.add("tl-theme__force-sRGB"):n.classList.remove("tl-theme__force-sRGB")}),[t,n,o,r])}(),function(){const t=Yr();e.useEffect((()=>{if(tu)return document.addEventListener("focusout",e),()=>document.removeEventListener("focusout",e);function e(e){(e.target instanceof HTMLInputElement&&"text"===e.target.type||e.target instanceof HTMLTextAreaElement)&&t.complete()}}),[t])}(),function(){const[t,n]=(0,e.useState)(0);(0,e.useEffect)((()=>n((e=>e+1))),[])}(),function(t){const n=Yr(),r=Qr();(0,e.useLayoutEffect)((()=>{t?(n.getInstanceState().isFocused||n.updateInstanceState({isFocused:!0}),n.getContainer().focus()):n.getInstanceState().isFocused&&n.updateInstanceState({isFocused:!1})}),[n,r,t])}(r),function(t){const n=Yr(),r=function(t){const n=(0,e.useRef)();return(0,e.useLayoutEffect)((()=>{n.current=t})),(0,e.useDebugValue)(t),(0,e.useCallback)(((...e)=>{const t=n.current;return me(t,"fn does not exist"),t(...e)}),[])}((e=>{const n=t?.(e);return e.emit("mount"),window.tldrawReady=!0,n}));e.useLayoutEffect((()=>{if(n)return r?.(n)}),[n,r])}(n),function(){const t=Yr(),n=Qr();e.useEffect((()=>te("useDPRMultiple",(()=>{const e=t.getInstanceState().devicePixelRatio;n.style.setProperty("--tl-dpr-multiple",Os(e).toString())}))),[t,n])}(),Yr().updateViewportScreenBounds(),t??(0,Fr.jsx)(Ns,{})}function lu({crashingError:e}){throw e}function uu({children:e}){const{Spinner:t}=xi();return(0,Fr.jsxs)("div",{className:"tl-loading",children:[t?(0,Fr.jsx)(t,{}):null,e]})}function du({children:e}){return(0,Fr.jsx)("div",{className:"tl-loading",children:e})}function hu({children:e,className:t="",...n}){return(0,Fr.jsx)("div",{...n,className:`tl-html-container ${t}`,children:e})}se((function({x:t=0,y:n=0,rotation:r=0,...o}){const i=Yr(),s=(0,e.useRef)(null),a=i.getCamera();return(0,e.useLayoutEffect)((()=>{const{x:e,y:o,z:a}=i.getCamera(),c=s.current;c&&void 0!==e&&(c.style.transform=`translate(${e}px, ${o}px) scale(${a}) rotate(${r}rad) translate(${t}px, ${n}px)`)}),[a,i,t,n,r]),(0,Fr.jsx)("div",{ref:s,...o,className:Rr("tl-positioned",o.className)})}));class pu extends Ua{getGeometry(e){return new $a({width:e.props.w,height:e.props.h,isFilled:!0})}onResize=(e,t)=>function(e,t,n={}){const{newPoint:r,handle:o,scaleX:i,scaleY:s}=t,{minWidth:a=1,maxWidth:c=1/0,minHeight:l=1,maxHeight:u=1/0}=n;let d=e.props.w*i,h=e.props.h*s;const p=new ho(0,0);if(d>0){if(d<a){switch(o){case"top_left":case"left":case"bottom_left":p.x=d-a;break;case"top":case"bottom":p.x=(d-a)/2;break;default:p.x=0}d=a}}else if(p.x=d,d=-d,d<a){switch(o){case"top_left":case"left":case"bottom_left":p.x=-d;break;default:p.x=-a}d=a}if(h>0){if(h<l){switch(o){case"top_left":case"top":case"top_right":p.y=h-l;break;case"right":case"left":p.y=(h-l)/2;break;default:p.y=0}h=l}}else if(p.y=h,h=-h,h<l){switch(o){case"top_left":case"top":case"top_right":p.y=-h;break;default:p.y=-l}h=l}const{x:f,y:g}=p.rot(e.rotation).add(r);return{x:f,y:g,props:{w:Math.min(c,d),h:Math.min(u,h)}}}(e,t)}function fu(e,t,n){const r="end"===t?e.end.arrowhead:e.start.arrowhead;if("none"===r)return;const o=function(e,t,n){const r="end"===t?e.end.point:e.start.point,o="end"===t?e.start.point:e.end.point,i=e.isStraight?ho.Dist(o,r):Math.abs(e.bodyArc.length),s=Math.max(Math.min(i/5,3*n),n);let a;if(e.isStraight)a=ho.Nudge(r,o,s);else{const n=function(e,t,n,r){let o=n.x-e.x,i=n.y-e.y;const s=Math.sqrt(o*o+i*i),a=(s*s-r*r+t*t)/(2*s),c=Math.sqrt(t*t-a*a);return o/=s,i/=s,[new ho(e.x+o*a-i*c,e.y+i*a+o*c),new ho(e.x+o*a+i*c,e.y+i*a-o*c)]}(r,s,e.handleArc.center,e.handleArc.radius);a="end"===t?e.handleArc.sweepFlag?n[0]:n[1]:e.handleArc.sweepFlag?n[1]:n[0]}return{point:r,int:a}}(e,t,n);if(o){switch(r){case"bar":return function({int:e,point:t}){const n=ho.Sub(e,t).div(2),r=ho.Add(t,ho.Rot(n,yo)),o=ho.Sub(t,ho.Rot(n,yo));return`M ${r.x} ${r.y} L ${o.x} ${o.y}`}(o);case"square":return function({int:e,point:t}){const n=ho.Lrp(t,e,.85),r=ho.Sub(n,t).div(2),o=ho.Add(t,ho.Rot(r,yo)),i=ho.Sub(t,ho.Rot(r,yo)),s=ho.Add(n,ho.Rot(r,yo)),a=ho.Sub(n,ho.Rot(r,yo));return`M ${o.x} ${o.y} L ${s.x} ${s.y} L ${a.x} ${a.y} L ${i.x} ${i.y} Z`}(o);case"diamond":return function({point:e,int:t}){const n=ho.Lrp(e,t,.75),r=ho.RotWith(n,e,_o/4),o=ho.RotWith(n,e,-_o/4),i=ho.Lrp(r,o,.5);return i.add(ho.Sub(i,e)),`M ${i.x} ${i.y} L ${r.x} ${r.y} ${e.x} ${e.y} L ${o.x} ${o.y} Z`}(o);case"dot":return function({point:e,int:t}){const n=ho.Lrp(e,t,.45),r=ho.Dist(n,e);return`M ${n.x-r},${n.y}\n  a ${r},${r} 0 1,0 ${2*r},0\n  a ${r},${r} 0 1,0 -${2*r},0 `}(o);case"inverted":return function({point:e,int:t}){const n=ho.Sub(t,e).div(2),r=ho.Add(e,ho.Rot(n,yo)),o=ho.Sub(e,ho.Rot(n,yo));return`M ${r.x} ${r.y} L ${t.x} ${t.y} L ${o.x} ${o.y} Z`}(o);case"arrow":return function({point:e,int:t}){const n=ho.RotWith(t,e,_o/6),r=ho.RotWith(t,e,-_o/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y}`}(o);case"triangle":return function({point:e,int:t}){const n=ho.RotWith(t,e,_o/6),r=ho.RotWith(t,e,-_o/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y} Z`}(o)}return""}}class gu extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}}class mu extends ll{static id="pointing";markId="";wasFocusedOnEnter=!1;onEnter=()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen()};onPointerMove=e=>{if(this.editor.inputs.isDragging){const{originPagePoint:t}=this.editor.inputs,n=this.parent.shapeType,r=jn();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:n,x:t.x,y:t.y,props:{w:1,h:1}}]).select(r),this.editor.setCurrentTool("select.resizing",{...e,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){const{originPagePoint:e}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const t=this.parent.shapeType,n=jn();this.editor.mark(this.markId),this.editor.createShapes([{id:n,type:t,x:e.x,y:e.y}]);const r=this.editor.getShape(n),{w:o,h:i}=this.editor.getShapeUtil(r).getDefaultProps(),s=new ho(o/2,i/2),a=this.editor.getShapeParentTransform(r);a&&s.rot(-a.rotation()),this.editor.updateShapes([{id:n,type:t,x:r.x-s.x,y:r.y-s.y}]),this.editor.setSelectedShapes([n]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}}class _u extends ll{static id="box";static initial="idle";static children=()=>[gu,mu]}function yu(e){const t=Yr();return le("isCropping",(()=>t.getCroppingShapeId()===e),[t,e])}function wu(e){const t=Yr();return le("isEditing",(()=>t.getEditingShapeId()===e),[t,e])}function vu(t){const n=Yr();return(0,e.useMemo)((function(){let e,r;return{onPointerDown:e=>{if(e.isKilled)return;if(2===e.button)return void n.dispatch({type:"pointer",target:"selection",handle:t,name:"right_click",...Gr(e)});if(0!==e.button)return;const r=Ur(e.currentTarget);Wr(r,e),r.addEventListener("pointerup",(function t(){r.removeEventListener("pointerup",t),Kr(r,e)})),n.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...Gr(e)}),Hr(e)},onPointerMove:function(o){o.isKilled||0===o.button&&(o.clientX===e&&o.clientY===r||(e=o.clientX,r=o.clientY,n.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...Gr(o)})))},onPointerUp:e=>{e.isKilled||0===e.button&&n.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...Gr(e)})}}}),[n,t])}function bu(e,t=20){return Math.max(8,Math.ceil(e/t))}class xu extends Aa{_center;radius;start;end;measure;length;angleStart;angleEnd;constructor(e){super({...e,isFilled:!1,isClosed:!1});const{center:t,radius:n,sweepFlag:r,largeArcFlag:o,start:i,end:s}=e;if(i.equals(s))throw Error("Arc must have different start and end points.");this.angleStart=ho.Angle(t,i),this.angleEnd=ho.Angle(t,s),this.measure=function(e,t,n,r){const o=(t-e)%wo*2%wo-(t-e)%wo;return r?(wo-Math.abs(o))*(n?1:-1):o}(this.angleStart,this.angleEnd,r,o),this.length=this.measure*n,this.start=i,this.end=s,this._center=t,this.radius=n}nearestPoint(e){const{_center:t,measure:n,radius:r,angleEnd:o,angleStart:i,start:s,end:a}=this,c=Su(n,i,o,t.angle(e));if(c<=0)return s;if(c>=1)return a;const l=t.clone().add(e.clone().sub(t).uni().mul(r));let u,d=1/0;for(const t of[s,a,l])e.dist(t)<d&&(u=t,d=e.dist(t));if(!u)throw Error("nearest point not found");return u}hitTestLineSegment(e,t,n){const{_center:r,radius:o,measure:i,angleStart:s,angleEnd:a}=this,c=Ma(e,t,r,o);return null!==c&&c.some((e=>{const t=Su(i,s,a,r.angle(e));return t>=0&&t<=1}))}getVertices(){const{_center:e,measure:t,length:n,radius:r,angleStart:o}=this,i=[];for(let s=0,a=bu(Math.abs(n));s<a+1;s++){const n=o+s/a*t;i.push(e.clone().add(new ho(Math.cos(n),Math.sin(n)).mul(r)))}return i}}function Su(e,t,n,r){let o;if(Math.abs(e)>_o){o=Po(t,r);const i=Po(r,n);return Math.abs(o)<Math.abs(i)?o/e:(e-i)/e}return o=Po(t,r),o/e}class ku extends Aa{constructor(e){super({isClosed:!0,...e}),this.config=e;const{x:t=0,y:n=0,radius:r}=e;this.x=t,this.y=n,this._center=new ho(r+t,r+n),this.radius=r}_center;radius;x;y;getBounds(){return new fo(this.x,this.y,2*this.radius,2*this.radius)}getVertices(){const{_center:e,radius:t}=this,n=[];for(let r=0,o=bu(wo*t);r<o;r++){const i=r/o*wo;n.push(e.clone().add(ho.FromAngle(i).mul(t)))}return n}nearestPoint(e){const{_center:t,radius:n}=this;return t.equals(e)?ho.AddXY(t,n,0):t.clone().add(e.clone().sub(t).uni().mul(n))}hitTestLineSegment(e,t,n){const{_center:r,radius:o}=this;return null!==Ma(e,t,r,o)}}class Cu extends Na{a;b;c;d;constructor(e){const{start:t,cp1:n,cp2:r,end:o}=e;super({...e,points:[t,o]}),this.a=t,this.b=n,this.c=r,this.d=o}getVertices(){const e=[],{a:t,b:n,c:r,d:o}=this;for(let i=0,s=10;i<=s;i++){const a=i/s;e.push(new ho((1-a)*(1-a)*(1-a)*t.x+(1-a)*(1-a)*3*a*n.x+3*(1-a)*(a*a)*r.x+a*a*a*o.x,(1-a)*(1-a)*(1-a)*t.y+(1-a)*(1-a)*3*a*n.y+3*(1-a)*(a*a)*r.y+a*a*a*o.y))}return e}midPoint(){return function(e,t){const{a:n,b:r,c:o,d:i}=e;return new ho(.125*n.x+.375*r.x+.375*o.x+.125*i.x,.125*n.y+.375*r.y+.375*o.y+.125*i.y)}(this)}nearestPoint(e){let t,n=1/0;for(const r of this.segments){const o=r.nearestPoint(e),i=o.dist(e);i<n&&(t=o,n=i)}if(!t)throw Error("nearest point not found");return t}}class Eu extends Aa{points;constructor(e){super({...e,isClosed:!1,isFilled:!1});const{points:t}=e;this.points=t}_segments;get segments(){if(!this._segments){this._segments=[];const{points:e}=this,t=e.length,n=t-2,r=1.25;for(let o=0;o<t-1;o++){const t=0===o?e[0]:e[o-1],i=e[o],s=e[o+1],a=o===n?s:e[o+2],c=i,l=0===o?t:new ho(i.x+(s.x-t.x)/6*r,i.y+(s.y-t.y)/6*r),u=o===n?s:new ho(s.x-(a.x-i.x)/6*r,s.y-(a.y-i.y)/6*r),d=s;this._segments.push(new Cu({start:c,cp1:l,cp2:u,end:d}))}}return this._segments}_length;get length(){return this._length||(this._length=this.segments.reduce(((e,t)=>e+t.length),0)),this._length}getVertices(){const e=this.segments.reduce(((e,t)=>e.concat(t.vertices)),[]);return e.push(this.points[this.points.length-1]),e}nearestPoint(e){let t,n=1/0;for(const r of this.segments){const o=r.nearestPoint(e),i=o.dist(e);i<n&&(t=o,n=i)}if(!t)throw Error("nearest point not found");return t}hitTestLineSegment(e,t,n){return this.segments.some((r=>r.hitTestLineSegment(e,t,n)))}}class Au extends Aa{constructor(e){super({...e,isClosed:!0}),this.config=e;const{width:t,height:n}=e;this.w=t,this.h=n}w;h;_edges;get edges(){if(!this._edges){const{vertices:e}=this;this._edges=[];for(let t=0,n=e.length;t<n;t++){const r=e[t],o=e[(t+1)%n];this._edges.push(new La({start:r,end:o}))}}return this._edges}getVertices(){const e=Math.max(1,this.w)/2,t=Math.max(1,this.h)/2,n=Math.pow(e-t,2)/Math.pow(e+t,2),r=bu(_o*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))),o=wo/r,i=Math.cos(o),s=Math.sin(o);let a=0,c=1,l=0,u=1;const d=Array(r);for(let n=0;n<r;n++)d[n]=new ho(e+e*c,t+t*a),l=s*c+i*a,u=i*c-s*a,a=l,c=u;return d}nearestPoint(e){let t,n=1/0;for(const r of this.edges){const o=r.nearestPoint(e),i=o.dist(e);i<n&&(t=o,n=i)}if(!t)throw Error("nearest point not found");return t}hitTestLineSegment(e,t,n){return this.edges.some((r=>r.hitTestLineSegment(e,t,n)))}getBounds(){return new fo(0,0,this.w,this.h)}}class Iu extends Au{constructor(e){super({...e}),this.config=e}getVertices(){const e=Math.max(1,this.w),t=Math.max(1,this.h),n=e/2,r=t/2,o=Array(18);if(t>e)for(let e=0;e<9;e++){const r=_o*e/8-_o,i=_o*e/8;o[e]=new ho(n+n*Math.cos(r),n+n*Math.sin(r)),o[e+9]=new ho(n+n*Math.cos(i),t-n+n*Math.sin(i))}else for(let n=0;n<9;n++){const i=_o*n/8-yo,s=yo+_o*-n/8;o[n]=new ho(e-r+r*Math.cos(i),t-r+r*Math.sin(i)),o[n+9]=new ho(r-r*Math.cos(s),t-r+r*Math.sin(s))}return o}}"undefined"!=typeof window&&(window.__tldraw__hardReset=async function({shouldReload:e=!0}={}){sessionStorage.clear(),await Promise.all(Xl().map((e=>function(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),Nl(n).then((()=>{}))}(e)))),localStorage.clear(),e&&window.location.reload()}),o(9923),o(2719),o(5204),o(6627),o(2522);const Pu=({children:e})=>{const t=Yr();return le("shouldDisplayHandles",(()=>t.isInAny("select.idle","select.pointing_handle")),[t])?(0,Fr.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:e}):null},Mu=({shapeId:e})=>{const t=Yr();return le("show hovered",(()=>t.isIn("select.editing_shape")?t.getHoveredShapeId()!==t.getEditingShapeId():t.isInAny("select.idle")),[t])?(0,Fr.jsx)(ao,{className:"tl-user-indicator__hovered",id:e}):null},{PI:Tu}=Math,ju=Tu+1e-4;function Du(e,t={}){const{size:n=16,smoothing:r=.5,start:o={},end:i={},last:s=!1}=t,{cap:a=!0}=o,{cap:c=!0}=i;if(0===e.length||n<=0)return[];const l=e[0],u=e[e.length-1],d=u.runningLength,h=!1===o.taper?0:!0===o.taper?Math.max(n,d):o.taper,p=!1===i.taper?0:!0===i.taper?Math.max(n,d):i.taper,f=Math.pow(n*r,2),g=[],m=[];let _,y=e[0].vector,w=e[0].point,v=w,b=w,x=v,S=!1;for(let t=0;t<e.length;t++){_=e[t];const{point:n,vector:r}=e[t],o=_.vector.dpr(y),i=(t<e.length-1?e[t+1]:e[t]).vector,s=t<e.length-1?i.dpr(_.vector):1,a=null!==s&&s<.2;if(o<0&&!S||a){if(s>-.62&&d-_.runningLength>_.radius){const e=y.clone().mul(_.radius);y.clone().cpr(i)<0?(b=ho.Add(n,e),x=ho.Sub(n,e)):(b=ho.Sub(n,e),x=ho.Add(n,e)),g.push(b),m.push(x)}else{const e=y.clone().mul(_.radius).per(),t=ho.Sub(_.input,e);for(let e=1/13,n=0;n<1;n+=e)b=ho.RotWith(t,_.input,ju*n),g.push(b),x=ho.RotWith(t,_.input,ju+ju*-n),m.push(x)}w=b,v=x,a&&(S=!0);continue}if(S=!1,_===l||_===u){const e=ho.Per(r).mul(_.radius);g.push(ho.Sub(n,e)),m.push(ho.Add(n,e));continue}const c=ho.Lrp(i,r,s).per().mul(_.radius);b=ho.Sub(n,c),(t<=1||ho.Dist2(w,b)>f)&&(g.push(b),w=b),x=ho.Add(n,c),(t<=1||ho.Dist2(v,x)>f)&&(m.push(x),v=x),y=r}const k=l.point,C=e.length>1?e[e.length-1].point:ho.AddXY(l.point,1,1);if(1===e.length&&(!h&&!p||s)){const e=ho.Add(k,ho.Sub(k,C).uni().per().mul(-l.radius)),t=[];for(let n=1/13,r=n;r<=1;r+=n)t.push(ho.RotWith(e,k,2*ju*r));return t}const E=[];if(h||p&&1===e.length);else if(a)for(let e=1/8,t=e;t<=1;t+=e){const e=ho.RotWith(m[0],k,ju*t);E.push(e)}else{const e=ho.Sub(g[0],m[0]),t=ho.Mul(e,.5),n=ho.Mul(e,.51);E.push(ho.Sub(k,t),ho.Sub(k,n),ho.Add(k,n),ho.Add(k,t))}const A=[],I=u.vector.clone().per().neg();if(p||h&&1===e.length)A.push(C);else if(c){const e=ho.Add(C,ho.Mul(I,u.radius));for(let t=1/29,n=t;n<1;n+=t)A.push(ho.RotWith(e,C,3*ju*n))}else A.push(ho.Add(C,ho.Mul(I,u.radius)),ho.Add(C,ho.Mul(I,.99*u.radius)),ho.Sub(C,ho.Mul(I,.99*u.radius)),ho.Sub(C,ho.Mul(I,u.radius)));return g.concat(A,m.reverse(),E)}const Ou=.025,zu=.01;function Fu(e,t={}){const{streamline:n=.5,size:r=16,simulatePressure:o=!1}=t;if(0===e.length)return[];const i=.15+.85*(1-n);let s=e.map(ho.From),a=0;if(!o){let e=s[0];for(;e&&!(e.z>=Ou);)s.shift(),e=s[0]}if(!o){let e=s[s.length-1];for(;e&&!(e.z>=zu);)s.pop(),e=s[s.length-1]}if(0===s.length)return[{point:ho.From(e[0]),input:ho.From(e[0]),pressure:o?.5:.15,vector:new ho(1,1),distance:0,runningLength:0,radius:1}];let c=s[1];for(;c&&!(ho.Dist(c,s[0])>r/3);)s[0].z=Math.max(s[0].z,c.z),s.splice(1,1),c=s[1];const l=s.pop();for(c=s[s.length-1];c&&!(ho.Dist(c,l)>r/3);)s.pop(),c=s[s.length-1],a++;s.push(l);const u=t.last||!t.simulatePressure||s.length>1&&ho.Dist(s[s.length-1],s[s.length-2])<r||a>0;if(2===s.length&&t.simulatePressure){const e=s[1];s=s.slice(0,-1);for(let t=1;t<5;t++){const n=ho.Lrp(s[0],e,t/4);n.z=(s[0].z+(e.z-s[0].z))*t/4,s.push(n)}}const d=[{point:s[0],input:s[0],pressure:o?.5:s[0].z,vector:new ho(1,1),distance:0,runningLength:0,radius:1}];let h,p,f=0,g=d[0];u&&n>0&&s.push(s[s.length-1].clone());for(let e=1,n=s.length;e<n;e++)h=!i||t.last&&e===n-1?s[e].clone():s[e].clone().lrp(g.point,1-i),g.point.equals(h)||(p=ho.Dist(h,g.point),f+=p,e<4&&f<r||(g={input:s[e],point:h,pressure:o?.5:s[e].z,vector:ho.Sub(g.point,h).uni(),distance:p,runningLength:f,radius:1},d.push(g)));if(d[1]?.vector&&(d[0].vector=d[1].vector.clone()),f<1){const e=Math.max(.5,...d.map((e=>e.pressure)));d.forEach((t=>t.pressure=e))}return d}const{min:Ru}=Math,Lu=.275;function Nu(e,t){const{size:n=16,thinning:r=.5,simulatePressure:o=!0,easing:i=(e=>e),start:s={},end:a={}}=t,{easing:c=uo.easeOutQuad}=s,{easing:l=uo.easeOutCubic}=a,u=e[e.length-1].runningLength;let d,h,p=e[0].pressure;if(!o&&u<n){const t=e.reduce(((e,t)=>Math.max(e,t.pressure)),.5);return e.forEach((e=>{e.pressure=t,e.radius=n*i(.5-r*(.5-e.pressure))})),e}{let t;for(let r=0,i=e.length;r<i&&(h=e[r],!(h.runningLength>5*n));r++){const e=Ru(1,h.distance/n);if(o){const n=Ru(1,1-e);t=Ru(1,p+e*Lu*(n-p))}else t=Ru(1,p+.5*(h.pressure-p));p+=.5*(t-p)}for(let t=0;t<e.length;t++){if(h=e[t],r){let{pressure:e}=h;const t=Ru(1,h.distance/n);if(o){const n=Ru(1,1-t);e=Ru(1,p+t*Lu*(n-p))}else e=Ru(1,p+t*Lu*(e-p));h.radius=n*i(.5-r*(.5-e)),p=e}else h.radius=n/2;void 0===d&&(d=h.radius)}}const f=!1===s.taper?0:!0===s.taper?Math.max(n,u):s.taper,g=!1===a.taper?0:!0===a.taper?Math.max(n,u):a.taper;if(f||g)for(let t=0;t<e.length;t++){h=e[t];const{runningLength:n}=h,r=n<f?c(n/f):1,o=u-n<g?l((u-n)/g):1;h.radius=Math.max(.01,h.radius*Math.min(r,o))}return e}const Bu=({scribble:e,zoom:t,color:n,opacity:r,className:o})=>{if(!e.points.length)return null;const i=function(e,t={}){return Du(Nu(Fu(e,t),t),t)}(e.points,{size:e.size/t,start:{taper:e.taper,easing:uo.linear},last:"stopping"===e.state,simulatePressure:!1,streamline:.32});let s;if(i.length<4){const n=e.size/t/2,{x:r,y:o}=e.points[e.points.length-1];s=`M ${r-n},${o} a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 ${2*-n},0`}else s=li(i);return(0,Fr.jsx)("svg",{className:o?Rr("tl-overlays__item",o):o,children:(0,Fr.jsx)("path",{className:"tl-scribble",d:s,fill:n??`var(--color-${e.color})`,opacity:r??e.opacity})})},$u=({bounds:e,rotation:t})=>{const n=Yr();return le("should display",(()=>n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing")),[n])?(0,Fr.jsx)(di,{bounds:e,rotation:t}):null};function Uu(){const e=Yr();return le("isReadonlyMode",(()=>e.getInstanceState().isReadonly),[e])}function Vu({size:e,width:t,height:n,hideAlternateHandles:r}){const o=No(e/3),i=o/2;return(0,Fr.jsxs)("svg",{className:"tl-overlays__item",children:[(0,Fr.jsx)("polyline",{className:"tl-corner-crop-handle",points:`\n\t\t\t\t\t\t${No(0-i)},${No(e)} \n\t\t\t\t\t\t${No(0-i)},${No(0-i)} \n\t\t\t\t\t\t${No(e)},${No(0-i)}`,strokeWidth:o,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),(0,Fr.jsx)("line",{className:Rr("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:No(t/2-e),y1:No(0-i),x2:No(t/2+e),y2:No(0-i),strokeWidth:o,"data-testid":"selection.crop.top","aria-label":"top handle"}),(0,Fr.jsx)("polyline",{className:Rr("tl-corner-crop-handle",{"tl-hidden":r}),points:`\n\t\t\t\t\t\t${No(t-e)},${No(0-i)} \n\t\t\t\t\t\t${No(t+i)},${No(0-i)} \n\t\t\t\t\t\t${No(t+i)},${No(e)}`,strokeWidth:o,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),(0,Fr.jsx)("line",{className:Rr("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:No(t+i),y1:No(n/2-e),x2:No(t+i),y2:No(n/2+e),strokeWidth:o,"data-testid":"selection.crop.right","aria-label":"right handle"}),(0,Fr.jsx)("polyline",{className:"tl-corner-crop-handle",points:`\n\t\t\t\t\t\t${No(t+i)},${No(n-e)} \n\t\t\t\t\t\t${No(t+i)},${No(n+i)}\n\t\t\t\t\t\t${No(t-e)},${No(n+i)}`,strokeWidth:o,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),(0,Fr.jsx)("line",{className:Rr("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:No(t/2-e),y1:No(n+i),x2:No(t/2+e),y2:No(n+i),strokeWidth:o,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),(0,Fr.jsx)("polyline",{className:Rr("tl-corner-crop-handle",{"tl-hidden":r}),points:`\n\t\t\t\t\t\t${No(0+e)},${No(n+i)} \n\t\t\t\t\t\t${No(0-i)},${No(n+i)}\n\t\t\t\t\t\t${No(0-i)},${No(n-e)}`,strokeWidth:o,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),(0,Fr.jsx)("line",{className:Rr("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:No(0-i),y1:No(n/2-e),x2:No(0-i),y2:No(n/2+e),strokeWidth:o,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const Wu=se((function({bounds:t,rotation:n}){const r=Yr(),o=(0,e.useRef)(null),i=Uu(),s=vu("top"),a=vu("right"),c=vu("bottom"),l=vu("left"),u=vu("top_left"),d=vu("top_right"),h=vu("bottom_right"),p=vu("bottom_left"),f=!r.getIsMenuOpen()&&"default"===r.getInstanceState().cursor.type,g=r.getInstanceState().isCoarsePointer,m=r.getSelectedShapes(),_=r.getOnlySelectedShape(),y=_&&r.isShapeOrAncestorLocked(_),w=_?r.getShapeUtil(_).expandSelectionOutlinePx(_):0;if(lo(o,t?.x,t?.y,1,r.getSelectionRotation(),{x:-w,y:-w}),!t)return null;t=t.clone().expandBy(w).zeroFix();const v=r.getZoomLevel(),b=r.getInstanceState().isChangingStyle,x=t.width,S=t.height,k=8/v,C=x<2*k,E=S<2*k,A=x<4*k,I=S<4*k,P=x<5*k,M=S<5*k,T=g?1.75:1,j=6/v*T,D=(A?j/2:j)*(.75*T),O=(I?j/2:j)*(.75*T),z=!(_&&r.getShapeUtil(_).hideSelectionBoundsFg(_)||b);let F=z&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle")||z&&r.isIn("select.resizing")&&_&&r.isShapeOfType(_,"text");_&&F&&r.environment.isFirefox&&r.isShapeOfType(_,"embed")&&(F=!1);const R=r.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!b&&!i,L=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!b&&!i,N=!g&&!(C||E)&&(L||R)&&(!_||!r.getShapeUtil(_).hideRotateHandle(_))&&!y,B=g&&(!A||!I)&&(L||R)&&(!_||!r.getShapeUtil(_).hideRotateHandle(_))&&!y,$=L&&(!_||r.getShapeUtil(_).canResize(_)&&!r.getShapeUtil(_).hideResizeHandles(_))&&!R&&!y,U=C||E,V=C&&E,W=P||M,K=$||R,H=!N,G=!L||!B,q=!L||!K,Y=!L||!K||U,X=!L||!K||U,Z=!L||!K||V&&!R;let Q=g;Q&&m.every((e=>r.getShapeUtil(e).isAspectRatioLocked(e)))&&(Q=!1);let J=!0;R?J=W:$&&(J=U||V||Q);const ee=Math.min(24/v,S-3*O),te=L&&g&&_&&r.isShapeOfType(_,"text")&&ee*v>=4;return(0,Fr.jsx)("svg",{className:"tl-overlays__item tl-selection__fg tl-svg-context","data-testid":"selection-foreground",children:(0,Fr.jsxs)("g",{ref:o,children:[F&&(0,Fr.jsx)("rect",{className:Rr("tl-selection__fg__outline"),width:No(x),height:No(S)}),(0,Fr.jsx)(Ku,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:j,corner:"top_left_rotate",cursor:f?xl("nwse-rotate",n):void 0,isHidden:H}),(0,Fr.jsx)(Ku,{"data-testid":"selection.rotate.top-right",cx:x+3*j,cy:0,targetSize:j,corner:"top_right_rotate",cursor:f?xl("nesw-rotate",n):void 0,isHidden:H}),(0,Fr.jsx)(Ku,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:S+3*j,targetSize:j,corner:"bottom_left_rotate",cursor:f?xl("swne-rotate",n):void 0,isHidden:H}),(0,Fr.jsx)(Ku,{"data-testid":"selection.rotate.bottom-right",cx:x+3*j,cy:S+3*j,targetSize:j,corner:"bottom_right_rotate",cursor:f?xl("senw-rotate",n):void 0,isHidden:H}),(0,Fr.jsx)(Gu,{"data-testid":"selection.rotate.mobile",cx:A?1.5*-j:x/2,cy:A?S/2:1.5*-j,size:k,isHidden:G}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:No(0-(I?2*O:O)),width:No(x),height:No(Math.max(1,2*O)),style:f?{cursor:xl("ns-resize",n)}:void 0,...s}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:No(x-(A?0:D)),y:0,height:No(S),width:No(Math.max(1,2*D)),style:f?{cursor:xl("ew-resize",n)}:void 0,...a}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:No(S-(I?0:O)),width:No(x),height:No(Math.max(1,2*O)),style:f?{cursor:xl("ns-resize",n)}:void 0,...c}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":J}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:No(0-(A?2*D:D)),y:0,height:No(S),width:No(Math.max(1,2*D)),style:f?{cursor:xl("ew-resize",n)}:void 0,...l}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":q}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:No(0-(A?2*D:1.5*D)),y:No(0-(I?2*O:1.5*O)),width:No(3*D),height:No(3*O),style:f?{cursor:xl("nwse-resize",n)}:void 0,...u}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":Y}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:No(x-(A?0:1.5*D)),y:No(0-(I?2*O:1.5*O)),width:No(3*D),height:No(3*O),style:f?{cursor:xl("nesw-resize",n)}:void 0,...d}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":Z}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:No(x-(A?D:1.5*D)),y:No(S-(I?O:1.5*O)),width:No(3*D),height:No(3*O),style:f?{cursor:xl("nwse-resize",n)}:void 0,...h}),(0,Fr.jsx)("rect",{className:Rr("tl-transparent",{"tl-hidden":X}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:No(0-(A?3*D:1.5*D)),y:No(S-(I?0:1.5*O)),width:No(3*D),height:No(3*O),style:f?{cursor:xl("nesw-resize",n)}:void 0,...p}),$&&(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("rect",{"data-testid":"selection.resize.top-left",className:Rr("tl-corner-handle",{"tl-hidden":q}),"aria-label":"top_left handle",x:No(0-k/2),y:No(0-k/2),width:No(k),height:No(k)}),(0,Fr.jsx)("rect",{"data-testid":"selection.resize.top-right",className:Rr("tl-corner-handle",{"tl-hidden":Y}),"aria-label":"top_right handle",x:No(x-k/2),y:No(0-k/2),width:No(k),height:No(k)}),(0,Fr.jsx)("rect",{"data-testid":"selection.resize.bottom-right",className:Rr("tl-corner-handle",{"tl-hidden":Z}),"aria-label":"bottom_right handle",x:No(x-k/2),y:No(S-k/2),width:No(k),height:No(k)}),(0,Fr.jsx)("rect",{"data-testid":"selection.resize.bottom-left",className:Rr("tl-corner-handle",{"tl-hidden":X}),"aria-label":"bottom_left handle",x:No(0-k/2),y:No(S-k/2),width:No(k),height:No(k)})]}),te&&(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:No(0-k/4),y:No(S/2-ee/2),rx:k/4,width:No(k/2),height:No(ee)}),(0,Fr.jsx)("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:k/4,x:No(x-k/4),y:No(S/2-ee/2),width:No(k/2),height:No(ee)})]}),R&&(0,Fr.jsx)(Vu,{size:k,width:x,height:S,hideAlternateHandles:W})]})})})),Ku=function({cx:e,cy:t,targetSize:n,corner:r,cursor:o,isHidden:i,"data-testid":s}){const a=vu(r);return(0,Fr.jsx)("rect",{className:Rr("tl-transparent","tl-rotate-corner",{"tl-hidden":i}),"data-testid":s,"aria-label":`${r} target`,pointerEvents:"all",x:No(e-3*n),y:No(t-3*n),width:No(Math.max(1,3*n)),height:No(Math.max(1,3*n)),cursor:o,...a})},Hu=Math.sqrt(Math.PI),Gu=function({cx:e,cy:t,size:n,isHidden:r,"data-testid":o}){const i=vu("mobile_rotate"),s=Yr(),a=le("zoom level",(()=>s.getZoomLevel()),[s]),c=Math.max(1/a*14,20/Math.max(1,a));return(0,Fr.jsxs)("g",{children:[(0,Fr.jsx)("circle",{"data-testid":o,pointerEvents:"all",className:Rr("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":r}),cx:e,cy:t,r:c,...i}),(0,Fr.jsx)("circle",{className:Rr("tl-mobile-rotate__fg",{"tl-hidden":r}),cx:e,cy:t,r:n/Hu})]})},qu={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},Yu={s:2,m:3.5,l:5,xl:10},Xu={s:18,m:24,l:36,xl:44},Zu={s:18,m:22,l:26,xl:32},Qu={s:18,m:20,l:24,xl:28},Ju={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};var ed=o(1785);function td(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?td(Object(n),!0).forEach((function(t){rd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):td(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rd(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function od(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,a=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(e,t)||sd(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function id(e){return function(e){if(Array.isArray(e))return ad(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||sd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sd(e,t){if(e){if("string"==typeof e)return ad(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ad(e,t):void 0}}function ad(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cd(e){var t,n,r=e.sizes.shift(),o=Math.max(Math.ceil(r[0]),1),i=Math.max(Math.ceil(r[1]),1),s=[o-1,i-1,1,1],a=Date.now(),c="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;c?(t=new OffscreenCanvas(1,1),n=new OffscreenCanvas(o,i)):((t=document.createElement("canvas")).width=1,t.height=1,(n=document.createElement("canvas")).width=o,n.height=i);var l=t.getContext("2d"),u=n.getContext("2d");u&&(u.fillRect.apply(u,s),l.drawImage(n,o-1,i-1,1,1,0,0,1,1));var d=l&&0!==l.getImageData(0,0,1,1).data[3],h=Date.now()-a;return[t,n].forEach((function(e){e.height=0,e.width=0})),c?(postMessage({width:o,height:i,benchmark:h,isTestPass:d}),!d&&e.sizes.length&&cd(e)):d?e.onSuccess(o,i,h):(e.onError(o,i,h),e.sizes.length&&cd(e)),d}var ld=[16384,14188,11402,11180,10836,8192,4096,1],ud=[8388607,65535,32767,16384,8192,4096,1],dd=[4194303,65535,32767,16384,8192,4096,1],hd=["onError","onSuccess"],pd={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},fd={};function gd(e){var t=e.width===e.height,n=1===e.height,r=1===e.width,o=[];if(e.width&&e.height)for(var i=e.min||pd.min,s=e.step||pd.step,a=Math.max(e.width,e.height);a>=i;){var c=t||n?a:1,l=t||r?a:1;o.push([c,l]),a-=s}else e.sizes.forEach((function(e){var i=t||n?e:1,s=t||r?e:1;o.push([i,s])}));return o}function md(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),o=e.onError,i=e.onSuccess,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,hd),a=null;if(!t)return!1;if(e.useWorker&&n){var c="\n            var canvasTest = ".concat(cd.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),l=new Blob([c],{type:"application/javascript"}),u=URL.createObjectURL(l);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(e){var t=e.data,n=t.width,o=t.height,i=t.benchmark;t.isTestPass?(fd[r].onSuccess(n,o,i),delete fd[r]):fd[r].onError(n,o,i)}}return e.usePromise?new Promise((function(t,n){var c=nd(nd({},e),{},{onError:function(t,r,i){var s;if(0===e.sizes.length)s=!0;else{var a=od(e.sizes.slice(-1),1),c=od(a[0],2),l=c[0],u=c[1];s=t===l&&r===u}o(t,r,i),s&&n({width:t,height:r,benchmark:i})},onSuccess:function(e,n,r){i(e,n,r),t({width:e,height:n,benchmark:r})}});if(a){var l=c.onError,u=c.onSuccess;fd[r]={onError:l,onSuccess:u},a.postMessage(s)}else cd(c)})):a?(fd[r]={onError:o,onSuccess:i},void a.postMessage(s)):cd(e)}var _d={maxArea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=gd({width:e.max,height:e.max,min:e.min,step:e.step,sizes:id(ld)});return md(nd(nd(nd({},pd),e),{},{sizes:t}))},maxHeight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=gd({width:1,height:e.max,min:e.min,step:e.step,sizes:id(ud)});return md(nd(nd(nd({},pd),e),{},{sizes:t}))},maxWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=gd({width:e.max,height:1,min:e.min,step:e.step,sizes:id(dd)});return md(nd(nd(nd({},pd),e),{},{sizes:t}))},test:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=nd(nd({},pd),e);return t.sizes=id(t.sizes),t.width&&t.height&&(t.sizes=[[t.width,t.height]]),md(t)}};let yd=null;function wd(){return yd||(yd=async function(){const e=await _d.maxWidth({usePromise:!0}),t=await _d.maxHeight({usePromise:!0}),n=await _d.maxArea({usePromise:!0});return{maxWidth:e.width,maxHeight:t.height,maxArea:n.width*n.height}}()),yd}function vd(e,t){let n=0;for(;e[t+n];)n+=e[t+n]+1;return n+1}async function bd(e){return await new Promise(((t,n)=>{const r=new FileReader;r.onerror=()=>n(r.error),r.onload=()=>{t(!!r.result&&function(e){const t=new Uint8Array(e);let n,r,o=0,i=0;if(!function(e){return"GIF"===new TextDecoder("ascii").decode(e.slice(0,3))}(e))return!1;for(n=128&t[10],r=7&t[10],o+=6,o+=7,o+=n?3*Math.pow(2,r+1):0;i<2&&o<t.length;)switch(t[o]){case 44:i+=1,n=128&t[o+9],r=7&t[o+9],o+=10,o+=n?3*Math.pow(2,r+1):0,o+=vd(t,o+1)+1;break;case 33:o+=2,o+=vd(t,o);break;default:o=t.length}return i>1}(r.result))},r.readAsArrayBuffer(e)}))}const xd=(e,t)=>!!e.find((e=>{const n=new RegExp(e.split("*").map((e=>function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e))).join(".+"));return t.match(n)}));function Sd(e){return function(e){const t=new URL(e).host.replace("www.","");for(const n of ir)if(xd(n.hostnames,t)){const t=n.toEmbedUrl(e);if(t)return{definition:n,embedUrl:t,url:e}}}(e)??function(e){const t=new URL(e).host.replace("www.","");for(const n of ir)if(xd(n.hostnames,t)){const t=n.fromEmbedUrl(e);if(t)return{definition:n,url:t,embedUrl:e}}}(e)}function kd(e){try{return Sd(e)}catch(e){console.error(e)}}const Cd="  ";class Ed{static insertTextFirefox(e,t){e.setRangeText(t,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:t,inputType:"insertText",isComposing:!1}))}static insert(e,t){const n=e.ownerDocument,r=n.activeElement;r!==e&&e.focus(),n.execCommand("insertText",!1,t)||Ed.insertTextFirefox(e,t),r===n.body?e.blur():r instanceof HTMLElement&&r!==e&&r.focus()}static set(e,t){e.select(),Ed.insert(e,t)}static getSelection(e){const{selectionStart:t,selectionEnd:n}=e;return e.value.slice(t||void 0,n||void 0)}static wrapSelection(e,t,n){const{selectionStart:r,selectionEnd:o}=e,i=Ed.getSelection(e);Ed.insert(e,t+i+(n??t)),e.selectionStart=(r||0)+t.length,e.selectionEnd=(o||0)+t.length}static replace(e,t,n){let r=0;e.value.replace(t,((...t)=>{const o=r+t[t.length-2],i=t[0].length;e.selectionStart=o,e.selectionEnd=o+i;const s="string"==typeof n?n:n(...t);return Ed.insert(e,s),e.selectionStart=o,r+=s.length-i,s}))}static findLineEnd(e,t){const n=e.lastIndexOf("\n",t-1)+1;return"\t"!==e.charAt(n)?t:n+1}static indent(e){const{selectionStart:t,selectionEnd:n,value:r}=e,o=r.slice(t,n),i=/\n/g.exec(o)?.length;if(i&&i>0){const o=r.lastIndexOf("\n",t-1)+1,i=e.value.slice(o,n-1),s=i.replace(/^|\n/g,`$&${Cd}`),a=s.length-i.length;e.setSelectionRange(o,n-1),Ed.insert(e,s),e.setSelectionRange(t+1,n+a)}else Ed.insert(e,Cd)}static unindent(e){const{selectionStart:t,selectionEnd:n,value:r}=e,o=r.lastIndexOf("\n",t-1)+1,i=Ed.findLineEnd(r,n),s=e.value.slice(o,i),a=s.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=s.length-a.length;e.setSelectionRange(o,i),Ed.insert(e,a);const l=/\t| {1,2}/.exec(r.slice(o,t)),u=l?l[0].length:0,d=t-u;e.setSelectionRange(t-u,Math.max(d,n-c))}static indentCE(e){const t=window.getSelection(),n=e.innerText,r=Ad(e)??0,o=Ad(e)??0,i=n.slice(r,o),s=/\n/g.exec(i)?.length;if(s&&s>0){const i=n.lastIndexOf("\n",r-1)+1,s=n.slice(i,o-1),a=s.replace(/^|\n/g,`$&${Cd}`).length-s.length;t&&t.setBaseAndExtent(e,r+1,e,o+a)}else{const t=window.getSelection();e.innerText=n.slice(0,r)+Cd+n.slice(r),t?.setBaseAndExtent(e,r+1,e,r+2)}}static unindentCE(e){const t=window.getSelection(),n=e.innerText,r=Ad(e)??0,o=Ad(e)??0,i=n.lastIndexOf("\n",r-1)+1,s=Ed.findLineEnd(n,o),a=n.slice(i,s),c=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),l=a.length-c.length;if(t){t.setBaseAndExtent(e,i,e,s);const a=/\t| {1,2}/.exec(n.slice(i,r)),c=a?a[0].length:0,u=r-c;t.setBaseAndExtent(e,r-c,e,Math.max(u,o-l))}}static fixNewLines=/\r?\n|\r/g;static normalizeText(e){return e.replace(Ed.fixNewLines,"\n")}static normalizeTextForDom(e){return e.replace(Ed.fixNewLines,"\n").split("\n").map((e=>e||" ")).join("\n")}}function Ad(e){if(void 0===window.getSelection)return;const t=window.getSelection();if(!t)return;let n=0;if(0!==t.rangeCount){const r=t.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(e),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length}return n}const Id=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;const Pd=(e,t)=>e.length<=t?e:e.substring(0,t-3)+"...";function Md(e,{maxImageDimension:t,maxAssetSize:n,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:o}){e.registerExternalAssetHandler("file",(async({file:e})=>await new Promise(((i,s)=>{r.includes(e.type)||o.includes(e.type)||(console.warn(`File type not allowed: ${e.type}`),s()),e.size>n&&(console.warn(`File size too big: ${(e.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),s());const a=new FileReader;a.onerror=()=>s(a.error),a.onload=async()=>{let n=a.result;"video/quicktime"===e.type&&n.includes("video/quicktime")&&(n=n.replace("video/quicktime","video/mp4"));const o=r.includes(e.type);let s,c;if(o?(s=await Ce.getImageSizeFromSrc(n),c="image/gif"===e.type&&await bd(e)):(c=!0,s=await Ce.getVideoSizeFromSrc(n)),isFinite(t)){const n=function(e,t){const n=e.w/t.w,r=e.h/t.h;return n<=1&&r<=1?e:n>r?{w:e.w/n,h:e.h/n}:{w:e.w/r,h:e.h/r}}(s,{w:t,h:t});s===n||"image/jpeg"!==e.type&&"image/png"!==e.type||(s=n)}"image/jpeg"!==e.type&&"image/png"!==e.type||(n=await async function(e,t,n,r={}){let o=2*t,i=2*n;const{type:s="image/jpeg",quality:a=.92}=r,c=await wd(),l=t/n;if(o>c.maxWidth&&(o=c.maxWidth,i=o/l),i>c.maxHeight&&(i=c.maxHeight,o=i*l),o*i>c.maxArea){const e=Math.sqrt(c.maxArea/(o*i));o*=e,i*=e}return await ed(e,o,i,{imageType:s,quality:a})}(n,s.w,s.h,{type:e.type,quality:.92}));const l=Cn.createId(be(n)),u=Cn.create({id:l,type:o?"image":"video",typeName:"asset",props:{name:e.name,src:n,w:s.w,h:s.h,mimeType:e.type,isAnimated:c}});i(u)},a.readAsDataURL(e)})))),e.registerExternalAssetHandler("url",(async({url:e})=>{let t;try{const n=await fetch(e,{method:"GET",mode:"no-cors"}),r=await n.text(),o=(new DOMParser).parseFromString(r,"text/html");t={image:o.head.querySelector('meta[property="og:image"]')?.getAttribute("content")??"",title:o.head.querySelector('meta[property="og:title"]')?.getAttribute("content")??Pd(e,32),description:o.head.querySelector('meta[property="og:description"]')?.getAttribute("content")??""}}catch(n){console.error(n),t={image:"",title:Pd(e,32),description:""}}return{id:Cn.createId(be(e)),typeName:"asset",type:"bookmark",props:{src:e,description:t.description,image:t.image,title:t.title},meta:{}}})),e.registerExternalContentHandler("svg-text",(async({point:t,text:n})=>{const r=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),o=(new DOMParser).parseFromString(n,"image/svg+xml").querySelector("svg");if(!o)throw new Error("No <svg/> element present");let i=parseFloat(o.getAttribute("width")||"0"),s=parseFloat(o.getAttribute("height")||"0");if(!i||!s){document.body.appendChild(o);const e=o.getBoundingClientRect();document.body.removeChild(o),i=e.width,s=e.height}const a=await e.getAssetForExternalContent({type:"file",file:new File([n],"asset.svg",{type:"image/svg+xml"})});if(!a)throw Error("Could not create an asset");Td(e,[a],r)})),e.registerExternalContentHandler("embed",(({point:t,url:n,embed:r})=>{const o=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),{width:i,height:s}=r,a=jn(),c={id:a,type:"embed",x:o.x-(i||450)/2,y:o.y-(s||450)/2,props:{w:i,h:s,url:n}};e.createShapes([c]).select(a)})),e.registerExternalContentHandler("files",(async({point:t,files:i})=>{const s=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),a=new ho(s.x,s.y),c=[];await Promise.all(i.map((async(t,i)=>{if(t.size>n)return console.warn(`File size too big: ${(t.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),null;if(!t.type)throw new Error("No mime type");if(!r.concat(o).includes(t.type))return console.warn(`${t.name} not loaded - Extension not allowed.`),null;try{const n=await e.getAssetForExternalContent({type:"file",file:t});if(!n)throw Error("Could not create an asset");c[i]=n}catch(e){return console.error(e),null}}))),Td(e,he(c),a)})),e.registerExternalContentHandler("text",(async({point:t,text:n})=>{const r=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),o=e.getShapeUtil("text").getDefaultProps(),i=function(e){return function(e){return e.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}(function(e){const t=e.split("\n");for(;t[0]&&0===t[0].trim().length;)t.shift();let n=1/0;for(const e of t)if(e.trim().length>0){const t=e.length-e.trimStart().length;n=Math.min(n,t)}return t.map((e=>e.slice(n))).join("\n")}(function(e){return e.replace(/\t/g,Cd)}(e)))}(n);let s,a,c,l="middle";const u=i.split("\n").length>1,d=function(e){return Id.test(e)}(i);u&&(l=u?d?"end":"start":"middle");const h=e.textMeasure.measureText(i,{...qu,fontFamily:Ju[o.font],fontSize:Xu[o.size],maxWidth:null}),p=Math.min(u?.9*e.getViewportPageBounds().width:920,Math.max(200,.9*e.getViewportPageBounds().width));if(h.w>p){const t=e.textMeasure.measureText(i,{...qu,fontFamily:Ju[o.font],fontSize:Xu[o.size],maxWidth:p});s=t.w,a=t.h,c=!1,l=d?"end":"start"}else s=h.w,a=h.h,c=!0;r.y-a/2<e.getViewportPageBounds().minY+40&&(r.y=e.getViewportPageBounds().minY+40+a/2),e.createShapes([{id:jn(),type:"text",x:r.x-s/2,y:r.y-a/2,props:{text:i,align:l,autoSize:c,w:s}}])})),e.registerExternalContentHandler("url",(async({point:t,url:n})=>{const r=kd(n);if(r)return e.putExternalContent({type:"embed",url:r.url,point:t,embed:r.definition});const o=t??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.getViewportPageCenter()),i=Cn.createId(be(n)),s=function(e,t,n){const r={id:jn(),type:"bookmark",x:n.x-150,y:n.y-160,opacity:1,props:{assetId:null,url:t}};return e.batch((()=>{e.createShapes([r]).select(r.id),jd(e,n)})),e.getShape(r.id)}(e,n,o);let a=e.getAsset(i),c=!1;if(!a){c=!0;const t=await e.getAssetForExternalContent({type:"url",url:n});if(!t)throw Error("Could not create an asset");a=t}e.batch((()=>{c&&e.createAssets([a]),e.updateShapes([{id:s.id,type:s.type,props:{assetId:a.id}}])}))}))}async function Td(e,t,n){if(!t.length)return[];const r=ho.From(n),o=[];for(const e of t)switch(e.type){case"bookmark":o.push({id:jn(),type:"bookmark",x:r.x-150,y:r.y-160,opacity:1,props:{assetId:e.id,url:e.props.src}}),r.x+=300;break;case"image":o.push({id:jn(),type:"image",x:r.x-e.props.w/2,y:r.y-e.props.h/2,opacity:1,props:{assetId:e.id,w:e.props.w,h:e.props.h}}),r.x+=e.props.w;break;case"video":o.push({id:jn(),type:"video",x:r.x-e.props.w/2,y:r.y-e.props.h/2,opacity:1,props:{assetId:e.id,w:e.props.w,h:e.props.h}}),r.x+=e.props.w}return e.batch((()=>{const r=t.filter((t=>!e.getAsset(t.id)));r.length&&e.createAssets(r),e.createShapes(o).select(...o.map((e=>e.id))),jd(e,n)})),o.map((e=>e.id))}function jd(e,t){const n=e.getViewportPageBounds();let r=e.getSelectionPageBounds();if(r){const n=r.center.sub(t);e.updateShapes(e.getSelectedShapes().map((t=>{const r=e.getShapeParentTransform(t).decompose().rotation,o=ho.Rot(n,-r);return{id:t.id,type:t.type,x:t.x-o.x,y:t.y-o.y}})))}r=e.getSelectionPageBounds(),r&&!n.contains(r)&&e.zoomToSelection()}class Dd extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")};onKeyUp=e=>{if("Enter"===e.key){if(this.editor.getInstanceState().isReadonly)return null;const t=this.editor.getOnlySelectedShape();t&&this.editor.getShapeUtil(t).canEdit(t)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(t.id),this.editor.root.getCurrent()?.transition("editing_shape",{...e,target:"shape",shape:t}))}}}class Od extends ll{static id="pointing";shape;markId="";onEnter=()=>{this.didTimeout=!1;const e=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:e=>!e.isLocked&&this.editor.getShapeUtil(e).canBind(e),margin:0,hitInside:!0,renderingOnly:!0});e?this.editor.setHintingShapes([e.id]):this.createArrowShape(),this.startPreciseTimeout()};onExit=()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()};onPointerMove=()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:this.editor.getShapeHandles(this.shape).find((e=>"end"===e.id)),isCreating:!0,onInteractionEnd:"arrow"})}};onPointerUp=()=>{this.cancel()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){const{originPagePoint:e}=this.editor.inputs,t=jn();this.markId=`creating:${t}`,this.editor.mark(this.markId),this.editor.createShapes([{id:t,type:"arrow",x:e.x,y:e.y}]);const n=this.editor.getShape(t);if(!n)throw Error("expected shape");const r=this.editor.getShapeHandles(n);if(!r)throw Error("expected handles for arrow");const o=this.editor.getShapeUtil("arrow"),i=this.shape,s=r.find((e=>"start"===e.id)),a=o.onHandleChange?.(n,{handle:{...s,x:0,y:0},isPrecise:!0,initial:i});if(a){const e=a.props?.start;"binding"===e?.type&&this.editor.setHintingShapes([e.boundShapeId]),this.editor.updateShapes([a],{squashing:!0})}this.shape=this.editor.getShape(t),this.editor.select(t)}updateArrowShapeEndHandle(){const e=this.shape;if(!e)throw Error("expected shape");const t=this.editor.getShapeHandles(e);if(!t)throw Error("expected handles for arrow");const n={...e,props:{...e.props,end:{...e.props.end,x:0,y:0}}};{const r=this.editor.getShapeUtil("arrow"),o=this.shape,i=this.editor.getPointInShapeSpace(e,this.editor.inputs.currentPagePoint),s=t.find((e=>"end"===e.id)),a=r.onHandleChange?.(n,{handle:{...s,x:i.x,y:i.y},isPrecise:!1,initial:o});if(a){const e=a.props?.end;"binding"===e?.type&&this.editor.setHintingShapes([e.boundShapeId]),this.editor.updateShapes([a],{squashing:!0})}}{const e=this.editor.getShapeUtil("arrow"),r=this.shape,o=t.find((e=>"start"===e.id)),i=e.onHandleChange?.(n,{handle:{...o,x:0,y:0},isPrecise:this.didTimeout,initial:r});i&&this.editor.updateShapes([i],{squashing:!0})}this.shape=this.editor.getShape(e.id)}preciseTimeout=-1;didTimeout=!1;startPreciseTimeout(){this.preciseTimeout=window.setTimeout((()=>{this.getIsActive()&&(this.didTimeout=!0)}),320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}}class zd extends ll{static id="drawing";info={};initialShape;shapeType="highlight"===this.parent.id?"highlight":"draw";util=this.editor.getShapeUtil(this.shapeType);isPen=!1;segmentMode="free";didJustShiftClickToExtendPreviousShapeLine=!1;pagePointWhereCurrentSegmentChanged={};pagePointWhereNextSegmentChanged=null;lastRecordedPoint={};mergeNextPoint=!1;currentLineLength=0;canDraw=!1;markId=null;onEnter=e=>{this.markId=null,this.info=e,this.canDraw=!this.editor.getIsMenuOpen(),this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()};onPointerMove=()=>{const{editor:{inputs:e}}=this;if(this.isPen!==e.isPen){if(this.markId)return this.editor.bailToMark(this.markId),void this.startShape()}else!this.canDraw&&e.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(e.isPen?ho.Dist(e.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=e.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())};onKeyDown=e=>{if("Shift"===e.key)switch(this.segmentMode){case"free":this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()};onKeyUp=e=>{if("Shift"===e.key)switch(this.editor.snaps.clear(),this.segmentMode){case"straight":this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_straight":this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free"}this.updateShapes()};onExit=()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()};canClose(){return"highlight"!==this.shapeType}getIsClosed(e,t){if(!this.canClose())return!1;const n=Yu[t],r=e[0].points[0],o=e[e.length-1],i=o.points[o.points.length-1];return r!==i&&this.currentLineLength>4*n&&ho.Dist(r,i)<2*n}startShape(){const{inputs:{originPagePoint:e,isPen:t}}=this.editor;this.markId="draw start "+ua(),this.editor.mark(this.markId),this.isPen=t;const n=this.isPen?1.25*this.info.point.z:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=e.clone(),this.initialShape){const t=this.editor.getShape(this.initialShape.id);if(t&&"straight"===this.segmentMode){this.didJustShiftClickToExtendPreviousShapeLine=!0;const n=pe(t.props.segments);if(!n)throw Error("Expected a previous segment!");const r=pe(n.points);if(!r)throw Error("Expected a previous point!");const{x:o,y:i}=this.editor.getPointInShapeSpace(t,e).toFixed(),s=this.isPen?1.25*this.info.point.z:.5,a={type:this.segmentMode,points:[{x:r.x,y:r.y,z:+s.toFixed(2)},{x:o,y:i,z:+s.toFixed(2)}]},c=ks.applyToPoint(this.editor.getShapePageTransform(t.id),r);this.pagePointWhereCurrentSegmentChanged=c,this.pagePointWhereNextSegmentChanged=null;const l=[...t.props.segments,a];this.currentLineLength=this.getLineLength(l);const u={id:t.id,type:this.shapeType,props:{segments:l}};return this.canClose()&&(u.props.isClosed=this.getIsClosed(l,t.props.size)),void this.editor.updateShapes([u])}}this.pagePointWhereCurrentSegmentChanged=e.clone();const r=jn();this.editor.createShapes([{id:r,type:this.shapeType,x:e.x,y:e.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+n.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(r)}updateShapes(){const{inputs:e}=this.editor,{initialShape:t}=this;if(!t)return;const{id:n,props:{size:r}}=t,o=this.editor.getShape(n);if(!o)return;const{segments:i}=o.props,{x:s,y:a,z:c}=this.editor.getPointInShapeSpace(o,e.currentPagePoint).toFixed(),l={x:s,y:a,z:this.isPen?+(1.25*c).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:t}=this;if(null===t)throw Error("We should have a point where the segment changed");if(ho.Dist(t,e.currentPagePoint)>4){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const e=pe(i);if(!e)throw Error("Expected a previous segment!");const t=pe(e.points);if(!t)throw Error("Expected a previous last point!");let s;const a=this.editor.getPointInShapeSpace(o,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if("straight"===e.type){this.currentLineLength+=ho.Dist(t,a),s={type:"straight",points:[{...t},a]};const e=this.editor.getShapePageTransform(o);this.pagePointWhereCurrentSegmentChanged=ks.applyToPoint(e,t)}else s={type:"straight",points:[a,l]};const c={id:n,type:this.shapeType,props:{segments:[...i,s]}};this.canClose()&&(c.props.isClosed=this.getIsClosed(i,r)),this.editor.updateShapes([c],{squashing:!0})}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:t}=this;if(null===t)throw Error("We should have a point where the segment changed");if(ho.Dist(t,e.currentPagePoint)>4){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const e=i.slice(),t=pe(e[e.length-1].points);if(!t)throw Error("No previous point!");const o={type:"free",points:[...ho.PointsBetween(t,l,6).map((e=>e.toFixed().toJson()))]},s=[...e,o];this.currentLineLength=this.getLineLength(s);const a={id:n,type:this.shapeType,props:{segments:s}};this.canClose()&&(a.props.isClosed=this.getIsClosed(s,r)),this.editor.updateShapes([a],{squashing:!0})}break}case"straight":{const e=i.slice(),t=e[e.length-1],{pagePointWhereCurrentSegmentChanged:s}=this,{currentPagePoint:a,ctrlKey:c}=this.editor.inputs;if(!s)throw Error("We should have a point where the segment changed");let l,u=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(u=!c,this.didJustShiftClickToExtendPreviousShapeLine=!1):u=!c;let d,h=this.editor.getPointInShapeSpace(o,a).toFixed().toJson(),p=!1;if((this.editor.user.getIsSnapMode()?!c:c)&&e.length>2){let e,t=8/this.editor.getZoomLevel();for(let n=0,r=i.length-2;n<r;n++){const r=i[n];if(!r)break;if("free"===r.type)continue;const o=r.points[0],s=pe(r.points);if(!o||!s)continue;const a=ho.NearestPointOnLineSegment(o,s,h),c=ho.Dist(a,h);if(c<t){e=a.toFixed().toJson(),t=c,d=r;break}}e&&(p=!0,h=e)}if(p&&d){const e=this.editor.getShapePageTransform(o),t=d.points[0],n=pe(d.points);if(!n)throw Error("Expected a last point!");const r=ks.applyToPoint(e,t),i=ks.applyToPoint(e,n),s=ks.applyToPoint(e,h);this.editor.snaps.setLines([{id:ua(),type:"points",points:[r,s,i]}])}else{if(this.editor.snaps.clear(),u){const e=ho.Angle(s,a),t=To(e,24)-e;l=ho.RotWith(a,s,t)}else l=a;h=this.editor.getPointInShapeSpace(o,l).toFixed().toJson()}this.currentLineLength+=ho.Dist(t.points[0],h),e[e.length-1]={...t,type:"straight",points:[t.points[0],h]};const f={id:n,type:this.shapeType,props:{segments:e}};this.canClose()&&(f.props.isClosed=this.getIsClosed(i,r)),this.editor.updateShapes([f],{squashing:!0});break}case"free":{const e=i.slice(),t=e[e.length-1],o=[...t.points];if(o.length&&this.mergeNextPoint){const{z:e}=o[o.length-1];o[o.length-1]={x:l.x,y:l.y,z:e?Math.max(e,l.z):l.z}}else this.currentLineLength+=ho.Dist(o[o.length-1],l),o.push(l);e[e.length-1]={...t,points:o},this.currentLineLength=this.getLineLength(e);const s={id:n,type:this.shapeType,props:{segments:e}};if(this.canClose()&&(s.props.isClosed=this.getIsClosed(e,r)),this.editor.updateShapes([s],{squashing:!0}),o.length>500){this.editor.updateShapes([{id:n,type:this.shapeType,props:{isComplete:!0}}]);const{currentPagePoint:e}=this.editor.inputs,t=jn();this.editor.createShapes([{id:t,type:this.shapeType,x:Bo(e.x),y:Bo(e.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(1.25*c).toFixed():.5}]}]}}]),this.initialShape=structuredClone(this.editor.getShape(t)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(e){let t=0;for(const n of e)for(let e=0;e<n.points.length-1;e++){const r=n.points[e],o=n.points[e+1];t+=ho.Sub(o,r).len2()}return Math.sqrt(t)}onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())};complete(){if(!this.canDraw)return void this.cancel();const{initialShape:e}=this;e&&(this.editor.updateShapes([{id:e.id,type:e.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}class Fd extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("drawing",e)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}}class Rd extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onKeyUp=e=>{if("Enter"===e.key){if(this.editor.getInstanceState().isReadonly)return null;const t=this.editor.getOnlySelectedShape();t&&this.editor.getShapeUtil(t).canEdit(t)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(t.id),this.editor.root.getCurrent()?.transition("editing_shape",{...e,target:"shape",shape:t}))}};onCancel=()=>{this.editor.setCurrentTool("select")}}class Ld extends ll{static id="pointing";markId="";onPointerUp=()=>{this.complete()};onPointerMove=e=>{if(this.editor.inputs.isDragging){const{originPagePoint:t}=this.editor.inputs,n=jn();this.markId=`creating:${n}`,this.editor.mark(this.markId),this.editor.createShapes([{id:n,type:"geo",x:t.x,y:t.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(pr)}}]).select(n).setCurrentTool("select.resizing",{...e,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){const{originPagePoint:e}=this.editor.inputs,t=jn();this.markId=`creating:${t}`,this.editor.mark(this.markId),this.editor.createShapes([{id:t,type:"geo",x:e.x,y:e.y,props:{geo:this.editor.getStyleForNextShape(pr),w:1,h:1}}]);const n=this.editor.getShape(t);if(!n)return;const r="star"===n.props.geo?((e,t,n)=>{const r=wo/5/2,o=2*Math.floor(5/4),i=10-o,s=2*Math.floor(2.5),a=200*Math.cos(o*r-yo)/2,c=200*Math.cos(i*r-yo)/2,l=200*Math.sin(0*r-yo)/2,u=200*Math.sin(s*r-yo)/2;return new fo(0,0,a-c,u-l)})():"cloud"===n.props.geo?new fo(0,0,300,180):new fo(0,0,200,200),o=r.center,i=this.editor.getShapeParentTransform(n);i&&o.rot(-i.rotation()),this.editor.select(t),this.editor.updateShapes([{id:n.id,type:"geo",x:n.x-o.x,y:n.y-o.y,props:{geo:this.editor.getStyleForNextShape(pr),w:r.width,h:r.height}}]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}}class Nd extends ll{static id="idle";shapeId="";onEnter=e=>{this.shapeId=e.shapeId,this.editor.setCursor({type:"cross",rotation:0})};onPointerDown=()=>{this.parent.transition("pointing",{shapeId:this.shapeId})};onCancel=()=>{this.editor.setCurrentTool("select")}}class Bd extends ll{static id="pointing";shape={};markId;onEnter=e=>{const{inputs:t}=this.editor,{currentPagePoint:n}=t;this.markId=void 0;const r=e.shapeId&&this.editor.getShape(e.shapeId);if(r&&t.shiftKey){this.markId=`creating:${r.id}`,this.editor.mark(this.markId),this.shape=r;const e=this.editor.getShapeHandles(this.shape);if(!e)return;const t=e.filter((e=>"vertex"===e.type)).sort(fc),o=t[t.length-1],i=t[t.length-2],s=ks.applyToPoint(this.editor.getShapeParentTransform(this.shape),new ho(this.shape.x,this.shape.y));let a,c,l;const u=ho.Sub(n,s);ho.Dist(o,i)<2||ho.Dist(u,o)<2?(a=o.index,c=o.id,l={...o,x:u.x+.1,y:u.y+.1}):(a=hc(o.index),c="handle:"+a,l={id:c,type:"vertex",index:a,x:u.x+.1,y:u.y+.1,canBind:!1});const d=We(this.shape.props.handles);d[l.id]=l,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:d}}])}else{const e=jn();this.markId=`creating:${e}`,this.editor.mark(this.markId),this.editor.createShapes([{id:e,type:"line",x:n.x,y:n.y}]),this.editor.select(e),this.shape=this.editor.getShape(e)}};onPointerMove=()=>{if(this.shape&&this.editor.inputs.isDragging){const e=this.editor.getShapeHandles(this.shape);if(console,!e)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const t=pe(e);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...t,x:t.x-.1,y:t.y-.1},onInteractionEnd:"line"})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clear()};complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}}class $d extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}}class Ud extends ll{static id="pointing";dragged=!1;info={};wasFocusedOnEnter=!1;markId="";shape={};onEnter=()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen(),this.wasFocusedOnEnter&&(this.shape=this.createShape())};onPointerMove=e=>{this.editor.inputs.isDragging&&(this.wasFocusedOnEnter||(this.shape=this.createShape()),this.editor.setCurrentTool("select.translating",{...e,target:"shape",shape:this.shape,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"}))};onPointerUp=()=>{this.complete()};onInterrupt=()=>{this.cancel()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};complete(){this.wasFocusedOnEnter&&(this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}createShape(){const{inputs:{originPagePoint:e}}=this.editor,t=jn();this.markId=`creating:${t}`,this.editor.mark(this.markId),this.editor.createShapes([{id:t,type:"note",x:e.x,y:e.y}]).select(t);const n=this.editor.getShape(t),r=this.editor.getShapeGeometry(n).bounds;return this.editor.updateShapes([{id:t,type:"note",x:n.x-r.width/2,y:n.y-r.height/2}]),this.editor.getShape(t)}}function Vd(e){const t=e.getShapeAtPoint(e.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:8/e.getZoomLevel(),renderingOnly:!0});if(!t)return e.setHoveredShape(null);let n;const r=e.getOutermostSelectableShape(t);return n=r===t||r.id===e.getFocusedGroupId()||e.getSelectedShapeIds().includes(r.id)?t:r,e.setHoveredShape(n.id)}class Wd extends ll{static id="idle";onPointerMove=e=>{switch(e.target){case"shape":case"canvas":Vd(this.editor)}};onPointerDown=e=>{this.parent.transition("pointing",e)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onKeyDown=e=>{if("Enter"===e.key){if(this.editor.getInstanceState().isReadonly)return null;const t=this.editor.getOnlySelectedShape();t&&this.editor.getShapeUtil(t).canEdit(t)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(t.id),this.editor.root.getCurrent()?.transition("editing_shape",{...e,target:"shape",shape:t}))}};onCancel=()=>{this.editor.setCurrentTool("select")}}class Kd extends ll{static id="pointing";shape;markId="";onExit=()=>{this.editor.setHintingShapes([])};onPointerMove=e=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:t}}=this.editor,n=jn();if(this.markId=`creating:${n}`,this.editor.mark(this.markId),this.editor.createShapes([{id:n,type:"text",x:t.x,y:t.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(n),this.shape=this.editor.getShape(n),!this.shape)return;this.editor.setCurrentTool("select.resizing",{...e,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}};onPointerUp=()=>{this.complete()};onComplete=()=>{this.cancel()};onCancel=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.editor.mark("creating text shape");const e=jn(),{x:t,y:n}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:e,type:"text",x:t,y:n,props:{text:"",autoSize:!0}}]).select(e),this.editor.setEditingShape(e),this.editor.setCurrentTool("select"),this.editor.root.getCurrent()?.transition("editing_shape")}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}}const Hd=[class extends ll{static id="text";static initial="idle";static children=()=>[Wd,Kd];shapeType="text"},class extends ll{static id="draw";static initial="idle";static children=()=>[Fd,zd];shapeType="draw";onExit=()=>{this.children.drawing.initialShape=void 0}},class extends ll{static id="geo";static initial="idle";static children=()=>[Rd,Ld];shapeType="geo"},class extends ll{static id="note";static initial="idle";static children=()=>[$d,Ud];shapeType="note"},class extends ll{static id="line";static initial="idle";static children=()=>[Nd,Bd];shapeType="line"},class extends _u{static id="frame";static initial="idle";shapeType="frame"},class extends ll{static id="arrow";static initial="idle";static children=()=>[Dd,Od];shapeType="arrow"},class extends ll{static id="highlight";static initial="idle";static children=()=>[Fd,zd];shapeType="highlight";onExit=()=>{this.children.drawing.initialShape=void 0}}];function Gd(){return Ln({isDarkMode:ml()})}const qd=e.memo((function({theme:e,d:t,color:n,fill:r}){switch(r){case"none":return null;case"solid":return(0,Fr.jsx)("path",{fill:e[n].semi,d:t});case"semi":return(0,Fr.jsx)("path",{fill:e.solid,d:t});case"pattern":return(0,Fr.jsx)(Yd,{theme:e,color:n,fill:r,d:t})}})),Yd=function({d:e,color:t,theme:n}){const r=Yr(),o=le("zoomLevel",(()=>r.getZoomLevel()),[r]),i=Math.ceil(o),s=r.getZoomLevel()<=.18;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("path",{fill:n[t].pattern,d:e}),(0,Fr.jsx)("path",{fill:s?n[t].semi:`url(#${ti[`${i}_${n.id}`]})`,d:e})]})};function Xd({d:e,color:t,fill:n,theme:r}){if("none"===n)return;if("pattern"===n){const n=document.createElementNS("http://www.w3.org/2000/svg","g"),o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",e),o.setAttribute("fill",r[t].pattern);const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",e),i.setAttribute("fill","url(#hash_pattern)"),n.appendChild(o),n.appendChild(i),n}const o=document.createElementNS("http://www.w3.org/2000/svg","path");switch(o.setAttribute("d",e),n){case"semi":o.setAttribute("fill",r.solid);break;case"solid":o.setAttribute("fill",r[t].semi)}return o}function Zd(e,t){if(t){const n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(t),n.appendChild(e),n}return e}function Qd(e,t,n){const{padding:r=0}=n,o=document.createElementNS("http://www.w3.org/2000/svg","text");if(o.setAttribute("font-size",n.fontSize+"px"),o.setAttribute("font-family",n.fontFamily),o.setAttribute("font-style",n.fontStyle),o.setAttribute("font-weight",n.fontWeight),o.setAttribute("line-height",n.lineHeight*n.fontSize+"px"),o.setAttribute("dominant-baseline","mathematical"),o.setAttribute("alignment-baseline","mathematical"),0===t.length)return o;const i=fo.From(t[0].box);for(const{box:e}of t)i.union(e);const s=r+(n.offsetX??0),a=(n.offsetY??0)+n.fontSize/2+("start"===n.verticalTextAlign?r:"end"===n.verticalTextAlign?n.height-r-i.height:(Math.ceil(n.height)-i.height)/2);let c=null;for(const{text:e,box:n}of t){if(null!==c&&n.y>c){const e=document.createElementNS("http://www.w3.org/2000/svg","tspan");e.setAttribute("alignment-baseline","mathematical"),e.setAttribute("x",s+"px"),e.setAttribute("y",n.y+a+"px"),e.textContent="\n",o.appendChild(e)}const t=document.createElementNS("http://www.w3.org/2000/svg","tspan");t.setAttribute("alignment-baseline","mathematical"),t.setAttribute("x",n.x+s+"px"),t.setAttribute("y",n.y+a+"px");const r=e.replace(/\s/g,"");t.textContent=r,o.appendChild(t),c=n.y}return n.stroke&&n.strokeWidth&&(o.setAttribute("stroke",n.stroke),o.setAttribute("stroke-width",n.strokeWidth+"px")),n.fill&&o.setAttribute("fill",n.fill),o}function Jd(e){return{key:`${Vn.id}:${e}`,getElement:async()=>{const t=function(e){const t=Wn[e];for(const e of document.fonts)if(t.includes(e.family))return e;return null}(e);if(!t)return null;const n=t.$$_url,r=t.$$_fontface;if(!n||!r)return null;const o=await(await fetch(n)).blob(),i=await new Promise(((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(o)})),s=r.replace(n,i),a=document.createElementNS("http://www.w3.org/2000/svg","style");return a.textContent=s,a}}}function eh(e,t){return{key:`${Vn.id}:${e}`,getElement:async()=>{if("pattern"!==e)return null;const n=8/12,r=document.createElement("div");return r.innerHTML=`\n\t\t\t\t<svg>\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<mask id="hash_pattern_mask">\n\t\t\t\t\t\t\t<rect x="0" y="0" width="8" height="8" fill="white" />\n\t\t\t\t\t\t\t<g\n\t\t\t\t\t\t\t\tstrokeLinecap="round"\n\t\t\t\t\t\t\t\tstroke="black"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<line x1="${1*n}" y1="2" x2="2" y2="${1*n}" />\n\t\t\t\t\t\t\t\t<line x1="${5*n}" y1="${7*n}" x2="${7*n}" y2="${5*n}" />\n\t\t\t\t\t\t\t\t<line x1="6" y1="${11*n}" x2="${11*n}" y2="6" />\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</mask>\n\t\t\t\t\t\t<pattern\n\t\t\t\t\t\t\tid="hash_pattern"\n\t\t\t\t\t\t\twidth="8"\n\t\t\t\t\t\t\theight="8"\n\t\t\t\t\t\t\tpatternUnits="userSpaceOnUse"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<rect x="0" y="0" width="8" height="8" fill="${t.solid}" mask="url(#hash_pattern_mask)" />\n\t\t\t\t\t\t</pattern>\n\t\t\t\t\t</defs>\n\t\t\t\t</svg>\n\t\t\t`,Array.from(r.querySelectorAll("defs > *"))}}}function th(){return{key:`${Vn.id}:pattern`,component:sh}}const nh=8,rh=(e,t,n)=>new Promise(((r,o)=>{const i=nh*t*e,s=document.createElement("canvas");s.width=i,s.height=i;const a=s.getContext("2d");if(!a)return;a.fillStyle=n?"#212529":"#f8f9fa",a.fillRect(0,0,i,i),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*t*e;const c=8/12,l=n=>n*t*e;a.beginPath(),a.moveTo(l(1*c),l(2)),a.lineTo(l(2),l(1*c)),a.moveTo(l(5*c),l(7*c)),a.lineTo(l(7*c),l(5*c)),a.moveTo(l(6),l(11*c)),a.lineTo(l(11*c),l(6)),a.stroke(),s.toBlob((e=>{!e||Nr.throwToBlob.get()?o():r(e)}))})),oh=(e,t)=>{const n=document.createElement("canvas");n.width=e[0],n.height=e[1];const r=n.getContext("2d");return r?(t(r),n.toDataURL()):""},ih=()=>{const e=[];for(let t=1;t<=Math.ceil(Jo);t++){const n=oh([1,1],(e=>{e.fillStyle=Rn.lightMode.black.semi,e.fillRect(0,0,1,1)})),r=oh([1,1],(e=>{e.fillStyle=Rn.darkMode.black.semi,e.fillRect(0,0,1,1)}));e.push({zoom:t,url:n,darkMode:!1}),e.push({zoom:t,url:r,darkMode:!0})}return e};function sh(){const t=Yr(),n=(0,e.useRef)(null),{defs:r,isReady:o}=function(){const t=Yr().getInstanceState().devicePixelRatio,[n,r]=(0,e.useState)(!1),o=(0,e.useMemo)((()=>ih()),[]),[i,s]=(0,e.useState)(o);return(0,e.useEffect)((()=>{const e=[];for(let n=1;n<=Math.ceil(Jo);n++)e.push(rh(t,n,!1).then((e=>({zoom:n,url:URL.createObjectURL(e),darkMode:!1})))),e.push(rh(t,n,!0).then((e=>({zoom:n,url:URL.createObjectURL(e),darkMode:!0}))));let n=!1;return Promise.all(e).then((e=>{n||(s(e),r(!0))})),()=>{n=!0,r(!1)}}),[t]),{defs:(0,Fr.jsx)(Fr.Fragment,{children:i.map((e=>{const t=e.zoom+(e.darkMode?"_dark":"_light");return(0,Fr.jsx)("pattern",{id:ti[t],width:nh,height:nh,patternUnits:"userSpaceOnUse",children:(0,Fr.jsx)("image",{href:e.url,width:nh,height:nh})},t)}))}),isReady:n}}();return(0,e.useEffect)((()=>{if(o&&t.environment.isSafari){const e=ah(n.current);e&&requestAnimationFrame((()=>{e.style.display="none",requestAnimationFrame((()=>{e.style.display=""}))}))}}),[t,o]),(0,Fr.jsx)("g",{ref:n,children:r})}function ah(e){return e.classList.contains("tl-html-layer")?e:e.parentElement?ah(e.parentElement):null}function ch(e,t,n={}){const{closed:r=!1,snap:o=1,start:i="outset",end:s="outset",lengthRatio:a=2,style:c="dashed"}=n;let l=0,u=0,d=1,h=0,p=0;switch(c){case"dashed":d=1,l=Math.min(t*a,e/4);break;case"dotted":d=100,l=t/d;break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||("outset"===i?(e+=l/2,p+=l/2):"skip"===i&&(e-=l,p-=l),"outset"===s?e+=l/2:"skip"===s&&(e-=l)),u=Math.floor(e/l/(2*d)),u-=u%o,u<3&&"dashed"===c?e/t<5?(l=e,u=1,h=0):(l=.333*e,h=.333*e):(u=Math.max(u,3),l=e/u/(2*d),r?(p=l/2,h=(e-u*l)/u):h=(e-u*l)/Math.max(1,u-1)),{strokeDasharray:[l,h].join(" "),strokeDashoffset:p.toString()}}function lh(t,n,r){const o=Yr(),i=(0,e.useRef)(null),s=(0,e.useRef)(!1),a=(0,e.useRef)(),c=le("isEditing",(()=>o.getEditingShapeId()===t),[o,t]);(0,e.useEffect)((()=>{const e=i.current;e&&c&&document.activeElement!==e&&e.focus()}),[c]);const l=(0,e.useCallback)((()=>{const e=s.current;s.current=!1,requestAnimationFrame((()=>{const n=i.current;if(!n)return;const r=o.getShape(t);r&&(n.value=r.props.text,n.value.length&&!e&&n.select())}))}),[o,t]),u=(0,e.useCallback)((()=>{const e=a.current;requestAnimationFrame((()=>{const n=i.current,r=o.getEditingShapeId();if(n&&r){if(r===t)if(e)if(e.length){s.current=!0,n.focus();const t=window.getSelection();t&&e.forEach((e=>t.addRange(e)))}else n.focus();else n.focus()}else window.getSelection()?.removeAllRanges(),o.complete()}))}),[o,t]),d=(0,e.useCallback)((e=>{if(c)switch((e.ctrlKey||e.metaKey)&&Hr(e),e.key){case"Enter":(e.ctrlKey||e.metaKey)&&o.complete();break;case"Tab":Vr(e),e.shiftKey?Ed.unindent(e.currentTarget):Ed.indent(e.currentTarget)}}),[o,c]),h=(0,e.useCallback)((e=>{if(!c)return;let r=Ed.normalizeText(e.currentTarget.value);const i=r.replace(/\t/g,Cd);if(i!==r){const t=e.currentTarget.selectionStart;e.currentTarget.value=i,e.currentTarget.selectionStart=t+(i.length-r.length),e.currentTarget.selectionEnd=t+(i.length-r.length),r=i}o.updateShapes([{id:t,type:n,props:{text:r}}])}),[o,t,n,c]),p=0===r.trim().length;(0,e.useEffect)((()=>{if(c&&i.current){let e=function(){const e=window.getSelection?.();if(e&&"None"!==e.type){const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt?.(n));a.current=t}};return document.addEventListener("selectionchange",e),()=>{document.removeEventListener("selectionchange",e)}}}),[c]);const f=(0,e.useCallback)((e=>{o.dispatch({...Gr(e),type:"pointer",name:"pointer_down",target:"shape",shape:o.getShape(t)}),Hr(e)}),[o,t]);return{rInput:i,isEditing:c,handleFocus:l,handleBlur:u,handleKeyDown:d,handleChange:h,handleInputPointerDown:f,handleDoubleClick:Hr,isEmpty:p}}const uh=e.memo((function({id:e,text:t,size:n,font:r,position:o,width:i,labelColor:s}){const{rInput:a,isEditing:c,handleFocus:l,handleBlur:u,handleKeyDown:d,handleChange:h,isEmpty:p,handleInputPointerDown:f,handleDoubleClick:g}=lh(e,"arrow",t),m=Ed.normalizeTextForDom(t).trim().length>0;return c||m?(0,Fr.jsx)("div",{className:"tl-arrow-label","data-font":r,"data-align":"center","data-hastext":!p,"data-isediting":c,style:{textAlign:"center",fontSize:Qu[n],lineHeight:Qu[n]*qu.lineHeight+"px",transform:`translate(${o.x}px, ${o.y}px)`,color:s},children:(0,Fr.jsxs)("div",{className:"tl-arrow-label__inner",children:[(0,Fr.jsx)("p",{style:{width:i||"9px"},children:t?Ed.normalizeTextForDom(t):" "}),c&&(0,Fr.jsx)("textarea",{ref:a,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:t,onFocus:l,onChange:h,onKeyDown:d,onBlur:u,onContextMenu:Hr,onPointerDown:f,onDoubleClick:g})]})}):null}));let dh=0;function hh(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n.setAttribute("fill","arrow"===t?"none":"black"),n.setAttribute("stroke","none"),n}function ph(e,t,n,r,o){const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",e),i.setAttribute("fill","none"),i.setAttribute("stroke",o[t].solid),i.setAttribute("stroke-width",n+"");const s=Xd({d:e,fill:r,color:t,theme:o});if(s){const e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.appendChild(s),e.appendChild(i),e}return i}function fh(e){return.5!==e.x||.5!==e.y}const gh="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function mh({url:e,zoomLevel:t}){return(0,Fr.jsx)("a",{className:Rr("tl-hyperlink-button",{"tl-hyperlink-button__hidden":t<.32}),href:e,target:"_blank",rel:"noopener noreferrer",onPointerDown:Hr,onPointerUp:Hr,title:e,draggable:!1,children:(0,Fr.jsx)("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${gh}") center 100% / 100% no-repeat`,WebkitMask:`url("${gh}") center 100% / 100% no-repeat`}})})}const _h=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function yh(e){return _h.map((t=>{const{offsetX:n,offsetY:r,blur:o,spread:i,color:s}=t,a=new ho(n,r),{x:c,y:l}=a.rot(-e);return`${c}px ${l}px ${o}px ${i}px ${s}`})).join(", ")}function wh(e,t){const{url:n}=t.props,r=Cn.createId(be(n));e.getAsset(r)?t.props.assetId!==r&&e.updateShapes([{id:t.id,type:t.type,props:{assetId:r}}]):(e.updateShapes([{id:t.id,type:t.type,props:{assetId:null}}]),vh(e,t))}const vh=ye((async(e,t)=>{const{url:n}=t.props,r=await e.getAssetForExternalContent({type:"url",url:n});r&&e.batch((()=>{e.createAssets([r]),e.updateShapes([{id:t.id,type:t.type,props:{assetId:r.id}}])}))}),500);function bh(e,t=!1){const n=e.length;if(n<2)return"";let r=e[0].point,o=e[1].point;if(2===n)return`M${go(r)}L${go(o)}`;let i="";for(let t=2,s=n-1;t<s;t++)r=e[t].point,o=e[t+1].point,i+=mo(r,o);return t?`M${mo(e[0].point,e[1].point)}Q${go(e[1].point)}${mo(e[1].point,e[2].point)}T${i}${mo(e[n-1].point,e[0].point)}${mo(e[0].point,e[1].point)}Z`:`M${go(e[0].point)}Q${go(e[1].point)}${mo(e[1].point,e[2].point)}${e.length>3?"T":""}${i}L${go(e[n-1].point)}`}function xh(){const e=Yr();return le("zoom",(()=>e.getZoomLevel()<.35),[e])}const Sh=e=>.65*e+.35*bo(e*_o/2),kh=e=>({size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:uo.easeOutSine,simulatePressure:!0}),Ch=e=>({size:1+1.2*e,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:Sh}),Eh=e=>({size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:uo.linear});function Ah({strokeWidth:e,showAsComplete:t}){return{size:1+e,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:uo.easeOutSine,last:t}}function Ih(e,t,n,r){return{...r?Eh(t):"draw"===e.dash?e.isPen?Ch(t):kh(t):Eh(t),last:e.isComplete||n}}function Ph(e){const t=[];for(const n of e)if("free"===n.type||n.points.length<2)t.push(...n.points.map(ho.Cast));else{const e=Math.max(4,Math.floor(ho.Dist(n.points[0],n.points[1])/16));t.push(...ho.PointsBetween(n.points[0],n.points[1],e))}return t}function Mh(e,t){return{draw:"none",solid:"none",dotted:"0.1 "+2*t,dashed:`${2*t} ${2*t}`}[e.props.dash]}function Th(e,t){const n=.5*(t+1);return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}function jh(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}function Dh({id:e,file:t,isInteractive:n,width:r,height:o,style:i,pageRotation:s}){return(0,Fr.jsx)("iframe",{className:"tl-embed",draggable:!1,width:No(r),height:No(o),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...i,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:yh(s)},srcDoc:`\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<base target="_blank">\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<script src=https://gist.github.com/${e}.js${t?`?file=${t}`:""}><\/script>\n\t\t\t\t\t<style type="text/css">\n\t\t\t\t\t\t* { margin: 0px; }\n\t\t\t\t\t\ttable { height: 100%; background-color: red; }\n\t\t\t\t\t\t.gist { background-color: none; height: 100%;  }\n\t\t\t\t\t\t.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }\n\t\t\t\t\t</style>\n\t\t\t\t</body>\n\t\t\t</html>`})}const Oh=(0,e.forwardRef)((({id:t,name:n,isEditing:r},o)=>{const i=Yr(),s=(0,e.useCallback)((e=>{"Enter"!==e.key||e.nativeEvent.isComposing||(Hr(e),e.currentTarget.blur(),i.setEditingShape(null))}),[i]),a=(0,e.useCallback)((e=>{const n=i.getShape(t);if(!n)return;const r=n.props.name,o=e.currentTarget.value.trim();r!==o&&i.updateShapes([{id:t,type:"frame",props:{name:o}}],{squashing:!0})}),[t,i]),c=(0,e.useCallback)((e=>{const n=i.getShape(t);if(!n)return;const r=n.props.name,o=e.currentTarget.value;r!==o&&i.updateShapes([{id:t,type:"frame",props:{name:o}}],{squashing:!0})}),[t,i]);return(0,Fr.jsxs)("div",{className:"tl-frame-label "+(r?"tl-frame-label__editing":""),children:[(0,Fr.jsx)("input",{className:"tl-frame-name-input",ref:o,style:{display:r?void 0:"none"},value:n,autoFocus:!0,onKeyDown:s,onBlur:a,onChange:c}),Fh(n,"Frame")+String.fromCharCode(8203)]})})),zh=function({id:t,name:n,width:r,height:o}){const i=Yr(),s=le("shape rotation",(()=>Eo(i.getShapePageTransform(t).rotation())),[i,t]),a=wu(t),c=(0,e.useRef)(null),l=(0,e.useCallback)((e=>{const n=Gr(e);i.getEditingShapeId()!==t&&(i.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:i.getShape(t),...n}),e.preventDefault())}),[i,t]);(0,e.useEffect)((()=>{const e=c.current;e&&a&&(e.focus(),e.select(),requestAnimationFrame((()=>{document.activeElement!==e&&(e.focus(),e.select())})))}),[c,a]);const u=((s+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(u)];let h;switch(d){case"top":h="";break;case"right":h=`translate(${No(r)}px, 0px) rotate(90deg)`;break;case"bottom":h=`translate(${No(r)}px, ${No(o)}px) rotate(180deg)`;break;case"left":h=`translate(0px, ${No(o)}px) rotate(270deg)`}return(0,Fr.jsx)("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${"top"===d||"bottom"===d?Math.ceil(r):Math.ceil(o)}px + var(--space-5))`,bottom:"100%",transform:`${h} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:l,children:(0,Fr.jsx)("div",{className:"tl-frame-heading-hit-area",children:(0,Fr.jsx)(Oh,{ref:c,id:t,name:n,isEditing:a})})})};function Fh(e,t){return e.match(/^\s*$/)?t:e}const Rh=e.memo((function({id:e,type:t,text:n,size:r,labelColor:o,font:i,align:s,verticalAlign:a,wrap:c,bounds:l}){const{rInput:u,isEmpty:d,isEditing:h,handleFocus:p,handleChange:f,handleKeyDown:g,handleBlur:m,handleInputPointerDown:_,handleDoubleClick:y}=lh(e,t,n),w=Ed.normalizeTextForDom(n),v=w.length>0,b=function(e){return"start-legacy"===e||"middle-legacy"===e||"end-legacy"===e}(s),x=Gd();return h||v?(0,Fr.jsx)("div",{className:"tl-text-label","data-font":i,"data-align":s,"data-hastext":!d,"data-isediting":h,"data-textwrap":!!c,style:{justifyContent:"middle"===s||b?"center":s,alignItems:"middle"===a?"center":a,...l?{top:l.minY,left:l.minX,width:l.width,height:l.height,position:"absolute"}:{}},children:(0,Fr.jsxs)("div",{className:"tl-text-label__inner",style:{fontSize:Zu[r],lineHeight:Zu[r]*qu.lineHeight+"px",minHeight:qu.lineHeight+32,minWidth:0,color:x[o].solid},children:[(0,Fr.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:w}),h&&(0,Fr.jsx)("textarea",{ref:u,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:p,onChange:f,onKeyDown:g,onBlur:m,onContextMenu:Hr,onPointerDown:_,onDoubleClick:y})]})}):null}));function Lh({bounds:e,editor:t,font:n,shape:r}){const o={fontSize:Zu[r.props.size],fontFamily:n,textAlign:r.props.align,verticalTextAlign:r.props.verticalAlign,width:Math.ceil(e.width),height:Math.ceil(e.height),padding:16,lineHeight:qu.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},i=t.textMeasure.measureTextSpans(r.props.text,o),s=function(e,t,n,r){if(("start-legacy"===e||"end-legacy"===e)&&0!==n.length){const t=fo.From(n[0].box);for(const{box:e}of n)t.union(e);if("start-legacy"===e)return(r-32-t.width)/2;if("end-legacy"===e)return-(r-32-t.width)/2}}(r.props.align,0,i,e.width);return s&&(o.offsetX=s),Qd(0,i,o)}function Nh(e){return`${No(e.x)},${No(e.y)} `}function Bh(e=""){let t=0,n=0,r=0,o=0;function i(){const e=t^t<<11;return t=n,n=r,r=o,o^=(o>>>19^e^e>>>8)>>>0,o/4294967296*2}for(let n=0;n<e.length+64;n++)t^=0|e.charCodeAt(n),i();return i}function $h(e){let t,n,r,o="M";for(let i=0,s=e.length;i<s;i+=3)t=e[i],n=e[i+1],r=e[i+2],o+=`${Nh(t)}L${Nh(n)}Q${Nh(r)}`;return o+=`${Nh(e[0])}`,o}function Uh(e,t,n,r,o){const i=[],s=Bh(e);let a,c=t[0];const l=t.length;for(let e=0,u=l*o;e<u;e++){a=ho.AddXY(t[(e+1)%l],s()*n,s()*n);const o=ho.Sub(a,c),u=ho.Len(o),d=ho.Div(o,u).mul(Math.min(u/4,r));i.push(ho.Add(c,d),ho.Add(a,d.neg()),a),c=a}return i}function Vh(e,t,n){let r=`M ${Nh(t[0])}L`,o=`M ${Nh(t[0])}L`;const i=n/3,s=2*n,a=Bh(e);let c,l,u=t[0],d=t[0];for(let e=0,n=t.length-1;e<n;e++){c=t[e+1],l=ho.AddXY(t[e+1],a()*i,a()*i);const h=ho.Sub(c,u),p=ho.Len(h),f=ho.Div(h,p).mul(Math.min(p/4,s)),g=ho.Add(u,f),m=ho.Add(c,f.neg()),_=ho.Sub(l,d),y=ho.Len(_),w=ho.Div(_,y).mul(Math.min(y/4,s)),v=ho.Add(d,w),b=ho.Add(l,w.neg());e===n-1?(r+=`${Nh(g)}L ${Nh(c)}`,o+=`${Nh(v)}L ${Nh(l)}`):(r+=`${Nh(g)}L ${Nh(m)}Q ${Nh(c)}`,o+=`${Nh(v)}L ${Nh(b)}Q ${Nh(l)}`,u=c,d=l)}return[r,r+o]}function Wh(e,t){const n=Math.min(e,t)/2,r=Math.max(e,t)-2*n;return Math.PI*(2*n)+2*r}const Kh=(e,t,n,r,o)=>{switch(e){case"s":return t;case"m":return n;case"l":return r;case"xl":return o}};function Hh(e,t,n,r){const o=Ee(n),i=Wh(e,t),s=Math.max(Math.ceil(i/Kh(r,50,70,100,130)),6,Math.ceil(i/Math.min(e,t))),a=i/s*.2,c=Math.max(e-2*a,1),l=Math.max(t-2*a,1),u=(e-c)/2,d=(t-l)/2,h=Wh(c,l)/s,p=function(e,t,n){const r=Math.min(e,t)/2,o=Math.max(e,t)-2*r,i=(Math.PI*(2*r)+2*o)/n,s=e>t?[{type:"straight",start:new ho(r,0),delta:new ho(1,0)},{type:"arc",center:new ho(e-r,r),startAngle:-_o/2},{type:"straight",start:new ho(e-r,t),delta:new ho(-1,0)},{type:"arc",center:new ho(r,r),startAngle:_o/2}]:[{type:"straight",start:new ho(e,r),delta:new ho(0,1)},{type:"arc",center:new ho(r,t-r),startAngle:0},{type:"straight",start:new ho(0,t-r),delta:new ho(0,-1)},{type:"arc",center:new ho(r,r),startAngle:_o}];let a=0;const c=[];for(let e=0;e<n;e++){const e=s[0];"straight"===e.type?c.push(ho.Add(e.start,ho.Mul(e.delta,a))):c.push(Do(e.center.x,e.center.y,r,e.startAngle+a/r)),a+=i;let t="straight"===e.type?o:_o*r;for(;a>t;)a-=t,s.push(s.shift()),t="straight"===s[0].type?o:_o*r}return c}(c,l,s).map((e=>e.addXY(u,d))),f=e<20?0:.3*a,g=t<20?0:.3*a,m=p.slice(0);for(let e=0;e<Math.floor(s/2);e++)m[e]=ho.AddXY(m[e],o()*f,o()*g),m[s-e-1]=ho.AddXY(m[s-e-1],o()*f,o()*g);const _=[];for(let n=0;n<m.length;n++){const r=n===m.length-1?0:n+1,o=m[n],i=m[r],s=p[n],a=p[r],c=ho.Average([s,a]),l=ho.Angle(s,a)-Math.PI/2,f=ho.Dist(s,a),g=h-f,y=ho.Dist(o,i)/f,w=(Math.max(u,d)+g)*y,v=ho.Add(c,ho.FromAngle(l,w));v.x<0?v.x=0:v.x>e&&(v.x=e),v.y<0?v.y=0:v.y>t&&(v.y=t);const b=Gh(o,i,v),x=ho.Dist(b||ho.Average([o,i]),o);_.push({leftPoint:o,rightPoint:i,arcPoint:v,center:b,radius:x})}return _}function Gh(e,t,n){const r=e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y,o=-((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/(2*r),i=-((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/(2*r);return Number.isFinite(o)&&Number.isFinite(i)?new ho(o,i):null}function qh(e,t,n,r){const o=[],i=Hh(e,t,n,r);for(const{center:e,radius:t,leftPoint:n,rightPoint:r}of i)o.push(...Zh(n,r,e,t,10));return o}function Yh(e,t,n,r){const o=Hh(e,t,n,r);let i=`M${No(o[0].leftPoint.x)},${No(o[0].leftPoint.y)}`;for(const{leftPoint:e,rightPoint:t,radius:n,center:r}of o){if(null===r){i+=` L${No(t.x)},${No(t.y)}`;continue}const o=Qh(e,t,r)?"0":"1";i+=` A${No(n)},${No(n)} 0 ${o},1 ${No(t.x)},${No(t.y)}`}return i+=" Z",i}function Xh(e,t,n,r){const o=Ee(n),i="s"===r?.5:"m"===r?.7:"l"===r?.9:1.6,s=e=>e+o()*i*2,a=Hh(e,t,n,r),c=a.reduce(((e,t)=>e+ho.Dist(t.leftPoint,t.rightPoint)),0)/a.length>15*i?e=>new ho(s(e.x),s(e.y)):e=>e;let l=`M${No(a[0].leftPoint.x)},${No(a[0].leftPoint.y)}`,u=c(a[0].leftPoint),d=`M${No(u.x)},${No(u.y)}`;for(const{leftPoint:e,center:t,rightPoint:n,radius:r,arcPoint:o}of a){if(null===t){l+=` L${No(n.x)},${No(n.y)}`;const e=c(n);d+=` L${No(e.x)},${No(e.y)}`,u=e;continue}const i=Qh(e,n,t)?"0":"1";l+=` A${No(r)},${No(r)} 0 ${i},1 ${No(n.x)},${No(n.y)}`;const s=c(n),a=Gh(u,s,c(o));if(!a){d+=` L${No(s.x)},${No(s.y)}`,u=s;continue}const h=Math.abs(ho.Dist(a,u));d+=` A${No(h)},${No(h)} 0 ${i},1 ${No(s.x)},${No(s.y)}`,u=s}return l+d+" Z"}function Zh(e,t,n,r,o){if(null===n)return[ho.From(e),ho.From(t)];const i=[],s=ho.Angle(n,e),a=Ao(s,ho.Angle(n,t));for(let e=0;e<o;e++){const t=s+a*(e/(o-1)),c=Do(n.x,n.y,r,t);i.push(c)}return i}function Qh(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)>0}const Jh=e.memo((function({dash:e,fill:t,color:n,strokeWidth:r,w:o,h:i,id:s,size:a}){const c=Gd(),l=Yh(o,i,s,a),u=Hh(o,i,s,a);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:c,d:l,fill:t,color:n}),(0,Fr.jsx)("g",{strokeWidth:r,stroke:c[n].solid,fill:"none",pointerEvents:"all",children:u.map((({leftPoint:t,rightPoint:n,center:o,radius:i},s)=>{const a=o?i*Eo(Eo(ho.Angle(o,n))-Eo(ho.Angle(o,t))):ho.Dist(t,n),{strokeDasharray:c,strokeDashoffset:l}=ch(a,r,{style:e,start:"outset",end:"outset"});return(0,Fr.jsx)("path",{d:o?`M${t.x},${t.y}A${i},${i},0,0,1,${n.x},${n.y}`:`M${t.x},${t.y}L${n.x},${n.y}`,strokeDasharray:c,strokeDashoffset:l},s)}))})]})})),ep=e.memo((function({w:e,h:t,strokeWidth:n,dash:r,color:o,fill:i}){const s=Gd(),a=e/2,c=t/2,l=Math.max(0,a),u=Math.max(0,c),d=Co(l,u),{strokeDasharray:h,strokeDashoffset:p}=ch(d<64?2*d:d,n,{style:r,snap:4,closed:!0}),f=`M${a-l},${c}a${l},${u},0,1,1,${2*l},0a${l},${u},0,1,1,-${2*l},0`;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:s,d:f,color:o,fill:i}),(0,Fr.jsx)("path",{d:f,strokeWidth:n,width:No(e),height:No(t),fill:"none",stroke:s[o].solid,strokeDasharray:h,strokeDashoffset:p,pointerEvents:"all"})]})}));function tp(e,t){if(t>e){const n=e/2;return`\n    M0,${n}\n    a${n},${n},0,1,1,${2*n},0\n    L${e},${t-n}\n    a${n},${n},0,1,1,-${2*n},0\n    Z`}const n=t/2;return`\n    M${n},0\n    L${e-n},0\n    a${n},${n},0,1,1,0,${2*n}\n    L${n},${t}\n    a${n},${n},0,1,1,0,${2*-n}\n    Z`}function np(e,t){if(e>t){const n=t/2;return Co(n,n)+2*(e-2*n)}const n=e/2;return Co(n,n)+2*(t-2*n)}const rp=e.memo((function({w:e,h:t,strokeWidth:n,dash:r,color:o,fill:i}){const s=Gd(),a=tp(e,t),c=np(e,t),{strokeDasharray:l,strokeDashoffset:u}=ch(c<64?2*c:c,n,{style:r,snap:4,start:"outset",end:"outset",closed:!0});return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:s,d:a,color:o,fill:i}),(0,Fr.jsx)("path",{d:a,strokeWidth:n,width:No(e),height:No(t),fill:"none",stroke:s[o].solid,strokeDasharray:l,strokeDashoffset:u,pointerEvents:"all"})]})}));const op=e.memo((function({dash:e,fill:t,color:n,strokeWidth:r,outline:o,lines:i}){const s=Gd(),a="M"+o[0]+"L"+o.slice(1)+"Z";return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:s,d:a,fill:t,color:n}),(0,Fr.jsxs)("g",{strokeWidth:r,stroke:s[n].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(o.length)).map(((t,n)=>{const i=o[n],s=o[(n+1)%o.length],a=ho.Dist(i,s),{strokeDasharray:c,strokeDashoffset:l}=ch(a,r,{style:e,start:"outset",end:"outset"});return(0,Fr.jsx)("line",{x1:i.x,y1:i.y,x2:s.x,y2:s.y,strokeDasharray:c,strokeDashoffset:l},n)})),i&&i.map((([t,o],i)=>{const a=ho.Dist(t,o),{strokeDasharray:c,strokeDashoffset:l}=ch(a,r,{style:e,start:"skip",end:"outset",snap:"dotted"===e?4:void 0});return(0,Fr.jsx)("path",{d:`M${t.x},${t.y}L${o.x},${o.y}`,stroke:s[n].solid,strokeWidth:r,fill:"none",strokeDasharray:c,strokeDashoffset:l},`line_fg_${i}`)}))]})]})})),ip=e.memo((function({fill:e,color:t,strokeWidth:n,w:r,h:o,id:i,size:s}){const a=Gd(),c=Xh(r,o,i,s);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:a,d:c,fill:e,color:t}),(0,Fr.jsx)("path",{d:c,stroke:a[t].solid,strokeWidth:n,fill:"none"})]})}));function sp(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function ap(e,t,n,r){const o=Ee(e),i=t/2,s=n/2,a=Co(i,s),c=[],l=wo*o(),u=wo+yo/2+Math.abs(o())*yo,d=Math.max(16,a/10);for(let e=0;e<d;e++){const r=e/(d-1),a=l+r*u,h=Math.cos(a),p=Math.sin(a);c.push(new ho(i*h+.5*t+.05*o(),s*p+n/2+.05*o(),Math.min(1,.5+Math.abs(.5-(o()>0?uo.easeInOutSine(r):uo.easeInExpo(r)))/2)))}return Fu(c,sp(r))}function cp(e,t,n,r){const o=sp(r);return li(Du(Nu(ap(e,t,n,r),o),o))}function lp(e,t,n,r){return bh(ap(e,t,n,r))}e.memo((function({id:e,w:t,h:n,strokeWidth:r,fill:o,color:i}){const s=Gd(),a=lp(e,t,n,r),c=cp(e,t,n,r);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:s,d:a,color:i,fill:o}),(0,Fr.jsx)("path",{d:c,fill:s[i].solid,strokeWidth:0,pointerEvents:"all"})]})}));const up=e.memo((function({id:e,outline:t,lines:n,fill:r,color:o,strokeWidth:i}){const s=Gd();let a=$h(Uh(e,t,i/3,2*i,2));if(n)for(const[e,t]of n)a+=`M${e.x},${e.y}L${t.x},${t.y}`;const c=$h(Uh(e,t,0,2*i,1));return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{d:c,fill:r,color:o,theme:s}),(0,Fr.jsx)("path",{d:a,stroke:s[o].solid,strokeWidth:i,fill:"none"})]})})),dp=e.memo((function({fill:e,color:t,strokeWidth:n,w:r,h:o,id:i,size:s}){const a=Gd(),c=Yh(r,o,i,s);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{theme:a,d:c,fill:e,color:t}),(0,Fr.jsx)("path",{d:c,stroke:a[t].solid,strokeWidth:n,fill:"none"})]})})),hp=e.memo((function({w:e,h:t,strokeWidth:n,fill:r,color:o}){const i=Gd(),s=e/2,a=t/2,c=Math.max(0,s),l=Math.max(0,a),u=`M${s-c},${a}a${c},${l},0,1,1,${2*c},0a${c},${l},0,1,1,-${2*c},0`;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{d:u,color:o,fill:r,theme:i}),(0,Fr.jsx)("path",{d:u,stroke:i[o].solid,strokeWidth:n,fill:"none"})]})})),pp=e.memo((function({w:e,h:t,strokeWidth:n,fill:r,color:o}){const i=Gd(),s=fp(e,t);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{d:s,color:o,fill:r,theme:i}),(0,Fr.jsx)("path",{d:s,stroke:i[o].solid,strokeWidth:n,fill:"none"})]})}));function fp(e,t){let n;if(t>e){const r=e/2;n=`\n    M0,${r}\n    a${r},${r},0,1,1,${2*r},0\n    L${e},${t-r}\n    a${r},${r},0,1,1,-${2*r},0\n    Z`}else{const r=t/2;n=`\n    M${r},0\n    L${e-r},0\n    a${r},${r},0,1,1,0,${2*r}\n    L${r},${t}\n    a${r},${r},0,1,1,0,${2*-r}\n    Z`}return n}const gp=e.memo((function({outline:e,lines:t,fill:n,color:r,strokeWidth:o}){const i=Gd();let s="M"+e[0]+"L"+e.slice(1)+"Z";if(t)for(const[e,n]of t)s+=`M${e.x},${e.y}L${n.x},${n.y}`;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(qd,{d:s,fill:n,color:r,theme:i}),(0,Fr.jsx)("path",{d:s,stroke:i[r].solid,strokeWidth:o,fill:"none"})]})})),mp=51;function _p(e,t){const n=t.props.text;if(!n)return{w:0,h:0};const r=e.textMeasure.measureText("w",{...qu,fontFamily:Ju[t.props.font],fontSize:Zu[t.props.size],maxWidth:100}),o=e.textMeasure.measureText(n,{...qu,fontFamily:Ju[t.props.font],fontSize:Zu[t.props.size],minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+{s:2,m:3.5,l:5,xl:10}[t.props.size]),Math.ceil(t.props.w-32))});return{w:o.w+32,h:o.h+32}}function yp(e,t){switch(e.geo){case"x-box":return function(e,t,n,r){const o="draw"===r?.62:0;if("dashed"===r)return[[new ho(0,0),new ho(e/2,t/2)],[new ho(e,t),new ho(e/2,t/2)],[new ho(0,t),new ho(e/2,t/2)],[new ho(e,0),new ho(e/2,t/2)]];const i=t=>Math.max(0,Math.min(e,t)),s=e=>Math.max(0,Math.min(t,e));return[[new ho(i(n*o),s(n*o)),new ho(i(e-n*o),s(t-n*o))],[new ho(i(n*o),s(t-n*o)),new ho(i(e-n*o),s(n*o))]]}(e.w,e.h,t,e.dash);case"check-box":return function(e,t){const n=.82*Math.min(e,t),r=(e-n)/2,o=(t-n)/2,i=t=>Math.max(0,Math.min(e,t)),s=e=>Math.max(0,Math.min(t,e));return[[new ho(i(r+.25*n),s(o+.52*n)),new ho(i(r+.45*n),s(o+.82*n))],[new ho(i(r+.45*n),s(o+.82*n)),new ho(i(r+.82*n),s(o+.22*n))]]}(e.w,e.h);default:return}}function wp(e,t,n){const r=Ph(e.props.segments),o=e.props.isComplete||"straight"===pe(e.props.segments)?.type;let i=t;return n||e.props.isPen||1!==r.length||(i+=Ee(e.id)()*(t/6)),{strokePoints:Fu(r,Ah({strokeWidth:i,showAsComplete:o})),sw:i}}function vp(e,t,n){const{strokePoints:r,sw:o}=wp(e,t,n);var i;return{solidStrokePath:r.length>1?bh(r,!1):`M ${(i=e.props.segments[0].points[0]).x} ${i.y} m -0.1, 0 a 0.1,0.1 0 1,0 0.2,0 a 0.1,0.1 0 1,0 -0.2,0`,sw:o}}function bp({strokeWidth:t,shape:n,opacity:r}){const o=Gd(),i=xh(),{solidStrokePath:s,sw:a}=vp(n,t,i),c=function(){const[t,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=CSS.supports("color","color(display-p3 1 1 1)"),t=matchMedia("(color-gamut: p3)");n(e&&t.matches);const r=()=>n(e&&t.matches);return t.addEventListener("change",r),()=>t.removeEventListener("change",r)}),[]),le(Nr.forceSrgb)||!t?"srgb":"p3"}(),l=o[n.props.color].highlight[c];return(0,Fr.jsx)(Ea,{id:n.id,style:{opacity:r},children:(0,Fr.jsx)("path",{d:s,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:l,strokeWidth:a})})}function xp(e,t,n,r){const{solidStrokePath:o,sw:i}=vp(t,e,!1),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",o),s.setAttribute("fill","none"),s.setAttribute("stroke",r[t.props.color].highlight.srgb),s.setAttribute("stroke-width",`${i}`),s.setAttribute("opacity",`${n}`),s}function Sp(e){return 1.12*Xu[e.props.size]}function kp(e){return 1===e.props.segments.length&&e.props.segments[0].points.length<2}function Cp(){const[t,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=()=>{n(e.matches)};return t(),e.addEventListener("change",t),()=>e.removeEventListener("change",t)}),[]),t}function Ep(e){const t=e.props.crop,n=t?.topLeft;if(!n)return{width:e.props.w,height:e.props.h};const r=1/(t.bottomRight.x-t.topLeft.x)*e.props.w,o=1/(t.bottomRight.y-t.topLeft.y)*e.props.h;return{transform:`translate(${-n.x*r}px, ${-n.y*o}px)`,width:r,height:o}}function Ap(e,t){const{start:n,end:r}=e;return t?`M${No(n.x)},${No(n.y)} L${No(r.x)},${No(r.y)} `:`${No(r.x)},${No(r.y)} `}function Ip(e,t){const{a:n,b:r,c:o,d:i}=e;return ho.Equals(n,i)?"":`${t?`M${No(n.x)},${No(n.y)}`:""}C${No(r.x)},${No(r.y)} ${No(o.x)},${No(o.y)} ${No(i.x)},${No(i.y)}`}function Pp(e,t){let n=e.segments.reduce(((e,t,n)=>e+Ip(t,0===n)),"");return t&&(n+="Z"),n}function Mp(e,t=!1){return e instanceof Na?function(e,t){let n=e.segments.reduce(((e,t,n)=>e+Ap(t,0===n)),"");return t&&(n+="Z"),n}(e,t):Pp(e,t)}function Tp(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function jp(e,t,n){return Fu(t.vertices,Tp(n))}function Dp(e,t,n){const r=function(e,t,n){const r=Tp(n);return Du(Nu(jp(0,t,n),r),r)}(0,t,n);return li(r)}const Op=new Xa;function zp(e){const{spline:t,handles:n}=e.props,r=Object.values(n).sort(fc).map(ho.From);switch(t){case"cubic":return new Eu({points:r});case"line":return new Na({points:r})}}const Fp=200;function Rp(e,t,n=0){const r=e.textMeasure.measureText(t.props.text,{...qu,fontFamily:Ju[t.props.font],fontSize:Zu[t.props.size],maxWidth:166}).h+34;let o=null;if(r>Fp?o=r-Fp:n&&(o=0),null!==o)return{...t,props:{...t.props,growY:o}}}function Lp(e,{initialBounds:t,scaleX:n,scaleY:r,newPoint:o}){const i=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),s=new ho(0,0);n<0&&(s.x=-t.width*i),r<0&&(s.y=-t.height*i);const{x:a,y:c}=ho.Add(o,s.rot(e.rotation));return{x:a,y:c,props:{scale:i*e.props.scale}}}const Np=new Xa;function Bp(e,t){const{font:n,text:r,autoSize:o,size:i,w:s}=t,a=o?16:Math.max(16,s),c=Xu[i],l=o?null:Math.floor(Math.max(a,s)),u=e.textMeasure.measureText(r,{...qu,fontFamily:Ju[n],fontSize:c,maxWidth:l});return o&&(u.w+=1),{width:Math.max(a,u.w),height:Math.max(c,u.h)}}const $p=se((function(t){const{shape:n,videoUtil:r}=t,o=r.editor.getShapeGeometry(n).bounds.w*r.editor.getZoomLevel()>=110,i=n.props.assetId?r.editor.getAsset(n.props.assetId):null,{time:s,playing:a}=n.props,c=wu(n.id),l=Cp(),u=e.useRef(null),d=e.useCallback((e=>{const t=e.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:t.currentTime}}])}),[n.id,r.editor]),h=e.useCallback((e=>{const t=e.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:t.currentTime}}])}),[n.id,r.editor]),p=e.useCallback((e=>{const t=e.currentTarget;c&&r.editor.updateShapes([{type:"video",id:n.id,props:{time:t.currentTime}}])}),[c,n.id,r.editor]),[f,g]=e.useState(!1),m=e.useCallback((e=>{const t=e.currentTarget;s!==t.currentTime&&(t.currentTime=s),a||t.pause(),g(!0)}),[a,s]);return e.useEffect((()=>{const e=u.current;e&&(f&&!c&&s!==e.currentTime&&(e.currentTime=s),c&&document.activeElement!==e&&e.focus())}),[c,f,s]),e.useEffect((()=>{if(l){const e=u.current;e.pause(),e.currentTime=0}}),[u,l]),(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(hu,{id:n.id,children:(0,Fr.jsx)("div",{className:"tl-counter-scaled",children:i?.props.src?(0,Fr.jsx)("video",{ref:u,style:c?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${n.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:c&&o,onPlay:d,onPause:h,onTimeUpdate:p,onLoadedData:m,hidden:!f,children:(0,Fr.jsx)("source",{src:i.props.src})}):null})}),"url"in n.props&&n.props.url&&(0,Fr.jsx)(mh,{url:n.props.url,zoomLevel:r.editor.getZoomLevel()})]})})),Up=[class extends Ua{static type="text";static props=Pr;static migrations=Mr;getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(e){return Np.get(e.props,(e=>Bp(this.editor,e)))}getGeometry(e){const{scale:t}=e.props,{width:n,height:r}=this.getMinDimensions(e);return new $a({width:n*t,height:r*t,isFilled:!0})}canEdit=()=>!0;isAspectRatioLocked=()=>!0;component(e){const{id:t,type:n,props:{text:r,color:o}}=e,i=Ln({isDarkMode:this.editor.user.getIsDarkMode()}),{width:s,height:a}=this.getMinDimensions(e),{rInput:c,isEmpty:l,isEditing:u,handleFocus:d,handleChange:h,handleKeyDown:p,handleBlur:f,handleInputPointerDown:g,handleDoubleClick:m}=lh(t,n,r);return(0,Fr.jsx)(hu,{id:e.id,children:(0,Fr.jsxs)("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":e.props.font,"data-align":e.props.align,"data-hastext":!l,"data-isediting":u,"data-textwrap":!0,style:{fontSize:Xu[e.props.size],lineHeight:Xu[e.props.size]*qu.lineHeight+"px",transform:`scale(${e.props.scale})`,transformOrigin:"top left",width:Math.max(1,s),height:Math.max(Xu[e.props.size]*qu.lineHeight,a),color:i[o].solid},children:[(0,Fr.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:r}),u?(0,Fr.jsx)("textarea",{ref:c,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:u,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:r,onFocus:d,onChange:h,onKeyDown:p,onBlur:f,onTouchEnd:Hr,onContextMenu:Hr,onPointerDown:g,onDoubleClick:m}):null]})})}indicator(e){const t=this.editor.getShapeGeometry(e).bounds,n=Yr();return e.props.autoSize&&n.getEditingShapeId()===e.id?null:(0,Fr.jsx)("rect",{width:No(t.width),height:No(t.height)})}toSvg(e,t){t.addExportDef(Jd(e.props.font));const n=Ln({isDarkMode:this.editor.user.getIsDarkMode()}),r=this.editor.getShapeGeometry(e).bounds,o=e.props.text,i=r.width/(e.props.scale??1),s=r.height/(e.props.scale??1),a={fontSize:Xu[e.props.size],fontFamily:Wn[e.props.font],textAlign:e.props.align,verticalTextAlign:"middle",width:i,height:s,padding:0,lineHeight:qu.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},c=n[e.props.color].solid,l=document.createElementNS("http://www.w3.org/2000/svg","g"),u=Qd(this.editor,this.editor.textMeasure.measureTextSpans(o,a),{...a,stroke:n.background,strokeWidth:2,fill:n.background,padding:0}),d=u.cloneNode(!0);return d.setAttribute("fill",c),d.setAttribute("stroke","none"),l.append(u),l.append(d),l}onResize=(e,t)=>{const{initialBounds:n,initialShape:r,scaleX:o,handle:i}=t;if("scale_shape"===t.mode||"right"!==i&&"left"!==i)return{id:e.id,type:e.type,...Lp(e,t)};{const t=n.width;let s=t*o;const a=new ho(0,0);s=Math.max(1,Math.abs(s)),"left"===i?(a.x=t-s,o<0&&(a.x+=s)):o<0&&(a.x-=s);const{x:c,y:l}=a.rot(e.rotation).add(r);return{id:e.id,type:e.type,x:c,y:l,props:{w:s/r.props.scale,autoSize:!1}}}};onBeforeCreate=e=>{if(!e.props.autoSize)return;if(e.props.text.trim())return;const t=this.getMinDimensions(e);return{...e,x:e.x-t.width/2,y:e.y-t.height/2}};onEditEnd=e=>{const{id:t,type:n,props:{text:r}}=e,o=e.props.text.trimEnd();0===o.length?this.editor.deleteShapes([e.id]):o!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])};onBeforeUpdate=(e,t)=>{if(!t.props.autoSize)return;const n=e.props.size!==t.props.size||e.props.align!==t.props.align||e.props.font!==t.props.font||1!==e.props.scale&&1===t.props.scale,r=e.props.text!==t.props.text;if(!n&&!r)return;const o=this.getMinDimensions(e),i=Bp(this.editor,t.props),s=o.width*e.props.scale,a=o.height*e.props.scale,c=i.width*t.props.scale,l=i.height*t.props.scale;let u;switch(t.props.align){case"middle":u=new ho((c-s)/2,r?0:(l-a)/2);break;case"end":u=new ho(c-s,r?0:(l-a)/2);break;default:if(r)break;u=new ho(0,(l-a)/2)}if(u){u.rot(t.rotation);const{x:e,y:n}=t;return{...t,x:e-u.x,y:n-u.y,props:{...t.props,w:c}}}return{...t,props:{...t.props,w:c}}};onDoubleClickEdge=e=>e.props.autoSize?1!==e.props.scale?{id:e.id,type:e.type,props:{scale:1}}:void 0:{id:e.id,type:e.type,props:{autoSize:!0}}},class extends pu{static type="bookmark";static props=Qn;static migrations=Jn;canResize=()=>!1;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(e){const t=e.props.assetId?this.editor.getAsset(e.props.assetId):null,n=this.editor.getShapePageTransform(e).rotation(),r=(e=>{try{const t=new URL(e.props.url),n=t.pathname.replace(/\/*$/,"");return`${t.hostname}${n}`}catch(t){return e.props.url}})(e);return(0,Fr.jsx)(hu,{children:(0,Fr.jsxs)("div",{className:"tl-bookmark__container",style:{boxShadow:yh(n)},children:[(0,Fr.jsxs)("div",{className:"tl-bookmark__image_container",children:[t?.props.image?(0,Fr.jsx)("img",{className:"tl-bookmark__image",draggable:!1,src:t?.props.image,alt:t?.props.title||""}):(0,Fr.jsx)("div",{className:"tl-bookmark__placeholder"}),(0,Fr.jsx)(mh,{url:e.props.url,zoomLevel:this.editor.getZoomLevel()})]}),(0,Fr.jsxs)("div",{className:"tl-bookmark__copy_container",children:[t?.props.title&&(0,Fr.jsx)("h2",{className:"tl-bookmark__heading",children:Pd(t?.props.title||"",54)}),t?.props.description&&(0,Fr.jsx)("p",{className:"tl-bookmark__description",children:Pd(t?.props.description||"",128)}),(0,Fr.jsx)("a",{className:"tl-bookmark__link",href:e.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:Hr,onPointerUp:Hr,onClick:Hr,children:Pd(r,45)})]})]})})}indicator(e){return(0,Fr.jsx)("rect",{width:No(e.props.w),height:No(e.props.h),rx:"8",ry:"8"})}onBeforeCreate=e=>{wh(this.editor,e)};onBeforeUpdate=(e,t)=>{if(e.props.url!==t.props.url){if(!Ue(t.props.url))return{...t,props:{...t.props,url:e.props.url}};wh(this.editor,t)}}},class extends Ua{static type="draw";static props=tr;static migrations=nr;hideResizeHandles=e=>jh(e);hideRotateHandle=e=>jh(e);hideSelectionBoundsFg=e=>jh(e);getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getGeometry(e){const t=Ph(e.props.segments),n=Yu[e.props.size];if(1===e.props.segments.length){const e=fo.FromPoints(t);if(e.width<2*n&&e.height<2*n)return new ku({x:-n,y:-n,radius:n,isFilled:!0})}const r=Fu(t,Ih(e.props,n,!0,!0)).map((e=>e.point));return e.props.isClosed?new Ba({points:r,isFilled:"none"!==e.props.fill}):new Na({points:r})}component(e){const t=Gd(),n=xh(),r=Yu[e.props.size],o=Ph(e.props.segments),i=e.props.isComplete||"straight"===pe(e.props.segments)?.type;let s=r;n||e.props.isPen||"draw"!==e.props.dash||1!==o.length||(s+=Ee(e.id)()*(r/6));const a=Ih(e.props,s,i,n),c=Fu(o,a),l=c.length>1?bh(c,e.props.isClosed):Th(o[0],s);if(!n&&"draw"===e.props.dash||c.length<2){Nu(c,a);const n=Du(c,a);return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{theme:t,fill:e.props.isClosed?e.props.fill:"none",color:e.props.color,d:l}),(0,Fr.jsx)("path",{d:li(n,!0),strokeLinecap:"round",fill:t[e.props.color].solid})]})}return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{theme:t,color:e.props.color,fill:e.props.isClosed?e.props.fill:"none",d:l}),(0,Fr.jsx)("path",{d:l,strokeLinecap:"round",fill:"none",stroke:t[e.props.color].solid,strokeWidth:r,strokeDasharray:Mh(e,r),strokeDashoffset:"0"})]})}indicator(e){const t=xh(),n=Yu[e.props.size],r=Ph(e.props.segments);let o=n;t||e.props.isPen||"draw"!==e.props.dash||1!==r.length||(o+=Ee(e.id)()*(n/6));const i=e.props.isComplete||"straight"===pe(e.props.segments)?.type,s=Fu(r,Ih(e.props,o,i,!0)),a=s.length>1?bh(s,e.props.isClosed):Th(r[0],o);return(0,Fr.jsx)("path",{d:a})}toSvg(e,t){const n=Ln({isDarkMode:this.editor.user.getIsDarkMode()});t.addExportDef(eh(e.props.fill,n));const{color:r}=e.props,o=Yu[e.props.size],i=Ph(e.props.segments),s=e.props.isComplete||"straight"===pe(e.props.segments)?.type;let a=o;e.props.isPen||"draw"!==e.props.dash||1!==i.length||(a+=Ee(e.id)()*(o/6));const c=Ih(e.props,a,s,!1),l=Fu(i,c),u=l.length>1?bh(l,e.props.isClosed):Th(i[0],a);let d;if("draw"===e.props.dash||l.length<2){Nu(l,c);const e=Du(l,c),t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",li(e,!0)),t.setAttribute("fill",n[r].solid),t.setAttribute("stroke-linecap","round"),d=t}else{const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",u),t.setAttribute("stroke",n[r].solid),t.setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-width",o.toString()),t.setAttribute("stroke-dasharray",Mh(e,o)),t.setAttribute("stroke-dashoffset","0"),d=t}const h=Xd({fill:e.props.isClosed?e.props.fill:"none",d:u,color:e.props.color,theme:n});if(h){const e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.appendChild(h),e.appendChild(d),e}return d}getCanvasSvgDefs(){return[th()]}onResize=(e,t)=>{const{scaleX:n,scaleY:r}=t,o=[];for(const t of e.props.segments)o.push({...t,points:t.points.map((({x:e,y:t,z:o})=>({x:Bo(n*e),y:Bo(r*t),z:o})))});return{props:{segments:o}}};expandSelectionOutlinePx(e){const t="draw"===e.props.dash?1.6:1;return Yu[e.props.size]*t/2}},class extends pu{static type="geo";static props=fr;static migrations=gr;canEdit=()=>!0;getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}getGeometry(e){const t=Math.max(1,e.props.w),n=Math.max(1,e.props.h+e.props.growY),r=t/2,o=n/2,i=Yu[e.props.size],s="none"!==e.props.fill;let a;switch(e.props.geo){case"cloud":a=new Ba({points:qh(t,n,e.id,e.props.size),isFilled:s});break;case"triangle":a=new Ba({points:[new ho(r,0),new ho(t,n),new ho(0,n)],isFilled:s});break;case"diamond":a=new Ba({points:[new ho(r,0),new ho(t,o),new ho(r,n),new ho(0,o)],isFilled:s});break;case"pentagon":a=new Ba({points:Oo(t,n,5),isFilled:s});break;case"hexagon":a=new Ba({points:Oo(t,n,6),isFilled:s});break;case"octagon":a=new Ba({points:Oo(t,n,8),isFilled:s});break;case"ellipse":a=new Au({width:t,height:n,isFilled:s});break;case"oval":a=new Iu({width:t,height:n,isFilled:s});break;case"star":{const e=5,r=wo/e/2,o=2*Math.floor(e/4),i=2*e-o,c=0,l=2*Math.floor(e/2),u=Math.cos(o*r-yo)*t/2,d=Math.cos(i*r-yo)*t/2,h=Math.sin(c*r-yo)*n/2,p=Math.sin(l*r-yo)*n/2,f=t-Math.abs(u-d),g=n-Math.abs(p-h),m=1,_=(t-(t/2+d-(t/2-u)))/2,y=(n-(n/2+h-(n/2-p)))/2,w=(t+f)/2,v=(n+g)/2,b=w*m/2,x=v*m/2;a=new Ba({points:Array.from(Array(2*e)).map(((e,t)=>{const n=t*r-yo;return new ho(_+(t%2?b:w)*Math.cos(n),y+(t%2?x:v)*Math.sin(n))})),isFilled:s});break}case"rhombus":{const e=Math.min(.38*t,.38*n);a=new Ba({points:[new ho(e,0),new ho(t,0),new ho(t-e,n),new ho(0,n)],isFilled:s});break}case"rhombus-2":{const e=Math.min(.38*t,.38*n);a=new Ba({points:[new ho(0,0),new ho(t-e,0),new ho(t,n),new ho(e,n)],isFilled:s});break}case"trapezoid":{const e=Math.min(.38*t,.38*n);a=new Ba({points:[new ho(e,0),new ho(t-e,0),new ho(t,n),new ho(0,n)],isFilled:s});break}case"arrow-right":{const e=.38*Math.min(t,n),r=.16*n;a=new Ba({points:[new ho(0,r),new ho(t-e,r),new ho(t-e,0),new ho(t,n/2),new ho(t-e,n),new ho(t-e,n-r),new ho(0,n-r)],isFilled:s});break}case"arrow-left":{const e=.38*Math.min(t,n),r=.16*n;a=new Ba({points:[new ho(e,0),new ho(e,r),new ho(t,r),new ho(t,n-r),new ho(e,n-r),new ho(e,n),new ho(0,n/2)],isFilled:s});break}case"arrow-up":{const e=.16*t,r=.38*Math.min(t,n);a=new Ba({points:[new ho(t/2,0),new ho(t,r),new ho(t-e,r),new ho(t-e,n),new ho(e,n),new ho(e,r),new ho(0,r)],isFilled:s});break}case"arrow-down":{const e=.16*t,r=.38*Math.min(t,n);a=new Ba({points:[new ho(e,0),new ho(t-e,0),new ho(t-e,n-r),new ho(t,n-r),new ho(t/2,n),new ho(0,n-r),new ho(e,n-r)],isFilled:s});break}case"check-box":case"x-box":case"rectangle":a=new $a({width:t,height:n,isFilled:s,isSnappable:!0})}const c=_p(this.editor,e),l=Math.min(t,Math.max(c.w,Math.min(32,Math.max(1,t-8)))),u=Math.min(n,Math.max(c.h,Math.min(32,Math.max(1,t-8)))),d=yp(e.props,i),h=d?d.map((e=>new Na({points:e}))):[];return new Ia({children:[a,new $a({x:"start"===e.props.align?0:"end"===e.props.align?t-l:(t-l)/2,y:"start"===e.props.verticalAlign?0:"end"===e.props.verticalAlign?n-u:(n-u)/2,width:l,height:u,isFilled:!0,isSnappable:!1,isLabel:!0}),...h],isSnappable:!1})}onEditEnd=e=>{const{id:t,type:n,props:{text:r}}=e;r.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])};component(e){const{id:t,type:n,props:r}=e,o=Yu[r.size],{w:i,color:s,labelColor:a,fill:c,dash:l,growY:u,font:d,align:h,verticalAlign:p,size:f,text:g}=r;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(Ea,{id:t,children:(()=>{const n=r.h+u;switch(r.geo){case"cloud":if("solid"===l)return(0,Fr.jsx)(dp,{color:s,fill:c,strokeWidth:o,w:i,h:n,id:t,size:f});if("dashed"===l||"dotted"===l)return(0,Fr.jsx)(Jh,{color:s,fill:c,strokeWidth:o,w:i,h:n,id:t,size:f,dash:l});if("draw"===l)return(0,Fr.jsx)(ip,{color:s,fill:c,strokeWidth:o,w:i,h:n,id:t,size:f});break;case"ellipse":if("solid"===l)return(0,Fr.jsx)(hp,{strokeWidth:o,w:i,h:n,color:s,fill:c});if("dashed"===l||"dotted"===l)return(0,Fr.jsx)(ep,{id:t,strokeWidth:o,w:i,h:n,dash:l,color:s,fill:c});if("draw"===l)return(0,Fr.jsx)(hp,{strokeWidth:o,w:i,h:n,color:s,fill:c});break;case"oval":if("solid"===l)return(0,Fr.jsx)(pp,{strokeWidth:o,w:i,h:n,color:s,fill:c});if("dashed"===l||"dotted"===l)return(0,Fr.jsx)(rp,{id:t,strokeWidth:o,w:i,h:n,dash:l,color:s,fill:c});if("draw"===l)return(0,Fr.jsx)(pp,{strokeWidth:o,w:i,h:n,color:s,fill:c});break;default:{const n=this.editor.getShapeGeometry(e),r=n instanceof Ia?n.children[0].vertices:n.vertices,i=yp(e.props,o);if("solid"===l)return(0,Fr.jsx)(gp,{fill:c,color:s,strokeWidth:o,outline:r,lines:i});if("dashed"===l||"dotted"===l)return(0,Fr.jsx)(op,{dash:l,fill:c,color:s,strokeWidth:o,outline:r,lines:i});if("draw"===l)return(0,Fr.jsx)(up,{id:t,fill:c,color:s,strokeWidth:o,outline:r,lines:i})}}})()}),(0,Fr.jsxs)(hu,{id:e.id,style:{overflow:"hidden",width:e.props.w,height:e.props.h+r.growY},children:[(0,Fr.jsx)(Rh,{id:t,type:n,font:d,fill:c,size:f,align:h,verticalAlign:p,text:g,labelColor:a,wrap:!0,bounds:"cloud"===r.geo?this.getGeometry(e).bounds:void 0}),e.props.url&&(0,Fr.jsx)(mh,{url:e.props.url,zoomLevel:this.editor.getZoomLevel()})]})]})}indicator(e){const{id:t,props:n}=e,{w:r,size:o}=n,i=n.h+n.growY,s=Yu[o];switch(n.geo){case"ellipse":return"draw"===n.dash?(0,Fr.jsx)("path",{d:lp(t,r,i,s)}):(0,Fr.jsx)("ellipse",{cx:r/2,cy:i/2,rx:r/2,ry:i/2});case"oval":return(0,Fr.jsx)("path",{d:fp(r,i)});case"cloud":return(0,Fr.jsx)("path",{d:Yh(r,i,t,o)});default:{const r=this.editor.getShapeGeometry(e),o=r instanceof Ia?r.children[0].vertices:r.vertices;let i;i="draw"===n.dash?$h(Uh(t,o,0,2*s,1)):"M"+o[0]+"L"+o.slice(1)+"Z";const a=yp(e.props,s);if(a)for(const[e,t]of a)i+=`M${e.x},${e.y}L${t.x},${t.y}`;return(0,Fr.jsx)("path",{d:i})}}}toSvg(e,t){const{id:n,props:r}=e,o=Yu[r.size],i=Ln({isDarkMode:this.editor.user.getIsDarkMode()});let s;switch(t.addExportDef(eh(e.props.fill,i)),r.geo){case"ellipse":switch(r.dash){case"draw":s=function({id:e,w:t,h:n,strokeWidth:r,fill:o,color:i,theme:s}){const a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",cp(e,t,n,r)),a.setAttribute("fill",s[i].solid),Zd(a,Xd({d:lp(e,t,n,r),fill:o,color:i,theme:s}))}({id:n,w:r.w,h:r.h,color:r.color,fill:r.fill,strokeWidth:o,theme:i});break;case"solid":s=function({w:e,h:t,strokeWidth:n,fill:r,color:o,theme:i}){const s=e/2,a=t/2,c=Math.max(0,s),l=Math.max(0,a),u=`M${s-c},${a}a${c},${l},0,1,1,${2*c},0a${c},${l},0,1,1,-${2*c},0`,d=document.createElementNS("http://www.w3.org/2000/svg","path");return d.setAttribute("d",u),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",i[o].solid),Zd(d,Xd({d:u,fill:r,color:o,theme:i}))}({strokeWidth:o,w:r.w,h:r.h,color:r.color,fill:r.fill,theme:i});break;default:s=function({w:e,h:t,strokeWidth:n,dash:r,color:o,theme:i,fill:s}){const a=e/2,c=t/2,l=Math.max(0,a-n/2),u=Math.max(0,c-n/2),d=Co(l,u),{strokeDasharray:h,strokeDashoffset:p}=ch(d<64?2*d:d,n,{style:r,snap:4,closed:!0}),f=`M${a-l},${c}a${l},${u},0,1,1,${2*l},0a${l},${u},0,1,1,-${2*l},0`,g=document.createElementNS("http://www.w3.org/2000/svg","path");return g.setAttribute("d",f),g.setAttribute("stroke-width",n.toString()),g.setAttribute("width",e.toString()),g.setAttribute("height",t.toString()),g.setAttribute("fill","none"),g.setAttribute("stroke",i[o].solid),g.setAttribute("stroke-dasharray",h),g.setAttribute("stroke-dashoffset",p),Zd(g,Xd({d:f,fill:s,color:o,theme:i}))}({id:n,strokeWidth:o,w:r.w,h:r.h,dash:r.dash,color:r.color,fill:r.fill,theme:i})}break;case"oval":switch(r.dash){case"draw":default:s=function({w:e,h:t,strokeWidth:n,dash:r,color:o,theme:i,fill:s}){const a=tp(e,t),c=np(e,t),{strokeDasharray:l,strokeDashoffset:u}=ch(c<64?2*c:c,n,{style:r,snap:4,closed:!0}),d=document.createElementNS("http://www.w3.org/2000/svg","path");return d.setAttribute("d",a),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",i[o].solid),d.setAttribute("stroke-dasharray",l),d.setAttribute("stroke-dashoffset",u),Zd(d,Xd({d:a,fill:s,color:o,theme:i}))}({id:n,strokeWidth:o,w:r.w,h:r.h,dash:r.dash,color:r.color,fill:r.fill,theme:i});break;case"solid":s=function({w:e,h:t,strokeWidth:n,fill:r,color:o,theme:i}){const s=fp(e,t),a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",s),a.setAttribute("stroke-width",n.toString()),a.setAttribute("width",e.toString()),a.setAttribute("height",t.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke",i[o].solid),Zd(a,Xd({d:s,fill:r,color:o,theme:i}))}({strokeWidth:o,w:r.w,h:r.h,color:r.color,fill:r.fill,theme:i})}break;case"cloud":switch(r.dash){case"draw":s=function({fill:e,color:t,strokeWidth:n,theme:r,w:o,h:i,id:s,size:a}){const c=Xh(o,i,s,a),l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("d",c),l.setAttribute("stroke-width",n.toString()),l.setAttribute("stroke",r[t].solid),l.setAttribute("fill","none"),Zd(l,Xd({d:c,fill:e,color:t,theme:r}))}({id:n,strokeWidth:o,w:r.w,h:r.h,color:r.color,fill:r.fill,size:r.size,theme:i});break;case"solid":s=function({fill:e,color:t,strokeWidth:n,theme:r,w:o,h:i,id:s,size:a}){const c=Yh(o,i,s,a),l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("d",c),l.setAttribute("stroke-width",n.toString()),l.setAttribute("stroke",r[t].solid),l.setAttribute("fill","none"),Zd(l,Xd({d:c,fill:e,color:t,theme:r}))}({strokeWidth:o,w:r.w,h:r.h,color:r.color,fill:r.fill,size:r.size,id:n,theme:i});break;default:s=function({dash:e,fill:t,color:n,theme:r,strokeWidth:o,w:i,h:s,id:a,size:c}){const l=Yh(i,s,a,c),u=Hh(i,s,a,c),d=document.createElementNS("http://www.w3.org/2000/svg","g");d.setAttribute("stroke-width",o.toString()),d.setAttribute("stroke",r[n].solid),d.setAttribute("fill","none");for(const{leftPoint:t,rightPoint:n,center:r,radius:i}of u){const s=r?i*Eo(Eo(ho.Angle(r,n))-Eo(ho.Angle(r,t))):ho.Dist(t,n),{strokeDasharray:a,strokeDashoffset:c}=ch(s,o,{style:e,start:"outset",end:"outset"}),l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",r?`M${t.x},${t.y}A${i},${i},0,0,1,${n.x},${n.y}`:`M${t.x},${t.y}L${n.x},${n.y}`),l.setAttribute("stroke-dasharray",a.toString()),l.setAttribute("stroke-dashoffset",c.toString()),d.appendChild(l)}return Zd(d,Xd({d:l,fill:t,color:n,theme:r}))}({id:n,strokeWidth:o,w:r.w,h:r.h,dash:r.dash,color:r.color,fill:r.fill,theme:i,size:r.size})}break;default:{const t=this.editor.getShapeGeometry(e),a=t instanceof Ia?t.children[0].vertices:t.vertices,c=yp(e.props,o);switch(r.dash){case"draw":s=function({id:e,outline:t,lines:n,fill:r,color:o,theme:i,strokeWidth:s}){let a=$h(Uh(e,t,s/3,2*s,2));if(n)for(const[e,t]of n)a+=`M${e.x},${e.y}L${t.x},${t.y}`;const c=$h(Uh(e,t,0,2*s,1)),l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("d",a),l.setAttribute("fill","none"),l.setAttribute("stroke",i[o].solid),l.setAttribute("stroke-width",s.toString()),Zd(l,Xd({d:c,fill:r,color:o,theme:i}))}({id:n,fill:r.fill,color:r.color,strokeWidth:o,outline:a,lines:c,theme:i});break;case"solid":s=function({outline:e,lines:t,fill:n,color:r,strokeWidth:o,theme:i}){const s="M"+e[0]+"L"+e.slice(1)+"Z",a=s;let c=s;if(t)for(const[e,n]of t)c+=`M${e.x},${e.y}L${n.x},${n.y}`;const l=document.createElementNS("http://www.w3.org/2000/svg","path");return l.setAttribute("d",c),l.setAttribute("stroke-width",o.toString()),l.setAttribute("stroke",i[r].solid),l.setAttribute("fill","none"),Zd(l,Xd({d:a,fill:n,color:r,theme:i}))}({fill:r.fill,color:r.color,strokeWidth:o,outline:a,lines:c,theme:i});break;default:s=function({dash:e,fill:t,color:n,theme:r,strokeWidth:o,outline:i,lines:s}){const a=document.createElementNS("http://www.w3.org/2000/svg","g");if(a.setAttribute("stroke-width",o.toString()),a.setAttribute("stroke",r[n].solid),a.setAttribute("fill","none"),Array.from(Array(i.length)).forEach(((t,n)=>{const r=i[n],s=i[(n+1)%i.length],c=ho.Dist(r,s),{strokeDasharray:l,strokeDashoffset:u}=ch(c,o,{style:e}),d=document.createElementNS("http://www.w3.org/2000/svg","line");d.setAttribute("x1",r.x.toString()),d.setAttribute("y1",r.y.toString()),d.setAttribute("x2",s.x.toString()),d.setAttribute("y2",s.y.toString()),d.setAttribute("stroke-dasharray",l.toString()),d.setAttribute("stroke-dashoffset",u.toString()),a.appendChild(d)})),s)for(const[t,n]of s){const r=ho.Dist(t,n),{strokeDasharray:i,strokeDashoffset:s}=ch(r,o,{style:e,start:"skip",end:"skip",snap:"dotted"===e?4:2}),c=document.createElementNS("http://www.w3.org/2000/svg","line");c.setAttribute("x1",t.x.toString()),c.setAttribute("y1",t.y.toString()),c.setAttribute("x2",n.x.toString()),c.setAttribute("y2",n.y.toString()),c.setAttribute("stroke-dasharray",i.toString()),c.setAttribute("stroke-dashoffset",s.toString()),a.appendChild(c)}const c=Xd({d:"M"+i[0]+"L"+i.slice(1)+"Z",fill:t,color:n,theme:r});return Zd(a,c)}({dash:r.dash,fill:r.fill,color:r.color,strokeWidth:o,outline:a,lines:c,theme:i})}break}}if(r.text){const n=this.editor.getShapeGeometry(e).bounds;t.addExportDef(Jd(e.props.font));const r=Lh({editor:this.editor,shape:e,font:Wn[e.props.font],bounds:n}),o=r.cloneNode(!0);o.setAttribute("fill",i[e.props.labelColor].solid),o.setAttribute("stroke","none");const a=r.cloneNode(!0);a.setAttribute("stroke-width","2"),a.setAttribute("fill",i.background),a.setAttribute("stroke",i.background);const c=document.createElementNS("http://www.w3.org/2000/svg","g");if(c.append(a),c.append(o),"g"===s.nodeName)return s.appendChild(c),s;{const e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.appendChild(s),e.appendChild(c),e}}return s}getCanvasSvgDefs(){return[th()]}onResize=(e,{handle:t,newPoint:n,scaleX:r,scaleY:o,initialShape:i})=>{let s=i.props.w*r,a=(i.props.h+i.props.growY)*o,c=0,l=0;if(e.props.text.trim()){let t=Math.max(Math.abs(s),mp),n=Math.max(Math.abs(a),mp);t<mp&&n===mp&&(t=mp),t===mp&&n<mp&&(n=mp);const r=_p(this.editor,{...e,props:{...e.props,w:t,h:n}}),o=Math.max(Math.abs(s),r.w)*Math.sign(s),i=Math.max(Math.abs(a),r.h)*Math.sign(a);c=Math.abs(o)-Math.abs(s),l=Math.abs(i)-Math.abs(a),s=o,a=i}const u=new ho(0,0);r<0&&(u.x+=s),"left"!==t&&"top_left"!==t&&"bottom_left"!==t||(u.x+=r<0?c:-c),o<0&&(u.y+=a),"top"!==t&&"top_left"!==t&&"top_right"!==t||(u.y+=o<0?l:-l);const{x:d,y:h}=u.rot(e.rotation).add(n);return{x:d,y:h,props:{w:Math.max(Math.abs(s),1),h:Math.max(Math.abs(a),1),growY:0}}};onBeforeCreate=e=>{if(!e.props.text)return e.props.growY?{...e,props:{...e.props,growY:0}}:void 0;const t=e.props.h,n=_p(this.editor,e).h;let r=null;return n>t?r=n-t:e.props.growY&&(r=0),null!==r?{...e,props:{...e.props,growY:r}}:void 0};onBeforeUpdate=(e,t)=>{const n=e.props.text,r=t.props.text;if(n===r&&e.props.font===t.props.font&&e.props.size===t.props.size)return;if(n&&!r)return{...t,props:{...t.props,growY:0}};const o=e.props.w,i=e.props.h,s=_p(this.editor,t),a=s.w,c=s.h;if(!n&&r&&1===r.length){let n=Math.max(o,a),r=Math.max(i,c);return e.props.w<mp&&e.props.h<mp&&(n=Math.max(n,mp),r=Math.max(r,mp),n=Math.max(n,r),r=Math.max(n,r)),{...t,props:{...t.props,w:n,h:r,growY:0}}}let l=null;return c>i?l=c-i:e.props.growY&&(l=0),null!==l?{...t,props:{...t.props,growY:l,w:Math.max(t.props.w,a)}}:a>e.props.w?{...t,props:{...t.props,w:a}}:void 0};onDoubleClick=e=>{if(this.editor.inputs.altKey)switch(e.props.geo){case"rectangle":return{...e,props:{geo:"check-box"}};case"check-box":return{...e,props:{geo:"rectangle"}}}}},class extends Ua{static type="note";static props=Ar;static migrations=Ir;canEdit=()=>!0;hideResizeHandles=()=>!0;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(e){return Fp+e.props.growY}getGeometry(e){const t=this.getHeight(e);return new $a({width:Fp,height:t,isFilled:!0})}component(e){const{id:t,type:n,props:{color:r,font:o,size:i,align:s,text:a,verticalAlign:c}}=e,l=Gd(),u="black"===r?"yellow":r;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)("div",{style:{position:"absolute",width:Fp,height:this.getHeight(e)},children:(0,Fr.jsxs)("div",{className:"tl-note__container",style:{color:l[u].solid,backgroundColor:l[u].solid},children:[(0,Fr.jsx)("div",{className:"tl-note__scrim"}),(0,Fr.jsx)(Rh,{id:t,type:n,font:o,size:i,align:s,verticalAlign:c,text:a,labelColor:"black",wrap:!0})]})}),"url"in e.props&&e.props.url&&(0,Fr.jsx)(mh,{url:e.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(e){return(0,Fr.jsx)("rect",{rx:"7",width:No(Fp),height:No(this.getHeight(e))})}toSvg(e,t){t.addExportDef(Jd(e.props.font));const n=Ln({isDarkMode:this.editor.user.getIsDarkMode()}),r=this.editor.getShapeGeometry(e).bounds,o=document.createElementNS("http://www.w3.org/2000/svg","g"),i="black"===e.props.color?"yellow":e.props.color,s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("rx","10"),s.setAttribute("width",Fp.toString()),s.setAttribute("height",r.height.toString()),s.setAttribute("fill",n[i].solid),s.setAttribute("stroke",n[i].solid),s.setAttribute("stroke-width","1"),o.appendChild(s);const a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("rx","10"),a.setAttribute("width",Fp.toString()),a.setAttribute("height",r.height.toString()),a.setAttribute("fill",n.background),a.setAttribute("opacity",".28"),o.appendChild(a);const c=Lh({editor:this.editor,shape:e,font:Wn[e.props.font],bounds:r});return c.setAttribute("fill",n.text),c.setAttribute("stroke","none"),o.appendChild(c),o}onBeforeCreate=e=>Rp(this.editor,e,e.props.growY);onBeforeUpdate=(e,t)=>{if(e.props.text!==t.props.text||e.props.font!==t.props.font||e.props.size!==t.props.size)return Rp(this.editor,t,e.props.growY)};onEditEnd=e=>{const{id:t,type:n,props:{text:r}}=e;r.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])}},class extends Ua{static type="line";static props=Cr;static migrations=Er;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsFg=()=>!0;hideSelectionBoundsBg=()=>!0;getDefaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,canSnap:!0,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,canSnap:!0,index:"a2",x:.1,y:.1}}}}getGeometry(e){return zp(e)}getHandles(e){return Op.get(e.props,(()=>{const t=e.props.handles,n=zp(e),r=Object.values(t).sort(fc),o=r.slice();for(let e=0;e<n.segments.length;e++){const t=n.segments[e].midPoint(),i=dc(r[e].index,r[e+1].index);o.push({id:`mid-${e}`,type:"create",index:i,x:t.x,y:t.y})}return o.sort(fc)}))}getOutlineSegments(e){return this.editor.getShapeGeometry(e).segments.map((e=>e.vertices))}onResize=(e,t)=>{const{scaleX:n,scaleY:r}=t,o=Me(e.props.handles);return Object.values(e.props.handles).forEach((({id:e,x:t,y:i})=>{o[e].x=t*n,o[e].y=i*r})),{props:{handles:o}}};onHandleChange=(e,{handle:t})=>{const n=Me(e);switch(t.id){case"start":case"end":n.props.handles[t.id]={...n.props.handles[t.id],x:t.x,y:t.y};break;default:{const r="handle:"+t.index,o=e.props.handles[r];n.props.handles[r]=o?{...o,x:t.x,y:t.y}:{id:r,type:"vertex",canBind:!1,index:t.index,x:t.x,y:t.y};break}}return n};component(e){const t=Gd(),n=zp(e),r=Yu[e.props.size],{dash:o,color:i}=e.props;if("line"===e.props.spline){if("solid"===o){const o=n.points,s="M"+o[0]+"L"+o.slice(1);return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{d:s,fill:"none",color:i,theme:t}),(0,Fr.jsx)("path",{d:s,stroke:t[i].solid,strokeWidth:r,fill:"none"})]})}if("dashed"===o||"dotted"===o){const s=n.points,a="M"+s[0]+"L"+s.slice(1);return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{d:a,fill:"none",color:i,theme:t}),(0,Fr.jsx)("g",{stroke:t[i].solid,strokeWidth:r,children:n.segments.map(((e,t)=>{const{strokeDasharray:i,strokeDashoffset:s}=ch(e.length,r,{style:o,start:t>0?"outset":"none",end:t<n.segments.length-1?"outset":"none"});return(0,Fr.jsx)("path",{strokeDasharray:i,strokeDashoffset:s,d:Ap(e,!0),fill:"none"},t)}))})]})}if("draw"===o){const o=n.points,[s,a]=Vh(e.id,o,r);return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{d:s,fill:"none",color:i,theme:t}),(0,Fr.jsx)("path",{d:a,stroke:t[i].solid,strokeWidth:r,fill:"none"})]})}}if("cubic"===e.props.spline){const s=Mp(n);if("solid"===o)return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{d:s,fill:"none",color:i,theme:t}),(0,Fr.jsx)("path",{strokeWidth:r,stroke:t[i].solid,fill:"none",d:s})]});if("dashed"===o||"dotted"===o)return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{d:s,fill:"none",color:i,theme:t}),(0,Fr.jsx)("g",{stroke:t[i].solid,strokeWidth:r,children:n.segments.map(((e,t)=>{const{strokeDasharray:i,strokeDashoffset:s}=ch(e.length,r,{style:o,start:t>0?"outset":"none",end:t<n.segments.length-1?"outset":"none"});return(0,Fr.jsx)("path",{strokeDasharray:i,strokeDashoffset:s,d:Ip(e,!0),fill:"none"},t)}))})]});if("draw"===o)return(0,Fr.jsxs)(Ea,{id:e.id,children:[(0,Fr.jsx)(qd,{d:s,fill:"none",color:i,theme:t}),(0,Fr.jsx)("path",{d:Dp(0,n,r),strokeWidth:1,stroke:t[i].solid,fill:t[i].solid})]})}}indicator(e){const t=Yu[e.props.size],n=zp(e),{dash:r}=e.props;let o;if("line"===e.props.spline){const i=n.points;if("solid"===r||"dotted"===r||"dashed"===r)o="M"+i[0]+"L"+i.slice(1);else{const[n]=Vh(e.id,i,t);o=n}}else o=function(e,t,n){return"draw"===e.props.dash?bh(jp(0,t,n)):Mp(t)}(e,n,t);return(0,Fr.jsx)("path",{d:o})}toSvg(e){const t=Ln({isDarkMode:this.editor.user.getIsDarkMode()})[e.props.color].solid,n=zp(e),r=Yu[e.props.size];switch(e.props.dash){case"draw":{let o;if(n instanceof Eu)o=Dp(0,n,r);else{const[t,i]=Vh(e.id,n.points,r);o=i}const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("stroke-width",r+"px"),i.setAttribute("stroke",t),i.setAttribute("fill","none"),i.setAttribute("d",o),i}case"solid":{let e;if(n instanceof Eu)e=Pp(n,!1);else{const t=n.points;e="M"+t[0]+"L"+t.slice(1)}const o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width",r+"px"),o.setAttribute("stroke",t),o.setAttribute("fill","none"),o.setAttribute("d",e),o}default:{const{segments:o}=n,i=document.createElementNS("http://www.w3.org/2000/svg","g");i.setAttribute("stroke",t),i.setAttribute("stroke-width",r.toString());const s=n instanceof Eu?Ip:Ap;return o.forEach(((t,n)=>{const a=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:c,strokeDashoffset:l}=ch(t.length,r,{style:e.props.dash,start:n>0?"outset":"none",end:n<o.length-1?"outset":"none"});a.setAttribute("stroke-dasharray",c.toString()),a.setAttribute("stroke-dashoffset",l.toString()),a.setAttribute("d",s(t,!0)),a.setAttribute("fill","none"),i.appendChild(a)})),i}}}},class extends pu{static type="frame";static props=lr;static migrations=ur;canBind=()=>!0;canEdit=()=>!0;getDefaultProps(){return{w:320,h:180,name:""}}getGeometry(e){return new $a({width:e.props.w,height:e.props.h,isFilled:!1})}component(e){const t=this.editor.getShapeGeometry(e).bounds,n=Gd();return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(Ea,{children:(0,Fr.jsx)("rect",{className:"tl-frame__body",width:t.width,height:t.height,fill:n.solid,stroke:n.text})}),(0,Fr.jsx)(zh,{id:e.id,name:e.props.name,width:t.width,height:t.height})]})}toSvg(e){const t=Ln({isDarkMode:this.editor.user.getIsDarkMode()}),n=document.createElementNS("http://www.w3.org/2000/svg","g"),r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("width",e.props.w.toString()),r.setAttribute("height",e.props.h.toString()),r.setAttribute("fill",t.solid),r.setAttribute("stroke",t.black.solid),r.setAttribute("stroke-width","1"),r.setAttribute("rx","1"),r.setAttribute("ry","1"),n.appendChild(r);const o=((Eo(this.editor.getShapePageTransform(e.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4;let i;switch(["top","left","bottom","right"][Math.floor(o)]){case"top":default:i="";break;case"right":i=`translate(${No(e.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":i=`translate(${No(e.props.w)}px, ${No(e.props.h)}px) rotate(180deg)`;break;case"left":i=`translate(0px, ${No(e.props.h)}px) rotate(270deg)`}const s={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:e.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},a=this.editor.textMeasure.measureTextSpans(Fh(e.props.name,"Frame")+String.fromCharCode(8203),s),c=a[0],l=pe(a),u=l.box.w+l.box.x-c.box.x,d=Qd(this.editor,a,{offsetY:-s.height-2,...s});d.style.setProperty("transform",i);const h=document.createElementNS("http://www.w3.org/2000/svg","rect");return h.setAttribute("x","-8px"),h.setAttribute("y",-s.height-4+"px"),h.setAttribute("width",u+16+"px"),h.setAttribute("height",`${s.height}px`),h.setAttribute("rx","4px"),h.setAttribute("ry","4px"),h.setAttribute("fill",t.background),n.appendChild(h),n.appendChild(d),n}indicator(e){const t=this.editor.getShapeGeometry(e).bounds;return(0,Fr.jsx)("rect",{width:No(t.width),height:No(t.height),className:"tl-frame-indicator"})}canReceiveNewChildrenOfType=(e,t)=>!e.isLocked;providesBackgroundForChildren(){return!0}canDropShapes=(e,t)=>!e.isLocked;onDragShapesOver=(e,t)=>t.every((t=>t.parentId===e.id))?{shouldHint:!1}:(this.editor.reparentShapes(t.map((e=>e.id)),e.id),{shouldHint:!0});onDragShapesOut=(e,t)=>{const n=this.editor.getShape(e.parentId);n&&this.editor.isShapeOfType(n,"group")?this.editor.reparentShapes(t,n.id):this.editor.reparentShapes(t,this.editor.getCurrentPageId())};onResizeEnd=e=>{const t=this.editor.getShapePageBounds(e),n=this.editor.getSortedChildIdsForParent(e.id),r=[];for(const e of n){const n=this.editor.getShapePageBounds(e);t.includes(n)||r.push(e)}r.length>0&&this.editor.reparentShapes(r,this.editor.getCurrentPageId())}},class extends Ua{static type="arrow";static props=Xn;static migrations=Zn;canEdit=()=>!0;canBind=()=>!1;canSnap=()=>!1;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsBg=()=>!0;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getGeometry(e){const t=this.editor.getArrowInfo(e),n=t.isStraight?new La({start:ho.From(t.start.point),end:ho.From(t.end.point)}):new xu({center:ho.Cast(t.handleArc.center),radius:t.handleArc.radius,start:ho.Cast(t.start.point),end:ho.Cast(t.end.point),sweepFlag:t.bodyArc.sweepFlag,largeArcFlag:t.bodyArc.largeArcFlag});let r;if(e.props.text.trim()){const o=n.bounds,{w:i,h:s}=this.editor.textMeasure.measureText(e.props.text,{...qu,fontFamily:Ju[e.props.font],fontSize:Qu[e.props.size],maxWidth:null});let a=i,c=s;if(o.width>o.height){a=Math.max(Math.min(i,64),Math.min(o.width-64,i));const{w:t,h:n}=this.editor.textMeasure.measureText(e.props.text,{...qu,fontFamily:Ju[e.props.font],fontSize:Qu[e.props.size],maxWidth:a});a=t,c=n}if(a>16*Qu[e.props.size]){a=16*Qu[e.props.size];const{w:t,h:n}=this.editor.textMeasure.measureText(e.props.text,{...qu,fontFamily:Ju[e.props.font],fontSize:Qu[e.props.size],maxWidth:a});a=t,c=n}r=new $a({x:t.middle.x-a/2-4.25,y:t.middle.y-c/2-4.25,width:a+8.5,height:c+8.5,isFilled:!0,isLabel:!0})}return new Ia({children:r?[n,r]:[n],isSnappable:!1})}getHandles(e){const t=this.editor.getArrowInfo(e);return[{id:"start",type:"vertex",index:"a0",x:t.start.handle.x,y:t.start.handle.y,canBind:!0},{id:"middle",type:"virtual",index:"a2",x:t.middle.x,y:t.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:t.end.handle.x,y:t.end.handle.y,canBind:!0}]}onHandleChange=(e,{handle:t,isPrecise:n})=>{const r=t.id;if("middle"===r){const{start:n,end:r}=Yc(this.editor,e),o=ho.Sub(r,n),i=ho.Per(o),s=ho.Med(r,n),a=ho.Sub(s,i),c=ho.Add(s,i),l=ho.NearestPointOnLineSegment(a,c,t,!1);let u=ho.Dist(l,s);return ho.Clockwise(l,r,s)&&(u*=-1),{id:e.id,type:e.type,props:{bend:u}}}const o=Me(e),i=this.editor.getShapePageTransform(o.id).applyToPoint(t);if(this.editor.inputs.ctrlKey)return o.props[r]={type:"point",x:t.x,y:t.y},o;const s=this.editor.getShapePageTransform(e.id).applyToPoint(t),a=this.editor.getShapeAtPoint(s,{hitInside:!0,hitFrameInside:!0,margin:0,filter:e=>!e.isLocked&&this.editor.getShapeUtil(e).canBind(e)});if(!a)return o.props[r]={type:"point",x:t.x,y:t.y},o;const c=this.editor.getShapeGeometry(a),l=fo.ZeroFix(c.bounds),u=this.editor.getPointInShapeSpace(a,i);let d=n;if(!d){const e=o.props[r];("point"===e.type||"binding"===e.type&&a.id!==e.boundShapeId)&&(d=this.editor.inputs.pointerVelocity.len()<.5)}if(d&&(d=ho.Dist(u,l.center)>Math.max(4,Math.min(.15*Math.min(l.width,l.height),16))/this.editor.getZoomLevel()),!n){c.isClosed||(d=!0);const e=o.props["start"===r?"end":"start"];"binding"===e.type&&a.id===e.boundShapeId&&ho.Equals(e.normalizedAnchor,{x:.5,y:.5})&&(d=!0)}return o.props[r]={type:"binding",boundShapeId:a.id,normalizedAnchor:d?{x:(u.x-l.minX)/l.width,y:(u.y-l.minY)/l.height}:{x:.5,y:.5},isExact:this.editor.inputs.altKey},"binding"===o.props.start.type&&"binding"===o.props.end.type&&o.props.start.boundShapeId===o.props.end.boundShapeId&&ho.Equals(o.props.start.normalizedAnchor,o.props.end.normalizedAnchor)&&(o.props.end.normalizedAnchor.x+=.05),o};onTranslateStart=e=>{const t="binding"===e.props.start.type?e.props.start.boundShapeId:null,n="binding"===e.props.end.type?e.props.end.boundShapeId:null,r=this.editor.getSelectedShapeIds();if(t&&(r.includes(t)||this.editor.isAncestorSelected(t))||n&&(r.includes(n)||this.editor.isAncestorSelected(n)))return;const{start:o,end:i}=Yc(this.editor,e);return{id:e.id,type:e.type,props:{...e.props,start:{type:"point",x:o.x,y:o.y},end:{type:"point",x:i.x,y:i.y}}}};onResize=(e,t)=>{const{scaleX:n,scaleY:r}=t,o=Yc(this.editor,e),{start:i,end:s}=Me(e.props);let{bend:a}=e.props;"point"===i.type&&(i.x=o.start.x*n,i.y=o.start.y*r),"point"===s.type&&(s.x=o.end.x*n,s.y=o.end.y*r);const c=Math.abs(n),l=Math.abs(r);return n<0&&r>=0?(0!==a&&(a*=-1,a*=Math.max(c,l)),"binding"===i.type&&(i.normalizedAnchor.x=1-i.normalizedAnchor.x),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x)):n>=0&&r<0?(0!==a&&(a*=-1,a*=Math.max(c,l)),"binding"===i.type&&(i.normalizedAnchor.y=1-i.normalizedAnchor.y),"binding"===s.type&&(s.normalizedAnchor.y=1-s.normalizedAnchor.y)):n>=0&&r>=0?0!==a&&(a*=Math.max(c,l)):n<0&&r<0&&(0!==a&&(a*=Math.max(c,l)),"binding"===i.type&&(i.normalizedAnchor.x=1-i.normalizedAnchor.x,i.normalizedAnchor.y=1-i.normalizedAnchor.y),"binding"===s.type&&(s.normalizedAnchor.x=1-s.normalizedAnchor.x,s.normalizedAnchor.y=1-s.normalizedAnchor.y)),{props:{start:i,end:s,bend:a}}};onDoubleClickHandle=(e,t)=>{switch(t.id){case"start":return{id:e.id,type:e.type,props:{...e.props,arrowheadStart:"none"===e.props.arrowheadStart?"arrow":"none"}};case"end":return{id:e.id,type:e.type,props:{...e.props,arrowheadEnd:"none"===e.props.arrowheadEnd?"arrow":"none"}}}};component(t){const n=Gd(),r=this.editor.getOnlySelectedShape(),o=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.getInstanceState().isReadonly,i=this.editor.getArrowInfo(t),s=fo.ZeroFix(this.editor.getShapeGeometry(t).bounds),a=e.useMemo((()=>this.editor.environment.isSafari?dh+=1:0),[t]);if(!i?.isValid)return null;const c=Yu[t.props.size],l=i.start.arrowhead&&fu(i,"start",c),u=i.end.arrowhead&&fu(i,"end",c),d=i.isStraight?nl(i):sl(i);let h=null;if(r===t&&o){const e=2,{strokeDasharray:n,strokeDashoffset:r}=ch(i.isStraight?ho.Dist(i.start.handle,i.end.handle):Math.abs(i.handleArc.length),e,{end:"skip",start:"skip",lengthRatio:2.5});h="binding"===t.props.start.type||"binding"===t.props.end.type?(0,Fr.jsx)("path",{className:"tl-arrow-hint",d:i.isStraight?tl(i):il(i),strokeDasharray:n,strokeDashoffset:r,strokeWidth:e,markerStart:"binding"===t.props.start.type?t.props.start.isExact?"":fh(t.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:"binding"===t.props.end.type?t.props.end.isExact?"":fh(t.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:p,strokeDashoffset:f}=ch(i.isStraight?i.length:Math.abs(i.bodyArc.length),c,{style:t.props.dash}),g=t.props.text.trim()?this.editor.getShapeGeometry(t).children[1]:null,m=!("none"===i.start.arrowhead||"arrow"===i.start.arrowhead),_=!("none"===i.end.arrowhead||"arrow"===i.end.arrowhead),y=(t.id+"_clip_"+a).replace(":","_");return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(Ea,{id:t.id,style:{minWidth:50,minHeight:50},children:[(0,Fr.jsx)("defs",{children:(0,Fr.jsxs)("mask",{id:y,children:[(0,Fr.jsx)("rect",{x:No(-100+s.minX),y:No(-100+s.minY),width:No(s.width+200),height:No(s.height+200),fill:"white"}),g&&(0,Fr.jsx)("rect",{x:g.x,y:g.y,width:g.w,height:g.h,fill:"black",rx:4,ry:4}),l&&m&&(0,Fr.jsx)("path",{d:l,fill:"arrow"===i.start.arrowhead?"none":"black",stroke:"none"}),u&&_&&(0,Fr.jsx)("path",{d:u,fill:"arrow"===i.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,Fr.jsxs)("g",{fill:"none",stroke:n[t.props.color].solid,strokeWidth:c,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[h,(0,Fr.jsxs)("g",{mask:`url(#${y})`,children:[(0,Fr.jsx)("rect",{x:No(s.minX-100),y:No(s.minY-100),width:No(s.width+200),height:No(s.height+200),opacity:0}),(0,Fr.jsx)("path",{d,strokeDasharray:p,strokeDashoffset:f})]}),l&&m&&"none"!==t.props.fill&&(0,Fr.jsx)(qd,{theme:n,d:l,color:t.props.color,fill:t.props.fill}),u&&_&&"none"!==t.props.fill&&(0,Fr.jsx)(qd,{theme:n,d:u,color:t.props.color,fill:t.props.fill}),l&&(0,Fr.jsx)("path",{d:l}),u&&(0,Fr.jsx)("path",{d:u})]})]}),(0,Fr.jsx)(uh,{id:t.id,text:t.props.text,font:t.props.font,size:t.props.size,position:i.middle,width:g?.w??0,labelColor:n[t.props.labelColor].solid})]})}indicator(e){const{start:t,end:n}=Yc(this.editor,e),r=this.editor.getArrowInfo(e),o=this.editor.getShapeGeometry(e),i=o.bounds,s=e.props.text.trim()?o.children[1]:null,a=wu(e.id);if(!r)return null;if(ho.Equals(t,n))return null;const c=Yu[e.props.size],l=r.start.arrowhead&&fu(r,"start",c),u=r.end.arrowhead&&fu(r,"end",c),d=r.isStraight?nl(r):sl(r),h=l&&"arrow"!==r.start.arrowhead||u&&"arrow"!==r.end.arrowhead||!!s,p=(e.id+"_clip").replace(":","_");return a&&s?(0,Fr.jsx)("rect",{x:No(s.x),y:No(s.y),width:s.w,height:s.h,rx:3.5,ry:3.5}):(0,Fr.jsxs)("g",{children:[h&&(0,Fr.jsx)("defs",{children:(0,Fr.jsxs)("mask",{id:p,children:[(0,Fr.jsx)("rect",{x:i.minX-100,y:i.minY-100,width:i.w+200,height:i.h+200,fill:"white"}),s&&(0,Fr.jsx)("rect",{x:No(s.x),y:No(s.y),width:s.w,height:s.h,fill:"black",rx:3.5,ry:3.5}),l&&(0,Fr.jsx)("path",{d:l,fill:"arrow"===r.start.arrowhead?"none":"black",stroke:"none"}),u&&(0,Fr.jsx)("path",{d:u,fill:"arrow"===r.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,Fr.jsxs)("g",{...h?{mask:`url(#${p})`}:void 0,children:[h&&(0,Fr.jsx)("rect",{x:i.minX-100,y:i.minY-100,width:i.width+200,height:i.height+200,opacity:0}),(0,Fr.jsx)("path",{d})]}),l&&(0,Fr.jsx)("path",{d:l}),u&&(0,Fr.jsx)("path",{d:u}),s&&(0,Fr.jsx)("rect",{x:No(s.x),y:No(s.y),width:s.w,height:s.h,rx:3.5,ry:3.5})]})}onEditEnd=e=>{const{id:t,type:n,props:{text:r}}=e;r.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:t,type:n,props:{text:r.trimEnd()}}])};toSvg(e,t){const n=Ln({isDarkMode:this.editor.user.getIsDarkMode()});t.addExportDef(eh(e.props.fill,n));const r=n[e.props.color].solid,o=this.editor.getArrowInfo(e),i=Yu[e.props.size],s=document.createElementNS("http://www.w3.org/2000/svg","g");if(!o)return s;const a=o.start.arrowhead&&fu(o,"start",i),c=o.end.arrowhead&&fu(o,"end",i),l=this.editor.getShapeGeometry(e),u=l.bounds,d=e.props.text.trim()?l.children[1]:null,h=(e.id+"_clip").replace(":","_");if(a||c||d){const e=document.createElementNS("http://www.w3.org/2000/svg","defs"),t=document.createElementNS("http://www.w3.org/2000/svg","mask");t.id=h;const n=document.createElementNS("http://www.w3.org/2000/svg","rect");if(n.setAttribute("x",u.minX-100+""),n.setAttribute("y",u.minY-100+""),n.setAttribute("width",u.width+200+""),n.setAttribute("height",u.height+200+""),n.setAttribute("fill","white"),t.appendChild(n),a&&t.appendChild(hh(a,o.start.arrowhead)),c&&t.appendChild(hh(c,o.end.arrowhead)),d){const e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x",d.x+""),e.setAttribute("y",d.y+""),e.setAttribute("width",d.w+""),e.setAttribute("height",d.h+""),e.setAttribute("fill","black"),t.appendChild(e)}e.appendChild(t),s.appendChild(e)}const p=document.createElementNS("http://www.w3.org/2000/svg","g");p.setAttribute("mask",`url(#${h})`),s.appendChild(p);const f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("x","-100"),f.setAttribute("y","-100"),f.setAttribute("width",u.width+200+""),f.setAttribute("height",u.height+200+""),f.setAttribute("fill","transparent"),f.setAttribute("stroke","none"),p.appendChild(f);const g=function(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",t),r.setAttribute("stroke-width",n+""),r}(o.isStraight?nl(o):sl(o),r,i),{strokeDasharray:m,strokeDashoffset:_}=ch(o.isStraight?o.length:Math.abs(o.bodyArc.length),i,{style:e.props.dash});if(g.setAttribute("stroke-dasharray",m),g.setAttribute("stroke-dashoffset",_),p.appendChild(g),a&&s.appendChild(ph(a,e.props.color,i,"arrow"===e.props.arrowheadStart?"none":e.props.fill,n)),c&&s.appendChild(ph(c,e.props.color,i,"arrow"===e.props.arrowheadEnd?"none":e.props.fill,n)),d){t.addExportDef(Jd(e.props.font));const r={fontSize:Qu[e.props.size],lineHeight:qu.lineHeight,fontFamily:Wn[e.props.font],padding:0,textAlign:"middle",width:d.w-8,verticalTextAlign:"middle",height:d.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},o=Qd(this.editor,this.editor.textMeasure.measureTextSpans(e.props.text,r),r);o.setAttribute("fill",n[e.props.labelColor].solid),Array.from(o.children).forEach((e=>{const t=parseFloat(e.getAttribute("x")||"0"),n=parseFloat(e.getAttribute("y")||"0");e.setAttribute("x",t+4+d.x+"px"),e.setAttribute("y",n+d.y+"px")}));const i=o.cloneNode(!0);i.setAttribute("stroke-width","2"),i.setAttribute("fill",n.background),i.setAttribute("stroke",n.background),s.appendChild(i),s.appendChild(o)}return s}getCanvasSvgDefs(){return[th()]}},class extends Ua{static type="highlight";static props=yr;static migrations=wr;hideResizeHandles=e=>kp(e);hideRotateHandle=e=>kp(e);hideSelectionBoundsFg=e=>kp(e);getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getGeometry(e){const t=Sp(e);if(kp(e))return new ku({x:-t/2,y:-t/2,radius:t/2,isFilled:!0});const{strokePoints:n,sw:r}=wp(e,t,!0),o=Ah({strokeWidth:r,showAsComplete:!0});return Nu(n,o),new Ba({points:Du(n,o),isFilled:!0})}component(e){return(0,Fr.jsx)(bp,{strokeWidth:Sp(e),shape:e,opacity:.35})}backgroundComponent(e){return(0,Fr.jsx)(bp,{strokeWidth:Sp(e),shape:e,opacity:.82})}indicator(e){const t=xh(),n=Sp(e),r=Ph(e.props.segments);let o=n;t||e.props.isPen||1!==r.length||(o+=Ee(e.id)()*(n/6));const i=Fu(r,Ah({strokeWidth:n,showAsComplete:e.props.isComplete||"straight"===pe(e.props.segments)?.type}));let s;return s=i.length<2?function(e,t){const n=t/2;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${2*n},0 a ${n},${n} 0 1,0 -${2*n},0`}(r[0],o):bh(i,!1),(0,Fr.jsx)("path",{d:s})}toSvg(e){const t=Ln({isDarkMode:this.editor.user.getIsDarkMode()});return xp(Sp(e),e,.35,t)}toBackgroundSvg(e){const t=Ln({isDarkMode:this.editor.user.getIsDarkMode()});return xp(Sp(e),e,.82,t)}onResize=(e,t)=>{const{scaleX:n,scaleY:r}=t,o=[];for(const t of e.props.segments)o.push({...t,points:t.points.map((({x:e,y:t,z:o})=>({x:n*e,y:r*t,z:o})))});return{props:{segments:o}}}},class extends pu{static type="embed";static props=ar;static migrations=cr;hideSelectionBoundsFg=e=>!this.canResize(e);canEdit=()=>!0;canUnmount=e=>!!kd(e.props.url)?.definition?.canUnmount;canResize=e=>!!kd(e.props.url)?.definition?.doesResize;canEditInReadOnly=()=>!0;getDefaultProps(){return{w:300,h:300,url:""}}isAspectRatioLocked=e=>{const t=kd(e.props.url);return t?.definition.isAspectRatioLocked??!1};onResize=(e,t)=>{const n=this.isAspectRatioLocked(e),r=kd(e.props.url);let o=r?.definition.minWidth??200,i=r?.definition.minHeight??200;if(n){const t=e.props.w/e.props.h;t>1?o*=t:i/=t}return function(e,t,n={}){const{newPoint:r,handle:o,scaleX:i,scaleY:s}=t,{minWidth:a=1,maxWidth:c=1/0,minHeight:l=1,maxHeight:u=1/0}=n;let d=e.props.w*i,h=e.props.h*s;const p=new ho(0,0);if(d>0){if(d<a){switch(o){case"top_left":case"left":case"bottom_left":p.x=d-a;break;case"top":case"bottom":p.x=(d-a)/2;break;default:p.x=0}d=a}}else if(p.x=d,d=-d,d<a){switch(o){case"top_left":case"left":case"bottom_left":p.x=-d;break;default:p.x=-a}d=a}if(h>0){if(h<l){switch(o){case"top_left":case"top":case"top_right":p.y=h-l;break;case"right":case"left":p.y=(h-l)/2;break;default:p.y=0}h=l}}else if(p.y=h,h=-h,h<l){switch(o){case"top_left":case"top":case"top_right":p.y=-h;break;default:p.y=-l}h=l}const{x:f,y:g}=p.rot(e.rotation).add(r);return{x:f,y:g,props:{w:Math.min(c,d),h:Math.min(u,h)}}}(e,t,{minWidth:o,minHeight:i})};component(t){const{w:n,h:r,url:o}=t.props,i=wu(t.id),s=(0,e.useMemo)((()=>Sd(o)),[o]),a=le("is hovering",(()=>{const{editingShapeId:e,hoveredShapeId:t}=this.editor.getCurrentPageState();if(e&&t!==e){const t=this.editor.getShape(e);if(t&&this.editor.isShapeOfType(t,"embed"))return!0}return!1}),[]),c=this.editor.getShapePageTransform(t).rotation(),l=i||a;if("github_gist"===s?.definition.type){const e=s.url.split("/").pop();if(!e)throw Error("No gist id!");return(0,Fr.jsx)(hu,{className:"tl-embed-container",id:t.id,children:(0,Fr.jsx)(Dh,{id:e,width:No(n),height:No(r),isInteractive:l,pageRotation:c})})}const u=(d={...sr,...s?.definition.overridePermissions??{}},Object.entries(d).filter((([e,t])=>t)).map((([e])=>e)).join(" "));var d;return(0,Fr.jsx)(hu,{className:"tl-embed-container",id:t.id,children:s?.definition?(0,Fr.jsx)("iframe",{className:"tl-embed",sandbox:u,src:s.embedUrl,width:No(n),height:No(r),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:l?"auto":"none",zIndex:l?"":"-1",boxShadow:yh(c),borderRadius:s?.definition.overrideOutlineRadius??8,background:s?.definition.backgroundColor}}):null})}indicator(t){const n=(0,e.useMemo)((()=>kd(t.props.url)),[t.props.url]);return(0,Fr.jsx)("rect",{width:No(t.props.w),height:No(t.props.h),rx:n?.definition.overrideOutlineRadius??8,ry:n?.definition.overrideOutlineRadius??8})}},class extends pu{static type="image";static props=br;static migrations=xr;isAspectRatioLocked=()=>!0;canCrop=()=>!0;getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(t){const n=Ep(t),r=yu(t.id),o=Cp(),[i,s]=(0,e.useState)(""),a=t.props.assetId?this.editor.getAsset(t.props.assetId):void 0;if("bookmark"===a?.type)throw Error("Bookmark assets can't be rendered as images");const c=le("onlySelectedShape",(()=>t.id===this.editor.getOnlySelectedShape()?.id),[this.editor])&&r&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),l=o&&(a?.props.mimeType?.includes("video")||a?.props.mimeType?.includes("gif"));return(0,e.useEffect)((()=>{if(a?.props.src&&"mimeType"in a.props&&"image/gif"===a?.props.mimeType){let e=!1;return(async()=>{const t=await(async e=>{const t=await(async e=>new Promise(((t,n)=>{const r=new Image;r.onload=()=>t(r),r.onerror=()=>n(new Error("Failed to load image")),r.crossOrigin="anonymous",r.src=e})))(e),n=document.createElement("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");if(r)return r.drawImage(t,0,0),n.toDataURL()})(a.props.src);e||t&&s(t)})(),()=>{e=!0}}}),[o,a?.props]),(0,Fr.jsxs)(Fr.Fragment,{children:[a?.props.src&&c&&(0,Fr.jsx)("div",{style:n,children:(0,Fr.jsx)("div",{className:"tl-image",style:{opacity:.1,backgroundImage:`url(${!t.props.playing||l?i:a.props.src})`},draggable:!1})}),(0,Fr.jsxs)(hu,{id:t.id,style:{overflow:"hidden",width:t.props.w,height:t.props.h},children:[(0,Fr.jsxs)("div",{className:"tl-image-container",style:n,children:[a?.props.src?(0,Fr.jsx)("div",{className:"tl-image",style:{backgroundImage:`url(${!t.props.playing||l?i:a.props.src})`},draggable:!1}):null,a?.props.isAnimated&&!t.props.playing&&(0,Fr.jsx)("div",{className:"tl-image__tg",children:"GIF"})]}),"url"in t.props&&t.props.url&&(0,Fr.jsx)(mh,{url:t.props.url,zoomLevel:this.editor.getZoomLevel()})]})]})}indicator(e){return yu(e.id)?null:(0,Fr.jsx)("rect",{width:No(e.props.w),height:No(e.props.h)})}async toSvg(e){const t=document.createElementNS("http://www.w3.org/2000/svg","g"),n=e.props.assetId?this.editor.getAsset(e.props.assetId):null;let r=n?.props.src||"";r&&r.startsWith("http")&&(r=await async function(e){const t=await fetch(e),n=await t.blob();return new Promise(((e,t)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=t,r.readAsDataURL(n)}))}(r)||"");const o=document.createElementNS("http://www.w3.org/2000/svg","image");o.setAttributeNS("http://www.w3.org/1999/xlink","href",r);const i=Ep(e),s=e.props.crop;if(i.transform&&s){const{transform:e,width:n,height:r}=i,a=[new ho(s.topLeft.x*n,s.topLeft.y*r),new ho(s.bottomRight.x*n,s.topLeft.y*r),new ho(s.bottomRight.x*n,s.bottomRight.y*r),new ho(s.topLeft.x*n,s.bottomRight.y*r)],c=document.createElementNS("http://www.w3.org/2000/svg","g");c.style.clipPath=`polygon(${a.map((e=>`${e.x}px ${e.y}px`)).join(",")})`,o.setAttribute("width",n.toString()),o.setAttribute("height",r.toString()),o.style.transform=e,c.appendChild(o),t.appendChild(c)}else o.setAttribute("width",e.props.w.toString()),o.setAttribute("height",e.props.h.toString()),t.appendChild(o);return t}onDoubleClick=e=>{const t=e.props.assetId?this.editor.getAsset(e.props.assetId):void 0;t&&t.props.src&&"mimeType"in t.props&&"image/gif"===t.props.mimeType&&this.editor.updateShapes([{type:"image",id:e.id,props:{playing:!e.props.playing}}])};onDoubleClickEdge=e=>{const t=e.props;if(!t)return;if(this.editor.getCroppingShapeId()!==e.id)return;const n=Me(t.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},r=1/(n.bottomRight.x-n.topLeft.x)*e.props.w,o=1/(n.bottomRight.y-n.topLeft.y)*e.props.h,i=new ho(n.topLeft.x*r,n.topLeft.y*o).rot(e.rotation),s={id:e.id,type:e.type,x:e.x-i.x,y:e.y-i.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:r,h:o}};this.editor.updateShapes([s])}},class extends pu{static type="video";static props=Tr;static migrations=jr;canEdit=()=>!0;isAspectRatioLocked=()=>!0;getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(e){return(0,Fr.jsx)($p,{shape:e,videoUtil:this})}indicator(e){return(0,Fr.jsx)("rect",{width:No(e.props.w),height:No(e.props.h)})}toSvg(e){const t=document.createElementNS("http://www.w3.org/2000/svg","g"),n=document.createElementNS("http://www.w3.org/2000/svg","image");return n.setAttributeNS("http://www.w3.org/1999/xlink","href",function(e){const t=e.split(":")[1],n=document.querySelector(`.tl-video-shape-${t}`);if(n){const e=document.createElement("canvas");return e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0),e.toDataURL("image/png")}throw new Error("Video with id "+t+" not found")}(e.id)),n.setAttribute("width",e.props.w.toString()),n.setAttribute("height",e.props.h.toString()),t.appendChild(n),t}}];class Vp extends ll{static id="erasing";info={};scribbleId="id";markId="";excludedShapeIds=new Set;onEnter=e=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=e;const{originPagePoint:t}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter((e=>{if(this.editor.isShapeOrAncestorLocked(e))return!0;if(this.editor.isShapeOfType(e,"group")||this.editor.isShapeOfType(e,"frame")){const n=this.editor.getPointInShapeSpace(e,t);return this.editor.getShapeGeometry(e).bounds.containsPoint(n)}return!1})).map((e=>e.id)));const n=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=n.id,this.update()};pushPointToScribble=()=>{const{x:e,y:t}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,e,t)};onExit=()=>{this.editor.scribbles.stop(this.scribbleId)};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};update(){const e=this.editor.getErasingShapeIds(),t=this.editor.getZoomLevel(),n=this.editor.getCurrentPageShapes(),{inputs:{currentPagePoint:r,previousPagePoint:o}}=this.editor,{excludedShapeIds:i}=this;this.pushPointToScribble();const s=new Set(e);for(const e of n){if(this.editor.isShapeOfType(e,"group"))continue;const n=this.editor.getShapeMask(e.id);if(n&&!Lo(r,n))continue;const i=this.editor.getShapeGeometry(e),a=this.editor.getPointInShapeSpace(e,o),c=this.editor.getPointInShapeSpace(e,r);i.hitTestLineSegment(a,c,8/t)&&s.add(this.editor.getOutermostSelectableShape(e).id)}this.editor.setErasingShapes([...s].filter((e=>!i.has(e))))}complete(){this.editor.deleteShapes(this.editor.getCurrentPageState().erasingShapeIds),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}class Wp extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("pointing",e)};onCancel=()=>{this.editor.setCurrentTool("select")}}class Kp extends ll{static id="pointing";onEnter=()=>{const e=this.editor.getZoomLevel(),t=this.editor.getCurrentPageShapesSorted(),{inputs:{currentPagePoint:n}}=this.editor,r=new Set,o=r.size;for(let i=t.length-1;i>=0;i--){const s=t[i];if(!this.editor.isShapeOrAncestorLocked(s)&&!this.editor.isShapeOfType(s,"group")&&this.editor.isPointInShape(s,n,{hitInside:!1,margin:8/e})){const e=this.editor.getOutermostSelectableShape(s);if(this.editor.isShapeOfType(e,"frame")&&r.size>o)break;r.add(e.id)}}this.editor.setErasingShapes([...r])};onPointerMove=e=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",e)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){const e=this.editor.getErasingShapeIds();e.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(e)),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle")}}class Hp extends ll{static id="dragging";onEnter=()=>{this.update()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};update(){const{currentScreenPoint:e,previousScreenPoint:t}=this.editor.inputs,n=ho.Sub(e,t);(Math.abs(n.x)>0||Math.abs(n.y)>0)&&this.editor.pan(n)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:ri}),this.parent.transition("idle")}}class Gp extends ll{static id="idle";onEnter=()=>{this.editor.setCursor({type:"grab",rotation:0})};onPointerDown=e=>{this.parent.transition("pointing",e)};onCancel=()=>{this.editor.setCurrentTool("select")}}class qp extends ll{static id="pointing";onEnter=()=>{this.editor.stopCameraAnimation(),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})};onPointerMove=e=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",e)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.complete()};complete(){this.parent.transition("idle")}}class Yp extends ll{static id="idle";onPointerDown=e=>{this.parent.transition("lasering",e)}}class Xp extends ll{static id="lasering";scribbleId="id";onEnter=()=>{const e=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:1200,shrink:.05,taper:!0});this.scribbleId=e.id,this.pushPointToScribble()};onExit=()=>{this.editor.scribbles.stop(this.scribbleId)};onPointerMove=()=>{this.pushPointToScribble()};onPointerUp=()=>{this.complete()};pushPointToScribble=()=>{const{x:e,y:t}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,e,t)};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}class Zp extends ll{static id="brushing";info={};brush=new fo;initialSelectedShapeIds=[];excludedShapeIds=new Set;initialStartShape=null;onEnter=e=>{const{altKey:t,currentPagePoint:n}=this.editor.inputs;t?this.parent.transition("scribble_brushing",e):(this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter((e=>this.editor.isShapeOfType(e,"group")||this.editor.isShapeOrAncestorLocked(e))).map((e=>e.id))),this.info=e,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(n)[0],this.onPointerMove())};onExit=()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})};onPointerMove=()=>{this.hitTestShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=e=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds,{squashing:!0}),this.parent.transition("idle",e)};onKeyDown=e=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",e):this.hitTestShapes()};onKeyUp=()=>{this.hitTestShapes()};complete(){this.parent.transition("idle")}hitTestShapes(){const e=this.editor.getZoomLevel(),t=this.editor.getCurrentPageShapes(),n=this.editor.getCurrentPageId(),{inputs:{originPagePoint:r,currentPagePoint:o,shiftKey:i,ctrlKey:s}}=this.editor;this.brush.setTo(fo.FromPoints([r,o]));const a=new Set(i?this.initialSelectedShapeIds:[]);let c,l,u,d,h,p;const{corners:f}=this.brush,{excludedShapeIds:g}=this;e:for(let r=0,i=t.length;r<i;r++)if(u=t[r],!g.has(u.id)&&!a.has(u.id)&&(d=this.editor.getShapePageBounds(u),d))if(this.brush.contains(d))this.handleHit(u,o,n,a,f);else if(!s&&!this.editor.isShapeOfType(u,"frame")&&this.brush.collides(d)){const t=this.editor.getShapeGeometry(u);if(h=this.editor.getShapePageTransform(u),!h)continue e;p=h.clone().invert().applyToPoints(f);t:for(let r=0;r<p.length;r++)if(c=p[r],l=p[(r+1)%p.length],t.hitTestLineSegment(c,l,8/e)){this.handleHit(u,o,n,a,f);break t}}this.editor.updateInstanceState({brush:{...this.brush.toJson()}}),this.editor.setSelectedShapes(Array.from(a),{squashing:!0})}onInterrupt=()=>{this.editor.updateInstanceState({brush:null})};handleHit(e,t,n,r,o){if(e.parentId===n)return void r.add(e.id);const i=this.editor.getOutermostSelectableShape(e),s=this.editor.getShapeMask(i.id);(!s||function(e,t){let n,r,o,i;for(let s=0,a=e.length;s<a;s++){n=e[s],r=e[(s+1)%a];for(let e=0,s=t.length;e<s;e++)if(o=t[e],i=t[(e+1)%s],Fa(n,r,o,i))return!0}return!1}(s,o)||Lo(t,s))&&r.add(i.id)}}function Qp(e){const t=e.getZoomLevel(),{inputs:{currentPagePoint:n}}=e;return e.getShapeAtPoint(n,{hitInside:!1,hitLabels:!1,margin:8/t,renderingOnly:!0})??e.getSelectedShapeAtPoint(n)}function Jp(e,t,n){if(!t)throw Error("Needs to translate a cropped shape!");const{crop:r}=t.props;if(!r)return;const o=e.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;"x"===o?n.x=0:"y"===o&&(n.y=0),n.rot(-t.rotation);const i=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,s=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,a=r.bottomRight.y-r.topLeft.y,c=r.bottomRight.x-r.topLeft.x,l=Me(r);return l.topLeft.x=Math.min(1-c,Math.max(0,l.topLeft.x-n.x/i)),l.topLeft.y=Math.min(1-a,Math.max(0,l.topLeft.y-n.y/s)),l.bottomRight.x=l.topLeft.x+c,l.bottomRight.y=l.topLeft.y+a,{id:t.id,type:t.type,props:{crop:l}}}class ef extends ll{static id="idle";onEnter=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0});const e=this.editor.getOnlySelectedShape();this.editor.on("change-history",this.cleanupCroppingState),e&&(this.editor.mark("crop"),this.editor.setCroppingShape(e.id))};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.off("change-history",this.cleanupCroppingState)};onCancel=()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})};onPointerDown=e=>{if(!this.editor.getIsMenuOpen()){if(e.ctrlKey)return this.cancel(),void this.editor.root.handleEvent(e);switch(e.target){case"canvas":{const t=Qp(this.editor);if(t&&!this.editor.isShapeOfType(t,"group"))return void this.onPointerDown({...e,shape:t,target:"shape"});this.cancel(),this.editor.root.handleEvent(e);break}case"shape":if(e.shape.id===this.editor.getCroppingShapeId())return void this.editor.setCurrentTool("select.crop.pointing_crop",e);this.editor.getShapeUtil(e.shape)?.canCrop(e.shape)?(this.editor.setCroppingShape(e.shape.id),this.editor.setSelectedShapes([e.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",e)):(this.cancel(),this.editor.root.handleEvent(e));break;case"selection":switch(e.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.editor.setCurrentTool("select.pointing_rotate_handle",{...e,onInteractionEnd:"select.crop"});break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":this.editor.setCurrentTool("select.pointing_crop_handle",{...e,onInteractionEnd:"select.crop"});break;default:this.cancel()}}}};onDoubleClick=e=>{if(this.editor.inputs.shiftKey||"up"!==e.phase)return;const t=this.editor.getCroppingShapeId();if(!t)return;const n=this.editor.getShape(t);if(!n)return;const r=this.editor.getShapeUtil(n);r&&"selection"===e.target&&r.onDoubleClickEdge?.(n)};onKeyDown=()=>{this.nudgeCroppingImage(!1)};onKeyRepeat=()=>{this.nudgeCroppingImage(!0)};onKeyUp=e=>{"Enter"===e.code&&(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{}))};cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}cleanupCroppingState=()=>{this.editor.getCroppingShapeId()||this.editor.setCurrentTool("select.idle",{})};nudgeCroppingImage(e=!1){const{editor:{inputs:{keys:t}}}=this,n=t.has("ShiftLeft"),r=new ho(0,0);if(t.has("ArrowLeft")&&(r.x+=1),t.has("ArrowRight")&&(r.x-=1),t.has("ArrowUp")&&(r.y+=1),t.has("ArrowDown")&&(r.y-=1),r.equals(new ho(0,0)))return;n&&r.mul(10);const o=this.editor.getShape(this.editor.getCroppingShapeId());if(!o)return;const i=Jp(this.editor,o,r);i&&(e||this.editor.mark("translate crop"),this.editor.updateShapes([i]))}}class tf extends ll{static id="pointing_crop";onCancel=()=>{this.editor.setCurrentTool("select.crop.idle",{})};onPointerMove=e=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",e)};onPointerUp=e=>{this.editor.setCurrentTool("select.crop.idle",e)}}class nf extends ll{static id="translating_crop";info={};markId="translating crop";snapshot={};onEnter=e=>{this.info=e,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onKeyDown=e=>{switch(e.key){case"Alt":case"Shift":return void this.updateShapes()}};onKeyUp=e=>{switch(e.key){case"Enter":return void this.complete();case"Alt":case"Shift":this.updateShapes()}};complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const e=this.snapshot.shape;if(!e)return;const{originPagePoint:t,currentPagePoint:n}=this.editor.inputs,r=n.clone().sub(t),o=Jp(this.editor,e,r);o&&this.editor.updateShapes([o],{squashing:!0})}}class rf extends ll{static id="crop";static initial="idle";static children=()=>[ef,nf,tf]}const of={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class sf extends ll{static id="pointing_resize_handle";info={};updateCursor(){const e=this.editor.getSelectedShapes(),t=of[this.info.handle];this.editor.updateInstanceState({cursor:{type:t,rotation:1===e.length?e[0].rotation:0}})}onEnter=e=>{this.info=e,this.updateCursor()};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("resizing",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}class af extends ll{static id="cropping";info={};markId="";snapshot={};onEnter=e=>{this.info=e,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};updateCursor(){const e=this.editor.getSelectedShapes()[0];if(!e)return;const t=of[this.info.handle];this.editor.updateInstanceState({cursor:{type:t,rotation:e.rotation}})}getDefaultCrop=()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}});updateShapes(){const{shape:e,cursorHandleOffset:t}=this.snapshot;if(!e)return;if(!this.editor.getShapeUtil("image"))return;const n=e.props,r=this.editor.inputs.currentPagePoint.clone().sub(t),o=this.editor.inputs.originPagePoint.clone().sub(t),i=r.clone().sub(o).rot(-e.rotation),s=n.crop??this.getDefaultCrop(),a=Me(s),c=new ho(e.x,e.y),l=new ho(0,0),u=1/(s.bottomRight.x-s.topLeft.x)*n.w,d=1/(s.bottomRight.y-s.topLeft.y)*n.h;let h=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":if(d<8)break;h=!0,a.topLeft.y=a.topLeft.y+i.y/d,d*(a.bottomRight.y-a.topLeft.y)<8?(a.topLeft.y=a.bottomRight.y-8/d,l.y=(a.topLeft.y-s.topLeft.y)*d):a.topLeft.y<=0?(a.topLeft.y=0,l.y=(a.topLeft.y-s.topLeft.y)*d):l.y=i.y;break;case"bottom":case"bottom_left":case"bottom_right":if(d<8)break;h=!0,a.bottomRight.y=Math.min(1,a.bottomRight.y+i.y/d),d*(a.bottomRight.y-a.topLeft.y)<8&&(a.bottomRight.y=a.topLeft.y+8/d)}switch(this.info.handle){case"left":case"top_left":case"bottom_left":if(u<8)break;h=!0,a.topLeft.x=a.topLeft.x+i.x/u,u*(a.bottomRight.x-a.topLeft.x)<8?(a.topLeft.x=a.bottomRight.x-8/u,l.x=(a.topLeft.x-s.topLeft.x)*u):a.topLeft.x<=0?(a.topLeft.x=0,l.x=(a.topLeft.x-s.topLeft.x)*u):l.x=i.x;break;case"right":case"top_right":case"bottom_right":if(u<8)break;h=!0,a.bottomRight.x=Math.min(1,a.bottomRight.x+i.x/u),u*(a.bottomRight.x-a.topLeft.x)<8&&(a.bottomRight.x=a.topLeft.x+8/u)}if(!h)return;c.add(l.rot(e.rotation));const p={id:e.id,type:e.type,x:c.x,y:c.y,props:{crop:a,w:(a.bottomRight.x-a.topLeft.x)*u,h:(a.bottomRight.y-a.topLeft.y)*d}};this.editor.updateShapes([p],{squashing:!0}),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}createSnapshot(){const e=this.editor.getSelectionRotation(),{inputs:{originPagePoint:t}}=this.editor,n=this.editor.getOnlySelectedShape(),r=this.editor.getSelectionRotatedPageBounds(),o=ho.RotWith(r.getHandlePoint(this.info.handle),r.point,e);return{shape:n,cursorHandleOffset:ho.Sub(t,o)}}}class cf extends ll{static id="dragging_handle";shapeId="";initialHandle={};initialAdjacentHandle=null;initialPagePoint={};markId="";initialPageTransform;initialPageRotation;info={};isPrecise=!1;isPreciseId=null;pointingId=null;onEnter=e=>{const{shape:t,isCreating:n,handle:r}=e;this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.shapeId=t.id,this.markId=n?`creating:${t.id}`:"dragging handle",n||this.editor.mark(this.markId),this.initialHandle=Me(r),this.initialPageTransform=this.editor.getShapePageTransform(t),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.updateInstanceState({cursor:{type:n?"cross":"grabbing",rotation:0}},{ephemeral:!0});const o=this.editor.getShapeHandles(t).sort(fc),i=o.findIndex((t=>t.id===e.handle.id));this.initialAdjacentHandle=null;for(let t=i+1;t<o.length;t++){const n=o[t];if("vertex"===n.type&&"middle"!==n.id&&n.id!==e.handle.id){this.initialAdjacentHandle=n;break}}if(!this.initialAdjacentHandle)for(let t=o.length-1;t>=0;t--){const n=o[t];if("vertex"===n.type&&"middle"!==n.id&&n.id!==e.handle.id){this.initialAdjacentHandle=n;break}}const s=t.props[e.handle.id];this.isPrecise=!1,"binding"===s?.type?(this.editor.setHintingShapes([s.boundShapeId]),this.isPrecise=!ho.Equals(s.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=s.boundShapeId:this.resetExactTimeout()):this.editor.setHintingShapes([]),this.update(),this.editor.select(this.shapeId)};exactTimeout=-1;resetExactTimeout(){-1!==this.exactTimeout&&this.clearExactTimeout(),this.exactTimeout=setTimeout((()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1}),750)}clearExactTimeout(){-1!==this.exactTimeout&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onExit=()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};complete(){this.editor.snaps.clear();const{onInteractionEnd:e}=this.info;this.editor.getInstanceState().isToolLocked&&e?this.editor.setCurrentTool(e,{shapeId:this.shapeId}):this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();const{onInteractionEnd:e}=this.info;e?this.editor.setCurrentTool(e,{shapeId:this.shapeId}):this.parent.transition("idle")}update(){const{editor:e,shapeId:t,initialPagePoint:n}=this,{initialHandle:r,initialPageRotation:o,initialAdjacentHandle:i}=this,s=this.editor.getHintingShapeIds(),a=this.editor.user.getIsSnapMode(),{snaps:c,inputs:{currentPagePoint:l,shiftKey:u,ctrlKey:d,altKey:h,pointerVelocity:p}}=e,f=this.info.shape,g=e.getShape(t);if(!g)return;const m=e.getShapeUtil(g);let _=l.clone().sub(n).rot(-o).add(r);if(u&&i&&"middle"!==r.id){const e=ho.Angle(i,_),t=To(e,24)-e;_=ho.RotWith(_,i,t)}if(e.snaps.clear(),r.canSnap&&(a?!d:d)){const t=e.getShapePageTransform(g.id);if(!t)throw Error("Expected a page transform");const n=e.getShapeHandles(g).filter((({type:e})=>"vertex"===e)).sort(fc).findIndex((({index:e})=>r.index===e)),o=m.getOutlineSegments(g).map((e=>ks.applyToPoints(t,e))).filter(((e,t)=>t!==n-1&&t!==n)),i=c.getSnappingHandleDelta({additionalSegments:o,handlePoint:ks.applyToPoint(t,_)});i&&(i.rot(-e.getShapeParentTransform(g).rotation()),_.add(i))}const y=m.onHandleChange?.(g,{handle:{...r,x:_.x,y:_.y},isPrecise:this.isPrecise||h,initial:f}),w={...g,...y};if(r.canBind){const t=w.props[r.id];"binding"===t?.type?s[0]!==t.boundShapeId&&(e.setHintingShapes([t.boundShapeId]),this.pointingId=t.boundShapeId,this.isPrecise=p.len()<.5||h,this.isPreciseId=this.isPrecise?t.boundShapeId:null,this.resetExactTimeout()):s.length>0&&(e.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}y&&e.updateShapes([w],{squashing:!0})}}class lf extends ll{static id="editing_shape";onEnter=()=>{const e=this.editor.getEditingShape();if(!e)throw Error("Entered editing state without an editing shape");Vd(this.editor),this.editor.select(e)};onExit=()=>{const{editingShapeId:e}=this.editor.getCurrentPageState();if(!e)return;this.editor.setEditingShape(null);const t=this.editor.getShape(e),n=this.editor.getShapeUtil(t);n.onEditEnd?.(t),setTimeout((()=>{this.editor.updateViewportScreenBounds()}),500)};onPointerMove=e=>{switch(e.target){case"shape":case"canvas":return void Vd(this.editor)}};onPointerDown=e=>{switch(e.target){case"canvas":{const t=Qp(this.editor);if(t)return void this.onPointerDown({...e,shape:t,target:"shape"});break}case"shape":{const{shape:t}=e,n=this.editor.getEditingShape();if(!n)throw Error("Expected an editing shape!");if(t.type===n.type){if(!this.editor.isShapeOfType(t,"geo")&&!this.editor.isShapeOfType(t,"arrow"))return t.id!==n.id?void this.parent.transition("pointing_shape",e):void(this.editor.isShapeOfType(t,"frame")&&this.editor.setEditingShape(null));{const r=this.editor.getShapeUtil(t).getGeometry(t).children[1];if(r){const o=this.editor.getPointInShapeSpace(t,this.editor.inputs.currentPagePoint);if(r.bounds.containsPoint(o))return t.id===n.id?void 0:void this.parent.transition("pointing_shape",e)}}}break}}this.parent.transition("idle",e),this.editor.root.handleEvent(e)};onComplete=e=>{this.parent.transition("idle",e)};onCancel=e=>{this.parent.transition("idle",e)}}function uf(e){const t=e.getOnlySelectedShape();return!(!t||e.isShapeOrAncestorLocked(t)||!e.getShapeUtil(t).canCrop(t))}function df(e){const t=e.getSelectedShapeIds(),{shiftKey:n,altKey:r,currentPagePoint:o}=e.inputs,i=e.getShapeAtPoint(o,{hitInside:!1,margin:8/e.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:e=>!e.isLocked});if(i){const o=e.getOutermostSelectableShape(i);if(n&&!r)e.cancelDoubleClick(),t.includes(o.id)?(e.mark("deselecting shape"),e.deselect(o)):(e.mark("shift selecting shape"),e.setSelectedShapes([...t,o.id]));else{let n;n=o===i||o.id===e.getFocusedGroupId()||t.includes(o.id)?i:o,n&&!t.includes(n.id)&&(e.mark("selecting shape"),e.select(n.id))}}else{if(n)return;{t.length>0&&(e.mark("selecting none"),e.selectNone());const n=e.getFocusedGroupId();if(Tn(n)){const t=e.getShape(n);e.isPointInShape(t,o,{margin:0,hitInside:!0})||e.setFocusedGroup(null)}}}}class hf extends ll{static id="idle";onEnter=()=>{this.parent.setCurrentToolIdMask(void 0),Vd(this.editor),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{Vd(this.editor)};onPointerDown=e=>{if(this.editor.getIsMenuOpen())return;const t=e.ctrlKey&&uf(this.editor);if(e.ctrlKey&&!t)return"shape"===e.target&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(e.shape)?void this.parent.transition("pointing_shape",e):void this.parent.transition("brushing",e);switch(e.target){case"canvas":{const t=Qp(this.editor);if(t)return void this.onPointerDown({...e,shape:t,target:"shape"});const n=this.editor.getSelectedShapeIds(),r=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:o}}=this.editor;if((n.length>1||r&&!this.editor.getShapeUtil(r).hideSelectionBoundsBg(r))&&mf(this.editor,o))return void this.onPointerDown({...e,target:"selection"});this.parent.transition("pointing_canvas",e);break}case"shape":if(this.editor.isShapeOrAncestorLocked(e.shape)){this.parent.transition("pointing_canvas",e);break}this.parent.transition("pointing_shape",e);break;case"handle":if(this.editor.getInstanceState().isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",e):this.parent.transition("pointing_handle",e);break;case"selection":switch(e.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.parent.transition("pointing_rotate_handle",e);break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":t?this.parent.transition("pointing_crop_handle",e):this.parent.transition("pointing_resize_handle",e);break;default:{const t=this.editor.getHoveredShape();if(t&&!this.editor.getSelectedShapeIds().includes(t.id))return void this.onPointerDown({...e,shape:t,target:"shape"});this.parent.transition("pointing_selection",e)}}}};onDoubleClick=e=>{if(!this.editor.inputs.shiftKey&&"up"===e.phase)switch(e.target){case"canvas":{const t=this.editor.getHoveredShape(),n=t&&!this.editor.isShapeOfType(t,"group")?t:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:8/this.editor.getZoomLevel(),hitInside:!1}),r=this.editor.getFocusedGroupId();if(n){if(this.editor.isShapeOfType(n,"group"))return void df(this.editor);{const e=this.editor.getShape(n.parentId);if(e&&this.editor.isShapeOfType(e,"group")&&(!r||e.id!==r))return void df(this.editor)}return void this.onDoubleClick({...e,shape:n,target:"shape"})}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(e);break}case"selection":{if(this.editor.getInstanceState().isReadonly)break;const t=this.editor.getOnlySelectedShape();if(t){const n=this.editor.getShapeUtil(t);if(!this.canInteractWithShapeInReadOnly(t))return;if("right"===e.handle||"left"===e.handle||"top"===e.handle||"bottom"===e.handle){const e=n.onDoubleClickEdge?.(t);if(e)return this.editor.mark("double click edge"),void this.editor.updateShapes([e])}if(n.canCrop(t)&&!this.editor.isShapeOrAncestorLocked(t))return void this.parent.transition("crop",e);this.shouldStartEditingShape(t)&&this.startEditingShape(t,e)}break}case"shape":{const{shape:t}=e,n=this.editor.getShapeUtil(t);if("video"!==t.type&&"embed"!==t.type&&this.editor.getInstanceState().isReadonly)break;if(n.onDoubleClick){const r=n.onDoubleClick?.(t);if(r)return void this.editor.updateShapes([r]);if(n.canCrop(t)&&!this.editor.isShapeOrAncestorLocked(t))return this.editor.mark("select and crop"),this.editor.select(e.shape?.id),void this.parent.transition("crop",e)}this.shouldStartEditingShape(t)?this.startEditingShape(t,e):this.handleDoubleClickOnCanvas(e);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;const{shape:t,handle:n}=e,r=this.editor.getShapeUtil(t),o=r.onDoubleClickHandle?.(t,n);o?this.editor.updateShapes([o]):this.shouldStartEditingShape(t)&&this.startEditingShape(t,e)}}};onRightClick=e=>{switch(e.target){case"canvas":{const t=this.editor.getHoveredShape(),n=t&&!this.editor.isShapeOfType(t,"group")?t:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:8/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitFrameInside:!1,renderingOnly:!0});if(n)return void this.onRightClick({...e,shape:n,target:"shape"});const r=this.editor.getSelectedShapeIds(),o=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:i}}=this.editor;if((r.length>1||o&&!this.editor.getShapeUtil(o).hideSelectionBoundsBg(o))&&mf(this.editor,i))return void this.onRightClick({...e,target:"selection"});this.editor.selectNone();break}case"shape":{const{selectedShapeIds:t}=this.editor.getCurrentPageState(),{shape:n}=e,r=this.editor.getOutermostSelectableShape(n,(e=>!t.includes(e.id)));t.includes(r.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([r.id]));break}}};onCancel=()=>{this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())};onKeyDown=e=>{switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!1)}};onKeyRepeat=e=>{switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!0)}};onKeyUp=e=>{switch(e.code){case"Enter":{const t=this.editor.getSelectedShapes();if(t.every((e=>this.editor.isShapeOfType(e,"group"))))return void this.editor.setSelectedShapes(t.flatMap((e=>this.editor.getSortedChildIdsForParent(e.id))));const n=this.editor.getOnlySelectedShape();if(n&&this.shouldStartEditingShape(n))return void this.startEditingShape(n,{...e,target:"shape",shape:n});uf(this.editor)&&this.parent.transition("crop",e);break}}};shouldStartEditingShape(e=this.editor.getOnlySelectedShape()){return!!e&&(!this.editor.isShapeOrAncestorLocked(e)||"embed"===e.type)&&!!this.canInteractWithShapeInReadOnly(e)&&this.editor.getShapeUtil(e).canEdit(e)}startEditingShape(e,t){this.editor.isShapeOrAncestorLocked(e)&&"embed"!==e.type||(this.editor.mark("editing shape"),this.editor.setEditingShape(e.id),this.parent.transition("editing_shape",t))}isDarwin=window.navigator.userAgent.toLowerCase().indexOf("mac")>-1;handleDoubleClickOnCanvas(e){if(this.editor.getInstanceState().isReadonly)return;this.editor.mark("creating text shape");const t=jn(),{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:t,type:"text",x:n,y:r,props:{text:"",autoSize:!0}}]);const o=this.editor.getShape(t);if(!o)return;const i=this.editor.getShapeUtil(o);this.editor.getInstanceState().isReadonly&&!i.canEditInReadOnly(o)||(this.editor.setEditingShape(t),this.editor.select(t),this.parent.transition("editing_shape",e))}nudgeSelectedShapes(e=!1){const{editor:{inputs:{keys:t}}}=this,n=t.has("ShiftLeft"),r=new ho(0,0);if(t.has("ArrowLeft")&&(r.x-=1),t.has("ArrowRight")&&(r.x+=1),t.has("ArrowUp")&&(r.y-=1),t.has("ArrowDown")&&(r.y+=1),r.equals(new ho(0,0)))return;e||this.editor.mark("nudge shapes");const{gridSize:o}=this.editor.getDocumentSettings(),i=this.editor.getInstanceState().isGridMode?n?o*gf:o:n?pf:ff;this.editor.nudgeShapes(this.editor.getSelectedShapeIds(),r.mul(i))}canInteractWithShapeInReadOnly(e){return!this.editor.getInstanceState().isReadonly||!!this.editor.getShapeUtil(e).canEditInReadOnly(e)}}const pf=10,ff=1,gf=5;function mf(e,t){const n=e.getSelectionRotatedPageBounds();if(!n)return!1;const r=e.getSelectionRotation();return r?Lo(t,n.corners.map((e=>ho.RotWith(e,n.point,r)))):n.containsPoint(t)}class _f extends ll{static id="pointing_canvas";onEnter=()=>{const{inputs:e}=this.editor;e.shiftKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())};onPointerMove=e=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",e)};onPointerUp=()=>{df(this.editor),this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle")};complete(){this.parent.transition("idle")}}class yf extends ll{static id="pointing_crop_handle";info={};updateCursor(e){const t=of[this.info.handle];this.editor.updateInstanceState({cursor:{type:t,rotation:e.rotation}})}onEnter=e=>{this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd);const t=this.editor.getSelectedShapes()[0];t&&(this.updateCursor(t),this.editor.setCroppingShape(t.id))};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})};onPointerUp=()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}}class wf extends ll{static id="pointing_handle";info={};onEnter=e=>{this.info=e;const t=e.shape.props[e.handle.id];"binding"===t?.type&&this.editor.setHintingShapes([t.boundShapeId]),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})};onExit=()=>{this.editor.setHintingShapes([]),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerUp=()=>{this.parent.transition("idle",this.info)};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle")}}class vf extends ll{static id="pointing_rotate_handle";info={};updateCursor(){const e=this.editor.getSelectionRotation();this.editor.updateInstanceState({cursor:{type:of[this.info.handle],rotation:e}})}onEnter=e=>{this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.info=e,this.updateCursor()};onExit=()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{const{isDragging:e}=this.editor.inputs;e&&this.parent.transition("rotating",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}class bf extends ll{static id="pointing_selection";info={};onEnter=e=>{this.info=e};onPointerUp=e=>{df(this.editor),this.parent.transition("idle",e)};onPointerMove=e=>{if(this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly)return;this.parent.transition("translating",e)}};onDoubleClick=e=>{const t=this.editor.getHoveredShape(),n=t&&!this.editor.isShapeOfType(t,"group")?t:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(n)return this.parent.transition("idle"),void this.parent.onDoubleClick?.({...e,target:"shape",shape:this.editor.getShape(n)})};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle")}}class xf extends ll{static id="pointing_shape";hitShape={};hitShapeForPointerUp={};didSelectOnEnter=!1;onEnter=e=>{const t=this.editor.getSelectedShapeIds(),n=this.editor.getSelectionRotatedPageBounds(),r=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:o,shiftKey:i,altKey:s}}=this.editor;this.hitShape=e.shape;const a=this.editor.getOutermostSelectableShape(e.shape);if(this.editor.getShapeUtil(e.shape).onClick||a.id===r||t.includes(a.id)||this.editor.isAncestorSelected(a.id)||t.length>1&&n?.containsPoint(o))return this.didSelectOnEnter=!1,void(this.hitShapeForPointerUp=a);this.didSelectOnEnter=!0,i&&!s?(this.editor.cancelDoubleClick(),t.includes(a.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...t,a.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([a.id]))};onPointerUp=e=>{const t=this.editor.getSelectedShapeIds(),n=this.editor.getFocusedGroupId(),r=this.editor.getZoomLevel(),{inputs:{currentPagePoint:o,shiftKey:i}}=this.editor,s=this.editor.getShapeAtPoint(o,{margin:8/r,hitInside:!0,renderingOnly:!0})??this.hitShape,a=s?this.editor.getOutermostSelectableShape(s):this.hitShapeForPointerUp;if(a){const r=this.editor.getShapeUtil(a);if(r.onClick){const t=r.onClick?.(a);if(t)return this.editor.mark("shape on click"),this.editor.updateShapes([t]),void this.parent.transition("idle",e)}if(a.id===n)return t.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),void this.parent.transition("idle",e)}if(!this.didSelectOnEnter){const e=this.editor.getOutermostSelectableShape(s,(e=>!t.includes(e.id)));if(t.includes(e.id))if(i)this.editor.mark("deselecting on pointer up"),this.editor.deselect(a);else if(t.includes(a.id)){if(1===t.length&&(this.editor.isShapeOfType(a,"geo")||this.editor.isShapeOfType(a,"arrow"))){const e=this.editor.getShapeGeometry(a).children[1];if(e){const t=this.editor.getPointInShapeSpace(a,o);if(e.bounds.containsPoint(t,0)&&e.hitTestPoint(t))return void this.editor.batch((()=>{this.editor.mark("editing on pointer up"),this.editor.select(a.id);const e=this.editor.getShapeUtil(a);this.editor.getInstanceState().isReadonly&&!e.canEditInReadOnly(a)||(this.editor.setEditingShape(a.id),this.editor.setCurrentTool("select.editing_shape"))}))}}this.editor.mark("selecting on pointer up"),this.editor.select(a.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(a);else if(i){const t=this.editor.getShapeAncestors(e);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter((e=>!t.find((t=>t.id===e)))),e.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([e.id])}this.parent.transition("idle",e)};onPointerMove=e=>{if(this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly)return;this.parent.transition("translating",e)}};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle")}}class Sf extends ll{static id="resizing";info={};markId="";creationCursorOffset={x:0,y:0};editAfterComplete=!1;snapshot={};onEnter=e=>{const{isCreating:t=!1,editAfterComplete:n=!1,creationCursorOffset:r={x:0,y:0}}=e;this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.editAfterComplete=n,this.creationCursorOffset=r,e.isCreating&&this.editor.updateInstanceState({cursor:{type:"cross",rotation:0}},{ephemeral:!0}),this.snapshot=this._createSnapshot(),this.markId=t?`creating:${this.editor.getOnlySelectedShape().id}`:"starting resizing",t||this.editor.mark(this.markId),this.handleResizeStart(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{this.updateShapes()};onKeyUp=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){this.handleResizeEnd();const e=this.editor.getOnlySelectedShape();if(this.editAfterComplete&&e)return this.editor.setEditingShape(e.id),void this.editor.setCurrentTool("select.editing_shape");this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:e}=this.snapshot,t=[];e.forEach((({shape:e})=>{const n=this.editor.getShapeUtil(e),r=n.onResizeStart?.(e);r&&t.push(r)})),t.length>0&&this.editor.updateShapes(t)}handleResizeEnd(){const{shapeSnapshots:e}=this.snapshot,t=[];e.forEach((({shape:e})=>{const n=this.editor.getShape(e.id),r=this.editor.getShapeUtil(e),o=r.onResizeEnd?.(e,n);o&&t.push(o)})),t.length>0&&this.editor.updateShapes(t)}updateShapes(){const{altKey:e,shiftKey:t}=this.editor.inputs,{shapeSnapshots:n,selectionBounds:r,cursorHandleOffset:o,selectedShapeIds:i,selectionRotation:s,canShapesDeform:a}=this.snapshot,c=t||!a,{ctrlKey:l}=this.editor.inputs,u=this.editor.inputs.currentPagePoint.clone().sub(o).sub(this.creationCursorOffset),d=this.editor.inputs.originPagePoint.clone().sub(o);if(this.editor.getInstanceState().isGridMode&&!l){const{gridSize:e}=this.editor.getDocumentSettings();u.snapToGrid(e)}const h=this.info.handle,p=Cf(h,Math.PI);if(this.editor.snaps.clear(),(this.editor.user.getIsSnapMode()?!l:l)&&s%yo==0){const{nudge:t}=this.editor.snaps.snapResize({dragDelta:ho.Sub(u,d),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:Cf(h,s),isAspectRatioLocked:c,isResizingFromCenter:e});u.add(t)}const f=ho.RotWith(e?r.center:r.getHandlePoint(p),r.point,s),g=ho.Sub(u,f).rot(-s),m=ho.Sub(d,f).rot(-s),_=ho.DivV(g,m);Number.isFinite(_.x)||(_.x=1),Number.isFinite(_.y)||(_.y=1);const y="top"===h||"bottom"===h,w="left"===h||"right"===h;c?w?_.y=Math.abs(_.x):y?_.x=Math.abs(_.y):Math.abs(_.x)>Math.abs(_.y)?_.y=Math.abs(_.x)*(_.y<0?-1:1):_.x=Math.abs(_.y)*(_.x<0?-1:1):(y&&(_.x=1),w&&(_.y=1)),this.info.isCreating||this.updateCursor({dragHandle:h,isFlippedX:_.x<0,isFlippedY:_.y<0,rotation:s});for(const e of n.keys()){const t=n.get(e);this.editor.resizeShape(e,_,{initialShape:t.shape,initialBounds:t.bounds,initialPageTransform:t.pageTransform,dragHandle:h,mode:1===i.length&&e===i[0]?"resize_bounds":"scale_shape",scaleOrigin:f,scaleAxisRotation:s})}}updateCursor({dragHandle:e,isFlippedX:t,isFlippedY:n,rotation:r}){const o={...this.editor.getInstanceState().cursor};switch(e){case"top_left":case"bottom_right":o.type="nwse-resize",t!==n&&(o.type="nesw-resize");break;case"top_right":case"bottom_left":o.type="nesw-resize",t!==n&&(o.type="nwse-resize")}o.rotation=r,this.editor.setCursor(o)}onExit=()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.snaps.clear()};_createSnapshot=()=>{const e=this.editor.getSelectedShapeIds(),t=this.editor.getSelectionRotation(),{inputs:{originPagePoint:n}}=this.editor,r=this.editor.getSelectionRotatedPageBounds(),o=ho.RotWith(r.getHandlePoint(this.info.handle),r.point,t),i=ho.Sub(n,o),s=new Map;e.forEach((t=>{const n=this.editor.getShape(t);if(n){if(s.set(n.id,this._createShapeSnapshot(n)),this.editor.isShapeOfType(n,"frame")&&1===e.length)return;this.editor.visitDescendants(n.id,(e=>{const t=this.editor.getShape(e);if(t&&(s.set(t.id,this._createShapeSnapshot(t)),this.editor.isShapeOfType(t,"frame")))return!1}))}}));const a=![...s.values()].some((e=>!jo(e.pageRotation,t)||e.isAspectRatioLocked));return{shapeSnapshots:s,selectionBounds:r,cursorHandleOffset:i,selectionRotation:t,selectedShapeIds:e,canShapesDeform:a,initialSelectionPageBounds:this.editor.getSelectionPageBounds()}};_createShapeSnapshot=e=>{const t=this.editor.getShapePageTransform(e),n=this.editor.getShapeUtil(e);return{shape:e,bounds:this.editor.getShapeGeometry(e).bounds,pageTransform:t,pageRotation:ks.Decompose(t).rotation,isAspectRatioLocked:n.isAspectRatioLocked(e)}}}const kf=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function Cf(e,t){t%=wo;const n=Math.round(t/(_o/4)),r=kf.indexOf(e);return kf[(r+n)%kf.length]}class Ef extends ll{static id="rotating";snapshot={};info={};markId="";onEnter=e=>{this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.markId="rotate start",this.editor.mark(this.markId);const t=mc({editor:this.editor});if(!t)return this.parent.transition("idle",this.info);this.snapshot=t,this.handleStart()};onExit=()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}};onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};update=()=>{const e=this._getRotationFromPointerPosition({snapToNearestDegree:!1});_c({editor:this.editor,delta:e,snapshot:this.snapshot,stage:"update"}),this.editor.updateInstanceState({cursor:{type:of[this.info.handle],rotation:e+this.snapshot.initialSelectionRotation}})};cancel=()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};complete=()=>{_c({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};handleStart(){const e=this._getRotationFromPointerPosition({snapToNearestDegree:!1});_c({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.updateInstanceState({cursor:{type:of[this.info.handle],rotation:e+this.snapshot.initialSelectionRotation}})}_getRotationFromPointerPosition({snapToNearestDegree:e}){const t=this.editor.getSelectionRotation(),n=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:r,currentPagePoint:o}}=this.editor,{initialCursorAngle:i,initialSelectionRotation:s}=this.snapshot;if(!n)return s;let a=s+(n.center.clone().rotWith(n.point,t).angle(o)-i);if(r)a=To(a,24);else if(e&&(a=Math.round(a/vo)*vo,this.editor.getInstanceState().isCoarsePointer)){const e=To(a,4),t=Po(a,e);Math.abs(t)<5*_o/180&&(a=e)}return a-s}}class Af extends ll{static id="scribble_brushing";hits=new Set;size=0;scribbleId="id";initialSelectedShapeIds=new Set;newlySelectedShapeIds=new Set;onEnter=()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const e=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=e.id,this.updateScribbleSelection(!0),requestAnimationFrame((()=>{this.editor.updateInstanceState({brush:null})}))};onExit=()=>{this.editor.scribbles.stop(this.scribbleId)};onPointerMove=()=>{this.updateScribbleSelection(!0)};onPointerUp=()=>{this.complete()};onKeyDown=()=>{this.updateScribbleSelection(!1)};onKeyUp=()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};pushPointToScribble=()=>{const{x:e,y:t}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,e,t)};updateScribbleSelection(e){const t=this.editor.getZoomLevel(),n=this.editor.getCurrentPageShapes(),{inputs:{shiftKey:r,originPagePoint:o,previousPagePoint:i,currentPagePoint:s}}=this.editor,{newlySelectedShapeIds:a,initialSelectedShapeIds:c}=this;e&&this.pushPointToScribble();const l=n;let u,d,h,p;for(let e=0,n=l.length;e<n;e++)if(u=l[e],d=this.editor.getShapeGeometry(u),!(this.editor.isShapeOfType(u,"group")||a.has(u.id)||this.editor.isShapeOrAncestorLocked(u))){if(this.editor.isShapeOfType(u,"frame")){const e=this.editor.getPointInShapeSpace(u,o);if(d.bounds.containsPoint(e))continue}if(h=this.editor.getPointInShapeSpace(u,i),p=this.editor.getPointInShapeSpace(u,s),d.hitTestLineSegment(h,p,8/t)){const e=this.editor.getOutermostSelectableShape(u),t=this.editor.getShapeMask(e.id);if(t&&null!==Ta(i,s,t)&&!Lo(s,t))continue;a.add(e.id)}}this.editor.setSelectedShapes([...new Set(r?[...a,...c]:[...a])],{squashing:!0})}complete(){this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds],{squashing:!0}),this.parent.transition("idle")}}class If{constructor(e){this.editor=e,e.disposables.add(this.dispose)}prevDroppingShapeId=null;droppingNodeTimer=null;first=!0;updateDroppingNode(e,t){this.first&&(this.prevDroppingShapeId=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,e)?.id??null,this.first=!1),null===this.droppingNodeTimer?this.setDragTimer(e,1e3,t):this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(e,100,t))}setDragTimer(e,t,n){this.droppingNodeTimer=setTimeout((()=>{this.editor.batch((()=>{this.handleDrag(this.editor.inputs.currentPagePoint,e,n)})),this.droppingNodeTimer=null}),t)}handleDrag(e,t,n){t=he(t.map((e=>this.editor.getShape(e.id))));const r=this.editor.getDroppingOverShape(e,t)?.id??null;if(r===this.prevDroppingShapeId)return;const{prevDroppingShapeId:o}=this,i=o&&this.editor.getShape(o),s=r&&this.editor.getShape(r);if(i&&this.editor.getShapeUtil(i).onDragShapesOut?.(i,t),s){const e=this.editor.getShapeUtil(s).onDragShapesOver?.(s,t);e&&e.shouldHint&&this.editor.setHintingShapes([s.id])}else this.editor.setHintingShapes([]);n?.(),this.prevDroppingShapeId=r}dropShapes(e){const{prevDroppingShapeId:t}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,e),t){const n=this.editor.getShape(t);if(!n)return;this.editor.getShapeUtil(n).onDropShapesOver?.(n,e)}}clear(){this.prevDroppingShapeId=null,null!==this.droppingNodeTimer&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}dispose=()=>{this.clear()}}class Pf extends ll{static id="translating";info={};selectionSnapshot={};snapshot={};markId="";isCloning=!1;isCreating=!1;editAfterComplete=!1;dragAndDropManager=new If(this.editor);onEnter=e=>{const{isCreating:t=!1,editAfterComplete:n=!1}=e;this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.isCreating=t,this.editAfterComplete=n,this.markId=t?`creating:${this.editor.getOnlySelectedShape().id}`:"translating",this.editor.mark(this.markId),this.isCloning=!1,this.info=e,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=Mf(this.editor),this.isCreating||!this.editor.inputs.altKey?(this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes(),this.editor.on("tick",this.updateParent)):this.startCloning()};onExit=()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.dragAndDropManager.clear()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{!this.editor.inputs.altKey||this.isCloning?this.updateShapes():this.startCloning()};onKeyUp=()=>{this.editor.inputs.altKey||!this.isCloning?this.updateShapes():this.stopCloning()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=Mf(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}updateParent=()=>{const{snapshot:e}=this;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms)};reset(){this.editor.bailToMark(this.markId)}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd)this.editor.setCurrentTool(this.info.onInteractionEnd);else if(this.editAfterComplete){const e=this.editor.getOnlySelectedShape();e&&(this.editor.setEditingShape(e.id),this.editor.setCurrentTool("select.editing_shape"))}else this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:e}=this.snapshot,t=[];e.forEach((e=>{const n=this.editor.getShapeUtil(e),r=n.onTranslateStart?.(e);r&&t.push(r)})),t.length>0&&this.editor.updateShapes(t),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:e}=this.snapshot,t=[];e.forEach((e=>{const n=this.editor.getShape(e.id),r=this.editor.getShapeUtil(e),o=r.onTranslateEnd?.(e,n);o&&t.push(o)})),t.length>0&&this.editor.updateShapes(t)}handleChange(){const{movingShapes:e}=this.snapshot,t=[];e.forEach((e=>{const n=this.editor.getShape(e.id),r=this.editor.getShapeUtil(e),o=r.onTranslate?.(e,n);o&&t.push(o)})),t.length>0&&this.editor.updateShapes(t)}updateShapes(){const{snapshot:e}=this;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms),function({editor:e,shapeSnapshots:t,averagePagePoint:n,initialSelectionPageBounds:r,initialSelectionSnapPoints:o}){const{inputs:i}=e,s=e.getInstanceState().isGridMode,a=e.getDocumentSettings().gridSize,c=ho.Sub(i.currentPagePoint,i.originPagePoint),l=e.inputs.shiftKey?Math.abs(c.x)<Math.abs(c.y)?"x":"y":null;if("x"===l?c.x=0:"y"===l&&(c.y=0),e.snaps.clear(),(e.user.getIsSnapMode()?!i.ctrlKey:i.ctrlKey)&&e.inputs.pointerVelocity.len()<.5){const{nudge:t}=e.snaps.snapTranslate({dragDelta:c,initialSelectionPageBounds:r,lockedAxis:l,initialSelectionSnapPoints:o});c.add(t)}const u=ho.Add(n,c);s&&!i.ctrlKey&&u.snapToGrid(a);const d=ho.Sub(u,n);e.updateShapes(he(t.map((({shape:e,pagePoint:t,parentTransform:n})=>{const r=ho.Add(t,d),o=n?ks.applyToPoint(n,r):r;return{id:e.id,type:e.type,x:o.x,y:o.y}}))),{squashing:!0})}({editor:this.editor,shapeSnapshots:e.shapeSnapshots,averagePagePoint:e.averagePagePoint,initialSelectionPageBounds:e.initialPageBounds,initialSelectionSnapPoints:e.initialSnapPoints}),this.handleChange()}updateParentTransforms=()=>{const{editor:e,snapshot:{shapeSnapshots:t}}=this,n=[];t.forEach((t=>{const r=e.getShape(t.shape.id);if(!r)return null;n.push(r);const o=Jt(r.parentId)?null:ks.Inverse(e.getShapePageTransform(r.parentId));t.parentTransform=o}))}}function Mf(e){const t=[],n=[],r=he(e.getSelectedShapeIds().map((r=>{const o=e.getShape(r);if(!o)return null;t.push(o);const i=e.getShapePageTransform(r).point();return i?(n.push(i),{shape:o,pagePoint:i,parentTransform:Qt.isId(o.parentId)?null:ks.Inverse(e.getShapePageTransform(o.parentId))}):null})));let o=[];if(1===e.getSelectedShapeIds().length)o=e.snaps.getSnapPointsCache().get(e.getSelectedShapeIds()[0]);else{const t=e.getSelectionPageBounds();t&&(o=t.snapPoints.map(((e,t)=>({id:"selection:"+t,x:e.x,y:e.y}))))}return{averagePagePoint:ho.Average(n),movingShapes:t,shapeSnapshots:r,initialPageBounds:e.getSelectionPageBounds(),initialSnapPoints:o}}class Tf extends ll{static id="idle";info={};onEnter=e=>{this.info=e};onPointerDown=()=>{this.parent.transition("pointing",this.info)}}class jf extends ll{static id="pointing";info={};onEnter=e=>{this.info=e};onPointerUp=()=>{this.complete()};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)};onCancel=()=>{this.cancel()};complete(){const{currentScreenPoint:e}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(e,{duration:220}):this.editor.zoomIn(e,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}class Df extends ll{static id="zoom_brushing";info={};zoomBrush=new fo;onEnter=e=>{this.info=e,this.update()};onExit=()=>{this.editor.updateInstanceState({zoomBrush:null})};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};update(){const{inputs:{originPagePoint:e,currentPagePoint:t}}=this.editor;this.zoomBrush.setTo(fo.FromPoints([e,t])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:e}=this,t=8/this.editor.getZoomLevel();if(e.width<t&&e.height<t){const e=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(e,{duration:220}):this.editor.zoomIn(e,{duration:220})}else{const t=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(e,t,{duration:220})}this.parent.transition("idle",this.info)}}const Of=[class extends ll{static id="eraser";static initial="idle";static children=()=>[Wp,Kp,Vp];onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})}},class extends ll{static id="hand";static initial="idle";static children=()=>[Gp,qp,Hp];onDoubleClick=e=>{if("settle"===e.phase){const{currentScreenPoint:e}=this.editor.inputs;this.editor.zoomIn(e,{duration:220,easing:uo.easeOutQuint})}};onTripleClick=e=>{if("settle"===e.phase){const{currentScreenPoint:e}=this.editor.inputs;this.editor.zoomOut(e,{duration:320,easing:uo.easeOutQuint})}};onQuadrupleClick=e=>{if("settle"===e.phase){const e=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:t}}=this.editor;1===e?this.editor.zoomToFit({duration:400,easing:uo.easeOutQuint}):this.editor.resetZoom(t,{duration:320,easing:uo.easeOutQuint})}}},class extends ll{static id="laser";static initial="idle";static children=()=>[Yp,Xp];onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})}},class extends ll{static id="zoom";static initial="idle";static children=()=>[Tf,Df,jf];info={};onEnter=e=>{this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.updateCursor()};onExit=()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)};onKeyDown=()=>{this.updateCursor()};onKeyUp=e=>{this.updateCursor(),"KeyZ"===e.code&&this.complete()};onInterrupt=()=>{this.complete()};complete(){this.info.onInteractionEnd&&"select"!==this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.updateInstanceState({cursor:{type:"zoom-out",rotation:0}},{ephemeral:!0}):this.editor.updateInstanceState({cursor:{type:"zoom-in",rotation:0}},{ephemeral:!0})}},class extends ll{static id="select";static initial="idle";static children=()=>[rf,af,hf,_f,xf,Pf,Zp,Af,yf,bf,sf,lf,Sf,Ef,vf,wf,cf];onExit=()=>{this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)}}];function zf(){return zf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zf.apply(this,arguments)}var Ff=o(3935);function Rf(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(null==e||e(r),!1===n||!r.defaultPrevented)return null==t?void 0:t(r)}}function Lf(...e){return t=>e.forEach((e=>function(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}(e,t)))}function Nf(...t){return(0,e.useCallback)(Lf(...t),t)}function Bf(t,n=[]){let r=[];const o=()=>{const n=r.map((t=>(0,e.createContext)(t)));return function(r){const o=(null==r?void 0:r[t])||n;return(0,e.useMemo)((()=>({[`__scope${t}`]:{...r,[t]:o}})),[r,o])}};return o.scopeName=t,[function(n,o){const i=(0,e.createContext)(o),s=r.length;function a(n){const{scope:r,children:o,...a}=n,c=(null==r?void 0:r[t][s])||i,l=(0,e.useMemo)((()=>a),Object.values(a));return(0,e.createElement)(c.Provider,{value:l},o)}return r=[...r,o],a.displayName=n+"Provider",[a,function(r,a){const c=(null==a?void 0:a[t][s])||i,l=(0,e.useContext)(c);if(l)return l;if(void 0!==o)return o;throw new Error(`\`${r}\` must be used within \`${n}\``)}]},$f(o,...n)]}function $f(...t){const n=t[0];if(1===t.length)return n;const r=()=>{const r=t.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(t){const o=r.reduce(((e,{useScope:n,scopeName:r})=>({...e,...n(t)[`__scope${r}`]})),{});return(0,e.useMemo)((()=>({[`__scope${n.scopeName}`]:o})),[o])}};return r.scopeName=n.scopeName,r}const Uf=(0,e.forwardRef)(((t,n)=>{const{children:r,...o}=t,i=e.Children.toArray(r),s=i.find(Kf);if(s){const t=s.props.children,r=i.map((n=>n===s?e.Children.count(t)>1?e.Children.only(null):(0,e.isValidElement)(t)?t.props.children:null:n));return(0,e.createElement)(Vf,zf({},o,{ref:n}),(0,e.isValidElement)(t)?(0,e.cloneElement)(t,void 0,r):null)}return(0,e.createElement)(Vf,zf({},o,{ref:n}),r)}));Uf.displayName="Slot";const Vf=(0,e.forwardRef)(((t,n)=>{const{children:r,...o}=t;return(0,e.isValidElement)(r)?(0,e.cloneElement)(r,{...Hf(o,r.props),ref:n?Lf(n,r.ref):r.ref}):e.Children.count(r)>1?e.Children.only(null):null}));Vf.displayName="SlotClone";const Wf=({children:t})=>(0,e.createElement)(e.Fragment,null,t);function Kf(t){return(0,e.isValidElement)(t)&&t.type===Wf}function Hf(e,t){const n={...t};for(const r in t){const o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...e)=>{i(...e),o(...e)}:o&&(n[r]=o):"style"===r?n[r]={...o,...i}:"className"===r&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}function Gf(t){const n=t+"CollectionProvider",[r,o]=Bf(n),[i,s]=r(n,{collectionRef:{current:null},itemMap:new Map}),a=t+"CollectionSlot",c=t+"CollectionItemSlot",l="data-radix-collection-item";return[{Provider:t=>{const{scope:n,children:r}=t,o=e.useRef(null),s=e.useRef(new Map).current;return e.createElement(i,{scope:n,itemMap:s,collectionRef:o},r)},Slot:e.forwardRef(((t,n)=>{const{scope:r,children:o}=t,i=Nf(n,s(a,r).collectionRef);return e.createElement(Uf,{ref:i},o)})),ItemSlot:e.forwardRef(((t,n)=>{const{scope:r,children:o,...i}=t,a=e.useRef(null),u=Nf(n,a),d=s(c,r);return e.useEffect((()=>(d.itemMap.set(a,{ref:a,...i}),()=>{d.itemMap.delete(a)}))),e.createElement(Uf,{[l]:"",ref:u},o)}))},function(n){const r=s(t+"CollectionConsumer",n);return e.useCallback((()=>{const e=r.collectionRef.current;if(!e)return[];const t=Array.from(e.querySelectorAll(`[${l}]`));return Array.from(r.itemMap.values()).sort(((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current)))}),[r.collectionRef,r.itemMap])},o]}const qf=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce(((t,n)=>{const r=(0,e.forwardRef)(((t,r)=>{const{asChild:o,...i}=t,s=o?Uf:n;return(0,e.useEffect)((()=>{window[Symbol.for("radix-ui")]=!0}),[]),(0,e.createElement)(s,zf({},i,{ref:r}))}));return r.displayName=`Primitive.${n}`,{...t,[n]:r}}),{});function Yf(e,t){e&&(0,Ff.flushSync)((()=>e.dispatchEvent(t)))}function Xf(t){const n=(0,e.useRef)(t);return(0,e.useEffect)((()=>{n.current=t})),(0,e.useMemo)((()=>(...e)=>{var t;return null===(t=n.current)||void 0===t?void 0:t.call(n,...e)}),[])}const Zf="dismissableLayer.update";let Qf;const Jf=(0,e.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),eg=(0,e.forwardRef)(((t,n)=>{var r;const{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:c,onDismiss:l,...u}=t,d=(0,e.useContext)(Jf),[h,p]=(0,e.useState)(null),f=null!==(r=null==h?void 0:h.ownerDocument)&&void 0!==r?r:null===globalThis||void 0===globalThis?void 0:globalThis.document,[,g]=(0,e.useState)({}),m=Nf(n,(e=>p(e))),_=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),w=_.indexOf(y),v=h?_.indexOf(h):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,x=v>=w,S=function(t,n=(null===globalThis||void 0===globalThis?void 0:globalThis.document)){const r=Xf(t),o=(0,e.useRef)(!1),i=(0,e.useRef)((()=>{}));return(0,e.useEffect)((()=>{const e=e=>{if(e.target&&!o.current){const t={originalEvent:e};function s(){ng("dismissableLayer.pointerDownOutside",r,t,{discrete:!0})}"touch"===e.pointerType?(n.removeEventListener("click",i.current),i.current=s,n.addEventListener("click",i.current,{once:!0})):s()}else n.removeEventListener("click",i.current);o.current=!1},t=window.setTimeout((()=>{n.addEventListener("pointerdown",e)}),0);return()=>{window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",i.current)}}),[n,r]),{onPointerDownCapture:()=>o.current=!0}}((e=>{const t=e.target,n=[...d.branches].some((e=>e.contains(t)));x&&!n&&(null==s||s(e),null==c||c(e),e.defaultPrevented||null==l||l())}),f),k=function(t,n=(null===globalThis||void 0===globalThis?void 0:globalThis.document)){const r=Xf(t),o=(0,e.useRef)(!1);return(0,e.useEffect)((()=>{const e=e=>{e.target&&!o.current&&ng("dismissableLayer.focusOutside",r,{originalEvent:e},{discrete:!1})};return n.addEventListener("focusin",e),()=>n.removeEventListener("focusin",e)}),[n,r]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}((e=>{const t=e.target;[...d.branches].some((e=>e.contains(t)))||(null==a||a(e),null==c||c(e),e.defaultPrevented||null==l||l())}),f);return function(t,n=(null===globalThis||void 0===globalThis?void 0:globalThis.document)){const r=Xf(t);(0,e.useEffect)((()=>{const e=e=>{"Escape"===e.key&&r(e)};return n.addEventListener("keydown",e),()=>n.removeEventListener("keydown",e)}),[r,n])}((e=>{v===d.layers.size-1&&(null==i||i(e),!e.defaultPrevented&&l&&(e.preventDefault(),l()))}),f),(0,e.useEffect)((()=>{if(h)return o&&(0===d.layersWithOutsidePointerEventsDisabled.size&&(Qf=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),tg(),()=>{o&&1===d.layersWithOutsidePointerEventsDisabled.size&&(f.body.style.pointerEvents=Qf)}}),[h,f,o,d]),(0,e.useEffect)((()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),tg())}),[h,d]),(0,e.useEffect)((()=>{const e=()=>g({});return document.addEventListener(Zf,e),()=>document.removeEventListener(Zf,e)}),[]),(0,e.createElement)(qf.div,zf({},u,{ref:m,style:{pointerEvents:b?x?"auto":"none":void 0,...t.style},onFocusCapture:Rf(t.onFocusCapture,k.onFocusCapture),onBlurCapture:Rf(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Rf(t.onPointerDownCapture,S.onPointerDownCapture)}))}));function tg(){const e=new CustomEvent(Zf);document.dispatchEvent(e)}function ng(e,t,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Yf(o,i):o.dispatchEvent(i)}const rg=eg,og=(0,e.forwardRef)(((t,n)=>{const r=(0,e.useContext)(Jf),o=(0,e.useRef)(null),i=Nf(n,o);return(0,e.useEffect)((()=>{const e=o.current;if(e)return r.branches.add(e),()=>{r.branches.delete(e)}}),[r.branches]),(0,e.createElement)(qf.div,zf({},t,{ref:i}))})),ig=(0,e.forwardRef)(((t,n)=>{var r;const{container:o=(null===globalThis||void 0===globalThis||null===(r=globalThis.document)||void 0===r?void 0:r.body),...i}=t;return o?Ff.createPortal((0,e.createElement)(qf.div,zf({},i,{ref:n})),o):null})),sg=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?e.useLayoutEffect:()=>{},ag=t=>{const{present:n,children:r}=t,o=function(t){const[n,r]=(0,e.useState)(),o=(0,e.useRef)({}),i=(0,e.useRef)(t),s=(0,e.useRef)("none"),a=t?"mounted":"unmounted",[c,l]=function(t,n){return(0,e.useReducer)(((e,t)=>{const r=n[e][t];return null!=r?r:e}),t)}(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,e.useEffect)((()=>{const e=cg(o.current);s.current="mounted"===c?e:"none"}),[c]),sg((()=>{const e=o.current,n=i.current;if(n!==t){const r=s.current,o=cg(e);t?l("MOUNT"):"none"===o||"none"===(null==e?void 0:e.display)?l("UNMOUNT"):l(n&&r!==o?"ANIMATION_OUT":"UNMOUNT"),i.current=t}}),[t,l]),sg((()=>{if(n){const e=e=>{const t=cg(o.current).includes(e.animationName);e.target===n&&t&&(0,Ff.flushSync)((()=>l("ANIMATION_END")))},t=e=>{e.target===n&&(s.current=cg(o.current))};return n.addEventListener("animationstart",t),n.addEventListener("animationcancel",e),n.addEventListener("animationend",e),()=>{n.removeEventListener("animationstart",t),n.removeEventListener("animationcancel",e),n.removeEventListener("animationend",e)}}l("ANIMATION_END")}),[n,l]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:(0,e.useCallback)((e=>{e&&(o.current=getComputedStyle(e)),r(e)}),[])}}(n),i="function"==typeof r?r({present:o.isPresent}):e.Children.only(r),s=Nf(o.ref,i.ref);return"function"==typeof r||o.isPresent?(0,e.cloneElement)(i,{ref:s}):null};function cg(e){return(null==e?void 0:e.animationName)||"none"}function lg({prop:t,defaultProp:n,onChange:r=(()=>{})}){const[o,i]=function({defaultProp:t,onChange:n}){const r=(0,e.useState)(t),[o]=r,i=(0,e.useRef)(o),s=Xf(n);return(0,e.useEffect)((()=>{i.current!==o&&(s(o),i.current=o)}),[o,i,s]),r}({defaultProp:n,onChange:r}),s=void 0!==t,a=s?t:o,c=Xf(r);return[a,(0,e.useCallback)((e=>{if(s){const n="function"==typeof e?e(t):e;n!==t&&c(n)}else i(e)}),[s,t,i,c])]}ag.displayName="Presence";const ug=(0,e.forwardRef)(((t,n)=>(0,e.createElement)(qf.span,zf({},t,{ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})))),dg="ToastProvider",[hg,pg,fg]=Gf("Toast"),[gg,mg]=Bf("Toast",[fg]),[_g,yg]=gg(dg),wg=t=>{const{__scopeToast:n,label:r="Notification",duration:o=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:a}=t,[c,l]=(0,e.useState)(null),[u,d]=(0,e.useState)(0),h=(0,e.useRef)(!1),p=(0,e.useRef)(!1);return(0,e.createElement)(hg.Provider,{scope:n},(0,e.createElement)(_g,{scope:n,label:r,duration:o,swipeDirection:i,swipeThreshold:s,toastCount:u,viewport:c,onViewportChange:l,onToastAdd:(0,e.useCallback)((()=>d((e=>e+1))),[]),onToastRemove:(0,e.useCallback)((()=>d((e=>e-1))),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:p},a))};wg.propTypes={label:e=>e.label&&"string"==typeof e.label&&!e.label.trim()?new Error(`Invalid prop \`label\` supplied to \`${dg}\`. Expected non-empty \`string\`.`):null};const vg=["F8"],bg="toast.viewportPause",xg="toast.viewportResume",Sg=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,hotkey:o=vg,label:i="Notifications ({hotkey})",...s}=t,a=yg("ToastViewport",r),c=pg(r),l=(0,e.useRef)(null),u=(0,e.useRef)(null),d=(0,e.useRef)(null),h=(0,e.useRef)(null),p=Nf(n,h,a.onViewportChange),f=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=a.toastCount>0;(0,e.useEffect)((()=>{const e=e=>{var t;o.every((t=>e[t]||e.code===t))&&(null===(t=h.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[o]),(0,e.useEffect)((()=>{const e=l.current,t=h.current;if(g&&e&&t){const n=()=>{if(!a.isClosePausedRef.current){const e=new CustomEvent(bg);t.dispatchEvent(e),a.isClosePausedRef.current=!0}},r=()=>{if(a.isClosePausedRef.current){const e=new CustomEvent(xg);t.dispatchEvent(e),a.isClosePausedRef.current=!1}},o=t=>{!e.contains(t.relatedTarget)&&r()},i=()=>{e.contains(document.activeElement)||r()};return e.addEventListener("focusin",n),e.addEventListener("focusout",o),e.addEventListener("pointermove",n),e.addEventListener("pointerleave",i),window.addEventListener("blur",n),window.addEventListener("focus",r),()=>{e.removeEventListener("focusin",n),e.removeEventListener("focusout",o),e.removeEventListener("pointermove",n),e.removeEventListener("pointerleave",i),window.removeEventListener("blur",n),window.removeEventListener("focus",r)}}}),[g,a.isClosePausedRef]);const m=(0,e.useCallback)((({tabbingDirection:e})=>{const t=c().map((t=>{const n=t.ref.current,r=[n,...Ng(n)];return"forwards"===e?r:r.reverse()}));return("forwards"===e?t.reverse():t).flat()}),[c]);return(0,e.useEffect)((()=>{const e=h.current;if(e){const t=t=>{const n=t.altKey||t.ctrlKey||t.metaKey;if("Tab"===t.key&&!n){const n=document.activeElement,s=t.shiftKey;var r;if(t.target===e&&s)return void(null===(r=u.current)||void 0===r||r.focus());const a=m({tabbingDirection:s?"backwards":"forwards"}),c=a.findIndex((e=>e===n));var o,i;Bg(a.slice(c+1))?t.preventDefault():s?null===(o=u.current)||void 0===o||o.focus():null===(i=d.current)||void 0===i||i.focus()}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}}),[c,m]),(0,e.createElement)(og,{ref:l,role:"region","aria-label":i.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:g?void 0:"none"}},g&&(0,e.createElement)(kg,{ref:u,onFocusFromOutsideViewport:()=>{Bg(m({tabbingDirection:"forwards"}))}}),(0,e.createElement)(hg.Slot,{scope:r},(0,e.createElement)(qf.ol,zf({tabIndex:-1},s,{ref:p}))),g&&(0,e.createElement)(kg,{ref:d,onFocusFromOutsideViewport:()=>{Bg(m({tabbingDirection:"backwards"}))}}))})),kg=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,onFocusFromOutsideViewport:o,...i}=t,s=yg("ToastFocusProxy",r);return(0,e.createElement)(ug,zf({"aria-hidden":!0,tabIndex:0},i,{ref:n,style:{position:"fixed"},onFocus:e=>{var t;const n=e.relatedTarget;(null===(t=s.viewport)||void 0===t||!t.contains(n))&&o()}}))})),Cg="Toast",Eg=(0,e.forwardRef)(((t,n)=>{const{forceMount:r,open:o,defaultOpen:i,onOpenChange:s,...a}=t,[c=!0,l]=lg({prop:o,defaultProp:i,onChange:s});return(0,e.createElement)(ag,{present:r||c},(0,e.createElement)(Pg,zf({open:c},a,{ref:n,onClose:()=>l(!1),onPause:Xf(t.onPause),onResume:Xf(t.onResume),onSwipeStart:Rf(t.onSwipeStart,(e=>{e.currentTarget.setAttribute("data-swipe","start")})),onSwipeMove:Rf(t.onSwipeMove,(e=>{const{x:t,y:n}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${n}px`)})),onSwipeCancel:Rf(t.onSwipeCancel,(e=>{e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")})),onSwipeEnd:Rf(t.onSwipeEnd,(e=>{const{x:t,y:n}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${n}px`),l(!1)}))})))})),[Ag,Ig]=gg(Cg,{onClose(){}}),Pg=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,type:o="foreground",duration:i,open:s,onClose:a,onEscapeKeyDown:c,onPause:l,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:p,onSwipeEnd:f,...g}=t,m=yg(Cg,r),[_,y]=(0,e.useState)(null),w=Nf(n,(e=>y(e))),v=(0,e.useRef)(null),b=(0,e.useRef)(null),x=i||m.duration,S=(0,e.useRef)(0),k=(0,e.useRef)(x),C=(0,e.useRef)(0),{onToastAdd:E,onToastRemove:A}=m,I=Xf((()=>{var e;(null==_?void 0:_.contains(document.activeElement))&&(null===(e=m.viewport)||void 0===e||e.focus()),a()})),P=(0,e.useCallback)((e=>{e&&e!==1/0&&(window.clearTimeout(C.current),S.current=(new Date).getTime(),C.current=window.setTimeout(I,e))}),[I]);(0,e.useEffect)((()=>{const e=m.viewport;if(e){const t=()=>{P(k.current),null==u||u()},n=()=>{const e=(new Date).getTime()-S.current;k.current=k.current-e,window.clearTimeout(C.current),null==l||l()};return e.addEventListener(bg,n),e.addEventListener(xg,t),()=>{e.removeEventListener(bg,n),e.removeEventListener(xg,t)}}}),[m.viewport,x,l,u,P]),(0,e.useEffect)((()=>{s&&!m.isClosePausedRef.current&&P(x)}),[s,x,m.isClosePausedRef,P]),(0,e.useEffect)((()=>(E(),()=>A())),[E,A]);const M=(0,e.useMemo)((()=>_?Fg(_):null),[_]);return m.viewport?(0,e.createElement)(e.Fragment,null,M&&(0,e.createElement)(Mg,{__scopeToast:r,role:"status","aria-live":"foreground"===o?"assertive":"polite","aria-atomic":!0},M),(0,e.createElement)(Ag,{scope:r,onClose:I},(0,Ff.createPortal)((0,e.createElement)(hg.ItemSlot,{scope:r},(0,e.createElement)(rg,{asChild:!0,onEscapeKeyDown:Rf(c,(()=>{m.isFocusedToastEscapeKeyDownRef.current||I(),m.isFocusedToastEscapeKeyDownRef.current=!1}))},(0,e.createElement)(qf.li,zf({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection},g,{ref:w,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Rf(t.onKeyDown,(e=>{"Escape"===e.key&&(null==c||c(e.nativeEvent),e.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,I()))})),onPointerDown:Rf(t.onPointerDown,(e=>{0===e.button&&(v.current={x:e.clientX,y:e.clientY})})),onPointerMove:Rf(t.onPointerMove,(e=>{if(!v.current)return;const t=e.clientX-v.current.x,n=e.clientY-v.current.y,r=Boolean(b.current),o=["left","right"].includes(m.swipeDirection),i=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,s=o?i(0,t):0,a=o?0:i(0,n),c="touch"===e.pointerType?10:2,l={x:s,y:a},u={originalEvent:e,delta:l};r?(b.current=l,Rg("toast.swipeMove",h,u,{discrete:!1})):Lg(l,m.swipeDirection,c)?(b.current=l,Rg("toast.swipeStart",d,u,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>c||Math.abs(n)>c)&&(v.current=null)})),onPointerUp:Rf(t.onPointerUp,(e=>{const t=b.current,n=e.target;if(n.hasPointerCapture(e.pointerId)&&n.releasePointerCapture(e.pointerId),b.current=null,v.current=null,t){const n=e.currentTarget,r={originalEvent:e,delta:t};Lg(t,m.swipeDirection,m.swipeThreshold)?Rg("toast.swipeEnd",f,r,{discrete:!0}):Rg("toast.swipeCancel",p,r,{discrete:!0}),n.addEventListener("click",(e=>e.preventDefault()),{once:!0})}}))})))),m.viewport))):null}));Pg.propTypes={type:e=>e.type&&!["foreground","background"].includes(e.type)?new Error(`Invalid prop \`type\` supplied to \`${Cg}\`. Expected \`foreground | background\`.`):null};const Mg=t=>{const{__scopeToast:n,children:r,...o}=t,i=yg(Cg,n),[s,a]=(0,e.useState)(!1),[c,l]=(0,e.useState)(!1);return function(e=(()=>{})){const t=Xf(e);sg((()=>{let e=0,n=0;return e=window.requestAnimationFrame((()=>n=window.requestAnimationFrame(t))),()=>{window.cancelAnimationFrame(e),window.cancelAnimationFrame(n)}}),[t])}((()=>a(!0))),(0,e.useEffect)((()=>{const e=window.setTimeout((()=>l(!0)),1e3);return()=>window.clearTimeout(e)}),[]),c?null:(0,e.createElement)(ig,{asChild:!0},(0,e.createElement)(ug,o,s&&(0,e.createElement)(e.Fragment,null,i.label," ",r)))},Tg=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,...o}=t;return(0,e.createElement)(qf.div,zf({},o,{ref:n}))})),jg=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,...o}=t;return(0,e.createElement)(qf.div,zf({},o,{ref:n}))})),Dg=(0,e.forwardRef)(((t,n)=>{const{altText:r,...o}=t;return r?(0,e.createElement)(zg,{altText:r,asChild:!0},(0,e.createElement)(Og,zf({},o,{ref:n}))):null}));Dg.propTypes={altText:e=>e.altText?null:new Error("Missing prop `altText` expected on `ToastAction`")};const Og=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,...o}=t,i=Ig("ToastClose",r);return(0,e.createElement)(zg,{asChild:!0},(0,e.createElement)(qf.button,zf({type:"button"},o,{ref:n,onClick:Rf(t.onClick,i.onClose)})))})),zg=(0,e.forwardRef)(((t,n)=>{const{__scopeToast:r,altText:o,...i}=t;return(0,e.createElement)(qf.div,zf({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":o||void 0},i,{ref:n}))}));function Fg(e){const t=[];return Array.from(e.childNodes).forEach((e=>{if(e.nodeType===e.TEXT_NODE&&e.textContent&&t.push(e.textContent),function(e){return e.nodeType===e.ELEMENT_NODE}(e)){const n=e.ariaHidden||e.hidden||"none"===e.style.display,r=""===e.dataset.radixToastAnnounceExclude;if(!n)if(r){const n=e.dataset.radixToastAnnounceAlt;n&&t.push(n)}else t.push(...Fg(e))}})),t}function Rg(e,t,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Yf(o,i):o.dispatchEvent(i)}const Lg=(e,t,n=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),i=r>o;return"left"===t||"right"===t?i&&r>n:!i&&o>n};function Ng(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Bg(e){const t=document.activeElement;return e.some((e=>e===t||(e.focus(),document.activeElement!==t)))}const $g=Eg,Ug=Tg,Vg=jg,Wg=Dg,Kg=Og,Hg="2.0.0-canary.52c38654209b";let Gg={fonts:{draw:`https://unpkg.com/@tldraw/assets@${Hg}/fonts/Shantell_Sans-Normal-SemiBold.woff2`,serif:`https://unpkg.com/@tldraw/assets@${Hg}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${Hg}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${Hg}/fonts/IBMPlexMono-Medium.woff2`}},qg={...Gg,icons:Object.fromEntries(["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","status-online","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"].map((e=>[e,`https://unpkg.com/@tldraw/assets@${Hg}/icons/icon/${e}.svg`]))),translations:Object.fromEntries(Dr.map((e=>[e.locale,`https://unpkg.com/@tldraw/assets@${Hg}/translations/${e.locale}.json`]))),embedIcons:Object.fromEntries(ir.map((e=>[e.type,`https://unpkg.com/@tldraw/assets@${Hg}/embed-icons/${e.type}.png`])))};function Yg(e){return e?{fonts:Object.assign({...qg.fonts},{...e?.fonts}),icons:Object.assign({...qg.icons},{...e?.icons}),embedIcons:Object.assign({...qg.embedIcons},{...e?.embedIcons}),translations:Object.assign({...qg.translations},{...e?.translations})}:qg}const Xg=(0,e.createContext)(null);function Zg({assetUrls:e,children:t}){return(0,Fr.jsx)(Xg.Provider,{value:e,children:t})}function Qg(){const t=(0,e.useContext)(Xg);if(!t)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return t}const Jg={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},em={locale:"en",label:"English",messages:Jg},tm=e.createContext({}),nm=()=>e.useContext(tm),rm=se((function({overrides:t,children:n}){const r=Yr().user.getLocale(),o=Qg(),[i,s]=e.useState((()=>t&&t.en?{locale:"en",label:"English",messages:{...Jg,...t.en}}:{locale:"en",label:"English",messages:Jg}));return e.useEffect((()=>{let e=!1;return async function(){const n=await async function(e,t){if(!(await fetch(t.translations.en)).ok)return console.warn("No main translations found."),em;if("en"===e)return em;const n=Dr.find((t=>t.locale===e));if(!n)return console.warn(`No translation found for locale ${e}`),em;const r=await fetch(t.translations[n.locale]),o=await r.json();if(!o)return console.warn(`No messages found for locale ${e}`),em;const i=[];for(const e in em.messages)o[e]||i.push(e);return i.length,{locale:e,label:n.label,messages:{...em.messages,...o}}}(r,o);n&&!e&&(t&&t[r]?s({...n,messages:{...n.messages,...t[r]}}):s(n))}(),()=>{e=!0}}),[o,r,t]),(0,Fr.jsx)(tm.Provider,{value:i,children:n})}));function om(){const t=nm();return e.useCallback((function(e){return t.messages[e]??e}),[t])}function im(e){return(0,Fr.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",...e,children:(0,Fr.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,Fr.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),(0,Fr.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:(0,Fr.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const sm=(0,e.memo)((function({small:t,invertIcon:n,icon:r,color:o,className:i,...s}){const a=Qg(),c=a.icons[r]??a.icons["question-mark-circle"],l=(0,e.useRef)(null);return(0,e.useLayoutEffect)((()=>{c||console.error(`Icon not found: ${r}. Add it to the assetUrls.icons object.`),l?.current&&(l.current.style.webkitMask=`url(${c}) center 100% / 100% no-repeat`)}),[l,c,r]),(0,Fr.jsx)("div",{...s,ref:l,className:Rr("tlui-icon",{"tlui-icon__small":t},i),style:{color:o,mask:`url(${c}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})})),am="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,cm=am?"":"Ctrl",lm=am?"":"Alt";function um(e){return" "+e.split(",")[0].split("").map((e=>{const t=e.replace(/\$/g,cm).replace(/\?/g,lm).replace(/!/g,"");return t[0].toUpperCase()+t.slice(1)})).join("")}function dm({children:e}){return(0,Fr.jsx)("kbd",{className:"tlui-kbd",children:(t=e,t.split(",")[0].split("").map((e=>{const t=e.replace(/\$/g,cm).replace(/\?/g,lm).replace(/!/g,"");return t[0].toUpperCase()+t.slice(1)}))).map(((e,t)=>(0,Fr.jsx)("span",{children:e},t)))});var t}const hm=e.forwardRef((function({label:e,icon:t,invertIcon:n,iconLeft:r,smallIcon:o,kbd:i,isChecked:s=!1,type:a,children:c,spinner:l,...u},d){const h=om(),p=e?h(e):"";return(0,Fr.jsxs)("button",{ref:d,draggable:!1,type:"button",...u,title:u.title??p,className:Rr("tlui-button",`tlui-button__${a}`,u.className),children:[r&&(0,Fr.jsx)(sm,{icon:r,className:"tlui-button__icon-left",small:!0}),c,e&&(0,Fr.jsxs)("span",{className:"tlui-button__label",draggable:!1,children:[p,s&&(0,Fr.jsx)(sm,{icon:"check"})]}),i&&(0,Fr.jsx)(dm,{children:i}),t&&!l&&(0,Fr.jsx)(sm,{icon:t,small:!!e||o,invertIcon:n}),l&&(0,Fr.jsx)(im,{})]})})),pm=t["useId".toString()]||(()=>{});let fm=0;function gm(t){const[n,r]=e.useState(pm());return sg((()=>{t||r((e=>null!=e?e:String(fm++)))}),[t]),t||(n?`radix-${n}`:"")}const mm="focusScope.autoFocusOnMount",_m="focusScope.autoFocusOnUnmount",ym={bubbles:!1,cancelable:!0},wm=(0,e.forwardRef)(((t,n)=>{const{loop:r=!1,trapped:o=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=t,[c,l]=(0,e.useState)(null),u=Xf(i),d=Xf(s),h=(0,e.useRef)(null),p=Nf(n,(e=>l(e))),f=(0,e.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,e.useEffect)((()=>{if(o){function e(e){if(f.paused||!c)return;const t=e.target;c.contains(t)?h.current=t:Sm(h.current,{select:!0})}function t(e){if(f.paused||!c)return;const t=e.relatedTarget;null!==t&&(c.contains(t)||Sm(h.current,{select:!0}))}function n(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&Sm(c)}document.addEventListener("focusin",e),document.addEventListener("focusout",t);const r=new MutationObserver(n);return c&&r.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}}),[o,c,f.paused]),(0,e.useEffect)((()=>{if(c){km.add(f);const e=document.activeElement;if(!c.contains(e)){const t=new CustomEvent(mm,ym);c.addEventListener(mm,u),c.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Sm(r,{select:t}),document.activeElement!==n)return}(vm(c).filter((e=>"A"!==e.tagName)),{select:!0}),document.activeElement===e&&Sm(c))}return()=>{c.removeEventListener(mm,u),setTimeout((()=>{const t=new CustomEvent(_m,ym);c.addEventListener(_m,d),c.dispatchEvent(t),t.defaultPrevented||Sm(null!=e?e:document.body,{select:!0}),c.removeEventListener(_m,d),km.remove(f)}),0)}}}),[c,u,d,f]);const g=(0,e.useCallback)((e=>{if(!r&&!o)return;if(f.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){const t=e.currentTarget,[o,i]=function(e){const t=vm(e);return[bm(t,e),bm(t.reverse(),e)]}(t);o&&i?e.shiftKey||n!==i?e.shiftKey&&n===o&&(e.preventDefault(),r&&Sm(i,{select:!0})):(e.preventDefault(),r&&Sm(o,{select:!0})):n===t&&e.preventDefault()}}),[r,o,f.paused]);return(0,e.createElement)(qf.div,zf({tabIndex:-1},a,{ref:p,onKeyDown:g}))}));function vm(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bm(e,t){for(const n of e)if(!xm(n,{upTo:t}))return n}function xm(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function Sm(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}const km=function(){let e=[];return{add(t){const n=e[0];t!==n&&(null==n||n.pause()),e=Cm(e,t),e.unshift(t)},remove(t){var n;e=Cm(e,t),null===(n=e[0])||void 0===n||n.resume()}}}();function Cm(e,t){const n=[...e],r=n.indexOf(t);return-1!==r&&n.splice(r,1),n}let Em=0;function Am(){(0,e.useEffect)((()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:Im()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:Im()),Em++,()=>{1===Em&&document.querySelectorAll("[data-radix-focus-guard]").forEach((e=>e.remove())),Em--}}),[])}function Im(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var Pm=function(){return Pm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pm.apply(this,arguments)};function Mm(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Tm="right-scroll-bar-position",jm="width-before-scroll-bar";function Dm(e){return e}var Om=function(e){void 0===e&&(e={});var t=function(e,t){void 0===t&&(t=Dm);var n=[],r=!1;return{read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var o=t(e,r);return n.push(o),function(){n=n.filter((function(e){return e!==o}))}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var o=n;n=[],o.forEach(e),t=n}var i=function(){var n=t;t=[],n.forEach(e)},s=function(){return Promise.resolve().then(i)};s(),n={push:function(e){t.push(e),s()},filter:function(e){return t=t.filter(e),n}}}}}(null);return t.options=Pm({async:!0,ssr:!1},e),t}(),zm=function(){},Fm=e.forwardRef((function(t,n){var r=e.useRef(null),o=e.useState({onScrollCapture:zm,onWheelCapture:zm,onTouchMoveCapture:zm}),i=o[0],s=o[1],a=t.forwardProps,c=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,p=t.sideCar,f=t.noIsolation,g=t.inert,m=t.allowPinchZoom,_=t.as,y=void 0===_?"div":_,w=Mm(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),v=p,b=function(t,n){return r=n||null,o=function(e){return t.forEach((function(t){return function(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}(t,e)}))},i=(0,e.useState)((function(){return{value:r,callback:o,facade:{get current(){return i.value},set current(e){var t=i.value;t!==e&&(i.value=e,i.callback(e,t))}}}}))[0],i.callback=o,i.facade;var r,o,i}([r,n]),x=Pm(Pm({},w),i);return e.createElement(e.Fragment,null,d&&e.createElement(v,{sideCar:Om,removeScrollBar:u,shards:h,noIsolation:f,inert:g,setCallbacks:s,allowPinchZoom:!!m,lockRef:r}),a?e.cloneElement(e.Children.only(c),Pm(Pm({},x),{ref:b})):e.createElement(y,Pm({},x,{className:l,ref:b}),c))}));Fm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},Fm.classNames={fullWidth:jm,zeroRight:Tm};var Rm=function(t){var n=t.sideCar,r=Mm(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var o=n.read();if(!o)throw new Error("Sidecar medium not found");return e.createElement(o,Pm({},r))};Rm.isSideCarExport=!0;var Lm=function(){var e=0,t=null;return{add:function(n){var r,i;0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=o.nc;return t&&e.setAttribute("nonce",t),e}())&&(i=n,(r=t).styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){! --e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Nm=function(){var t,n=(t=Lm(),function(n,r){e.useEffect((function(){return t.add(n),function(){t.remove()}}),[n&&r])});return function(e){var t=e.styles,r=e.dynamic;return n(t,r),null}},Bm={left:0,top:0,right:0,gap:0},$m=function(e){return parseInt(e||"",10)||0},Um=Nm(),Vm=function(e,t,n,r){var o=e.left,i=e.top,s=e.right,a=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(a,"px ").concat(r,";\n  }\n  body {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(o,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(s,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(Tm," {\n    right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(jm," {\n    margin-right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(Tm," .").concat(Tm," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(jm," .").concat(jm," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},Wm=function(t){var n=t.noRelative,r=t.noImportant,o=t.gapMode,i=void 0===o?"margin":o,s=e.useMemo((function(){return function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return Bm;var t=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],o=t["padding"===e?"paddingRight":"marginRight"];return[$m(n),$m(r),$m(o)]}(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}}(i)}),[i]);return e.createElement(Um,{styles:Vm(s,!n,i,r?"":"!important")})},Km=!1;if("undefined"!=typeof window)try{var Hm=Object.defineProperty({},"passive",{get:function(){return Km=!0,!0}});window.addEventListener("test",Hm,Hm),window.removeEventListener("test",Hm,Hm)}catch(e){Km=!1}var Gm=!!Km&&{passive:!1},qm=function(e,t){var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===n[t])},Ym=function(e,t){var n=t;do{if("undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot&&(n=n.host),Xm(e,n)){var r=Zm(e,n);if(r[1]>r[2])return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Xm=function(e,t){return"v"===e?function(e){return qm(e,"overflowY")}(t):function(e){return qm(e,"overflowX")}(t)},Zm=function(e,t){return"v"===e?[(n=t).scrollTop,n.scrollHeight,n.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var n},Qm=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Jm=function(e){return[e.deltaX,e.deltaY]},e_=function(e){return e&&"current"in e?e.current:e},t_=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},n_=0,r_=[];const o_=(i_=function(t){var n=e.useRef([]),r=e.useRef([0,0]),o=e.useRef(),i=e.useState(n_++)[0],s=e.useState((function(){return Nm()}))[0],a=e.useRef(t);e.useEffect((function(){a.current=t}),[t]),e.useEffect((function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var e=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([t.lockRef.current],(t.shards||[]).map(e_),!0).filter(Boolean);return e.forEach((function(e){return e.classList.add("allow-interactivity-".concat(i))})),function(){document.body.classList.remove("block-interactivity-".concat(i)),e.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(i))}))}}}),[t.inert,t.lockRef.current,t.shards]);var c=e.useCallback((function(e,t){if("touches"in e&&2===e.touches.length)return!a.current.allowPinchZoom;var n,i=Qm(e),s=r.current,c="deltaX"in e?e.deltaX:s[0]-i[0],l="deltaY"in e?e.deltaY:s[1]-i[1],u=e.target,d=Math.abs(c)>Math.abs(l)?"h":"v";if("touches"in e&&"h"===d&&"range"===u.type)return!1;var h=Ym(d,u);if(!h)return!0;if(h?n=d:(n="v"===d?"h":"v",h=Ym(d,u)),!h)return!1;if(!o.current&&"changedTouches"in e&&(c||l)&&(o.current=n),!n)return!0;var p=o.current||n;return function(e,t,n,r,o){var i=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),s=i*r,a=n.target,c=t.contains(a),l=!1,u=s>0,d=0,h=0;do{var p=Zm(e,a),f=p[0],g=p[1]-p[2]-i*f;(f||g)&&Xm(e,a)&&(d+=g,h+=f),a=a.parentNode}while(!c&&a!==document.body||c&&(t.contains(a)||t===a));return(u&&(0===d||!1)||!u&&(0===h||!1))&&(l=!0),l}(p,t,e,"h"===p?c:l)}),[]),l=e.useCallback((function(e){var t=e;if(r_.length&&r_[r_.length-1]===s){var r="deltaY"in t?Jm(t):Qm(t),o=n.current.filter((function(e){return e.name===t.type&&e.target===t.target&&(n=e.delta,o=r,n[0]===o[0]&&n[1]===o[1]);var n,o}))[0];if(o&&o.should)t.cancelable&&t.preventDefault();else if(!o){var i=(a.current.shards||[]).map(e_).filter(Boolean).filter((function(e){return e.contains(t.target)}));(i.length>0?c(t,i[0]):!a.current.noIsolation)&&t.cancelable&&t.preventDefault()}}}),[]),u=e.useCallback((function(e,t,r,o){var i={name:e,delta:t,target:r,should:o};n.current.push(i),setTimeout((function(){n.current=n.current.filter((function(e){return e!==i}))}),1)}),[]),d=e.useCallback((function(e){r.current=Qm(e),o.current=void 0}),[]),h=e.useCallback((function(e){u(e.type,Jm(e),e.target,c(e,t.lockRef.current))}),[]),p=e.useCallback((function(e){u(e.type,Qm(e),e.target,c(e,t.lockRef.current))}),[]);e.useEffect((function(){return r_.push(s),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:p}),document.addEventListener("wheel",l,Gm),document.addEventListener("touchmove",l,Gm),document.addEventListener("touchstart",d,Gm),function(){r_=r_.filter((function(e){return e!==s})),document.removeEventListener("wheel",l,Gm),document.removeEventListener("touchmove",l,Gm),document.removeEventListener("touchstart",d,Gm)}}),[]);var f=t.removeScrollBar,g=t.inert;return e.createElement(e.Fragment,null,g?e.createElement(s,{styles:t_(i)}):null,f?e.createElement(Wm,{gapMode:"margin"}):null)},Om.useMedium(i_),Rm);var i_,s_=e.forwardRef((function(t,n){return e.createElement(Fm,Pm({},t,{ref:n,sideCar:o_}))}));s_.classNames=Fm.classNames;const a_=s_;var c_=new WeakMap,l_=new WeakMap,u_={},d_=0,h_=function(e){return e&&(e.host||h_(e.parentNode))},p_=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),o=t||function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body}(e);return o?(r.push.apply(r,Array.from(o.querySelectorAll("[aria-live]"))),function(e,t,n,r){var o=function(e,t){return t.map((function(t){if(e.contains(t))return t;var n=h_(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)})).filter((function(e){return Boolean(e)}))}(t,Array.isArray(e)?e:[e]);u_[n]||(u_[n]=new WeakMap);var i=u_[n],s=[],a=new Set,c=new Set(o),l=function(e){e&&!a.has(e)&&(a.add(e),l(e.parentNode))};o.forEach(l);var u=function(e){e&&!c.has(e)&&Array.prototype.forEach.call(e.children,(function(e){if(a.has(e))u(e);else{var t=e.getAttribute(r),o=null!==t&&"false"!==t,c=(c_.get(e)||0)+1,l=(i.get(e)||0)+1;c_.set(e,c),i.set(e,l),s.push(e),1===c&&o&&l_.set(e,!0),1===l&&e.setAttribute(n,"true"),o||e.setAttribute(r,"true")}}))};return u(t),a.clear(),d_++,function(){s.forEach((function(e){var t=c_.get(e)-1,o=i.get(e)-1;c_.set(e,t),i.set(e,o),t||(l_.has(e)||e.removeAttribute(r),l_.delete(e)),o||e.removeAttribute(n)})),--d_||(c_=new WeakMap,c_=new WeakMap,l_=new WeakMap,u_={})}}(r,o,n,"aria-hidden")):function(){return null}};const f_="Dialog",[g_,m_]=Bf(f_),[__,y_]=g_(f_),w_="DialogPortal",[v_,b_]=g_(w_,{forceMount:void 0}),x_="DialogOverlay",S_=(0,e.forwardRef)(((t,n)=>{const r=b_(x_,t.__scopeDialog),{forceMount:o=r.forceMount,...i}=t,s=y_(x_,t.__scopeDialog);return s.modal?(0,e.createElement)(ag,{present:o||s.open},(0,e.createElement)(k_,zf({},i,{ref:n}))):null})),k_=(0,e.forwardRef)(((t,n)=>{const{__scopeDialog:r,...o}=t,i=y_(x_,r);return(0,e.createElement)(a_,{as:Uf,allowPinchZoom:!0,shards:[i.contentRef]},(0,e.createElement)(qf.div,zf({"data-state":D_(i.open)},o,{ref:n,style:{pointerEvents:"auto",...o.style}})))})),C_="DialogContent",E_=(0,e.forwardRef)(((t,n)=>{const r=b_(C_,t.__scopeDialog),{forceMount:o=r.forceMount,...i}=t,s=y_(C_,t.__scopeDialog);return(0,e.createElement)(ag,{present:o||s.open},s.modal?(0,e.createElement)(A_,zf({},i,{ref:n})):(0,e.createElement)(I_,zf({},i,{ref:n})))})),A_=(0,e.forwardRef)(((t,n)=>{const r=y_(C_,t.__scopeDialog),o=(0,e.useRef)(null),i=Nf(n,r.contentRef,o);return(0,e.useEffect)((()=>{const e=o.current;if(e)return p_(e)}),[]),(0,e.createElement)(P_,zf({},t,{ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Rf(t.onCloseAutoFocus,(e=>{var t;e.preventDefault(),null===(t=r.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:Rf(t.onPointerDownOutside,(e=>{const t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()})),onFocusOutside:Rf(t.onFocusOutside,(e=>e.preventDefault()))}))})),I_=(0,e.forwardRef)(((t,n)=>{const r=y_(C_,t.__scopeDialog),o=(0,e.useRef)(!1),i=(0,e.useRef)(!1);return(0,e.createElement)(P_,zf({},t,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{var n,s;null===(n=t.onCloseAutoFocus)||void 0===n||n.call(t,e),e.defaultPrevented||(o.current||null===(s=r.triggerRef.current)||void 0===s||s.focus(),e.preventDefault()),o.current=!1,i.current=!1},onInteractOutside:e=>{var n,s;null===(n=t.onInteractOutside)||void 0===n||n.call(t,e),e.defaultPrevented||(o.current=!0,"pointerdown"===e.detail.originalEvent.type&&(i.current=!0));const a=e.target;(null===(s=r.triggerRef.current)||void 0===s?void 0:s.contains(a))&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&i.current&&e.preventDefault()}}))})),P_=(0,e.forwardRef)(((t,n)=>{const{__scopeDialog:r,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=t,c=y_(C_,r),l=Nf(n,(0,e.useRef)(null));return Am(),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(wm,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:i,onUnmountAutoFocus:s},(0,e.createElement)(eg,zf({role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":D_(c.open)},a,{ref:l,onDismiss:()=>c.onOpenChange(!1)}))),!1)})),M_="DialogTitle",T_=(0,e.forwardRef)(((t,n)=>{const{__scopeDialog:r,...o}=t,i=y_(M_,r);return(0,e.createElement)(qf.h2,zf({id:i.titleId},o,{ref:n}))})),j_=(0,e.forwardRef)(((t,n)=>{const{__scopeDialog:r,...o}=t,i=y_("DialogClose",r);return(0,e.createElement)(qf.button,zf({type:"button"},o,{ref:n,onClick:Rf(t.onClick,(()=>i.onOpenChange(!1)))}))}));function D_(e){return e?"open":"closed"}const[O_,z_]=function(t,n){const r=(0,e.createContext)(n);function o(t){const{children:n,...o}=t,i=(0,e.useMemo)((()=>o),Object.values(o));return(0,e.createElement)(r.Provider,{value:i},n)}return o.displayName=t+"Provider",[o,function(o){const i=(0,e.useContext)(r);if(i)return i;if(void 0!==n)return n;throw new Error(`\`${o}\` must be used within \`${t}\``)}]}("DialogTitleWarning",{contentName:C_,titleName:M_,docsSlug:"dialog"}),F_=t=>{const{__scopeDialog:n,children:r,open:o,defaultOpen:i,onOpenChange:s,modal:a=!0}=t,c=(0,e.useRef)(null),l=(0,e.useRef)(null),[u=!1,d]=lg({prop:o,defaultProp:i,onChange:s});return(0,e.createElement)(__,{scope:n,triggerRef:c,contentRef:l,contentId:gm(),titleId:gm(),descriptionId:gm(),open:u,onOpenChange:d,onOpenToggle:(0,e.useCallback)((()=>d((e=>!e))),[d]),modal:a},r)},R_=t=>{const{__scopeDialog:n,forceMount:r,children:o,container:i}=t,s=y_(w_,n);return(0,e.createElement)(v_,{scope:n,forceMount:r},e.Children.map(o,(t=>(0,e.createElement)(ag,{present:r||s.open},(0,e.createElement)(ig,{asChild:!0,container:i},t)))))},L_=S_,N_=E_;function B_({className:e,children:t}){return(0,Fr.jsx)("div",{className:Rr("tlui-dialog__header",e),children:t})}function $_({className:e,children:t}){return(0,Fr.jsx)(T_,{dir:"ltr",className:Rr("tlui-dialog__header__title",e),children:t})}function U_(){return(0,Fr.jsx)("div",{className:"tlui-dialog__header__close",children:(0,Fr.jsx)(j_,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:(0,Fr.jsx)(hm,{type:"icon","aria-label":"Close",onTouchEnd:e=>e.target.click(),children:(0,Fr.jsx)(sm,{small:!0,icon:"cross-2"})})})})}function V_({className:e,children:t,style:n}){return(0,Fr.jsx)("div",{className:Rr("tlui-dialog__body",e),style:n,children:t})}function W_({className:e,children:t}){return(0,Fr.jsx)("div",{className:Rr("tlui-dialog__footer",e),children:t})}const K_=e.forwardRef((function({className:t,label:n,icon:r,iconLeft:o,autoselect:i=!1,autofocus:s=!1,defaultValue:a,placeholder:c,onComplete:l,onValueChange:u,onCancel:d,onBlur:h,shouldManuallyMaintainScrollPositionWhenFocused:p=!1,children:f,value:g},m){const _=Yr(),y=e.useRef(null);e.useImperativeHandle(m,(()=>y.current));const w=om(),v=e.useRef(a??""),b=e.useRef(a??""),[x,S]=e.useState(!1),k=e.useCallback((e=>{S(!0);const t=e.currentTarget;b.current=t.value,requestAnimationFrame((()=>{i&&t.select()}))}),[i]),C=e.useCallback((e=>{const t=e.currentTarget.value;b.current=t,u?.(t)}),[u]),E=e.useCallback((e=>{switch(e.key){case"Enter":e.currentTarget.blur(),Hr(e),l?.(e.currentTarget.value);break;case"Escape":e.currentTarget.value=v.current,e.currentTarget.blur(),Hr(e),d?.(e.currentTarget.value)}}),[l,d]),A=e.useCallback((e=>{S(!1);const t=e.currentTarget.value;h?.(t)}),[h]);return e.useEffect((()=>{if(!_.environment.isIos)return;const e=window.visualViewport;if(x&&p&&e){const t=()=>{y.current?.scrollIntoView({block:"center"})};return e.addEventListener("resize",t),e.addEventListener("scroll",t),requestAnimationFrame((()=>{y.current?.scrollIntoView({block:"center"})})),()=>{e.removeEventListener("resize",t),e.removeEventListener("scroll",t)}}}),[_,x,p]),(0,Fr.jsxs)("div",{draggable:!1,className:"tlui-input__wrapper",children:[f,n&&(0,Fr.jsx)("label",{children:w(n)}),o&&(0,Fr.jsx)(sm,{icon:o,className:"tlui-icon-left",small:!0}),(0,Fr.jsx)("input",{ref:y,className:Rr("tlui-input",t),type:"text",defaultValue:a,onKeyUp:E,onChange:C,onFocus:k,onBlur:A,autoFocus:s,placeholder:c,value:g}),r&&(0,Fr.jsx)(sm,{icon:r,small:!!n})]})}));function H_(e){return Ue(e)?{isValid:!0,hasProtocol:!0}:Ue("https://"+e)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const G_=se((function({onClose:e}){const t=Yr().getOnlySelectedShape();return t&&"url"in t.props&&"string"==typeof t.props.url?(0,Fr.jsx)(q_,{onClose:e,selectedShape:t}):null})),q_=se((function({onClose:t,selectedShape:n}){const r=Yr(),o=om(),i=(0,e.useRef)(null);(0,e.useEffect)((()=>{requestAnimationFrame((()=>i.current?.focus()))}),[]);const s=(0,e.useRef)(n.props.url),[a,c]=(0,e.useState)((()=>{const e=H_(n.props.url),t=!0===e.isValid?e.hasProtocol?n.props.url:"https://"+n.props.url:"https://";return{actual:t,safe:t,valid:!0}})),l=(0,e.useCallback)((e=>{const t=e.replace(/https?:\/\/(https?:\/\/)/,((e,t)=>t)),n=H_(t),r=!0===n.isValid?n.hasProtocol?t:"https://"+t:"https://";c({actual:t,safe:r,valid:n.isValid})}),[]),u=(0,e.useCallback)((()=>{const e=r.getOnlySelectedShape();e&&(r.updateShapes([{id:e.id,type:e.type,props:{url:""}}]),t())}),[r,t]),d=(0,e.useCallback)((()=>{const e=r.getOnlySelectedShape();e&&(e&&"url"in e.props&&e.props.url!==a.safe&&r.updateShapes([{id:e.id,type:e.type,props:{url:a.safe}}]),t())}),[r,t,a]),h=(0,e.useCallback)((()=>{t()}),[t]);if(!n)return t(),null;const p=s.current&&!a.valid;return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(B_,{children:[(0,Fr.jsx)($_,{children:o("edit-link-dialog.title")}),(0,Fr.jsx)(U_,{})]}),(0,Fr.jsx)(V_,{children:(0,Fr.jsxs)("div",{className:"tlui-edit-link-dialog",children:[(0,Fr.jsx)(K_,{ref:i,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:a.actual,onValueChange:l,onComplete:d,onCancel:h}),(0,Fr.jsx)("div",{children:a.valid?o("edit-link-dialog.detail"):o("edit-link-dialog.invalid-url")})]})}),(0,Fr.jsxs)(W_,{className:"tlui-dialog__footer__actions",children:[(0,Fr.jsx)(hm,{type:"normal",onClick:h,onTouchEnd:h,children:o("edit-link-dialog.cancel")}),p?(0,Fr.jsx)(hm,{type:"danger",onTouchEnd:u,onClick:u,children:o("edit-link-dialog.clear")}):(0,Fr.jsx)(hm,{type:"primary",disabled:!a.valid,onTouchEnd:d,onClick:d,children:o("edit-link-dialog.save")})]})]})})),Y_=se((function({onClose:t}){const n=Yr(),r=om(),o=Qg(),[i,s]=(0,e.useState)(null),[a,c]=(0,e.useState)(""),[l,u]=(0,e.useState)(null),[d,h]=(0,e.useState)(!1),p=(0,e.useRef)(-1);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(B_,{children:[(0,Fr.jsx)($_,{children:i?`${r("embed-dialog.title")}  ${i.title}`:r("embed-dialog.title")}),(0,Fr.jsx)(U_,{})]}),i?(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(V_,{className:"tlui-embed-dialog__enter",children:[(0,Fr.jsx)(K_,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:e=>{c(e);const t=kd(e);u(t&&t.definition.type===i.type?t:null),h(!1),clearTimeout(p.current),p.current=setTimeout((()=>h(!t)),320)}}),""===a?(0,Fr.jsxs)("div",{className:"tlui-embed-dialog__instruction",children:[(0,Fr.jsx)("span",{children:r("embed-dialog.instruction")})," ",i.instructionLink&&(0,Fr.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:i.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",(0,Fr.jsx)(sm,{icon:"external-link",small:!0})]})]}):(0,Fr.jsx)("div",{className:"tlui-embed-dialog__warning",children:d?r("embed-dialog.invalid-url"):""})]}),(0,Fr.jsxs)(W_,{className:"tlui-dialog__footer__actions",children:[(0,Fr.jsx)(hm,{type:"normal",onClick:()=>{s(null),u(null),c("")},label:"embed-dialog.back"}),(0,Fr.jsx)("div",{className:"tlui-embed__spacer"}),(0,Fr.jsx)(hm,{type:"normal",label:"embed-dialog.cancel",onClick:t}),(0,Fr.jsx)(hm,{type:"primary",disabled:!l,label:"embed-dialog.create",onClick:()=>{l&&(n.putExternalContent({type:"embed",url:a,point:n.getViewportPageCenter(),embed:l.definition}),t())}})]})]}):(0,Fr.jsx)(Fr.Fragment,{children:(0,Fr.jsx)(V_,{className:"tlui-embed-dialog__list",children:ir.map((e=>(0,Fr.jsx)(hm,{type:"menu",onClick:()=>s(e),label:e.title,children:(0,Fr.jsx)("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${o.embedIcons[e.type]})`}})},e.type)))})})]})}));var X_=o(6961);async function Z_(e,t,n){const{elements:r,files:o}=t,i={shapes:[],rootShapeIds:[],assets:[],schema:e.store.schema.serialize()},s=new Map,a=new Map,c=e.getCurrentPageId(),l=new Map,u=[],d=new Set;r.forEach((e=>{if(l.set(e.id,jn()),null!==e.boundElements)for(const t of e.boundElements)"text"===t.type&&d.add(t.id)}));let h="a1";for(const e of r){if(d.has(e.id))continue;const t=l.get(e.id),n={id:t,typeName:"shape",parentId:c,index:h,x:e.x,y:e.y,rotation:0,isLocked:e.locked,opacity:Q_(e.opacity),meta:{}};switch(0!==e.angle&&a.set(t,e.angle),e.groupIds&&e.groupIds.length>0?s.has(e.groupIds[0])?s.get(e.groupIds[0])?.push(t):s.set(e.groupIds[0],[t]):u.push(t),e.type){case"rectangle":case"ellipse":case"diamond":{let t="",o="middle";if(null!==e.boundElements)for(const n of e.boundElements)if("text"===n.type){const e=r.find((e=>e.id===n.id));e&&(t=e.text,o=sy[e.textAlign])}const s="transparent"===e.backgroundColor?e.strokeColor:e.backgroundColor;i.shapes.push({...n,type:"geo",props:{geo:e.type,url:e.link??"",w:e.width,h:e.height,size:J_[e.strokeWidth]??"draw",color:ry[s]??"black",text:t,align:o,dash:ly(e),fill:uy(e)}});break}case"freedraw":i.shapes.push({...n,type:"draw",props:{dash:ly(e),size:J_[e.strokeWidth],color:ry[e.strokeColor]??"black",segments:[{type:"free",points:e.points.map((([e,t,n=.5])=>({x:e,y:t,z:n})))}]}});break;case"line":{const t=e.points[0],r=e.points[e.points.length-1],o=pc(e.points.length);i.shapes.push({...n,type:"line",props:{dash:ly(e),size:J_[e.strokeWidth],color:ry[e.strokeColor]??"black",spline:e.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:o[0],x:t[0],y:t[1]},end:{id:"end",type:"vertex",index:o[o.length-1],x:r[0],y:r[1]},...Object.fromEntries(e.points.slice(1,-1).map((([e,t],n)=>{const r=ua();return[r,{id:r,type:"vertex",index:o[n+1],x:e,y:t}]})))}}});break}case"arrow":{let t="";if(null!==e.boundElements)for(const n of e.boundElements)if("text"===n.type){const e=r.find((e=>e.id===n.id));e&&(t=e.text)}const o=e.points[0],s=e.points[e.points.length-1],a=l.get(e.startBinding?.elementId),c=l.get(e.endBinding?.elementId);i.shapes.push({...n,type:"arrow",props:{text:t,bend:cy(e,o,s),dash:ly(e),size:J_[e.strokeWidth]??"m",color:ry[e.strokeColor]??"black",start:a?{type:"binding",boundShapeId:a,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:o[0],y:o[1]},end:c?{type:"binding",boundShapeId:c,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:s[0],y:s[1]},arrowheadEnd:ay[e.endArrowhead]??"none",arrowheadStart:ay[e.startArrowhead]??"none"}});break}case"text":{const{size:t,scale:r}=ty(e.fontSize);i.shapes.push({...n,type:"text",props:{size:t,scale:r,font:ny[e.fontFamily]??"draw",color:ry[e.strokeColor]??"black",text:e.text,align:sy[e.textAlign]}});break}case"image":{const t=o[e.fileId];if(!t)break;const r=Cn.createId();i.assets.push({id:r,typeName:"asset",type:"image",props:{w:e.width,h:e.height,name:e.id??"Untitled",isAnimated:!1,mimeType:t.mimeType,src:t.dataURL},meta:{}}),i.shapes.push({...n,type:"image",props:{w:e.width,h:e.height,assetId:r}})}}h=hc(h)}const p=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContentOntoCurrentPage(i,{point:p,select:!1,preserveIds:!0});for(const t of s.values())if(t.length>1){e.groupShapes(t);const n=e.getShape(t[0]);n?.parentId&&Tn(n.parentId)&&u.push(n.parentId)}for(const[t,n]of a)e.select(t),e.rotateShapesBy([t],n);const f=he(u.map((t=>e.getShape(t)))),g=fo.Common(f.map((t=>e.getShapePageBounds(t)))),m=e.getViewportPageBounds().center;e.updateShapes(f.map((e=>{const t=(e.x??0)-(g.x+g.w/2),n=(e.y??0)-(g.y+g.h/2);return{id:e.id,type:e.type,x:m.x+t,y:m.y+n}}))),e.setSelectedShapes(u)}const Q_=e=>{const t=e/100;return t<.2?.1:t<.4?.25:t<.6?.5:t<.8?.75:1},J_={1:"s",2:"m",3:"l",4:"xl"},ey={16:"s",20:"m",28:"l",36:"xl"};function ty(e){const t=ey[e];return t?{size:t,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}const ny={1:"draw",2:"sans",3:"mono"},ry={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},oy={solid:"draw",dashed:"dashed",dotted:"dotted"},iy={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},sy={left:"start",center:"middle",right:"end"},ay={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function cy(e,t,n){let r=0;if(e.points.length>2){const o=new ho(t[0],t[1]),i=new ho(n[0],n[1]),s=new ho(e.points[1][0],e.points[1][1]),a=ho.Sub(i,o),c=ho.Per(a),l=ho.Med(i,o),u=ho.Sub(l,c),d=ho.Add(l,c),h=ho.NearestPointOnLineSegment(u,d,s,!1);r=ho.Dist(h,l),ho.Clockwise(h,i,l)&&(r*=-1)}return r}const ly=e=>{let t=oy[e.strokeStyle]??"draw";return"draw"===t&&0===e.roughness&&(t="solid"),t},uy=e=>"transparent"===e.backgroundColor?"none":iy[e.fillStyle]??"solid";async function dy(e,t,n,r){const o=(await Promise.all(t.map((async e=>await(await fetch(e)).blob())))).map((e=>new File([e],"tldrawFile",{type:e.type})));e.mark("paste"),await e.putExternalContent({type:"files",files:o,point:n,ignoreParent:!1,sources:r}),t.forEach((e=>URL.revokeObjectURL(e)))}function hy(e,t,n){const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContentOntoCurrentPage(t,{point:r,select:!0})}async function py(e,t,n,r){try{if(new URL(t).pathname.match(/\.(png|jpe?g|gif|svg|webp)$/i)){const n=await fetch(t,{method:"HEAD"});if(n.headers.get("content-type")?.match(/^image\//))return e.mark("paste"),void dy(e,[t])}}catch(e){"Failed to fetch"!==e.message&&console.error(e)}return e.mark("paste"),await e.putExternalContent({type:"url",point:n,url:t,sources:r})}const fy=()=>{},gy=e.createContext({});function my({onEvent:e,children:t}){return(0,Fr.jsx)(gy.Provider,{value:e??fy,children:t})}function _y(){return e.useContext(gy)??fy}function yy(e){const t=document.implementation.createHTMLDocument("");return t.documentElement.innerHTML=e.trim(),t.body.textContent||t.body.innerText||""}const wy=["input","select","textarea"];function vy(e){const{activeElement:t}=document;return e.getIsMenuOpen()||t&&(t.getAttribute("contenteditable")||wy.indexOf(t.tagName.toLowerCase())>-1)}async function by(e){return new Promise(((t,n)=>{const r=new FileReader;r.addEventListener("loadend",(()=>{const e=r.result;t(e)})),r.addEventListener("error",(()=>{n(r.error)})),r.readAsText(e)}))}const xy=e=>e.types.find((e=>e.match(/^image\//))),Sy=(e,t,n,r)=>{const o=(e=>{const t=e.split(/[\n\s]/);for(const e of t)try{const t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)return}catch(e){return}return As(t)})(t);if(o)for(const t of o)py(e,t,n);else(e=>{try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){return!1}})(t)?py(e,t,n):/^<svg/.test(t)?(e.mark("paste"),e.putExternalContent({type:"svg-text",text:t,point:n,sources:r})):(e.mark("paste"),e.putExternalContent({type:"text",text:t,point:n,sources:r}))},ky=async(e,t,n)=>{const r=[];for(const e of t){if(xy(e))for(const t of e.types)t.match(/^image\//)&&r.push({type:"blob",source:e.getType(t)});e.types.includes("text/html")&&r.push({type:"html",source:new Promise((t=>e.getType("text/html").then((e=>by(e).then(t)))))}),e.types.includes("text/uri-list")&&r.push({type:"url",source:new Promise((t=>e.getType("text/uri-list").then((e=>by(e).then(t)))))}),e.types.includes("text/plain")&&r.push({type:"text",source:new Promise((t=>e.getType("text/plain").then((e=>by(e).then(t)))))})}return await Cy(e,r,n)};async function Cy(e,t,n){const r=t.filter((e=>("file"===e.type||"blob"===e.type)&&null!==e.source));if(r.length){const t=await Promise.all(r.map((e=>e.source))),o=t.filter(Boolean).map((e=>URL.createObjectURL(e)));return await dy(e,o,n)}const o=await Promise.all(t.filter((e=>"file"!==e.type)).map((e=>new Promise((t=>{const n=e;"file"!==n.type?n.source.then((e=>{const r=e.match(/<tldraw[^>]*>(.*)<\/tldraw>/)?.[1];if(r)try{const e=(0,X_.decompressFromBase64)(r);if(null===e)return void t({type:"error",data:e,reason:"found tldraw data comment but could not parse base64"});{const n=JSON.parse(e);return"application/tldraw"!==n.type&&t({type:"error",data:n,reason:`found tldraw data comment but JSON was of a different type: ${n.type}`}),"string"==typeof n.data?void t({type:"error",data:n,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"}):void t({type:"tldraw",data:n.data})}}catch(e){return void t({type:"error",data:r,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"})}else{if("html"===n.type)return void t({type:"text",data:e,subtype:"html"});if("url"===n.type)return void t({type:"text",data:e,subtype:"url"});try{const n=JSON.parse(e);return"excalidraw/clipboard"===n.type?void t({type:"excalidraw",data:n}):void t({type:"text",data:e,subtype:"json"})}catch(n){return void t({type:"text",data:e,subtype:"text"})}}t({type:"error",data:e,reason:"unhandled case"})})):t({type:"error",data:null,reason:"unexpected file"})})))));for(const t of o)if("tldraw"===t.type)return void hy(e,t.data,n);for(const t of o)if("excalidraw"===t.type)return void Z_(e,t.data,n);for(const t of o)if("text"===t.type&&"html"===t.subtype){const r=(new DOMParser).parseFromString(t.data,"text/html").querySelector("body");if(r&&1===Array.from(r.children).filter((e=>1===e.nodeType)).length&&r.firstElementChild&&"A"===r.firstElementChild.tagName&&r.firstElementChild.hasAttribute("href")&&""!==r.firstElementChild.getAttribute("href")){const t=r.firstElementChild.getAttribute("href");return void Sy(e,t,n,o)}if(!o.some((e=>"text"===e.type&&"html"!==e.subtype))&&t.data.trim())return void Sy(e,yy(t.data),n,o)}for(const t of o)if("text"===t.type&&"url"===t.subtype)return void py(e,t.data,n,o);for(const t of o)if("text"===t.type&&"text"===t.subtype&&t.data.trim())return void Sy(e,t.data,n,o)}const Ey=e=>{const t=e.getContentFromCurrentPage(e.getSelectedShapeIds());if(!t)return void(navigator&&navigator.clipboard&&navigator.clipboard.writeText(""));const n=(0,X_.compressToBase64)(JSON.stringify({type:"application/tldraw",kind:"content",data:t}));if("undefined"!=typeof navigator){const r=t.shapes.map((t=>e.isShapeOfType(t,"text")||e.isShapeOfType(t,"geo")||e.isShapeOfType(t,"arrow")?t.props.text:e.isShapeOfType(t,"bookmark")||e.isShapeOfType(t,"embed")?t.props.url:null)).filter(Ve);if(navigator.clipboard?.write){const e=new Blob([`<tldraw>${n}</tldraw>`],{type:"text/html"});let t=r.join(" ");""===t&&(t=" "),navigator.clipboard.write([new ClipboardItem({"text/html":e,"text/plain":new Blob([t],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${n}</tldraw>`)}};async function Ay(e,t,n){const{type:r,quality:o,scale:i}=n,s=+e.getAttribute("width"),a=+e.getAttribute("height");let c=s*i,l=a*i;const u=await Iy(e),d=await wd();if(s>d.maxWidth&&(c=d.maxWidth,l=c/s*a),a>d.maxHeight&&(l=d.maxHeight,c=l/a*s),c*l>d.maxArea){const e=Math.sqrt(d.maxArea/(c*l));c*=e,l*=e}c=Math.floor(c),l=Math.floor(l);const h=c/s,p=await new Promise((e=>{const n=new Image;n.crossOrigin="anonymous",n.onload=async()=>{t&&await new Promise((e=>setTimeout(e,250)));const r=document.createElement("canvas"),o=r.getContext("2d");r.width=c,r.height=l,o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(n,0,0,c,l),URL.revokeObjectURL(u),e(r)},n.onerror=()=>{e(null)},n.src=u}));if(!p)return null;const f=await new Promise((e=>p.toBlob((t=>{t&&!Nr.throwToBlob.get()||e(null),e(t)}),"image/"+r,o)));if(!f)return null;const g=new DataView(await f.arrayBuffer());return ke.setPhysChunk(g,h,{type:"image/"+r})}async function Iy(e){const t=e.cloneNode(!0);t.setAttribute("encoding",'UTF-8"');const n=new FileReader,r=Array.from(t.querySelectorAll("image"));for(const e of r){const t=e.getAttribute("xlink:href");if(t&&!t.startsWith("data:")){const r=await(await fetch(t)).blob(),o=await new Promise(((e,t)=>{n.onload=()=>e(n.result),n.onerror=()=>t(n.error),n.readAsDataURL(r)}));e.setAttribute("xlink:href",o)}}const o=(new XMLSerializer).serializeToString(t);return`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(o)))}`}async function Py(e){navigator.clipboard?.writeText?.(await e())}function My(e){const t=e.cloneNode(!0);return e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+""),(new XMLSerializer).serializeToString(t).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}const Ty=(0,e.createContext)({});function jy({children:t}){const[n,r]=(0,e.useState)([]),o=(0,e.useCallback)((e=>{const t=e.id??ua();return r((n=>[...n.filter((t=>t.id!==e.id)),{...e,id:t}])),t}),[]),i=(0,e.useCallback)((e=>(r((t=>t.filter((t=>t.id!==e)))),e)),[]),s=(0,e.useCallback)((()=>{r((()=>[]))}),[]);return(0,Fr.jsx)(Ty.Provider,{value:{toasts:n,addToast:o,removeToast:i,clearToasts:s},children:t})}function Dy(){const t=(0,e.useContext)(Ty);if(!t)throw new Error("useToasts must be used within a ToastsProvider");return t}const Oy=(0,e.createContext)({});function zy({children:t}){const n=Yr(),r=_y(),[o,i]=(0,e.useState)([]),s=(0,e.useCallback)((e=>{const t=e.id??ua();return i((n=>[...n.filter((t=>t.id!==e.id)),{...e,id:t}])),r("open-menu",{source:"dialog",id:t}),n.addOpenMenu(t),t}),[n,r]),a=(0,e.useCallback)(((e,t)=>(i((n=>n.map((n=>n.id===e?{...n,...t}:n)))),r("open-menu",{source:"dialog",id:e}),n.addOpenMenu(e),e)),[n,r]),c=(0,e.useCallback)((e=>(i((t=>t.filter((t=>t.id!==e||(t.onClose?.(),!1))))),r("close-menu",{source:"dialog",id:e}),n.deleteOpenMenu(e),e)),[n,r]),l=(0,e.useCallback)((()=>{i((e=>(e.forEach((e=>{e.onClose?.(),r("close-menu",{source:"dialog",id:e.id}),n.deleteOpenMenu(e.id)})),[])))}),[n,r]);return(0,Fr.jsx)(Oy.Provider,{value:{dialogs:o,addDialog:s,removeDialog:c,clearDialogs:l,updateDialog:a},children:t})}function Fy(){const t=(0,e.useContext)(Oy);if(!t)throw new Error("useDialogs must be used within a DialogsProvider");return t}function Ry(e,t){const n=document.createElement("a");n.href=e,n.download=t,n.click()}function Ly(){const t=Yr(),{addToast:n}=Dy(),r=om();return(0,e.useCallback)(((e,o="png")=>{(function(e,t,n="png",r={}){return e.getSvg(t?.length?t:[...e.getCurrentPageShapeIds()],r).then((r=>{if(!r)throw new Error("Could not construct SVG.");let o="shapes"+function(){const e=new Date;return` at ${String(e.getFullYear()).slice(2)}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}.${String(e.getMinutes()).padStart(2,"0")}.${String(e.getSeconds()).padStart(2,"0")}`}();if(1===t.length){const n=e.getShape(t[0]);o=e.isShapeOfType(n,"frame")?n.props.name??"frame":n.id.replace(/:/,"_")}switch(n){case"svg":return void Iy(r).then((e=>Ry(e,`${o}.svg`)));case"webp":case"png":return void Ay(r,e.environment.isSafari,{type:n,quality:1,scale:2}).then((e=>{if(!e)throw Error();const t=URL.createObjectURL(e);Ry(t,`${o}.${n}`),URL.revokeObjectURL(t)}));case"json":{const n=e.getContentFromCurrentPage(t),r=new Blob([JSON.stringify(n,null,4)],{type:"application/json"}),i=URL.createObjectURL(r);return Ry(i,`${o||"shapes"}.json`),void URL.revokeObjectURL(i)}default:throw new Error(`Export type ${n} not supported.`)}}))})(t,e,o,{scale:1,background:t.getInstanceState().exportBackground}).catch((e=>{console.error(e.message),n({id:"export-fail",title:r("toast.error.export-fail.title"),description:r("toast.error.export-fail.desc")})}))}),[t,n,r])}function Ny(){const t=Yr(),n=(0,e.useRef)();return(0,e.useEffect)((()=>{const e=window.document.createElement("input");async function r(n){const r=n.target.files;r&&0!==r.length&&(await t.putExternalContent({type:"files",files:Array.from(r),point:t.getViewportPageBounds().center,ignoreParent:!1}),e.value="")}return e.type="file",e.accept="image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/quicktime",e.multiple=!0,n.current=e,e.addEventListener("change",r),()=>{n.current=void 0,e.removeEventListener("change",r)}}),[t]),(0,e.useCallback)((()=>{n.current?.click()}),[n])}const By=e.createContext({});function $y({overrides:t,children:n}){const r=Yr(),{addDialog:o,clearDialogs:i}=Fy(),{clearToasts:s}=Dy(),a=Ny(),c=function(){const t=Yr(),n=(0,e.useRef)(null),r=(0,e.useRef)(null);return(0,e.useCallback)((async function(){const e=document.createElement("div"),o=document.createElement("style"),i=(e,t)=>{e&&(e.innerHTML=""),t&&document.head.contains(t)&&document.head.removeChild(t),e&&document.body.contains(e)&&document.body.removeChild(e)};i(n.current,r.current),n.current=e,r.current=o;const s=`tl-print-surface-${ua()}`;e.className=s,o.innerHTML=`\n\t\t\t.${s} {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.${s} svg {\n\t\t\t\tmax-width: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\n\t\t\t@media print {\t\t\t\t  \n\t\t\t\thtml, body {\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmargin: 0;\n\t\t\t\t}\n\n\t\t\t\tbody {\n\t\t\t\t\tposition: relative;\n\t\t\t\t}\n\n\t\t\t\tbody > * {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.tldraw__editor {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.${s} {\n\t\t\t\t\tdisplay: block !important;\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t}\n\n\t\t\t\t.${s}__item {\n\t\t\t\t\tpadding: 10mm;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tpage-break-after: always;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\n\t\t\t\t.${s}__item__main {\n\t\t\t\t\tflex: 1;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tmax-height: 100%;\n\t\t\t\t}\n\n\t\t\t\t.${s}__item__header {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.${s}__item__footer {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t\ttext-align: right;\n\t\t\t\t}\n\n\t\t\t\t.${s}__item__footer__hide {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t\n\t\t\t}\n\n\t\t`;const a=()=>{document.head.appendChild(o),document.body.appendChild(e)},c=()=>{t.once("change-history",(()=>{i(e,o)}))};function l(t,n,r){try{e.innerHTML+=`<div class="${s}__item">\n        <div class="${s}__item__header">\n          ${t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}\n        </div>\n        <div class="${s}__item__main">\n          ${r.outerHTML}\n        </div>\n        <div class="${s}__item__footer ${s}__item__footer__${n?"":"hide"}">\n          ${n??""}\n        </div>\n      </div>`}catch(e){console.error(e)}}function u(){t.environment.isChromeForIos?(a(),window.print()):t.environment.isSafari?(a(),document.execCommand("print",!1)):window.print()}window.addEventListener("beforeprint",a),window.addEventListener("afterprint",c);const d=t.getSelectedShapeIds(),h=t.getCurrentPageId(),p=t.getPages(),f={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.getSelectedShapeIds().length>0){const e=await t.getSvg(d,f);if(e){const t=p.find((e=>e.id===h));l(`tldraw  ${t?.name}`,null,e),u()}}else{const e=t.getCurrentPage(),n=await t.getSvg(t.getSortedChildIdsForParent(e.id),f);n&&(l(`tldraw  ${e.name}`,null,n),u())}window.removeEventListener("beforeprint",a),window.removeEventListener("afterprint",c)}),[t])}(),{cut:l,copy:u,paste:d}=function(){const t=Yr(),n=_y(),r=(0,e.useCallback)((function(e){0!==t.getSelectedShapeIds().length&&(Ey(t),n("copy",{source:e}))}),[t,n]),o=(0,e.useCallback)((function(e){0!==t.getSelectedShapeIds().length&&(Ey(t),t.deleteShapes(t.getSelectedShapeIds()),n("cut",{source:e}))}),[t,n]),i=(0,e.useCallback)((async function(e,r,o){null!==t.getEditingShapeId()||vy(t)||(Array.isArray(e)&&e[0]instanceof ClipboardItem?(ky(t,e,o),n("paste",{source:"menu"})):navigator.clipboard.read().then((e=>{i(e,r,o)})))}),[t,n]);return{copy:r,cut:o,paste:i}}(),h=function(){const t=Yr(),{addToast:n}=Dy(),r=om();return(0,e.useCallback)(((e,o="svg")=>{(function(e,t,n="svg",r={}){const o=window.navigator.clipboard?.write;return e.getSvg(t?.length?t:[...e.getCurrentPageShapeIds()],{scale:1,background:e.getInstanceState().exportBackground,...r}).then((r=>{if(!r)throw new Error("Could not construct SVG.");switch(n){case"svg":window.navigator.clipboard&&(o?o([new ClipboardItem({"text/plain":new Blob([My(r)],{type:"text/plain"})})]):Py((async()=>My(r))));break;case"jpeg":case"png":{const t=Ay(r,e.environment.isSafari,{type:n,quality:1,scale:2}).then((e=>{if(e){if(window.navigator.clipboard)return e;throw new Error("Copy not supported")}throw new Error("Copy not possible")})),i="jpeg"===n?"image/jpeg":"image/png";o&&o([new ClipboardItem({[i]:t})]).catch((e=>{e.toString().match(/^TypeError: DOMString not supported/)||console.error(e),t.then((e=>{window.navigator.clipboard.write([new ClipboardItem({[i]:e})])}))}));break}case"json":{const n=e.getContentFromCurrentPage(t),r=JSON.stringify(n);o?o([new ClipboardItem({"text/plain":new Blob([r],{type:"text/plain"})})]):Py((async()=>r));break}default:throw new Error(`Copy type ${n} not supported.`)}}))})(t,e,o).catch((()=>{n({id:"copy-fail",icon:"warning-triangle",title:r("toast.error.copy-fail.title"),description:r("toast.error.copy-fail.desc")})}))}),[t,n,r])}(),p=Ly(),f=_y(),g=e.useMemo((()=>{function e(){return r.isIn("select")||(r.complete(),r.setCurrentTool("select")),!1}function n(){return r.getSelectedShapeIds().length>0}const g=[{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(t){n()&&(e()||(f("edit-link",{source:t}),r.mark("edit-link"),o({component:G_})))}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(e){f("insert-embed",{source:e}),o({component:Y_})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(e){f("insert-media",{source:e}),a()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(e){f("undo",{source:e}),r.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(e){f("redo",{source:e}),r.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(e){f("export-as",{format:"svg",source:e}),p(r.getSelectedShapeIds(),"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(e){f("export-as",{format:"png",source:e}),p(r.getSelectedShapeIds(),"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(e){f("export-as",{format:"json",source:e}),p(r.getSelectedShapeIds(),"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(e){f("copy-as",{format:"svg",source:e}),h(r.getSelectedShapeIds(),"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(e){f("copy-as",{format:"png",source:e}),h(r.getSelectedShapeIds(),"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(e){f("copy-as",{format:"json",source:e}),h(r.getSelectedShapeIds(),"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(t){n()&&(e()||(f("toggle-auto-size",{source:t}),r.mark("toggling auto size"),r.updateShapes(r.getSelectedShapes().filter((e=>r.isShapeOfType(e,"text")&&!1===e.props.autoSize)).map((e=>({id:e.id,type:e.type,props:{...e.props,w:8,autoSize:!0}}))))))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(e){f("open-embed-link",{source:e});const t=r.getSelectedShapeIds(),n="No embed shapes selected";if(1!==t.length)return void console.error(n);const o=r.getShape(t[0]);o&&r.isShapeOfType(o,"embed")?function(e,t="_blank"){Ko.openWindow(e,t)}(o.props.url,"_blank"):console.error(n)}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(e){if("zoom"!==r.root.getCurrent()?.id&&(f("zoom-tool",{source:e}),!r.inputs.shiftKey&&!r.inputs.ctrlKey)){const e=r.root.getCurrent();e&&"idle"===e.getCurrent()?.id&&r.setCurrentTool("zoom",{onInteractionEnd:e.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(t){n()&&(e()||r.batch((()=>{f("convert-to-bookmark",{source:t});const e=r.getSelectedShapes(),n=[],o=[];for(const t of e){if(!t||!r.isShapeOfType(t,"embed")||!t.props.url)continue;const e=new ho(t.x,t.y);e.rot(-t.rotation),e.add(new ho(t.props.w/2-150,t.props.h/2-160)),e.rot(t.rotation);const i={id:jn(),type:"bookmark",rotation:t.rotation,x:e.x,y:e.y,opacity:1,props:{url:t.props.url}};n.push(i),o.push(t.id)}r.mark("convert shapes to bookmark"),r.deleteShapes(o),r.createShapes(n)})))}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(t){n()&&(e()||(f("convert-to-embed",{source:t}),r.batch((()=>{const e=he(r.getSelectedShapeIds().map((e=>r.getShape(e)))),t=[],n=[];for(const o of e){if(!r.isShapeOfType(o,"bookmark"))continue;const{url:e}=o.props,i=kd(o.props.url);if(!i)continue;if(!i.definition)continue;const{width:s,height:a}=i.definition,c=new ho(o.x,o.y);c.rot(-o.rotation),c.add(new ho(o.props.w/2-s/2,o.props.h/2-a/2)),c.rot(o.rotation);const l={id:jn(),type:"embed",x:c.x,y:c.y,rotation:o.rotation,props:{url:e,w:s,h:a}};t.push(l),n.push(o.id)}r.mark("convert shapes to embed"),r.deleteShapes(n),r.createShapes(t)}))))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(t){if(!n())return;if(e())return;f("duplicate-shapes",{source:t});const o=r.getSelectedShapeIds(),i=fo.Common(he(o.map((e=>r.getShapePageBounds(e))))),s=r.getInstanceState().canMoveCamera?{x:i.width+10,y:0}:{x:16/r.getZoomLevel(),y:16/r.getZoomLevel()};r.mark("duplicate shapes"),r.duplicateShapes(o,s)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(t){n()&&(e()||(f("ungroup-shapes",{source:t}),r.mark("ungroup"),r.ungroupShapes(r.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(t){if(!n())return;if(e())return;f("group-shapes",{source:t});const o=r.getOnlySelectedShape();o&&r.isShapeOfType(o,"group")?(r.mark("ungroup"),r.ungroupShapes(r.getSelectedShapeIds())):(r.mark("group"),r.groupShapes(r.getSelectedShapeIds()))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(t){n()&&(e()||(f("align-shapes",{operation:"left",source:t}),r.mark("align left"),r.alignShapes(r.getSelectedShapeIds(),"left")))}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(t){n()&&(e()||(f("align-shapes",{operation:"center-horizontal",source:t}),r.mark("align center horizontal"),r.alignShapes(r.getSelectedShapeIds(),"center-horizontal")))}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(t){n()&&(e()||(f("align-shapes",{operation:"right",source:t}),r.mark("align right"),r.alignShapes(r.getSelectedShapeIds(),"right")))}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(t){n()&&(e()||(f("align-shapes",{operation:"center-vertical",source:t}),r.mark("align center vertical"),r.alignShapes(r.getSelectedShapeIds(),"center-vertical")))}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(t){n()&&(e()||(f("align-shapes",{operation:"top",source:t}),r.mark("align top"),r.alignShapes(r.getSelectedShapeIds(),"top")))}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(t){n()&&(e()||(f("align-shapes",{operation:"bottom",source:t}),r.mark("align bottom"),r.alignShapes(r.getSelectedShapeIds(),"bottom")))}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(t){n()&&(e()||(f("distribute-shapes",{operation:"horizontal",source:t}),r.mark("distribute horizontal"),r.distributeShapes(r.getSelectedShapeIds(),"horizontal")))}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(t){n()&&(e()||(f("distribute-shapes",{operation:"vertical",source:t}),r.mark("distribute vertical"),r.distributeShapes(r.getSelectedShapeIds(),"vertical")))}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(t){n()&&(e()||(f("stretch-shapes",{operation:"horizontal",source:t}),r.mark("stretch horizontal"),r.stretchShapes(r.getSelectedShapeIds(),"horizontal")))}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(t){n()&&(e()||(f("stretch-shapes",{operation:"vertical",source:t}),r.mark("stretch vertical"),r.stretchShapes(r.getSelectedShapeIds(),"vertical")))}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(t){n()&&(e()||(f("flip-shapes",{operation:"horizontal",source:t}),r.mark("flip horizontal"),r.flipShapes(r.getSelectedShapeIds(),"horizontal")))}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(t){n()&&(e()||(f("flip-shapes",{operation:"vertical",source:t}),r.mark("flip vertical"),r.flipShapes(r.getSelectedShapeIds(),"vertical")))}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(t){n()&&(e()||(f("pack-shapes",{source:t}),r.mark("pack"),r.packShapes(r.getSelectedShapeIds(),16)))}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(t){n()&&(e()||(f("stack-shapes",{operation:"vertical",source:t}),r.mark("stack-vertical"),r.stackShapes(r.getSelectedShapeIds(),"vertical",16)))}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(t){n()&&(e()||(f("stack-shapes",{operation:"horizontal",source:t}),r.mark("stack-horizontal"),r.stackShapes(r.getSelectedShapeIds(),"horizontal",16)))}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(t){n()&&(e()||(f("reorder-shapes",{operation:"toFront",source:t}),r.mark("bring to front"),r.bringToFront(r.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(t){n()&&(e()||(f("reorder-shapes",{operation:"forward",source:t}),r.mark("bring forward"),r.bringForward(r.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(t){n()&&(e()||(f("reorder-shapes",{operation:"backward",source:t}),r.mark("send backward"),r.sendBackward(r.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(t){n()&&(e()||(f("reorder-shapes",{operation:"toBack",source:t}),r.mark("send to back"),r.sendToBack(r.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(t){n()&&(e()||(r.mark("cut"),l(t)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(t){n()&&(e()||u(t))}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(e){navigator.clipboard?.read().then((t=>{d(t,e,"context-menu"===e?r.inputs.currentPagePoint:void 0)}))}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(t){r.batch((()=>{e()||(f("select-all-shapes",{source:t}),r.mark("select all kbd"),r.selectAll())}))}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(t){n()&&(e()||(f("select-none-shapes",{source:t}),r.mark("select none"),r.selectNone()))}},{id:"delete",label:"action.delete",kbd:",del,backspace",icon:"trash",readonlyOk:!1,onSelect(t){n()&&(e()||(f("delete-shapes",{source:t}),r.mark("delete"),r.deleteShapes(r.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(t){if(!n())return;if(e())return;f("rotate-cw",{source:t}),r.mark("rotate-cw");const o=r.getSelectionRotation()%(yo/2),i=ko(o,0)||ko(o,yo/2);r.rotateShapesBy(r.getSelectedShapeIds(),yo/2-(i?0:o))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(t){if(!n())return;if(e())return;f("rotate-ccw",{source:t}),r.mark("rotate-ccw");const o=r.getSelectionRotation()%(yo/2),i=ko(o,0);r.rotateShapesBy(r.getSelectedShapeIds(),i?-yo/2:-o)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(e){f("zoom-in",{source:e}),r.zoomIn(r.getViewportScreenCenter(),{duration:Xo})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(e){f("zoom-out",{source:e}),r.zoomOut(r.getViewportScreenCenter(),{duration:Xo})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(e){f("reset-zoom",{source:e}),r.resetZoom(r.getViewportScreenCenter(),{duration:Xo})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(e){f("zoom-to-fit",{source:e}),r.zoomToFit({duration:Xo})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(t){n()&&(e()||(f("zoom-to-selection",{source:t}),r.zoomToSelection({duration:Xo})))}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(e){f("toggle-snap-mode",{source:e}),r.user.updateUserPreferences({isSnapMode:!r.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(e){f("toggle-dark-mode",{source:e}),r.user.updateUserPreferences({isDarkMode:!r.user.getIsDarkMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(e){f("toggle-reduce-motion",{source:e}),r.user.updateUserPreferences({animationSpeed:0===r.user.getAnimationSpeed()?1:0})},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(e){f("toggle-transparent",{source:e}),r.updateInstanceState({exportBackground:!r.getInstanceState().exportBackground},{ephemeral:!0})},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(e){f("toggle-tool-lock",{source:e}),r.updateInstanceState({isToolLocked:!r.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",readonlyOk:!1,onSelect(e){f("unlock-all",{source:e});const t=[];for(const e of r.getCurrentPageShapes())e.isLocked&&t.push({id:e.id,type:e.type,isLocked:!1});t.length>0&&r.updateShapes(t)}},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(e){requestAnimationFrame((()=>{r.batch((()=>{f("toggle-focus-mode",{source:e}),i(),s(),r.updateInstanceState({isFocusMode:!r.getInstanceState().isFocusMode})}))}))}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(e){f("toggle-grid-mode",{source:e}),r.updateInstanceState({isGridMode:!r.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(e){f("toggle-debug-mode",{source:e}),r.updateInstanceState({isDebugMode:!r.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(e){f("print",{source:e}),c()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(e){f("exit-pen-mode",{source:e}),r.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(e){f("stop-following",{source:e}),r.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(e){f("zoom-to-content",{source:e}),r.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect(e){r.mark("locking"),f("toggle-lock",{source:e}),r.toggleLock(r.getSelectedShapeIds())}}],m=function(e){return Object.fromEntries(e.map((e=>[e.id,e])))}(g);return t?t(r,m,void 0):m}),[r,f,t,o,a,p,h,l,u,d,i,s,c]);return(0,Fr.jsx)(By.Provider,{value:g,children:n})}function Uy(){const t=e.useContext(By);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function Vy(e){return e.filter((e=>null!=e&&!1!==e))}function Wy(e,...t){const n=Vy(t);return 0===n.length?null:{id:e,type:"group",checkbox:n.every((e=>"item"===e.type&&e.actionItem.checkbox)),disabled:n.every((e=>e.disabled)),readonlyOk:n.some((e=>e.readonlyOk)),children:n}}function Ky(e,t,...n){const r=Vy(n);return 0===r.length?null:{id:e,type:"submenu",label:t,children:r,disabled:r.every((e=>e.disabled)),readonlyOk:r.some((e=>e.readonlyOk))}}function Hy(e,t={}){const{readonlyOk:n=!0,disabled:r=!1}=t;return{id:e,type:"custom",disabled:r,readonlyOk:n}}function Gy(e,t={}){if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");const{checked:n=!1,disabled:r=!1}=t;return{id:e.id,type:"item",actionItem:e,disabled:r,checked:n,readonlyOk:e.readonlyOk}}const qy=()=>{const e=Yr();return le("threeStackableItems",(()=>function(e){return e.getSelectedShapeIds().map((t=>e.getShape(t))).filter((t=>!(!t||e.isShapeOfType(t,"arrow")&&"binding"===t.props.start.type||e.isShapeOfType(t,"arrow")&&"binding"===t.props.end.type)))}(e).length>2),[e])},Yy=()=>{const e=Yr();return le("allowGroup",(()=>function(e){const t=e.getSelectedShapes(),n=[],r=new Map;t.forEach((e=>{"arrow"===e.type?n.push(e):r.set(e.id,e)}));const o=n.filter((e=>!("binding"===e.props.start.type&&!r.has(e.props.start.boundShapeId)||"binding"===e.props.end.type&&!r.has(e.props.end.boundShapeId))));return Array.from(r.values()).concat(o)}(e).length>1),[e])},Xy=()=>{const e=Yr();return le("allowUngroup",(()=>e.getSelectedShapeIds().some((t=>"group"===e.getShape(t)?.type))),[e])},Zy="undefined"!=typeof window&&"navigator"in window&&Boolean(navigator.clipboard)&&Boolean(navigator.clipboard.read),Qy=[0,390,428,468,580,640,840,1023],Jy=e.createContext(0);function ew({forceMobile:e=!1,children:t}){const n=Yr(),r=le("breakpoint",(()=>{const{width:t}=n.getViewportScreenBounds(),r=e?3:Qy.length-1;for(let e=0;e<r;e++)if(t>Qy[e]&&t<=Qy[e+1])return e;return r}),[n]);return(0,Fr.jsx)(Jy.Provider,{value:r,children:t})}function tw(){return(0,e.useContext)(Jy)}function nw(){const e=Yr();return le("hasLinkShapeSelected",(()=>{const t=e.getSelectedShapes();return 1===t.length&&"url"in t[0].props&&"embed"!==t[0].type}),[e])}const rw=e.createContext({}),ow=({overrides:t,children:n})=>{const r=Yr(),o=Uy(),i=le("selected count",(()=>r.getSelectedShapeIds().length),[r]),s=i>0,a=i>1,c=i>2,l=qy(),u=Yy(),d=Xy(),h=nw(),p=tw(),f=le("zoom is 1",(()=>1===r.getZoomLevel()),[r]),g=(0,e.useMemo)((()=>{const e=[Gy(o["align-left"],{disabled:!a}),Gy(o["align-center-horizontal"],{disabled:!a}),Gy(o["align-right"],{disabled:!a}),Gy(o["stretch-horizontal"],{disabled:!a}),Gy(o["align-top"],{disabled:!a}),Gy(o["align-center-vertical"],{disabled:!a}),Gy(o["align-bottom"],{disabled:!a}),Gy(o["stretch-vertical"],{disabled:!a}),Gy(o["distribute-horizontal"],{disabled:!c}),Gy(o["distribute-vertical"],{disabled:!c}),Gy(o["stack-horizontal"],{disabled:!l}),Gy(o["stack-vertical"],{disabled:!l}),Gy(o["send-to-back"],{disabled:!s}),Gy(o["send-backward"],{disabled:!s}),Gy(o["bring-forward"],{disabled:!s}),Gy(o["bring-to-front"],{disabled:!s}),p<5?Gy(o["zoom-to-100"],{disabled:!!f}):Gy(o["rotate-ccw"],{disabled:!s}),Gy(o["rotate-cw"],{disabled:!s}),Gy(o["edit-link"],{disabled:!h}),u?Gy(o.group,{disabled:!a}):d?Gy(o.ungroup):Gy(o.group,{disabled:!a})];return t?t(r,e,{actions:o,oneSelected:s,twoSelected:a,threeSelected:c}):e}),[r,f,u,t,o,s,a,c,l,d,h,p]);return(0,Fr.jsx)(rw.Provider,{value:g,children:n})};function iw(){const e=Yr();return le("showAutoSizeToggle",(()=>{const t=e.getSelectedShapes();return 1===t.length&&e.isShapeOfType(t[0],"text")&&!1===t[0].props.autoSize}),[e])}const sw=e.createContext({}),aw=se((function({overrides:t,children:n}){const r=Yr(),o=Uy(),i=iw(),s=function(){const e=Yr();return le("onlyFlippableShape",(()=>{const t=e.getSelectedShapes();return 1===t.length&&t.every((t=>e.isShapeOfType(t,"group")||e.isShapeOfType(t,"arrow")||e.isShapeOfType(t,"line")||e.isShapeOfType(t,"draw")))}),[e])}(),a=r.getSelectedShapeIds().length,c=a>0,l=a>1,u=a>2,d=qy(),h=le("atLeastOneShapeOnPage",(()=>r.getCurrentPageShapeIds().size>0),[]),p=le("isTransparentBg",(()=>r.getInstanceState().exportBackground),[]),f=Yy(),g=Xy(),m=Boolean(window.navigator.clipboard?.write),_=nw(),y=r.getOnlySelectedShape(),w=y&&r.isShapeOrAncestorLocked(y),v=(0,e.useMemo)((()=>{let e=Vy([Wy("selection",i&&Gy(o["toggle-auto-size"]),_&&!w&&Gy(o["edit-link"]),c&&!w&&Gy(o.duplicate),f&&!w&&Gy(o.group),g&&!w&&Gy(o.ungroup),c&&Gy(o["toggle-lock"])),Wy("modify",(l||s)&&Ky("arrange","context-menu.arrange",l&&Wy("align",Gy(o["align-left"]),Gy(o["align-center-horizontal"]),Gy(o["align-right"]),Gy(o["align-top"]),Gy(o["align-center-vertical"]),Gy(o["align-bottom"])),u&&Wy("distribute",Gy(o["distribute-horizontal"]),Gy(o["distribute-vertical"])),l&&Wy("stretch",Gy(o["stretch-horizontal"]),Gy(o["stretch-vertical"])),s&&!w&&Wy("flip",Gy(o["flip-horizontal"]),Gy(o["flip-vertical"])),l&&Wy("order",Gy(o.pack,{disabled:!l}),d&&Gy(o["stack-vertical"]),d&&Gy(o["stack-horizontal"]))),c&&!w&&Ky("reorder","context-menu.reorder",Wy("reorder",Gy(o["bring-to-front"]),Gy(o["bring-forward"]),Gy(o["send-backward"]),Gy(o["send-to-back"]))),c&&!w&&Hy("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),Wy("clipboard-group",c&&!w&&Gy(o.cut),c&&Gy(o.copy),Zy&&Gy(o.paste)),h&&Wy("conversions",Ky("copy-as","context-menu.copy-as",Wy("copy-as-group",Gy(o["copy-as-svg"]),m&&Gy(o["copy-as-png"]),Gy(o["copy-as-json"])),Wy("export-bg",Gy(o["toggle-transparent"],{checked:!p}))),Ky("export-as","context-menu.export-as",Wy("export-as-group",Gy(o["export-as-svg"]),Gy(o["export-as-png"]),Gy(o["export-as-json"])),Wy("export-bg,",Gy(o["toggle-transparent"],{checked:!p})))),h&&Wy("set-selection-group",Gy(o["select-all"]),c&&Gy(o["select-none"])),c&&!w&&Wy("delete-group",Gy(o.delete))]);return t&&(e=t(r,e,{actions:o,oneSelected:c,twoSelected:l,threeSelected:u,showAutoSizeToggle:i,showUngroup:g,onlyFlippableShapeSelected:s})),e}),[r,t,o,c,l,u,i,s,h,d,f,g,m,_,p,w]);return(0,Fr.jsx)(sw.Provider,{value:v,children:n})}));function cw(){const t=e.useContext(sw);if(!t)throw new Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return t}const lw=e.createContext({});function uw({overrides:t,children:n}){const r=Yr(),o=_y(),{addDialog:i}=Fy(),s=Ny(),a=e.useMemo((()=>{const e=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(e){r.setCurrentTool("select"),o("select-tool",{source:e,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(e){r.setCurrentTool("hand"),o("select-tool",{source:e,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(e){r.setCurrentTool("eraser"),o("select-tool",{source:e,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(e){r.setCurrentTool("draw"),o("select-tool",{source:e,id:"draw"})}},...[...pr.values].map((e=>({id:e,label:`tool.${e}`,readonlyOk:!1,meta:{geo:e},kbd:"rectangle"===e?"r":"ellipse"===e?"o":void 0,icon:"geo-"+e,onSelect(t){r.batch((()=>{r.updateInstanceState({stylesForNextShape:{...r.getInstanceState().stylesForNextShape,[pr.id]:e}},{ephemeral:!0}),r.setCurrentTool("geo"),o("select-tool",{source:t,id:`geo-${e}`})}))}}))),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(e){r.setCurrentTool("arrow"),o("select-tool",{source:e,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(e){r.setCurrentTool("line"),o("select-tool",{source:e,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(e){r.setCurrentTool("frame"),o("select-tool",{source:e,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(e){r.setCurrentTool("text"),o("select-tool",{source:e,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(e){s(),o("select-tool",{source:e,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(e){r.setCurrentTool("note"),o("select-tool",{source:e,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(e){r.setCurrentTool("laser"),o("select-tool",{source:e,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(e){i({component:Y_}),o("select-tool",{source:e,id:"embed"})}}];e.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(e){r.setCurrentTool("highlight"),o("select-tool",{source:e,id:"highlight"})}});const n=Object.fromEntries(e.map((e=>[e.id,e])));return t?t(r,n,{insertMedia:s}):n}),[t,r,o,s,i]);return(0,Fr.jsx)(lw.Provider,{value:a,children:n})}function dw(){const t=e.useContext(lw);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}const hw=e.createContext({}),pw=se((function({overrides:t,children:n}){const r=Yr(),o=dw(),i=Uy(),s=(0,e.useMemo)((()=>{const e=he([Wy("shortcuts-dialog.tools",Gy(i["toggle-tool-lock"]),Gy(o.select),Gy(o.draw),Gy(o.eraser),Gy(o.hand),Gy(o.rectangle),Gy(o.ellipse),Gy(o.arrow),Gy(o.line),Gy(o.text),Gy(o.frame),Gy(o.note),Gy(o.laser)),Wy("shortcuts-dialog.file",Gy(i["insert-media"]),Gy(i.print)),Wy("shortcuts-dialog.preferences",Gy(i["toggle-dark-mode"]),Gy(i["toggle-focus-mode"]),Gy(i["toggle-grid"])),Wy("shortcuts-dialog.edit",Gy(i.undo),Gy(i.redo),Gy(i.cut),Gy(i.copy),Gy(i.paste),Gy(i["select-all"]),Gy(i.delete),Gy(i.duplicate),Gy(i["export-as-svg"]),Gy(i["export-as-png"])),Wy("shortcuts-dialog.view",Gy(i["zoom-in"]),Gy(i["zoom-out"]),Gy(i["zoom-to-100"]),Gy(i["zoom-to-fit"]),Gy(i["zoom-to-selection"])),Wy("shortcuts-dialog.transform",Gy(i["bring-to-front"]),Gy(i["bring-forward"]),Gy(i["send-backward"]),Gy(i["send-to-back"]),Gy(i.group),Gy(i.ungroup),Gy(i["flip-horizontal"]),Gy(i["flip-vertical"]),Gy(i["align-top"]),Gy(i["align-center-vertical"]),Gy(i["align-bottom"]),Gy(i["align-left"]),Gy(i["align-center-horizontal"]),Gy(i["align-right"]))]);return t?t(r,e,{tools:o,actions:i}):e}),[r,t,i,o]);return(0,Fr.jsx)(hw.Provider,{value:s,children:n})})),fw=()=>{const t=om(),n=Uu(),r=function(){const t=e.useContext(hw);if(!t)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return t}();return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(B_,{className:"tlui-shortcuts-dialog__header",children:[(0,Fr.jsx)($_,{children:t("shortcuts-dialog.title")}),(0,Fr.jsx)(U_,{})]}),(0,Fr.jsx)(V_,{className:"tlui-shortcuts-dialog__body",children:r.map((function e(r){if(!r)return null;if(n&&!r.readonlyOk)return null;switch(r.type){case"group":return(0,Fr.jsxs)("div",{className:"tlui-shortcuts-dialog__group",children:[(0,Fr.jsx)("h2",{className:"tlui-shortcuts-dialog__group__title",children:t(r.id)}),(0,Fr.jsx)("div",{className:"tlui-shortcuts-dialog__group__content",children:r.children.filter((e=>e&&"item"===e.type&&e.actionItem.kbd)).map(e)})]},r.id);case"item":{const{id:e,label:n,shortcutsLabel:o,kbd:i}=r.actionItem;return(0,Fr.jsxs)("div",{className:"tlui-shortcuts-dialog__key-pair",children:[(0,Fr.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:t(o??n)}),(0,Fr.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:(0,Fr.jsx)(dm,{children:i})})]},e)}}}))}),(0,Fr.jsx)("div",{className:"tlui-dialog__scrim"})]})};function gw(){const e=Yr();return{languages:Dr,currentLanguage:e.user.getLocale()}}const mw=e.createContext({}),_w=se((function({overrides:t,children:n}){const r=Yr(),o=Uy(),i=r.getSelectedShapeIds().length,s=i>0,a=i>1,c=i>2,{languages:l,currentLanguage:u}=gw(),{addDialog:d}=Fy(),h=(0,e.useMemo)((()=>{const e=he([Wy("top",Hy("LANGUAGE_MENU",{readonlyOk:!0}),Gy({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){d({component:fw})}}))]);return t?t(r,e,{actions:o,currentLanguage:u,languages:l,oneSelected:s,twoSelected:a,threeSelected:c}):e}),[r,t,l,o,s,a,c,u,d]);return(0,Fr.jsx)(mw.Provider,{value:h,children:n})}));function yw(){const e=Yr();return le("useCanRedo",(()=>e.getCanRedo()),[e])}function ww(){const e=Yr();return le("useCanUndo",(()=>e.getCanUndo()),[e])}const vw=e.createContext({});function bw({overrides:t,children:n}){const r=Yr(),o=Uy(),i=tw()<5,s=le("isDarkMode",(()=>r.user.getIsDarkMode()),[r]),a=le("animationSpeed",(()=>r.user.getAnimationSpeed()),[r]),c=le("isGridMode",(()=>r.getInstanceState().isGridMode),[r]),l=le("isSnapMode",(()=>r.user.getIsSnapMode()),[r]),u=le("isToolLock",(()=>r.getInstanceState().isToolLocked),[r]),d=le("isFocusMode",(()=>r.getInstanceState().isFocusMode),[r]),h=le("isDebugMode",(()=>r.getInstanceState().isDebugMode),[r]),p=le("exportBackground",(()=>r.getInstanceState().exportBackground),[r]),f=le("emptyPage",(()=>0===r.getCurrentPageShapeIds().size),[r]),g=le("selectedCount",(()=>r.getSelectedShapeIds().length),[r]),m=0===g,_=g>0,y=g>1,w=g>2,v=Boolean(window.navigator.clipboard?.write),b=nw(),x=iw(),S=Yy(),k=Xy(),C=ww(),E=yw(),A=le("isZoomedTo100",(()=>1===r.getZoomLevel()),[r]),I=le("oneEmbedSelected",(()=>{const e=r.getOnlySelectedShape();return!!e&&!(!r.isShapeOfType(e,"embed")||!e.props.url||r.isShapeOrAncestorLocked(e))}),[]),P=le("oneEmbeddableBookmarkSelected",(()=>{const e=r.getOnlySelectedShape();return!!e&&!(!(r.isShapeOfType(e,"bookmark")&&e.props.url&&kd(e.props.url))||r.isShapeOrAncestorLocked(e))}),[]),M=(0,e.useMemo)((()=>{const e=Vy([Wy("menu",Ky("file","menu.file",Wy("print",Gy(o.print,{disabled:f}))),Ky("edit","menu.edit",Wy("undo-actions",Gy(o.undo,{disabled:!C}),Gy(o.redo,{disabled:!E})),Wy("clipboard-actions",Gy(o.cut,{disabled:m}),Gy(o.copy,{disabled:m}),Gy(o.paste,{disabled:!Zy})),Wy("conversions",Ky("copy-as","menu.copy-as",Wy("copy-as-group",Gy(o["copy-as-svg"],{disabled:f}),Gy(o["copy-as-png"],{disabled:f||!v}),Gy(o["copy-as-json"],{disabled:f})),Wy("export-bg",Gy(o["toggle-transparent"],{checked:!p}))),Ky("export-as","menu.export-as",Wy("export-as-group",Gy(o["export-as-svg"],{disabled:f}),Gy(o["export-as-png"],{disabled:f}),Gy(o["export-as-json"],{disabled:f})),Wy("export-bg",Gy(o["toggle-transparent"],{checked:!p})))),Wy("set-selection-group",Gy(o["select-all"],{disabled:f}),Gy(o["select-none"],{disabled:!_})),Wy("selection",x&&Gy(o["toggle-auto-size"]),b&&Gy(o["edit-link"]),Gy(o.duplicate,{disabled:!_}),S&&Gy(o.group),k&&Gy(o.ungroup),Gy(o["unlock-all"],{disabled:f})),Wy("delete-group",Gy(o.delete,{disabled:!_})),Wy("embeds",I&&Gy(o["open-embed-link"]),I&&Gy(o["convert-to-bookmark"]),P&&Gy(o["convert-to-embed"]))),Ky("view","menu.view",Wy("view-actions",Gy(o["zoom-in"]),Gy(o["zoom-out"]),Gy(o["zoom-to-100"],{disabled:A}),Gy(o["zoom-to-fit"],{disabled:f}),Gy(o["zoom-to-selection"],{disabled:f||!_})))),Wy("extras",Gy(o["insert-embed"]),Gy(o["insert-media"])),Wy("preferences",Ky("preferences","menu.preferences",Wy("preferences-actions",Gy(o["toggle-snap-mode"],{checked:l}),Gy(o["toggle-tool-lock"],{checked:u}),Gy(o["toggle-grid"],{checked:c}),Gy(o["toggle-dark-mode"],{checked:s}),Gy(o["toggle-focus-mode"],{checked:d}),Gy(o["toggle-reduce-motion"],{checked:0===a}),Gy(o["toggle-debug-mode"],{checked:h}))),i&&Hy("LANGUAGE_MENU",{readonlyOk:!0}))]);return t?t(r,e,{actions:o,noneSelected:m,oneSelected:_,twoSelected:y,threeSelected:w}):e}),[r,t,o,_,y,w,f,i,S,k,b,v,x,m,C,E,a,s,c,l,u,d,p,h,A,P,I]);return(0,Fr.jsx)(vw.Provider,{value:M,children:n})}function xw(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}const Sw=e.createContext([]);function kw({overrides:t,children:n}){const r=Yr(),o=dw(),i=e.useMemo((()=>{const e=he([xw(o.select),xw(o.hand),xw(o.draw),xw(o.eraser),xw(o.arrow),xw(o.text),xw(o.note),xw(o.asset),xw(o.rectangle),xw(o.ellipse),xw(o.diamond),xw(o.triangle),xw(o.trapezoid),xw(o.rhombus),xw(o.hexagon),xw(o.cloud),xw(o.star),xw(o.oval),xw(o["x-box"]),xw(o["check-box"]),xw(o["arrow-left"]),xw(o["arrow-up"]),xw(o["arrow-down"]),xw(o["arrow-right"]),xw(o.line),xw(o.highlight),xw(o.frame),xw(o.laser)]);return t?t(r,e,{tools:o}):e}),[r,t,o]);return(0,Fr.jsx)(Sw.Provider,{value:i,children:n})}function Cw(t){return(0,e.useMemo)((()=>t),t)}function Ew(t){const n=Cw(null==t?[]:Array.isArray(t)?t:[t]);return(0,e.useMemo)((()=>{const e={};for(const t of n)if(t.translations)for(const[n,r]of De(t.translations)){let t=e[n];t||(t=e[n]={}),Object.assign(t,r)}return e}),[n])}function Aw({overrides:e,assetUrls:t,onUiEvent:n,forceMobile:r,children:o}){return(0,Fr.jsx)(Zg,{assetUrls:Yg(t),children:(0,Fr.jsx)(rm,{overrides:Ew(e),children:(0,Fr.jsx)(my,{onEvent:n,children:(0,Fr.jsx)(jy,{children:(0,Fr.jsx)(zy,{children:(0,Fr.jsx)(ew,{forceMobile:r,children:(0,Fr.jsx)(Iw,{overrides:e,children:o})})})})})})})}function Iw({overrides:t,children:n}){const r=function(t){const n=function(){const{addToast:t,removeToast:n,clearToasts:r}=Dy(),{addDialog:o,clearDialogs:i,removeDialog:s,updateDialog:a}=Fy(),c=tw()<5,l=om();return(0,e.useMemo)((()=>({addToast:t,removeToast:n,clearToasts:r,addDialog:o,clearDialogs:i,removeDialog:s,updateDialog:a,msg:l,isMobile:c})),[o,t,i,r,l,s,n,a,c])}(),r=Cw(null==t?[]:Array.isArray(t)?t:[t]);return(0,e.useMemo)((()=>function(e,t){const n={};for(const t of e)if(t.translations)for(const[e,r]of De(t.translations)){let t=n[e];t||(t=n[e]={}),Object.assign(t,r)}return{actionsMenu:(n,r,o)=>{for(const i of e)i.actionsMenu&&(r=i.actionsMenu(n,r,{...t,...o}));return r},actions:(n,r)=>{for(const o of e)o.actions&&(r=o.actions(n,r,t));return r},contextMenu:(n,r,o)=>{for(const i of e)i.contextMenu&&(r=i.contextMenu(n,r,{...t,...o}));return r},helpMenu:(n,r,o)=>{for(const i of e)i.helpMenu&&(r=i.helpMenu(n,r,{...t,...o}));return r},menu:(n,r,o)=>{for(const i of e)i.menu&&(r=i.menu(n,r,{...t,...o}));return r},toolbar:(n,r,o)=>{for(const i of e)i.toolbar&&(r=i.toolbar(n,r,{...t,...o}));return r},keyboardShortcutsMenu:(n,r,o)=>{for(const i of e)i.keyboardShortcutsMenu&&(r=i.keyboardShortcutsMenu(n,r,{...t,...o}));return r},tools:(n,r,o)=>{for(const i of e)i.tools&&(r=i.tools(n,r,{...t,...o}));return r},translations:n}}(r,n)),[r,n])}(t);return(0,Fr.jsx)($y,{overrides:r.actions,children:(0,Fr.jsx)(uw,{overrides:r.tools,children:(0,Fr.jsx)(kw,{overrides:r.toolbar,children:(0,Fr.jsx)(ow,{overrides:r.actionsMenu,children:(0,Fr.jsx)(pw,{overrides:r.keyboardShortcutsMenu,children:(0,Fr.jsx)(aw,{overrides:r.contextMenu,children:(0,Fr.jsx)(_w,{overrides:r.helpMenu,children:(0,Fr.jsx)(bw,{overrides:r.menu,children:n})})})})})})})})}function Pw(){const t=Yr(),n=Uy()["back-to-content"],[r,o]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{let e=!1;const n=setInterval((()=>{const n=t.getRenderingShapes(),r=t.getRenderingBounds(),i=0===n.filter((e=>e.maskedPageBounds&&r.includes(e.maskedPageBounds))).length&&t.getCurrentPageShapes().length>0;e!==i&&(o(i),e=i)}),1e3);return()=>{clearInterval(n)}}),[t]),r?(0,Fr.jsx)(hm,{iconLeft:n.icon,label:n.label,type:"low",onClick:()=>{n.onSelect("helper-buttons"),o(!1)}}):null}const Mw=(0,e.createContext)(void 0);function Tw(t){const n=(0,e.useContext)(Mw);return t||n||"ltr"}const jw=["top","right","bottom","left"],Dw=Math.min,Ow=Math.max,zw=Math.round,Fw=Math.floor,Rw=e=>({x:e,y:e}),Lw={left:"right",right:"left",bottom:"top",top:"bottom"},Nw={start:"end",end:"start"};function Bw(e,t,n){return Ow(e,Dw(t,n))}function $w(e,t){return"function"==typeof e?e(t):e}function Uw(e){return e.split("-")[0]}function Vw(e){return e.split("-")[1]}function Ww(e){return"x"===e?"y":"x"}function Kw(e){return"y"===e?"height":"width"}function Hw(e){return["top","bottom"].includes(Uw(e))?"y":"x"}function Gw(e){return Ww(Hw(e))}function qw(e){return e.replace(/start|end/g,(e=>Nw[e]))}function Yw(e){return e.replace(/left|right|bottom|top/g,(e=>Lw[e]))}function Xw(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function Zw(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Qw(e,t,n){let{reference:r,floating:o}=e;const i=Hw(t),s=Gw(t),a=Kw(s),c=Uw(t),l="y"===i,u=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,h=r[a]/2-o[a]/2;let p;switch(c){case"top":p={x:u,y:r.y-o.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-o.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Vw(t)){case"start":p[s]-=h*(n&&l?-1:1);break;case"end":p[s]+=h*(n&&l?-1:1)}return p}async function Jw(e,t){var n;void 0===t&&(t={});const{x:r,y:o,platform:i,rects:s,elements:a,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=$w(t,e),f=Xw(p),g=a[h?"floating"===d?"reference":"floating":d],m=Zw(await i.getClippingRect({element:null==(n=await(null==i.isElement?void 0:i.isElement(g)))||n?g:g.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),_="floating"===d?{...s.floating,x:r,y:o}:s.reference,y=await(null==i.getOffsetParent?void 0:i.getOffsetParent(a.floating)),w=await(null==i.isElement?void 0:i.isElement(y))&&await(null==i.getScale?void 0:i.getScale(y))||{x:1,y:1},v=Zw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:_,offsetParent:y,strategy:c}):_);return{top:(m.top-v.top+f.top)/w.y,bottom:(v.bottom-m.bottom+f.bottom)/w.y,left:(m.left-v.left+f.left)/w.x,right:(v.right-m.right+f.right)/w.x}}const ev=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:s,elements:a,middlewareData:c}=t,{element:l,padding:u=0}=$w(e,t)||{};if(null==l)return{};const d=Xw(u),h={x:n,y:r},p=Gw(o),f=Kw(p),g=await s.getDimensions(l),m="y"===p,_=m?"top":"left",y=m?"bottom":"right",w=m?"clientHeight":"clientWidth",v=i.reference[f]+i.reference[p]-h[p]-i.floating[f],b=h[p]-i.reference[p],x=await(null==s.getOffsetParent?void 0:s.getOffsetParent(l));let S=x?x[w]:0;S&&await(null==s.isElement?void 0:s.isElement(x))||(S=a.floating[w]||i.floating[f]);const k=v/2-b/2,C=S/2-g[f]/2-1,E=Dw(d[_],C),A=Dw(d[y],C),I=E,P=S-g[f]-A,M=S/2-g[f]/2+k,T=Bw(I,M,P),j=!c.arrow&&null!=Vw(o)&&M!=T&&i.reference[f]/2-(M<I?E:A)-g[f]/2<0,D=j?M<I?M-I:M-P:0;return{[p]:h[p]+D,data:{[p]:T,centerOffset:M-T-D,...j&&{alignmentOffset:D}},reset:j}}}),tv=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:s,initialPlacement:a,platform:c,elements:l}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:g=!0,...m}=$w(e,t);if(null!=(n=i.arrow)&&n.alignmentOffset)return{};const _=Uw(o),y=Uw(a)===a,w=await(null==c.isRTL?void 0:c.isRTL(l.floating)),v=h||(y||!g?[Yw(a)]:function(e){const t=Yw(e);return[qw(e),t,qw(t)]}(a));h||"none"===f||v.push(...function(e,t,n,r){const o=Vw(e);let i=function(e,t,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?i:s;default:return[]}}(Uw(e),"start"===n,r);return o&&(i=i.map((e=>e+"-"+o)),t&&(i=i.concat(i.map(qw)))),i}(a,g,f,w));const b=[a,...v],x=await Jw(t,m),S=[];let k=(null==(r=i.flip)?void 0:r.overflows)||[];if(u&&S.push(x[_]),d){const e=function(e,t,n){void 0===n&&(n=!1);const r=Vw(e),o=Gw(e),i=Kw(o);let s="x"===o?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=Yw(s)),[s,Yw(s)]}(o,s,w);S.push(x[e[0]],x[e[1]])}if(k=[...k,{placement:o,overflows:S}],!S.every((e=>e<=0))){var C,E;const e=((null==(C=i.flip)?void 0:C.index)||0)+1,t=b[e];if(t)return{data:{index:e,overflows:k},reset:{placement:t}};let n=null==(E=k.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:E.placement;if(!n)switch(p){case"bestFit":{var A;const e=null==(A=k.map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=a}if(o!==n)return{reset:{placement:n}}}return{}}}};function nv(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function rv(e){return jw.some((t=>e[t]>=0))}const ov=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=$w(e,t);switch(r){case"referenceHidden":{const e=nv(await Jw(t,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:rv(e)}}}case"escaped":{const e=nv(await Jw(t,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:rv(e)}}}default:return{}}}}},iv=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:s,middlewareData:a}=t,c=await async function(e,t){const{placement:n,platform:r,elements:o}=e,i=await(null==r.isRTL?void 0:r.isRTL(o.floating)),s=Uw(n),a=Vw(n),c="y"===Hw(n),l=["left","top"].includes(s)?-1:1,u=i&&c?-1:1,d=$w(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"==typeof f&&(p="end"===a?-1*f:f),c?{x:p*u,y:h*l}:{x:h*l,y:p*u}}(t,e);return s===(null==(n=a.offset)?void 0:n.placement)&&null!=(r=a.arrow)&&r.alignmentOffset?{}:{x:o+c.x,y:i+c.y,data:{...c,placement:s}}}}},sv=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:a={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...c}=$w(e,t),l={x:n,y:r},u=await Jw(t,c),d=Hw(Uw(o)),h=Ww(d);let p=l[h],f=l[d];if(i){const e="y"===h?"bottom":"right";p=Bw(p+u["y"===h?"top":"left"],p,p-u[e])}if(s){const e="y"===d?"bottom":"right";f=Bw(f+u["y"===d?"top":"left"],f,f-u[e])}const g=a.fn({...t,[h]:p,[d]:f});return{...g,data:{x:g.x-n,y:g.y-r}}}}},av=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:i,middlewareData:s}=t,{offset:a=0,mainAxis:c=!0,crossAxis:l=!0}=$w(e,t),u={x:n,y:r},d=Hw(o),h=Ww(d);let p=u[h],f=u[d];const g=$w(a,t),m="number"==typeof g?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const e="y"===h?"height":"width",t=i.reference[h]-i.floating[e]+m.mainAxis,n=i.reference[h]+i.reference[e]-m.mainAxis;p<t?p=t:p>n&&(p=n)}if(l){var _,y;const e="y"===h?"width":"height",t=["top","left"].includes(Uw(o)),n=i.reference[d]-i.floating[e]+(t&&(null==(_=s.offset)?void 0:_[d])||0)+(t?0:m.crossAxis),r=i.reference[d]+i.reference[e]+(t?0:(null==(y=s.offset)?void 0:y[d])||0)-(t?m.crossAxis:0);f<n?f=n:f>r&&(f=r)}return{[h]:p,[d]:f}}}},cv=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:o,elements:i}=t,{apply:s=(()=>{}),...a}=$w(e,t),c=await Jw(t,a),l=Uw(n),u=Vw(n),d="y"===Hw(n),{width:h,height:p}=r.floating;let f,g;"top"===l||"bottom"===l?(f=l,g=u===(await(null==o.isRTL?void 0:o.isRTL(i.floating))?"start":"end")?"left":"right"):(g=l,f="end"===u?"top":"bottom");const m=p-c[f],_=h-c[g],y=!t.middlewareData.shift;let w=m,v=_;if(d){const e=h-c.left-c.right;v=u||y?Dw(_,e):e}else{const e=p-c.top-c.bottom;w=u||y?Dw(m,e):e}if(y&&!u){const e=Ow(c.left,0),t=Ow(c.right,0),n=Ow(c.top,0),r=Ow(c.bottom,0);d?v=h-2*(0!==e||0!==t?e+t:Ow(c.left,c.right)):w=p-2*(0!==n||0!==r?n+r:Ow(c.top,c.bottom))}await s({...t,availableWidth:v,availableHeight:w});const b=await o.getDimensions(i.floating);return h!==b.width||p!==b.height?{reset:{rects:!0}}:{}}}};function lv(e){return hv(e)?(e.nodeName||"").toLowerCase():"#document"}function uv(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function dv(e){var t;return null==(t=(hv(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function hv(e){return e instanceof Node||e instanceof uv(e).Node}function pv(e){return e instanceof Element||e instanceof uv(e).Element}function fv(e){return e instanceof HTMLElement||e instanceof uv(e).HTMLElement}function gv(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof uv(e).ShadowRoot)}function mv(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=bv(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function _v(e){return["table","td","th"].includes(lv(e))}function yv(e){const t=wv(),n=bv(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function wv(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function vv(e){return["html","body","#document"].includes(lv(e))}function bv(e){return uv(e).getComputedStyle(e)}function xv(e){return pv(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Sv(e){if("html"===lv(e))return e;const t=e.assignedSlot||e.parentNode||gv(e)&&e.host||dv(e);return gv(t)?t.host:t}function kv(e){const t=Sv(e);return vv(t)?e.ownerDocument?e.ownerDocument.body:e.body:fv(t)&&mv(t)?t:kv(t)}function Cv(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const o=kv(e),i=o===(null==(r=e.ownerDocument)?void 0:r.body),s=uv(o);return i?t.concat(s,s.visualViewport||[],mv(o)?o:[],s.frameElement&&n?Cv(s.frameElement):[]):t.concat(o,Cv(o,[],n))}function Ev(e){const t=bv(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=fv(e),i=o?e.offsetWidth:n,s=o?e.offsetHeight:r,a=zw(n)!==i||zw(r)!==s;return a&&(n=i,r=s),{width:n,height:r,$:a}}function Av(e){return pv(e)?e:e.contextElement}function Iv(e){const t=Av(e);if(!fv(t))return Rw(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=Ev(t);let s=(i?zw(n.width):n.width)/r,a=(i?zw(n.height):n.height)/o;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const Pv=Rw(0);function Mv(e){const t=uv(e);return wv()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Pv}function Tv(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const o=e.getBoundingClientRect(),i=Av(e);let s=Rw(1);t&&(r?pv(r)&&(s=Iv(r)):s=Iv(e));const a=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==uv(e))&&t}(i,n,r)?Mv(i):Rw(0);let c=(o.left+a.x)/s.x,l=(o.top+a.y)/s.y,u=o.width/s.x,d=o.height/s.y;if(i){const e=uv(i),t=r&&pv(r)?uv(r):r;let n=e.frameElement;for(;n&&r&&t!==e;){const e=Iv(n),t=n.getBoundingClientRect(),r=bv(n),o=t.left+(n.clientLeft+parseFloat(r.paddingLeft))*e.x,i=t.top+(n.clientTop+parseFloat(r.paddingTop))*e.y;c*=e.x,l*=e.y,u*=e.x,d*=e.y,c+=o,l+=i,n=uv(n).frameElement}}return Zw({width:u,height:d,x:c,y:l})}function jv(e){return Tv(dv(e)).left+xv(e).scrollLeft}function Dv(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=uv(e),r=dv(e),o=n.visualViewport;let i=r.clientWidth,s=r.clientHeight,a=0,c=0;if(o){i=o.width,s=o.height;const e=wv();(!e||e&&"fixed"===t)&&(a=o.offsetLeft,c=o.offsetTop)}return{width:i,height:s,x:a,y:c}}(e,n);else if("document"===t)r=function(e){const t=dv(e),n=xv(e),r=e.ownerDocument.body,o=Ow(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=Ow(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+jv(e);const a=-n.scrollTop;return"rtl"===bv(r).direction&&(s+=Ow(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:s,y:a}}(dv(e));else if(pv(t))r=function(e,t){const n=Tv(e,!0,"fixed"===t),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=fv(e)?Iv(e):Rw(1);return{width:e.clientWidth*i.x,height:e.clientHeight*i.y,x:o*i.x,y:r*i.y}}(t,n);else{const n=Mv(e);r={...t,x:t.x-n.x,y:t.y-n.y}}return Zw(r)}function Ov(e,t){const n=Sv(e);return!(n===t||!pv(n)||vv(n))&&("fixed"===bv(n).position||Ov(n,t))}function zv(e,t,n){const r=fv(t),o=dv(t),i="fixed"===n,s=Tv(e,!0,i,t);let a={scrollLeft:0,scrollTop:0};const c=Rw(0);if(r||!r&&!i)if(("body"!==lv(t)||mv(o))&&(a=xv(t)),r){const e=Tv(t,!0,i,t);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else o&&(c.x=jv(o));return{x:s.left+a.scrollLeft-c.x,y:s.top+a.scrollTop-c.y,width:s.width,height:s.height}}function Fv(e,t){return fv(e)&&"fixed"!==bv(e).position?t?t(e):e.offsetParent:null}function Rv(e,t){const n=uv(e);if(!fv(e))return n;let r=Fv(e,t);for(;r&&_v(r)&&"static"===bv(r).position;)r=Fv(r,t);return r&&("html"===lv(r)||"body"===lv(r)&&"static"===bv(r).position&&!yv(r))?n:r||function(e){let t=Sv(e);for(;fv(t)&&!vv(t);){if(yv(t))return t;t=Sv(t)}return null}(e)||n}const Lv={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e;const o=fv(n),i=dv(n);if(n===i)return t;let s={scrollLeft:0,scrollTop:0},a=Rw(1);const c=Rw(0);if((o||!o&&"fixed"!==r)&&(("body"!==lv(n)||mv(i))&&(s=xv(n)),fv(n))){const e=Tv(n);a=Iv(n),c.x=e.x+n.clientLeft,c.y=e.y+n.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-s.scrollLeft*a.x+c.x,y:t.y*a.y-s.scrollTop*a.y+c.y}},getDocumentElement:dv,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const i=[..."clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let r=Cv(e,[],!1).filter((e=>pv(e)&&"body"!==lv(e))),o=null;const i="fixed"===bv(e).position;let s=i?Sv(e):e;for(;pv(s)&&!vv(s);){const t=bv(s),n=yv(s);n||"fixed"!==t.position||(o=null),(i?!n&&!o:!n&&"static"===t.position&&o&&["absolute","fixed"].includes(o.position)||mv(s)&&!n&&Ov(e,s))?r=r.filter((e=>e!==s)):o=t,s=Sv(s)}return t.set(e,r),r}(t,this._c):[].concat(n),r],s=i[0],a=i.reduce(((e,n)=>{const r=Dv(t,n,o);return e.top=Ow(r.top,e.top),e.right=Dw(r.right,e.right),e.bottom=Dw(r.bottom,e.bottom),e.left=Ow(r.left,e.left),e}),Dv(t,s,o));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:Rv,getElementRects:async function(e){let{reference:t,floating:n,strategy:r}=e;const o=this.getOffsetParent||Rv,i=this.getDimensions;return{reference:zv(t,await o(n),r),floating:{x:0,y:0,...await i(n)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){return Ev(e)},getScale:Iv,isElement:pv,isRTL:function(e){return"rtl"===bv(e).direction}};const Nv=(e,t,n)=>{const r=new Map,o={platform:Lv,...n},i={...o.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:s}=n,a=i.filter(Boolean),c=await(null==s.isRTL?void 0:s.isRTL(t));let l=await s.getElementRects({reference:e,floating:t,strategy:o}),{x:u,y:d}=Qw(l,r,c),h=r,p={},f=0;for(let n=0;n<a.length;n++){const{name:i,fn:g}=a[n],{x:m,y:_,data:y,reset:w}=await g({x:u,y:d,initialPlacement:r,placement:h,strategy:o,middlewareData:p,rects:l,platform:s,elements:{reference:e,floating:t}});u=null!=m?m:u,d=null!=_?_:d,p={...p,[i]:{...p[i],...y}},w&&f<=50&&(f++,"object"==typeof w&&(w.placement&&(h=w.placement),w.rects&&(l=!0===w.rects?await s.getElementRects({reference:e,floating:t,strategy:o}):w.rects),({x:u,y:d}=Qw(l,h,c))),n=-1)}return{x:u,y:d,placement:h,strategy:o,middlewareData:p}})(e,t,{...o,platform:i})},Bv=e=>({name:"arrow",options:e,fn(t){const{element:n,padding:r}="function"==typeof e?e(t):e;return n&&(o=n,{}.hasOwnProperty.call(o,"current"))?null!=n.current?ev({element:n.current,padding:r}).fn(t):{}:n?ev({element:n,padding:r}).fn(t):{};var o}});var $v="undefined"!=typeof document?e.useLayoutEffect:e.useEffect;function Uv(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;0!=r--;)if(!Uv(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;0!=r--;){const n=o[r];if(!("_owner"===n&&e.$$typeof||Uv(e[n],t[n])))return!1}return!0}return e!=e&&t!=t}function Vv(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Wv(e,t){const n=Vv(e);return Math.round(t*n)/n}function Kv(t){const n=e.useRef(t);return $v((()=>{n.current=t})),n}function Hv(t){const[n,r]=(0,e.useState)(void 0);return sg((()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const e=new ResizeObserver((e=>{if(!Array.isArray(e))return;if(!e.length)return;const n=e[0];let o,i;if("borderBoxSize"in n){const e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;o=t.inlineSize,i=t.blockSize}else o=t.offsetWidth,i=t.offsetHeight;r({width:o,height:i})}));return e.observe(t,{box:"border-box"}),()=>e.unobserve(t)}r(void 0)}),[t]),n}const Gv="Popper",[qv,Yv]=Bf(Gv),[Xv,Zv]=qv(Gv),Qv=(0,e.forwardRef)(((t,n)=>{const{__scopePopper:r,virtualRef:o,...i}=t,s=Zv("PopperAnchor",r),a=(0,e.useRef)(null),c=Nf(n,a);return(0,e.useEffect)((()=>{s.onAnchorChange((null==o?void 0:o.current)||a.current)})),o?null:(0,e.createElement)(qf.div,zf({},i,{ref:c}))})),Jv="PopperContent",[eb,tb]=qv(Jv),nb=(0,e.forwardRef)(((t,n)=>{var r,o,i,s,a,c,l,u;const{__scopePopper:d,side:h="bottom",sideOffset:p=0,align:f="center",alignOffset:g=0,arrowPadding:m=0,avoidCollisions:_=!0,collisionBoundary:y=[],collisionPadding:w=0,sticky:v="partial",hideWhenDetached:b=!1,updatePositionStrategy:x="optimized",onPlaced:S,...k}=t,C=Zv(Jv,d),[E,A]=(0,e.useState)(null),I=Nf(n,(e=>A(e))),[P,M]=(0,e.useState)(null),T=Hv(P),j=null!==(r=null==T?void 0:T.width)&&void 0!==r?r:0,D=null!==(o=null==T?void 0:T.height)&&void 0!==o?o:0,O=h+("center"!==f?"-"+f:""),z="number"==typeof w?w:{top:0,right:0,bottom:0,left:0,...w},F=Array.isArray(y)?y:[y],R=F.length>0,L={padding:z,boundary:F.filter(rb),altBoundary:R},{refs:N,floatingStyles:B,placement:$,isPositioned:U,middlewareData:V}=function(t){void 0===t&&(t={});const{placement:n="bottom",strategy:r="absolute",middleware:o=[],platform:i,elements:{reference:s,floating:a}={},transform:c=!0,whileElementsMounted:l,open:u}=t,[d,h]=e.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[p,f]=e.useState(o);Uv(p,o)||f(o);const[g,m]=e.useState(null),[_,y]=e.useState(null),w=e.useCallback((e=>{e!=S.current&&(S.current=e,m(e))}),[m]),v=e.useCallback((e=>{e!==k.current&&(k.current=e,y(e))}),[y]),b=s||g,x=a||_,S=e.useRef(null),k=e.useRef(null),C=e.useRef(d),E=Kv(l),A=Kv(i),I=e.useCallback((()=>{if(!S.current||!k.current)return;const e={placement:n,strategy:r,middleware:p};A.current&&(e.platform=A.current),Nv(S.current,k.current,e).then((e=>{const t={...e,isPositioned:!0};P.current&&!Uv(C.current,t)&&(C.current=t,Ff.flushSync((()=>{h(t)})))}))}),[p,n,r,A]);$v((()=>{!1===u&&C.current.isPositioned&&(C.current.isPositioned=!1,h((e=>({...e,isPositioned:!1}))))}),[u]);const P=e.useRef(!1);$v((()=>(P.current=!0,()=>{P.current=!1})),[]),$v((()=>{if(b&&(S.current=b),x&&(k.current=x),b&&x){if(E.current)return E.current(b,x,I);I()}}),[b,x,I,E]);const M=e.useMemo((()=>({reference:S,floating:k,setReference:w,setFloating:v})),[w,v]),T=e.useMemo((()=>({reference:b,floating:x})),[b,x]),j=e.useMemo((()=>{const e={position:r,left:0,top:0};if(!T.floating)return e;const t=Wv(T.floating,d.x),n=Wv(T.floating,d.y);return c?{...e,transform:"translate("+t+"px, "+n+"px)",...Vv(T.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:n}}),[r,c,T.floating,d.x,d.y]);return e.useMemo((()=>({...d,update:I,refs:M,elements:T,floatingStyles:j})),[d,I,M,T,j])}({strategy:"fixed",placement:O,whileElementsMounted:(...e)=>function(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:c=!1}=r,l=Av(e),u=o||i?[...l?Cv(l):[],...Cv(t)]:[];u.forEach((e=>{o&&e.addEventListener("scroll",n,{passive:!0}),i&&e.addEventListener("resize",n)}));const d=l&&a?function(e,t){let n,r=null;const o=dv(e);function i(){clearTimeout(n),r&&r.disconnect(),r=null}return function s(a,c){void 0===a&&(a=!1),void 0===c&&(c=1),i();const{left:l,top:u,width:d,height:h}=e.getBoundingClientRect();if(a||t(),!d||!h)return;const p={rootMargin:-Fw(u)+"px "+-Fw(o.clientWidth-(l+d))+"px "+-Fw(o.clientHeight-(u+h))+"px "+-Fw(l)+"px",threshold:Ow(0,Dw(1,c))||1};let f=!0;function g(e){const t=e[0].intersectionRatio;if(t!==c){if(!f)return s();t?s(!1,t):n=setTimeout((()=>{s(!1,1e-7)}),100)}f=!1}try{r=new IntersectionObserver(g,{...p,root:o.ownerDocument})}catch(e){r=new IntersectionObserver(g,p)}r.observe(e)}(!0),i}(l,n):null;let h,p=-1,f=null;s&&(f=new ResizeObserver((e=>{let[r]=e;r&&r.target===l&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame((()=>{f&&f.observe(t)}))),n()})),l&&!c&&f.observe(l),f.observe(t));let g=c?Tv(e):null;return c&&function t(){const r=Tv(e);!g||r.x===g.x&&r.y===g.y&&r.width===g.width&&r.height===g.height||n(),g=r,h=requestAnimationFrame(t)}(),n(),()=>{u.forEach((e=>{o&&e.removeEventListener("scroll",n),i&&e.removeEventListener("resize",n)})),d&&d(),f&&f.disconnect(),f=null,c&&cancelAnimationFrame(h)}}(...e,{animationFrame:"always"===x}),elements:{reference:C.anchor},middleware:[iv({mainAxis:p+D,alignmentAxis:g}),_&&sv({mainAxis:!0,crossAxis:!1,limiter:"partial"===v?av():void 0,...L}),_&&tv({...L}),cv({...L,apply:({elements:e,rects:t,availableWidth:n,availableHeight:r})=>{const{width:o,height:i}=t.reference,s=e.floating.style;s.setProperty("--radix-popper-available-width",`${n}px`),s.setProperty("--radix-popper-available-height",`${r}px`),s.setProperty("--radix-popper-anchor-width",`${o}px`),s.setProperty("--radix-popper-anchor-height",`${i}px`)}}),P&&Bv({element:P,padding:m}),ob({arrowWidth:j,arrowHeight:D}),b&&ov({strategy:"referenceHidden",...L})]}),[W,K]=ib($),H=Xf(S);sg((()=>{U&&(null==H||H())}),[U,H]);const G=null===(i=V.arrow)||void 0===i?void 0:i.x,q=null===(s=V.arrow)||void 0===s?void 0:s.y,Y=0!==(null===(a=V.arrow)||void 0===a?void 0:a.centerOffset),[X,Z]=(0,e.useState)();return sg((()=>{E&&Z(window.getComputedStyle(E).zIndex)}),[E]),(0,e.createElement)("div",{ref:N.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:U?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[null===(c=V.transformOrigin)||void 0===c?void 0:c.x,null===(l=V.transformOrigin)||void 0===l?void 0:l.y].join(" ")},dir:t.dir},(0,e.createElement)(eb,{scope:d,placedSide:W,onArrowChange:M,arrowX:G,arrowY:q,shouldHideArrow:Y},(0,e.createElement)(qf.div,zf({"data-side":W,"data-align":K},k,{ref:I,style:{...k.style,animation:U?void 0:"none",opacity:null!==(u=V.hide)&&void 0!==u&&u.referenceHidden?0:void 0}}))))}));function rb(e){return null!==e}const ob=e=>({name:"transformOrigin",options:e,fn(t){var n,r,o,i,s;const{placement:a,rects:c,middlewareData:l}=t,u=0!==(null===(n=l.arrow)||void 0===n?void 0:n.centerOffset),d=u?0:e.arrowWidth,h=u?0:e.arrowHeight,[p,f]=ib(a),g={start:"0%",center:"50%",end:"100%"}[f],m=(null!==(r=null===(o=l.arrow)||void 0===o?void 0:o.x)&&void 0!==r?r:0)+d/2,_=(null!==(i=null===(s=l.arrow)||void 0===s?void 0:s.y)&&void 0!==i?i:0)+h/2;let y="",w="";return"bottom"===p?(y=u?g:`${m}px`,w=-h+"px"):"top"===p?(y=u?g:`${m}px`,w=`${c.floating.height+h}px`):"right"===p?(y=-h+"px",w=u?g:`${_}px`):"left"===p&&(y=`${c.floating.width+h}px`,w=u?g:`${_}px`),{data:{x:y,y:w}}}});function ib(e){const[t,n="center"]=e.split("-");return[t,n]}const sb=t=>{const{__scopePopper:n,children:r}=t,[o,i]=(0,e.useState)(null);return(0,e.createElement)(Xv,{scope:n,anchor:o,onAnchorChange:i},r)},ab=Qv,cb=nb,lb="rovingFocusGroup.onEntryFocus",ub={bubbles:!1,cancelable:!0},db="RovingFocusGroup",[hb,pb,fb]=Gf(db),[gb,mb]=Bf(db,[fb]),[_b,yb]=gb(db),wb=(0,e.forwardRef)(((t,n)=>(0,e.createElement)(hb.Provider,{scope:t.__scopeRovingFocusGroup},(0,e.createElement)(hb.Slot,{scope:t.__scopeRovingFocusGroup},(0,e.createElement)(vb,zf({},t,{ref:n})))))),vb=(0,e.forwardRef)(((t,n)=>{const{__scopeRovingFocusGroup:r,orientation:o,loop:i=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:l,onEntryFocus:u,...d}=t,h=(0,e.useRef)(null),p=Nf(n,h),f=Tw(s),[g=null,m]=lg({prop:a,defaultProp:c,onChange:l}),[_,y]=(0,e.useState)(!1),w=Xf(u),v=pb(r),b=(0,e.useRef)(!1),[x,S]=(0,e.useState)(0);return(0,e.useEffect)((()=>{const e=h.current;if(e)return e.addEventListener(lb,w),()=>e.removeEventListener(lb,w)}),[w]),(0,e.createElement)(_b,{scope:r,orientation:o,dir:f,loop:i,currentTabStopId:g,onItemFocus:(0,e.useCallback)((e=>m(e)),[m]),onItemShiftTab:(0,e.useCallback)((()=>y(!0)),[]),onFocusableItemAdd:(0,e.useCallback)((()=>S((e=>e+1))),[]),onFocusableItemRemove:(0,e.useCallback)((()=>S((e=>e-1))),[])},(0,e.createElement)(qf.div,zf({tabIndex:_||0===x?-1:0,"data-orientation":o},d,{ref:p,style:{outline:"none",...t.style},onMouseDown:Rf(t.onMouseDown,(()=>{b.current=!0})),onFocus:Rf(t.onFocus,(e=>{const t=!b.current;if(e.target===e.currentTarget&&t&&!_){const t=new CustomEvent(lb,ub);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){const e=v().filter((e=>e.focusable));Sb([e.find((e=>e.active)),e.find((e=>e.id===g)),...e].filter(Boolean).map((e=>e.ref.current)))}}b.current=!1})),onBlur:Rf(t.onBlur,(()=>y(!1)))})))})),bb=(0,e.forwardRef)(((t,n)=>{const{__scopeRovingFocusGroup:r,focusable:o=!0,active:i=!1,tabStopId:s,...a}=t,c=gm(),l=s||c,u=yb("RovingFocusGroupItem",r),d=u.currentTabStopId===l,h=pb(r),{onFocusableItemAdd:p,onFocusableItemRemove:f}=u;return(0,e.useEffect)((()=>{if(o)return p(),()=>f()}),[o,p,f]),(0,e.createElement)(hb.ItemSlot,{scope:r,id:l,focusable:o,active:i},(0,e.createElement)(qf.span,zf({tabIndex:d?0:-1,"data-orientation":u.orientation},a,{ref:n,onMouseDown:Rf(t.onMouseDown,(e=>{o?u.onItemFocus(l):e.preventDefault()})),onFocus:Rf(t.onFocus,(()=>u.onItemFocus(l))),onKeyDown:Rf(t.onKeyDown,(e=>{if("Tab"===e.key&&e.shiftKey)return void u.onItemShiftTab();if(e.target!==e.currentTarget)return;const t=function(e,t,n){const r=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,n);return"vertical"===t&&["ArrowLeft","ArrowRight"].includes(r)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(r)?void 0:xb[r]}(e,u.orientation,u.dir);if(void 0!==t){e.preventDefault();let n=h().filter((e=>e.focusable)).map((e=>e.ref.current));if("last"===t)n.reverse();else if("prev"===t||"next"===t){"prev"===t&&n.reverse();const r=n.indexOf(e.currentTarget);n=u.loop?function(e,t){return e.map(((n,r)=>e[(t+r)%e.length]))}(n,r+1):n.slice(r+1)}setTimeout((()=>Sb(n)))}}))})))})),xb={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Sb(e){const t=document.activeElement;for(const n of e){if(n===t)return;if(n.focus(),document.activeElement!==t)return}}const kb=wb,Cb=bb,Eb=["Enter"," "],Ab=["ArrowUp","PageDown","End"],Ib=["ArrowDown","PageUp","Home",...Ab],Pb={ltr:[...Eb,"ArrowRight"],rtl:[...Eb,"ArrowLeft"]},Mb={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Tb="Menu",[jb,Db,Ob]=Gf(Tb),[zb,Fb]=Bf(Tb,[Ob,Yv,mb]),Rb=Yv(),Lb=mb(),[Nb,Bb]=zb(Tb),[$b,Ub]=zb(Tb),Vb=(0,e.forwardRef)(((t,n)=>{const{__scopeMenu:r,...o}=t,i=Rb(r);return(0,e.createElement)(ab,zf({},i,o,{ref:n}))})),Wb="MenuPortal",[Kb,Hb]=zb(Wb,{forceMount:void 0}),Gb="MenuContent",[qb,Yb]=zb(Gb),Xb=(0,e.forwardRef)(((t,n)=>{const r=Hb(Gb,t.__scopeMenu),{forceMount:o=r.forceMount,...i}=t,s=Bb(Gb,t.__scopeMenu),a=Ub(Gb,t.__scopeMenu);return(0,e.createElement)(jb.Provider,{scope:t.__scopeMenu},(0,e.createElement)(ag,{present:o||s.open},(0,e.createElement)(jb.Slot,{scope:t.__scopeMenu},a.modal?(0,e.createElement)(Zb,zf({},i,{ref:n})):(0,e.createElement)(Qb,zf({},i,{ref:n})))))})),Zb=(0,e.forwardRef)(((t,n)=>{const r=Bb(Gb,t.__scopeMenu),o=(0,e.useRef)(null),i=Nf(n,o);return(0,e.useEffect)((()=>{const e=o.current;if(e)return p_(e)}),[]),(0,e.createElement)(Jb,zf({},t,{ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Rf(t.onFocusOutside,(e=>e.preventDefault()),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)}))})),Qb=(0,e.forwardRef)(((t,n)=>{const r=Bb(Gb,t.__scopeMenu);return(0,e.createElement)(Jb,zf({},t,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)}))})),Jb=(0,e.forwardRef)(((t,n)=>{const{__scopeMenu:r,loop:o=!1,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:c,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,onDismiss:f,disableOutsideScroll:g,...m}=t,_=Bb(Gb,r),y=Ub(Gb,r),w=Rb(r),v=Lb(r),b=Db(r),[x,S]=(0,e.useState)(null),k=(0,e.useRef)(null),C=Nf(n,k,_.onContentChange),E=(0,e.useRef)(0),A=(0,e.useRef)(""),I=(0,e.useRef)(0),P=(0,e.useRef)(null),M=(0,e.useRef)("right"),T=(0,e.useRef)(0),j=g?a_:e.Fragment,D=g?{as:Uf,allowPinchZoom:!0}:void 0;(0,e.useEffect)((()=>()=>window.clearTimeout(E.current)),[]),Am();const O=(0,e.useCallback)((e=>{var t,n;return M.current===(null===(t=P.current)||void 0===t?void 0:t.side)&&function(e,t){if(!t)return!1;return function(e,t){const{x:n,y:r}=e;let o=!1;for(let e=0,i=t.length-1;e<t.length;i=e++){const s=t[e].x,a=t[e].y,c=t[i].x,l=t[i].y;a>r!=l>r&&n<(c-s)*(r-a)/(l-a)+s&&(o=!o)}return o}({x:e.clientX,y:e.clientY},t)}(e,null===(n=P.current)||void 0===n?void 0:n.area)}),[]);return(0,e.createElement)(qb,{scope:r,searchRef:A,onItemEnter:(0,e.useCallback)((e=>{O(e)&&e.preventDefault()}),[O]),onItemLeave:(0,e.useCallback)((e=>{var t;O(e)||(null===(t=k.current)||void 0===t||t.focus(),S(null))}),[O]),onTriggerLeave:(0,e.useCallback)((e=>{O(e)&&e.preventDefault()}),[O]),pointerGraceTimerRef:I,onPointerGraceIntentChange:(0,e.useCallback)((e=>{P.current=e}),[])},(0,e.createElement)(j,D,(0,e.createElement)(wm,{asChild:!0,trapped:i,onMountAutoFocus:Rf(s,(e=>{var t;e.preventDefault(),null===(t=k.current)||void 0===t||t.focus()})),onUnmountAutoFocus:a},(0,e.createElement)(eg,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:p,onDismiss:f},(0,e.createElement)(kb,zf({asChild:!0},v,{dir:y.dir,orientation:"vertical",loop:o,currentTabStopId:x,onCurrentTabStopIdChange:S,onEntryFocus:Rf(l,(e=>{y.isUsingKeyboardRef.current||e.preventDefault()}))}),(0,e.createElement)(cb,zf({role:"menu","aria-orientation":"vertical","data-state":mx(_.open),"data-radix-menu-content":"",dir:y.dir},w,m,{ref:C,style:{outline:"none",...m.style},onKeyDown:Rf(m.onKeyDown,(e=>{const t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,n=e.ctrlKey||e.altKey||e.metaKey,r=1===e.key.length;t&&("Tab"===e.key&&e.preventDefault(),!n&&r&&(e=>{var t,n;const r=A.current+e,o=b().filter((e=>!e.disabled)),i=document.activeElement,s=null===(t=o.find((e=>e.ref.current===i)))||void 0===t?void 0:t.textValue,a=function(e,t,n){const r=t.length>1&&Array.from(t).every((e=>e===t[0]))?t[0]:t,o=n?e.indexOf(n):-1;let i=function(e,t){return e.map(((n,r)=>e[(t+r)%e.length]))}(e,Math.max(o,0));1===r.length&&(i=i.filter((e=>e!==n)));const s=i.find((e=>e.toLowerCase().startsWith(r.toLowerCase())));return s!==n?s:void 0}(o.map((e=>e.textValue)),r,s),c=null===(n=o.find((e=>e.textValue===a)))||void 0===n?void 0:n.ref.current;!function e(t){A.current=t,window.clearTimeout(E.current),""!==t&&(E.current=window.setTimeout((()=>e("")),1e3))}(r),c&&setTimeout((()=>c.focus()))})(e.key));const o=k.current;if(e.target!==o)return;if(!Ib.includes(e.key))return;e.preventDefault();const i=b().filter((e=>!e.disabled)).map((e=>e.ref.current));Ab.includes(e.key)&&i.reverse(),function(e){const t=document.activeElement;for(const n of e){if(n===t)return;if(n.focus(),document.activeElement!==t)return}}(i)})),onBlur:Rf(t.onBlur,(e=>{e.currentTarget.contains(e.target)||(window.clearTimeout(E.current),A.current="")})),onPointerMove:Rf(t.onPointerMove,wx((e=>{const t=e.target,n=T.current!==e.clientX;if(e.currentTarget.contains(t)&&n){const t=e.clientX>T.current?"right":"left";M.current=t,T.current=e.clientX}})))})))))))})),ex=(0,e.forwardRef)(((t,n)=>{const{__scopeMenu:r,...o}=t;return(0,e.createElement)(qf.div,zf({role:"group"},o,{ref:n}))})),tx="MenuItem",nx="menu.itemSelect",rx=(0,e.forwardRef)(((t,n)=>{const{disabled:r=!1,onSelect:o,...i}=t,s=(0,e.useRef)(null),a=Ub(tx,t.__scopeMenu),c=Yb(tx,t.__scopeMenu),l=Nf(n,s),u=(0,e.useRef)(!1);return(0,e.createElement)(ox,zf({},i,{ref:l,disabled:r,onClick:Rf(t.onClick,(()=>{const e=s.current;if(!r&&e){const t=new CustomEvent(nx,{bubbles:!0,cancelable:!0});e.addEventListener(nx,(e=>null==o?void 0:o(e)),{once:!0}),Yf(e,t),t.defaultPrevented?u.current=!1:a.onClose()}})),onPointerDown:e=>{var n;null===(n=t.onPointerDown)||void 0===n||n.call(t,e),u.current=!0},onPointerUp:Rf(t.onPointerUp,(e=>{var t;u.current||null===(t=e.currentTarget)||void 0===t||t.click()})),onKeyDown:Rf(t.onKeyDown,(e=>{const t=""!==c.searchRef.current;r||t&&" "===e.key||Eb.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())}))}))})),ox=(0,e.forwardRef)(((t,n)=>{const{__scopeMenu:r,disabled:o=!1,textValue:i,...s}=t,a=Yb(tx,r),c=Lb(r),l=(0,e.useRef)(null),u=Nf(n,l),[d,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)("");return(0,e.useEffect)((()=>{const e=l.current;var t;e&&f((null!==(t=e.textContent)&&void 0!==t?t:"").trim())}),[s.children]),(0,e.createElement)(jb.ItemSlot,{scope:r,disabled:o,textValue:null!=i?i:p},(0,e.createElement)(Cb,zf({asChild:!0},c,{focusable:!o}),(0,e.createElement)(qf.div,zf({role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0},s,{ref:u,onPointerMove:Rf(t.onPointerMove,wx((e=>{o?a.onItemLeave(e):(a.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus())}))),onPointerLeave:Rf(t.onPointerLeave,wx((e=>a.onItemLeave(e)))),onFocus:Rf(t.onFocus,(()=>h(!0))),onBlur:Rf(t.onBlur,(()=>h(!1)))}))))})),ix=(0,e.forwardRef)(((t,n)=>{const{checked:r=!1,onCheckedChange:o,...i}=t;return(0,e.createElement)(lx,{scope:t.__scopeMenu,checked:r},(0,e.createElement)(rx,zf({role:"menuitemcheckbox","aria-checked":_x(r)?"mixed":r},i,{ref:n,"data-state":yx(r),onSelect:Rf(i.onSelect,(()=>null==o?void 0:o(!!_x(r)||!r)),{checkForDefaultPrevented:!1})})))})),[sx,ax]=zb("MenuRadioGroup",{value:void 0,onValueChange:()=>{}}),cx="MenuItemIndicator",[lx,ux]=zb(cx,{checked:!1}),dx=(0,e.forwardRef)(((t,n)=>{const{__scopeMenu:r,forceMount:o,...i}=t,s=ux(cx,r);return(0,e.createElement)(ag,{present:o||_x(s.checked)||!0===s.checked},(0,e.createElement)(qf.span,zf({},i,{ref:n,"data-state":yx(s.checked)})))})),hx="MenuSub",[px,fx]=zb(hx),gx="MenuSubTrigger";function mx(e){return e?"open":"closed"}function _x(e){return"indeterminate"===e}function yx(e){return _x(e)?"indeterminate":e?"checked":"unchecked"}function wx(e){return t=>"mouse"===t.pointerType?e(t):void 0}const vx=t=>{const{__scopeMenu:n,open:r=!1,children:o,dir:i,onOpenChange:s,modal:a=!0}=t,c=Rb(n),[l,u]=(0,e.useState)(null),d=(0,e.useRef)(!1),h=Xf(s),p=Tw(i);return(0,e.useEffect)((()=>{const e=()=>{d.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=()=>d.current=!1;return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}}),[]),(0,e.createElement)(sb,c,(0,e.createElement)(Nb,{scope:n,open:r,onOpenChange:h,content:l,onContentChange:u},(0,e.createElement)($b,{scope:n,onClose:(0,e.useCallback)((()=>h(!1)),[h]),isUsingKeyboardRef:d,dir:p,modal:a},o)))},bx=Vb,xx=t=>{const{__scopeMenu:n,forceMount:r,children:o,container:i}=t,s=Bb(Wb,n);return(0,e.createElement)(Kb,{scope:n,forceMount:r},(0,e.createElement)(ag,{present:r||s.open},(0,e.createElement)(ig,{asChild:!0,container:i},o)))},Sx=Xb,kx=ex,Cx=rx,Ex=ix,Ax=dx,Ix=t=>{const{__scopeMenu:n,children:r,open:o=!1,onOpenChange:i}=t,s=Bb(hx,n),a=Rb(n),[c,l]=(0,e.useState)(null),[u,d]=(0,e.useState)(null),h=Xf(i);return(0,e.useEffect)((()=>(!1===s.open&&h(!1),()=>h(!1))),[s.open,h]),(0,e.createElement)(sb,a,(0,e.createElement)(Nb,{scope:n,open:o,onOpenChange:h,content:u,onContentChange:d},(0,e.createElement)(px,{scope:n,contentId:gm(),triggerId:gm(),trigger:c,onTriggerChange:l},r)))},Px=(0,e.forwardRef)(((t,n)=>{const r=Bb(gx,t.__scopeMenu),o=Ub(gx,t.__scopeMenu),i=fx(gx,t.__scopeMenu),s=Yb(gx,t.__scopeMenu),a=(0,e.useRef)(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:l}=s,u={__scopeMenu:t.__scopeMenu},d=(0,e.useCallback)((()=>{a.current&&window.clearTimeout(a.current),a.current=null}),[]);return(0,e.useEffect)((()=>d),[d]),(0,e.useEffect)((()=>{const e=c.current;return()=>{window.clearTimeout(e),l(null)}}),[c,l]),(0,e.createElement)(Vb,zf({asChild:!0},u),(0,e.createElement)(ox,zf({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":mx(r.open)},t,{ref:Lf(n,i.onTriggerChange),onClick:e=>{var n;null===(n=t.onClick)||void 0===n||n.call(t,e),t.disabled||e.defaultPrevented||(e.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Rf(t.onPointerMove,wx((e=>{s.onItemEnter(e),e.defaultPrevented||t.disabled||r.open||a.current||(s.onPointerGraceIntentChange(null),a.current=window.setTimeout((()=>{r.onOpenChange(!0),d()}),100))}))),onPointerLeave:Rf(t.onPointerLeave,wx((e=>{var t;d();const n=null===(t=r.content)||void 0===t?void 0:t.getBoundingClientRect();if(n){var o;const t=null===(o=r.content)||void 0===o?void 0:o.dataset.side,i="right"===t,a=i?-5:5,l=n[i?"left":"right"],u=n[i?"right":"left"];s.onPointerGraceIntentChange({area:[{x:e.clientX+a,y:e.clientY},{x:l,y:n.top},{x:u,y:n.top},{x:u,y:n.bottom},{x:l,y:n.bottom}],side:t}),window.clearTimeout(c.current),c.current=window.setTimeout((()=>s.onPointerGraceIntentChange(null)),300)}else{if(s.onTriggerLeave(e),e.defaultPrevented)return;s.onPointerGraceIntentChange(null)}}))),onKeyDown:Rf(t.onKeyDown,(e=>{const n=""!==s.searchRef.current;var i;t.disabled||n&&" "===e.key||Pb[o.dir].includes(e.key)&&(r.onOpenChange(!0),null===(i=r.content)||void 0===i||i.focus(),e.preventDefault())}))})))})),Mx=(0,e.forwardRef)(((t,n)=>{const r=Hb(Gb,t.__scopeMenu),{forceMount:o=r.forceMount,...i}=t,s=Bb(Gb,t.__scopeMenu),a=Ub(Gb,t.__scopeMenu),c=fx("MenuSubContent",t.__scopeMenu),l=(0,e.useRef)(null),u=Nf(n,l);return(0,e.createElement)(jb.Provider,{scope:t.__scopeMenu},(0,e.createElement)(ag,{present:o||s.open},(0,e.createElement)(jb.Slot,{scope:t.__scopeMenu},(0,e.createElement)(Jb,zf({id:c.contentId,"aria-labelledby":c.triggerId},i,{ref:u,align:"start",side:"rtl"===a.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:e=>{var t;a.isUsingKeyboardRef.current&&(null===(t=l.current)||void 0===t||t.focus()),e.preventDefault()},onCloseAutoFocus:e=>e.preventDefault(),onFocusOutside:Rf(t.onFocusOutside,(e=>{e.target!==c.trigger&&s.onOpenChange(!1)})),onEscapeKeyDown:Rf(t.onEscapeKeyDown,(e=>{a.onClose(),e.preventDefault()})),onKeyDown:Rf(t.onKeyDown,(e=>{const t=e.currentTarget.contains(e.target),n=Mb[a.dir].includes(e.key);var r;t&&n&&(s.onOpenChange(!1),null===(r=c.trigger)||void 0===r||r.focus(),e.preventDefault())}))})))))})),Tx="DropdownMenu",[jx,Dx]=Bf(Tx,[Fb]),Ox=Fb(),[zx,Fx]=jx(Tx),Rx=t=>{const{__scopeDropdownMenu:n,children:r,dir:o,open:i,defaultOpen:s,onOpenChange:a,modal:c=!0}=t,l=Ox(n),u=(0,e.useRef)(null),[d=!1,h]=lg({prop:i,defaultProp:s,onChange:a});return(0,e.createElement)(zx,{scope:n,triggerId:gm(),triggerRef:u,contentId:gm(),open:d,onOpenChange:h,onOpenToggle:(0,e.useCallback)((()=>h((e=>!e))),[h]),modal:c},(0,e.createElement)(vx,zf({},l,{open:d,onOpenChange:h,dir:o,modal:c}),r))},Lx=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,disabled:o=!1,...i}=t,s=Fx("DropdownMenuTrigger",r),a=Ox(r);return(0,e.createElement)(bx,zf({asChild:!0},a),(0,e.createElement)(qf.button,zf({type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":o?"":void 0,disabled:o},i,{ref:Lf(n,s.triggerRef),onPointerDown:Rf(t.onPointerDown,(e=>{o||0!==e.button||!1!==e.ctrlKey||(s.onOpenToggle(),s.open||e.preventDefault())})),onKeyDown:Rf(t.onKeyDown,(e=>{o||(["Enter"," "].includes(e.key)&&s.onOpenToggle(),"ArrowDown"===e.key&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())}))})))})),Nx=t=>{const{__scopeDropdownMenu:n,...r}=t,o=Ox(n);return(0,e.createElement)(xx,zf({},o,r))},Bx=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Fx("DropdownMenuContent",r),s=Ox(r),a=(0,e.useRef)(!1);return(0,e.createElement)(Sx,zf({id:i.contentId,"aria-labelledby":i.triggerId},s,o,{ref:n,onCloseAutoFocus:Rf(t.onCloseAutoFocus,(e=>{var t;a.current||null===(t=i.triggerRef.current)||void 0===t||t.focus(),a.current=!1,e.preventDefault()})),onInteractOutside:Rf(t.onInteractOutside,(e=>{const t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;i.modal&&!r||(a.current=!0)})),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))})),$x=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Ox(r);return(0,e.createElement)(kx,zf({},i,o,{ref:n}))})),Ux=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Ox(r);return(0,e.createElement)(Cx,zf({},i,o,{ref:n}))})),Vx=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Ox(r);return(0,e.createElement)(Ex,zf({},i,o,{ref:n}))})),Wx=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Ox(r);return(0,e.createElement)(Ax,zf({},i,o,{ref:n}))})),Kx=t=>{const{__scopeDropdownMenu:n,children:r,open:o,onOpenChange:i,defaultOpen:s}=t,a=Ox(n),[c=!1,l]=lg({prop:o,defaultProp:s,onChange:i});return(0,e.createElement)(Ix,zf({},a,{open:c,onOpenChange:l}),r)},Hx=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Ox(r);return(0,e.createElement)(Px,zf({},i,o,{ref:n}))})),Gx=(0,e.forwardRef)(((t,n)=>{const{__scopeDropdownMenu:r,...o}=t,i=Ox(r);return(0,e.createElement)(Mx,zf({},i,o,{ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}));function qx(t,n){const r=Yr(),o=(0,e.useRef)(!1),i=_y(),s=(0,e.useRef)(0),a=(0,e.useCallback)((e=>{const i=Date.now();i-s.current<50||(s.current=i,o.current=e,r.batch((()=>{e?(r.complete(),r.addOpenMenu(t)):r.updateInstanceState({openMenus:r.getOpenMenus().filter((e=>!e.startsWith(t)))}),n?.(e)})))}),[r,t,n]),c=le("is menu open",(()=>r.getOpenMenus().includes(t)),[r,t]);return(0,e.useEffect)((()=>(o.current&&(i("open-menu",{source:"unknown",id:t}),r.addOpenMenu(t)),()=>{o.current&&(r.deleteOpenMenu(t),r.getOpenMenus().forEach((e=>{e.startsWith(t)&&(i("close-menu",{source:"unknown",id:t}),r.deleteOpenMenu(e))})),o.current=!1)})),[r,t,i]),[c,a]}function Yx({id:e,children:t,modal:n=!1,debugOpen:r=!1}){const[o,i]=qx(e);return(0,Fr.jsx)(Rx,{open:r||o,dir:"ltr",modal:n,onOpenChange:i,children:t})}function Xx({children:e,"data-testid":t}){return(0,Fr.jsx)(Lx,{dir:"ltr","data-testid":t,asChild:!0,onTouchEnd:e=>Vr(e),children:e})}function Zx({side:e="bottom",align:t="start",sideOffset:n=8,alignOffset:r=8,children:o}){const i=Qr();return(0,Fr.jsx)(Nx,{container:i,children:(0,Fr.jsx)(Bx,{className:"tlui-menu",align:t,sideOffset:n,side:e,alignOffset:r,collisionPadding:4,children:o})})}function Qx({id:e,children:t}){const[n,r]=qx(e);return(0,Fr.jsx)(Kx,{open:n,onOpenChange:r,children:t})}function Jx({label:e,"data-testid":t,"data-direction":n}){return(0,Fr.jsx)(Hx,{dir:"ltr","data-direction":n,"data-testid":t,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",className:"tlui-menu__submenu__trigger",label:e,icon:"chevron-right"})})}function eS({alignOffset:e=0,sideOffset:t=5,children:n}){const r=Qr();return(0,Fr.jsx)(Nx,{container:r,children:(0,Fr.jsx)(Gx,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:t,collisionPadding:4,children:n})})}function tS({children:e,size:t="medium"}){return(0,Fr.jsx)($x,{dir:"ltr",className:"tlui-menu__group","data-size":t,children:e})}function nS({noClose:e,...t}){return(0,Fr.jsx)(Ux,{dir:"ltr",asChild:!0,onClick:e||void 0!==t.isChecked?Vr:void 0,children:(0,Fr.jsx)(hm,{...t})})}function rS({children:e,onSelect:t,...n}){return(0,Fr.jsxs)(Vx,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",onSelect:e=>{t?.(e),Vr(e)},...n,children:[(0,Fr.jsx)(sm,{small:!0,icon:n.checked?"check":"checkbox-empty"}),e]})}function oS({children:e,onSelect:t,...n}){return(0,Fr.jsxs)(Vx,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",onSelect:e=>{t?.(e),Vr(e)},...n,children:[(0,Fr.jsx)("div",{className:"tlui-button__checkbox__indicator",children:(0,Fr.jsx)(Wx,{dir:"ltr",children:(0,Fr.jsx)(sm,{icon:"check",small:!0})})}),e]})}let iS=0;const sS=e.memo((function({renderDebugMenuItems:e}){const t=om();return(0,Fr.jsxs)("div",{className:"tlui-debug-panel",children:[(0,Fr.jsx)(aS,{}),(0,Fr.jsx)(cS,{}),(0,Fr.jsxs)(Yx,{id:"debug",children:[(0,Fr.jsx)(Xx,{children:(0,Fr.jsx)(hm,{type:"icon",icon:"dots-horizontal",title:t("debug-panel.more")})}),(0,Fr.jsx)(Zx,{side:"top",align:"end",alignOffset:0,children:(0,Fr.jsx)(lS,{renderDebugMenuItems:e})})]})]})})),aS=se((function(){const e=Yr();return(0,Fr.jsx)("div",{className:"tlui-debug-panel__current-state",children:e.getPath()})})),cS=function(){const e=Yr(),t=le("rendering shapes count",(()=>e.getRenderingShapes().length),[e]);return(0,Fr.jsxs)("div",{children:[t," Shapes"]})},lS=se((function({renderDebugMenuItems:t}){const n=Yr(),{addToast:r}=Dy(),{addDialog:o}=Fy(),[i,s]=e.useState(!1);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(tS,{children:[(0,Fr.jsx)(nS,{type:"menu",onClick:()=>{r({id:ua(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!1}),r({id:ua(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,icon:"twitter",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]})},label:"Show toast"}),(0,Fr.jsx)(nS,{type:"menu",onClick:()=>{o({component:({onClose:e})=>(0,Fr.jsx)(hS,{displayDontShowAgain:!0,onCancel:()=>{e()},onContinue:()=>{e()}}),onClose:()=>{}})},label:"Show dialog"}),(0,Fr.jsx)(nS,{type:"menu",onClick:()=>function(e,t){const n=Array(100),r=Math.floor(Math.sqrt(100));for(let e=0;e<100;e++)iS++,n[e]={id:jn("box"+iS),type:"geo",x:e%r*132,y:132*Math.floor(e/r)};e.batch((()=>{e.createShapes(n).setSelectedShapes(n.map((e=>e.id)))}))}(n),label:"Create 100 shapes"}),(0,Fr.jsx)(nS,{type:"menu",onClick:()=>{function e({children:t}){let n=0;if(!t.length)return 0;for(const r of[...t])n++,n+=e(r);return n}const t=n.getSelectedShapes(),r=0===t.length?n.getRenderingShapes():t,o=r.map((e=>document.getElementById(e.id).parentElement));let i=o.length;for(const t of o)i+=e(t);window.alert(`Shapes ${r.length}, DOM nodes:${i}`)},label:"Count shapes / nodes"}),(()=>{if(i)throw Error("oh no!")})(),(0,Fr.jsx)(nS,{type:"menu",onClick:()=>{s(!0)},label:"Throw error"}),(0,Fr.jsx)(nS,{type:"menu",onClick:()=>{Ho()},label:"Hard reset"})]}),(0,Fr.jsxs)(tS,{children:[(0,Fr.jsx)(dS,{flag:Nr.debugSvg}),(0,Fr.jsx)(dS,{flag:Nr.forceSrgb}),(0,Fr.jsx)(dS,{flag:Nr.debugGeometry}),(0,Fr.jsx)(dS,{flag:Nr.hideShapes})]}),(0,Fr.jsx)(tS,{children:Object.values(Lr).map((e=>(0,Fr.jsx)(dS,{flag:e},e.name)))}),t?.()]})}));function uS({label:e,value:t,onChange:n}){return(0,Fr.jsx)(rS,{title:e,checked:t,onSelect:()=>n(!t),children:(0,Fr.jsx)("span",{className:"tlui-button__label",draggable:!1,children:e})})}const dS=se((function({flag:e,onChange:t}){return(0,Fr.jsx)(uS,{label:e.name.replace(/([a-z0-9])([A-Z])/g,(e=>`${e[0]} ${e[1].toLowerCase()}`)).replace(/^[a-z]/,(e=>e.toUpperCase())),value:e.get(),onChange:n=>{e.set(n),t?.(n)}})}));function hS({title:t="title",body:n="hello hello hello",cancel:r="Cancel",confirm:o="Continue",displayDontShowAgain:i=!1,onCancel:s,onContinue:a}){const[c,l]=e.useState(!1);return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)(B_,{children:[(0,Fr.jsx)($_,{children:t}),(0,Fr.jsx)(U_,{})]}),(0,Fr.jsx)(V_,{style:{maxWidth:350},children:n}),(0,Fr.jsxs)(W_,{className:"tlui-dialog__footer__actions",children:[i&&(0,Fr.jsx)(hm,{type:"normal",onClick:()=>l(!c),iconLeft:c?"check":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),(0,Fr.jsx)(hm,{type:"normal",onClick:s,children:r}),(0,Fr.jsx)(hm,{type:"primary",onClick:async()=>a(),children:o})]})]})}const pS=({id:t,component:n,onClose:r})=>{const{removeDialog:o}=Fy(),i=Qr(),s=(0,e.useCallback)((e=>{if(!e){if(r)try{r()}catch(e){console.warn(e)}o(t)}}),[t,r,o]);return(0,Fr.jsx)(F_,{onOpenChange:s,defaultOpen:!0,children:(0,Fr.jsx)(R_,{container:i,children:(0,Fr.jsx)(L_,{dir:"ltr",className:"tlui-dialog__overlay",children:(0,Fr.jsx)(N_,{dir:"ltr",className:"tlui-dialog__content",children:(0,Fr.jsx)(n,{onClose:()=>s(!1)})})})})})},fS=e.memo((function(){const{dialogs:e}=Fy();return(0,Fr.jsx)(Fr.Fragment,{children:e.map((e=>(0,Fr.jsx)(pS,{...e},e.id)))})}));function gS(){const e=Yr(),t=le("follow",(()=>e.getInstanceState().followingUserId),[e]);return t?(0,Fr.jsx)(mS,{userId:t}):null}function mS({userId:e}){const t=Is(e);return t?(0,Fr.jsx)("div",{className:"tlui-following-indicator",style:{borderColor:t.color}}):null}function _S(){const t=Yr(),{languages:n,currentLanguage:r}=gw(),o=(0,e.useCallback)((e=>t.user.updateUserPreferences({locale:e})),[t]);return(0,Fr.jsxs)(Qx,{id:"help menu language",children:[(0,Fr.jsx)(Jx,{label:"menu.language","data-direction":"left"}),(0,Fr.jsx)(eS,{sideOffset:-4,children:(0,Fr.jsx)(tS,{children:n.map((({locale:e,label:t})=>(0,Fr.jsx)(oS,{title:e,checked:e===r,onSelect:()=>o(e),children:(0,Fr.jsx)("span",{className:"tlui-button__label",children:t})},e)))})})]})}const yS=e.memo((function(){const e=Qr(),t=om(),[n,r]=qx("help menu");return(0,Fr.jsx)("div",{className:"tlui-help-menu",children:(0,Fr.jsxs)(Rx,{dir:"ltr",open:n,onOpenChange:r,modal:!1,children:[(0,Fr.jsx)(Lx,{asChild:!0,dir:"ltr",children:(0,Fr.jsx)(hm,{type:"help",className:"tlui-button",smallIcon:!0,title:t("help-menu.title"),icon:"question-mark"})}),(0,Fr.jsx)(Nx,{container:e,children:(0,Fr.jsx)(Bx,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:(0,Fr.jsx)(wS,{})})})]})})}));function wS(){const t=function(){const t=e.useContext(mw);if(!t)throw new Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return t}(),n=Uu();return(0,Fr.jsx)(Fr.Fragment,{children:t.map((function e(t){if(!t)return null;if(n&&!t.readonlyOk)return null;switch(t.type){case"custom":if("LANGUAGE_MENU"===t.id)return(0,Fr.jsx)(_S,{},"item");break;case"group":return(0,Fr.jsx)(tS,{size:"small",children:t.children.map(e)},t.id);case"submenu":return(0,Fr.jsxs)(Qx,{id:`help menu ${t.id}`,children:[(0,Fr.jsx)(Jx,{label:t.label}),(0,Fr.jsx)(eS,{children:t.children.map(e)})]},t.id);case"item":{const{id:e,kbd:n,label:r,onSelect:o,icon:i}=t.actionItem;return(0,Fr.jsx)(nS,{type:"menu",kbd:n,label:r,onClick:()=>o("help-menu"),iconLeft:i},e)}}}))})}const vS="Popover",[bS,xS]=Bf(vS,[Yv]),SS=Yv(),[kS,CS]=bS(vS),ES=(0,e.forwardRef)(((t,n)=>{const{__scopePopover:r,...o}=t,i=CS("PopoverTrigger",r),s=SS(r),a=Nf(n,i.triggerRef),c=(0,e.createElement)(qf.button,zf({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":zS(i.open)},o,{ref:a,onClick:Rf(t.onClick,i.onOpenToggle)}));return i.hasCustomAnchor?c:(0,e.createElement)(ab,zf({asChild:!0},s),c)})),AS="PopoverPortal",[IS,PS]=bS(AS,{forceMount:void 0}),MS="PopoverContent",TS=(0,e.forwardRef)(((t,n)=>{const r=PS(MS,t.__scopePopover),{forceMount:o=r.forceMount,...i}=t,s=CS(MS,t.__scopePopover);return(0,e.createElement)(ag,{present:o||s.open},s.modal?(0,e.createElement)(jS,zf({},i,{ref:n})):(0,e.createElement)(DS,zf({},i,{ref:n})))})),jS=(0,e.forwardRef)(((t,n)=>{const r=CS(MS,t.__scopePopover),o=(0,e.useRef)(null),i=Nf(n,o),s=(0,e.useRef)(!1);return(0,e.useEffect)((()=>{const e=o.current;if(e)return p_(e)}),[]),(0,e.createElement)(a_,{as:Uf,allowPinchZoom:!0},(0,e.createElement)(OS,zf({},t,{ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Rf(t.onCloseAutoFocus,(e=>{var t;e.preventDefault(),s.current||null===(t=r.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:Rf(t.onPointerDownOutside,(e=>{const t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,r=2===t.button||n;s.current=r}),{checkForDefaultPrevented:!1}),onFocusOutside:Rf(t.onFocusOutside,(e=>e.preventDefault()),{checkForDefaultPrevented:!1})})))})),DS=(0,e.forwardRef)(((t,n)=>{const r=CS(MS,t.__scopePopover),o=(0,e.useRef)(!1),i=(0,e.useRef)(!1);return(0,e.createElement)(OS,zf({},t,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{var n,s;null===(n=t.onCloseAutoFocus)||void 0===n||n.call(t,e),e.defaultPrevented||(o.current||null===(s=r.triggerRef.current)||void 0===s||s.focus(),e.preventDefault()),o.current=!1,i.current=!1},onInteractOutside:e=>{var n,s;null===(n=t.onInteractOutside)||void 0===n||n.call(t,e),e.defaultPrevented||(o.current=!0,"pointerdown"===e.detail.originalEvent.type&&(i.current=!0));const a=e.target;(null===(s=r.triggerRef.current)||void 0===s?void 0:s.contains(a))&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&i.current&&e.preventDefault()}}))})),OS=(0,e.forwardRef)(((t,n)=>{const{__scopePopover:r,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:d,...h}=t,p=CS(MS,r),f=SS(r);return Am(),(0,e.createElement)(wm,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:i,onUnmountAutoFocus:s},(0,e.createElement)(eg,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:d,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1)},(0,e.createElement)(cb,zf({"data-state":zS(p.open),role:"dialog",id:p.contentId},f,h,{ref:n,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))}));function zS(e){return e?"open":"closed"}const FS=t=>{const{__scopePopover:n,children:r,open:o,defaultOpen:i,onOpenChange:s,modal:a=!1}=t,c=SS(n),l=(0,e.useRef)(null),[u,d]=(0,e.useState)(!1),[h=!1,p]=lg({prop:o,defaultProp:i,onChange:s});return(0,e.createElement)(sb,c,(0,e.createElement)(kS,{scope:n,contentId:gm(),triggerRef:l,open:h,onOpenChange:p,onOpenToggle:(0,e.useCallback)((()=>p((e=>!e))),[p]),hasCustomAnchor:u,onCustomAnchorAdd:(0,e.useCallback)((()=>d(!0)),[]),onCustomAnchorRemove:(0,e.useCallback)((()=>d(!1)),[]),modal:a},r))},RS=ES,LS=t=>{const{__scopePopover:n,forceMount:r,children:o,container:i}=t,s=CS(AS,n);return(0,e.createElement)(IS,{scope:n,forceMount:r},(0,e.createElement)(ag,{present:r||s.open},(0,e.createElement)(ig,{asChild:!0,container:i},o)))},NS=TS,BS=({id:e,children:t,onOpenChange:n,open:r})=>{const[o,i]=qx(e,n);return(0,Fr.jsx)(FS,{onOpenChange:i,open:r||o,children:(0,Fr.jsx)("div",{className:"tlui-popover",children:t})})},$S=({children:e,disabled:t,"data-testid":n})=>(0,Fr.jsx)(RS,{"data-testid":n,disabled:t,asChild:!0,dir:"ltr",children:e}),US=({side:e,children:t,align:n="center",sideOffset:r=8,alignOffset:o=0})=>{const i=Qr();return(0,Fr.jsx)(LS,{container:i,children:(0,Fr.jsx)(NS,{className:"tlui-popover__content",side:e,sideOffset:r,align:n,alignOffset:o,dir:"ltr",children:t})})},VS=(0,e.memo)((function(){const t=om(),n=Qr(),r=function(){const t=e.useContext(rw);if(!t)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return t}(),o=Uu();return(0,Fr.jsxs)(BS,{id:"actions-menu",children:[(0,Fr.jsx)($S,{children:(0,Fr.jsx)(hm,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:t("actions-menu.title"),type:"icon",smallIcon:!0})}),(0,Fr.jsx)(LS,{container:n,children:(0,Fr.jsx)(NS,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:(0,Fr.jsx)("div",{className:"tlui-actions-menu tlui-buttons__grid",children:r.map((function(e){if(!e)return null;if(o&&!e.readonlyOk)return null;if("item"===e.type){const{id:n,icon:r,label:o,kbd:i,onSelect:s}=e.actionItem;return(0,Fr.jsx)(hm,{"data-testid":`menu-item.${e.id}`,icon:r,type:"icon",title:o?i?`${t(o)} ${um(i)}`:`${t(o)}`:i?`${um(i)}`:"",onClick:()=>s("actions-menu"),disabled:e.disabled},n)}}))})})})]})})),WS=se((function(){const e=Yr(),t=Uy(),n=om(),r=t.duplicate;return(0,Fr.jsx)(hm,{icon:r.icon,type:"icon",onClick:()=>r.onSelect("quick-actions"),disabled:!(e.isIn("select")&&e.getSelectedShapeIds().length>0),title:`${n(r.label)} ${um(r.kbd)}`,smallIcon:!0})})),KS=e.memo((function(){const e=om();return(0,Fr.jsxs)(Yx,{id:"main menu",children:[(0,Fr.jsx)(Xx,{children:(0,Fr.jsx)(hm,{type:"icon",className:"tlui-menu__trigger","data-testid":"main.menu",title:e("menu.title"),icon:"menu",smallIcon:!0})}),(0,Fr.jsx)(Zx,{alignOffset:0,sideOffset:6,children:(0,Fr.jsx)(HS,{})})]})}));function HS(){const t=Yr(),n=om(),r=function(){const t=e.useContext(vw);if(!t)throw new Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return t}(),o=tw(),i=Uu();function s(e,t,r,a){if(!t)return null;switch(t.type){case"custom":return i&&!t.readonlyOk?null:"LANGUAGE_MENU"===t.id?(0,Fr.jsx)(_S,{},"item"):null;case"group":return i&&!t.readonlyOk?null:(0,Fr.jsx)(tS,{size:a<=1?"medium":o<3||"submenu"===r?.type&&a>2?"tiny":"medium",children:t.children.map((n=>s(e,n,t,a+1)))},t.id);case"submenu":return i&&!t.readonlyOk?null:(0,Fr.jsxs)(Qx,{id:`main menu ${r?r.id+" ":""}${t.id}`,children:[(0,Fr.jsx)(Jx,{label:t.label,"data-testid":`menu-item.${t.id}`}),(0,Fr.jsx)(eS,{sideOffset:-4,alignOffset:-1,children:t.children.map((n=>s(e,n,t,a+1)))})]},t.id);case"item":{if(i&&!t.readonlyOk)return null;const{id:e,checkbox:r,menuLabel:o,label:s,onSelect:a,kbd:c}=t.actionItem,l=o??s,u=l?n(l):void 0;return r?(0,Fr.jsxs)(rS,{onSelect:()=>a("menu"),title:u||"",checked:t.checked,disabled:t.disabled,children:[u&&(0,Fr.jsx)("span",{className:"tlui-button__label",children:u}),c&&(0,Fr.jsx)(dm,{children:c})]},e):(0,Fr.jsx)(nS,{type:"menu","data-testid":`menu-item.${t.id}`,kbd:c,label:l,onClick:()=>a("menu"),disabled:t.disabled},e)}}}return(0,Fr.jsx)(Fr.Fragment,{children:r.map((e=>s(t,e,null,0)))})}const GS=function({name:t,id:n,isCurrentPage:r}){const o=Yr(),i=(0,e.useRef)(null),s=(0,e.useCallback)((e=>{o.renamePage(n,e||"New Page",{ephemeral:!0})}),[o,n]),a=(0,e.useCallback)((e=>{o.mark("rename page"),o.renamePage(n,e||"New Page",{ephemeral:!1})}),[o,n]);return(0,Fr.jsx)(K_,{className:"tlui-page-menu__item__input",ref:e=>i.current=e,defaultValue:t,onValueChange:s,onComplete:a,onCancel:a,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:r,autoselect:!0})},qS=(e,t,n,r)=>{let o;const i=e.getPages(),s=n>r?i[r-1]:i[r],a=n>r?i[r]:i[r+1];o=s&&!a?hc(s.index):!s&&a?function(e){return cc(void 0,e,1)[0]}(i[0].index):dc(s.index,a.index),o!==i[n].index&&(e.mark("moving page"),e.updatePage({id:t,index:o}))},YS=se((function({index:t,listSize:n,item:r,onRename:o}){const i=Yr(),s=om(),a=i.getPages(),c=(0,e.useCallback)((()=>{i.mark("creating page");const e=Qt.createId();i.duplicatePage(r.id,e)}),[i,r]),l=(0,e.useCallback)((()=>{qS(i,r.id,t,t-1)}),[i,r,t]),u=(0,e.useCallback)((()=>{qS(i,r.id,t,t+1)}),[i,r,t]),d=(0,e.useCallback)((()=>{i.mark("deleting page"),i.deletePage(r.id)}),[i,r]);return(0,Fr.jsxs)(Yx,{id:`page item submenu ${t}`,children:[(0,Fr.jsx)(Xx,{children:(0,Fr.jsx)(hm,{type:"icon",title:s("page-menu.submenu.title"),icon:"dots-vertical"})}),(0,Fr.jsxs)(Zx,{alignOffset:0,children:[(0,Fr.jsxs)(tS,{children:[o&&(0,Fr.jsx)(Ux,{dir:"ltr",onSelect:o,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:"page-menu.submenu.rename"})}),(0,Fr.jsx)(Ux,{dir:"ltr",onSelect:c,disabled:a.length>=40,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:"page-menu.submenu.duplicate-page"})}),t>0&&(0,Fr.jsx)(Ux,{dir:"ltr",onSelect:l,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:"page-menu.submenu.move-up"})}),t<n-1&&(0,Fr.jsx)(Ux,{dir:"ltr",onSelect:u,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:"page-menu.submenu.move-down"})})]}),n>1&&(0,Fr.jsx)(tS,{children:(0,Fr.jsx)(Ux,{dir:"ltr",onSelect:d,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:"page-menu.submenu.delete"})})})]})]})})),XS=function(){const t=Yr(),n=om(),r=tw(),o=(0,e.useCallback)((()=>m(!1)),[]),[i,s]=qx("page-menu",o),a=36,c=(0,e.useRef)(null),l=le("pages",(()=>t.getPages()),[t]),u=le("currentPage",(()=>t.getCurrentPage()),[t]),d=le("currentPageId",(()=>t.getCurrentPageId()),[t]),h=Uu(),p=le("maxPageCountReached",(()=>t.getPages().length>=40),[t]),f=le("isCoarsePointer",(()=>t.getInstanceState().isCoarsePointer),[t]),[g,m]=(0,e.useState)(!1),_=(0,e.useCallback)((()=>{h||m((e=>!e))}),[h]),y=(0,e.useRef)({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[w,v]=(0,e.useState)(Object.fromEntries(l.map(((e,t)=>[e.id,{y:t*a,offsetY:0,isSelected:!1}]))));(0,e.useLayoutEffect)((()=>{v(Object.fromEntries(l.map(((e,t)=>[e.id,{y:t*a,offsetY:0,isSelected:!1}]))))}),[a,l]),(0,e.useEffect)((()=>{i&&requestAnimationFrame((()=>{const e=document.querySelector(`[data-testid="page-menu-item-${d}"]`);if(e){const t=c.current;if(!t)return;const n=e.offsetTop;n<t.scrollTop&&t.scrollTo({top:n});const r=n+a;r>t.scrollTop+t.offsetHeight&&t.scrollTo({top:r-t.offsetHeight})}}))}),[a,d,i]);const b=(0,e.useCallback)((e=>{const{clientY:t,currentTarget:n}=e,{dataset:{id:r,index:o}}=n;if(!r||!o)return;const i=y.current;Wr(e.currentTarget,e),i.status="pointing",i.pointing={id:r,index:+o};const s=w[r].y;i.startY=t,i.startIndex=Math.max(0,Math.min(Math.round(s/a),l.length-1))}),[a,l.length,w]),x=(0,e.useCallback)((e=>{const t=y.current;if("pointing"===t.status){const{clientY:n}=e,r=n-t.startY;Math.abs(r)>5&&(t.status="dragging")}if("dragging"===t.status){const{clientY:n}=e,r=n-t.startY,o=w[t.pointing.id],{startIndex:i,pointing:s}=t,c=o.y+r,u=Math.max(0,Math.min(Math.round(c/a),l.length-1)),d={...w};if(d[s.id]={y:o.y,offsetY:r,isSelected:!0},u!==t.dragIndex){t.dragIndex=u;for(let e=0;e<l.length;e++){const n=l[e];if(n.id===t.pointing.id)continue;let{y:r}=d[n.id];u===i?r=e*a:u<i?r=u<=e&&e<i?(e+1)*a:e*a:u>i&&(r=u>=e&&e>i?(e-1)*a:e*a),r!==d[n.id].y&&(d[n.id]={y:r,offsetY:0,isSelected:!0})}}v(d)}}),[a,l,w]),S=(0,e.useCallback)((e=>{const n=y.current;if("dragging"===n.status){const{id:e,index:r}=n.pointing;qS(t,e,r,n.dragIndex)}Kr(e.currentTarget,e),n.status="idle"}),[t]),k=(0,e.useCallback)((e=>{const t=y.current;"Escape"===e.key&&("dragging"===t.status&&v(Object.fromEntries(l.map(((e,t)=>[e.id,{y:t*a,offsetY:0,isSelected:!1}])))),t.status="idle")}),[a,l]),C=(0,e.useCallback)((()=>{h||t.batch((()=>{t.mark("creating page");const e=Qt.createId();t.createPage({name:n("page-menu.new-page-initial-name"),id:e}),t.setCurrentPage(e),m(!0)}))}),[t,n,h]);return(0,Fr.jsxs)(BS,{id:"pages",onOpenChange:s,open:i,children:[(0,Fr.jsx)($S,{children:(0,Fr.jsx)(hm,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",type:"menu",title:u.name,children:(0,Fr.jsx)("div",{className:"tlui-page-menu__name",children:u.name})})}),(0,Fr.jsx)(US,{side:"bottom",align:"start",sideOffset:6,children:(0,Fr.jsxs)("div",{className:"tlui-page-menu__wrapper",children:[(0,Fr.jsxs)("div",{className:"tlui-page-menu__header",children:[(0,Fr.jsx)("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!h&&(0,Fr.jsxs)("div",{className:"tlui-buttons__horizontal",children:[(0,Fr.jsx)(hm,{type:"icon","data-testid":"page-menu.edit",title:n(g?"page-menu.edit-done":"page-menu.edit-start"),icon:g?"check":"edit",onClick:_}),(0,Fr.jsx)(hm,{type:"icon","data-testid":"page-menu.create",icon:"plus",title:n(p?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:p,onClick:C})]})]}),(0,Fr.jsx)("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:a*l.length+4},ref:c,children:l.map(((e,o)=>{const i=w[e.id]??{position:40*o,offsetY:0};return g?(0,Fr.jsxs)("div",{"data-testid":`page-menu-item-${e.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:e.id===u.id?888:o,transform:`translate(0px, ${i.y+i.offsetY}px)`},children:[(0,Fr.jsx)(hm,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:b,onPointerUp:S,onPointerMove:x,onKeyDown:k,"data-id":e.id,"data-index":o}),r<5&&f?(0,Fr.jsx)(hm,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const n=window.prompt("Rename page",e.name);n&&n!==e.name&&t.renamePage(e.id,n)},onDoubleClick:_,isChecked:e.id===u.id,children:(0,Fr.jsx)("span",{children:e.name})}):(0,Fr.jsx)("div",{className:"tlui-page_menu__item__sortable__title",style:{height:a},children:(0,Fr.jsx)(GS,{id:e.id,name:e.name,isCurrentPage:e.id===u.id})}),!h&&(0,Fr.jsx)("div",{className:"tlui-page_menu__item__submenu","data-isediting":g,children:(0,Fr.jsx)(YS,{index:o,item:e,listSize:l.length})})]},e.id+"_editing"):(0,Fr.jsxs)("div",{"data-testid":`page-menu-item-${e.id}`,className:"tlui-page-menu__item",children:[(0,Fr.jsxs)(hm,{type:"icon",className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>t.setCurrentPage(e.id),onDoubleClick:_,isChecked:e.id===u.id,title:n("page-menu.go-to-page"),children:[(0,Fr.jsx)("div",{className:"tlui-page-menu__item__button__check",children:e.id===u.id&&(0,Fr.jsx)(sm,{icon:"check"})}),(0,Fr.jsx)("span",{children:e.name})]}),!h&&(0,Fr.jsx)("div",{className:"tlui-page_menu__item__submenu",children:(0,Fr.jsx)(YS,{index:o,item:e,listSize:l.length,onRename:()=>{if(t.environment.isIos){const n=window.prompt("Rename page",e.name);n&&n!==e.name&&t.renamePage(e.id,n)}else t.batch((()=>{m(!0),t.setCurrentPage(e.id)}))}})})]},e.id)}))})]})})]})},ZS=(0,e.memo)((function(){const e=om(),t=yw(),n=Uy().redo;return(0,Fr.jsx)(hm,{"data-testid":"main.redo",icon:n.icon,type:"icon",title:`${e(n.label)} ${um(n.kbd)}`,disabled:!t,onClick:()=>n.onSelect("quick-actions"),smallIcon:!0})})),QS=se((function(){const e=Yr(),t=Uy(),n=om(),r=t.delete;return Uu()?null:(0,Fr.jsx)(hm,{icon:r.icon,type:"icon",onClick:()=>r.onSelect("quick-actions"),disabled:!(e.isIn("select")&&e.getSelectedShapeIds().length>0),title:`${n(r.label)} ${um(r.kbd)}`,smallIcon:!0})})),JS=(0,e.memo)((function(){const e=om(),t=ww(),n=Uy().undo;return(0,Fr.jsx)(hm,{"data-testid":"main.undo",icon:n.icon,type:"icon",title:`${e(n.label)} ${um(n.kbd)}`,disabled:!t,onClick:()=>n.onSelect("quick-actions"),smallIcon:!0})})),ek=se((function(){const e=Yr(),t=tw(),n=Uu();return(0,Fr.jsx)("div",{className:"tlui-menu-zone",children:(0,Fr.jsxs)("div",{className:"tlui-buttons__horizontal",children:[(0,Fr.jsx)(KS,{}),(0,Fr.jsx)(XS,{}),t>=6&&!n&&!e.isInAny("hand","zoom")&&(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(JS,{}),(0,Fr.jsx)(ZS,{}),(0,Fr.jsx)(QS,{}),(0,Fr.jsx)(WS,{}),(0,Fr.jsx)(VS,{})]})]})})}));class tk{constructor(e){this.editor=e}dpr=1;colors={shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"};id=ua();cvs=null;pageBounds=[];collaborators=[];canvasScreenBounds=new fo;canvasPageBounds=new fo;contentPageBounds=new fo;contentScreenBounds=new fo;originPagePoint=new ho;originPageCenter=new ho;isInViewport=!1;debug=!1;setDpr(e){this.dpr=+e.toFixed(2)}updateContentScreenBounds=()=>{const{contentScreenBounds:e,contentPageBounds:t,canvasScreenBounds:n}=this;let{x:r,y:o,w:i,h:s}=e;if(t.w>t.h){const e=n.w/(t.w/t.h);e>n.h?(r=(n.w-n.w*(n.h/e))/2,o=0,i=n.w*(n.h/e),s=n.h):(r=0,o=(n.h-e)/2,i=n.w,s=e)}else if(t.w<t.h){const e=n.h/(t.h/t.w);r=(n.w-e)/2,o=0,i=e,s=n.h}else r=n.h/2,o=0,i=n.h,s=n.h;e.set(r,o,i,s)};updateCanvasPageBounds=()=>{const{canvasPageBounds:e,canvasScreenBounds:t,contentPageBounds:n,contentScreenBounds:r}=this;e.set(0,0,n.width/(r.width/t.width),n.height/(r.height/t.height)),e.center=n.center};getScreenPoint=(e,t)=>{const{canvasScreenBounds:n}=this;return{x:(e-n.minX)*this.dpr,y:(t-n.minY)*this.dpr}};getPagePoint=(e,t)=>{const{contentPageBounds:n,contentScreenBounds:r,canvasPageBounds:o}=this,{x:i,y:s}=this.getScreenPoint(e,t);return new ho(o.minX+i*n.width/r.width,o.minY+s*n.height/r.height,1)};minimapScreenPointToPagePoint=(e,t,n=!1,r=!1)=>{const{editor:o}=this,i=o.getViewportPageBounds();let{x:s,y:a}=this.getPagePoint(e,t);if(r){const e=this.editor.getCurrentPageBounds(),t=i,n=(e?.minX??0)-t.width/2,r=(e?.maxX??0)+t.width/2,o=(e?.minY??0)-t.height/2,c=(e?.maxY??0)+t.height/2,l=Math.max(0,n+t.width-s),u=Math.max(0,-(r-t.width-s)),d=Math.max(0,o+t.height-a),h=Math.max(0,-(c-t.height-a)),p=Math.max(0,l-u),f=Math.max(0,u-l),g=Math.max(0,d-h),m=Math.max(0,h-d);p&&p>f?s+=p/2:f&&(s-=f/2),g&&g>m?a+=g/2:m&&(a-=m/2),s=xo(s,n,r),a=xo(a,o,c)}if(n){const{originPagePoint:e}=this;Math.abs(s-e.x)>Math.abs(a-e.y)?a=e.y:s=e.x}return new ho(s,a)};render=()=>{const{cvs:e,pageBounds:t}=this;this.updateCanvasPageBounds();const{editor:n,canvasScreenBounds:r,canvasPageBounds:o,contentPageBounds:i,contentScreenBounds:s}=this,{width:a,height:c}=r,l=n.getSelectedShapeIds(),u=n.getViewportPageBounds();if(!e||!t)return;const d=e.getContext("2d");if(!d)throw new Error("Minimap (shapes): Could not get context");d.resetTransform(),d.globalAlpha=1,d.clearRect(0,0,a,c);const h=s.width/i.width,p=s.height/i.height;d.translate((a-s.width)/2,(c-s.height)/2),d.scale(h,p),d.translate(-i.minX,-i.minY);const f=8/h,g=8/h,m=1/h,_=1/h,y=f/4,w=g/4,v=new Path2D,b=new Path2D,{shapeFill:x,selectFill:S,viewportFill:k}=this.colors;let C;for(let e=0,n=t.length;e<n;e++)C=t[e],tk.roundedRect(l.includes(C.id)?b:v,C.minX,C.minY,C.width,C.height,xo(f,m,C.width/y),xo(g,_,C.height/w));if(d.fillStyle=x,d.fill(v),d.fillStyle=S,d.fill(b),this.debug){const e=fo.Common(t),{minX:n,minY:r,width:o,height:i}=e;d.strokeStyle="green",d.lineWidth=2/h,d.strokeRect(n+1/h,r+1/p,o-2/h,i-2/p)}{const{brush:e}=n.getInstanceState();if(e){const{x:t,y:n,w:r,h:o}=e;d.beginPath(),tk.sharpRect(d,t,n,r,o),d.closePath(),d.fillStyle=k,d.fill()}}{const{minX:e,minY:t,width:n,height:r}=u;d.beginPath();const o=12/h,i=12/h;tk.roundedRect(d,e,t,n,r,Math.min(n/4,o),Math.min(r/4,i)),d.closePath(),d.fillStyle=k,d.fill(),this.debug&&(d.strokeStyle="orange",d.strokeRect(e+1/h,t+1/p,n-2/h,r-2/p))}const E=2.5/h,A=2.5/p,I=n.getCurrentPageId();let P;for(let e=0;e<this.collaborators.length;e++)P=this.collaborators[e],P.currentPageId===I&&(d.beginPath(),d.ellipse(xo(P.cursor.x,o.minX+E,o.maxX-E),xo(P.cursor.y,o.minY+A,o.maxY-A),5/h,5/p,0,0,wo),d.fillStyle=P.color,d.fill());if(this.debug){d.lineWidth=2/h;{const{minX:e,minY:t,width:n,height:r}=i;d.strokeStyle="red",d.strokeRect(e+1/h,t+1/p,n-2/h,r-2/p)}{const{minX:e,minY:t,width:n,height:r}=o;d.strokeStyle="blue",d.strokeRect(e+1/h,t+1/p,n-2/h,r-2/p)}}};static roundedRect(e,t,n,r,o,i,s){i<1&&s<1?e.rect(t,n,r,o):(e.moveTo(t+i,n),e.lineTo(t+r-i,n),e.quadraticCurveTo(t+r,n,t+r,n+s),e.lineTo(t+r,n+o-s),e.quadraticCurveTo(t+r,n+o,t+r-i,n+o),e.lineTo(t+i,n+o),e.quadraticCurveTo(t,n+o,t,n+o-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+i,n))}static sharpRect(e,t,n,r,o,i,s){e.rect(t,n,r,o)}}function nk({shapeFill:t,selectFill:n,viewportFill:r}){const o=Yr(),i=e.useRef(null),s=e.useRef(!1),a=ml(),c=ae("dpr",(()=>o.getInstanceState().devicePixelRatio),[o]),l=e.useMemo((()=>o.store.query.records("instance_presence")),[o]),u=e.useMemo((()=>new tk(o)),[o]);e.useEffect((()=>{const e=requestAnimationFrame((()=>{const e=getComputedStyle(o.getContainer());u.colors={shapeFill:e.getPropertyValue(t).trim(),selectFill:e.getPropertyValue(n).trim(),viewportFill:e.getPropertyValue(r).trim()},u.render()}));return()=>{cancelAnimationFrame(e)}}),[o,n,t,r,u,a]);const d=e.useCallback((e=>{if(!o.getCurrentPageShapeIds().size)return;const t=u.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),n=u.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0);u.originPagePoint.setTo(n),u.originPageCenter.setTo(o.getViewportPageBounds().center),o.centerOnPoint(t,{duration:Xo})}),[o,u]),h=e.useCallback((e=>{const t=e.currentTarget;if(Wr(t,e),!o.getCurrentPageShapeIds().size)return;s.current=!0,u.isInViewport=!1;const n=u.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!1),r=u.minimapScreenPointToPagePoint(e.clientX,e.clientY,!1,!0),i=o.getViewportPageBounds();if(u.isInViewport=i.containsPoint(r),u.isInViewport)u.originPagePoint.setTo(r),u.originPageCenter.setTo(i.center);else{const e=ho.Sub(i.center,i.point),t=ho.Add(n,e);u.originPagePoint.setTo(t),u.originPageCenter.setTo(n),o.centerOnPoint(n,{duration:Xo})}document.body.addEventListener("pointerup",(function e(n){t&&Kr(t,n),s.current=!1,document.body.removeEventListener("pointerup",e)}))}),[o,u]),p=e.useCallback((e=>{const t=u.minimapScreenPointToPagePoint(e.clientX,e.clientY,e.shiftKey,!0);if(s.current){if(u.isInViewport){const e=u.originPagePoint.clone().sub(u.originPageCenter);return void o.centerOnPoint(ho.Sub(t,e))}o.centerOnPoint(t)}const n=u.getPagePoint(e.clientX,e.clientY),r=o.pageToScreen(n),i={type:"pointer",target:"canvas",name:"pointer_move",...Gr(e),point:r,isPen:o.getInstanceState().isPenMode};o.dispatch(i)}),[o,u]),f=e.useCallback((e=>{const t=ys(e);o.dispatch({type:"wheel",name:"wheel",delta:t,point:new ho(e.clientX,e.clientY),shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey})}),[o]);return ce("update when dpr changes",(()=>{const e=c.get();u.setDpr(e);const t=i.current,n=t.getBoundingClientRect(),r=n.width*e,o=n.height*e;t.width=r,t.height=o,u.canvasScreenBounds.set(n.x,n.y,r,o),u.cvs=i.current}),[c,u]),ce("minimap render when pagebounds or collaborators changes",(()=>{const e=o.getCurrentPageShapeIds(),t=o.getCurrentPageBounds(),n=o.getViewportPageBounds();c.get(),u.contentPageBounds=t?fo.Expand(t,n):n,u.updateContentScreenBounds();const r=[];e.forEach((e=>{let t=o.getShapePageBounds(e);if(!t)return;const n=o.getShapeMask(e);if(n){const e=Ra(n,t.corners);if(!e)return;t=fo.FromPoints(e)}t&&(t.id=e,r.push(t))})),u.pageBounds=r,u.collaborators=l.get(),u.render()}),[o,u]),(0,Fr.jsx)("div",{className:"tlui-minimap",children:(0,Fr.jsx)("canvas",{ref:i,className:"tlui-minimap__canvas",onDoubleClick:d,onPointerMove:p,onPointerDown:h,onWheel:f})})}const rk=se((function(){const t=Yr(),n=om(),r=tw(),o=t.getZoomLevel(),i=t.getCurrentPageShapeIds().size>0,s=t.getSelectedShapeIds().length>0,a=1===t.getZoomLevel(),c=e.useCallback((()=>{t.resetZoom(t.getViewportScreenCenter(),{duration:Xo})}),[t]);return(0,Fr.jsxs)(Yx,{id:"zoom",children:[(0,Fr.jsx)(Xx,{children:(0,Fr.jsx)(hm,{type:"icon",title:`${n("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:c,icon:r<4?"zoom-in":void 0,children:r<4?null:(0,Fr.jsxs)("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(100*o),"%"]})})}),(0,Fr.jsx)(Zx,{side:"top",align:"start",alignOffset:0,children:(0,Fr.jsxs)(tS,{children:[(0,Fr.jsx)(ok,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),(0,Fr.jsx)(ok,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),(0,Fr.jsx)(ok,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:a}),(0,Fr.jsx)(ok,{action:"zoom-to-fit",disabled:!i,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),(0,Fr.jsx)(ok,{action:"zoom-to-selection",disabled:!s,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})}));function ok(e){const{action:t,disabled:n=!1,noClose:r=!1}=e,o=Uy();return(0,Fr.jsx)(nS,{type:"menu",label:o[t].label,kbd:o[t].kbd,"data-testid":e["data-testid"],onClick:()=>o[t].onSelect("zoom-menu"),noClose:r,disabled:n})}const ik=(0,e.memo)((function(){const t=Uy(),n=om(),r=tw(),[o,i]=function(t,n){const[r,o]=e.useState(!0);return e.useLayoutEffect((()=>{const e=localStorage.getItem(t);if(e)try{o(JSON.parse(e))}catch(e){console.error(`Could not restore value ${t} from local storage.`)}}),[t]),[r,e.useCallback((e=>{o((n=>{const r="function"==typeof e?e(n):e;return localStorage.setItem(t,JSON.stringify(r)),r}))}),[t])]}("minimap"),s=(0,e.useCallback)((()=>{i((e=>!e))}),[i]);return r<4?null:(0,Fr.jsxs)("div",{className:"tlui-navigation-zone",children:[(0,Fr.jsx)("div",{className:"tlui-buttons__horizontal",children:r<6?(0,Fr.jsx)(rk,{}):o?(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(rk,{}),(0,Fr.jsx)(hm,{type:"icon",icon:o?"chevrons-ne":"chevrons-sw","data-testid":"minimap.toggle",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:s})]}):(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(hm,{type:"icon",icon:"minus","data-testid":"minimap.zoom-out",title:`${n(t["zoom-out"].label)} ${um(t["zoom-out"].kbd)}`,onClick:()=>t["zoom-out"].onSelect("navigation-zone")}),(0,Fr.jsx)(rk,{}),(0,Fr.jsx)(hm,{type:"icon",icon:"plus","data-testid":"minimap.zoom-in",title:`${n(t["zoom-in"].label)} ${um(t["zoom-in"].kbd)}`,onClick:()=>t["zoom-in"].onSelect("navigation-zone")}),(0,Fr.jsx)(hm,{type:"icon",icon:o?"chevrons-ne":"chevrons-sw","data-testid":"minimap.toggle",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:s})]})}),r>=6&&!o&&(0,Fr.jsx)(nk,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})})),sk=se((function(){const e=Yr().getInstanceState().isPenMode,t=Uy();if(!e)return null;const n=t["exit-pen-mode"];return(0,Fr.jsx)(hm,{type:"normal",label:n.label,iconLeft:n.icon,onClick:()=>n.onSelect("helper-buttons")})})),ak=se((function(){const e=Yr(),t=Uy();if(!e.getInstanceState().followingUserId)return null;const n=t["stop-following"];return(0,Fr.jsx)(hm,{type:"normal",label:n.label,iconLeft:n.icon,onClick:()=>n.onSelect("people-menu")})})),ck=[Nn,$n,Un,Kn];function lk(){const e=Yr();return le("getRelevantStyles",(()=>{const t=new Ya(e.getSharedStyles()),n=e.getSelectedShapeIds().length>0||!!e.root.getCurrent()?.shapeType;if(0===t.size&&e.isIn("select")&&0===e.getSelectedShapeIds().length)for(const n of ck)t.applyValue(n,e.getStyleForNextShape(n));return 0!==t.size||n?{styles:t,opacity:e.getSharedOpacity()}:null}),[e])}const uk=e.memo((function(t){const{uiType:n,items:r,title:o,style:i,value:s,onValueChange:a}=t,c=Yr(),l=om(),u=(0,e.useRef)(!1),{handleButtonClick:d,handleButtonPointerDown:h,handleButtonPointerEnter:p,handleButtonPointerUp:f}=e.useMemo((()=>{const e=()=>{u.current=!1,window.removeEventListener("pointerup",e)};return{handleButtonClick:e=>{const{id:t}=e.currentTarget.dataset;"shared"===s.type&&s.value===t||(c.mark("point picker item"),a(i,t,!1))},handleButtonPointerDown:t=>{const{id:n}=t.currentTarget.dataset;c.mark("point picker item"),a(i,n,!0),u.current=!0,window.addEventListener("pointerup",e)},handleButtonPointerEnter:e=>{if(!u.current)return;const{id:t}=e.currentTarget.dataset;a(i,t,!0)},handleButtonPointerUp:e=>{const{id:t}=e.currentTarget.dataset;a(i,t,!1)}}}),[s,c,a,i]),g=le("theme",(()=>Ln({isDarkMode:c.user.getIsDarkMode()})),[c]);return(0,Fr.jsx)("div",{className:Rr("tlui-buttons__grid"),children:r.map((e=>(0,Fr.jsx)(hm,{type:"icon","data-id":e.value,"data-testid":`style.${n}.${e.value}`,"aria-label":e.value,"data-state":"shared"===s.type&&s.value===e.value?"hinted":void 0,title:o+"  "+l(`${n}-style.${e.value}`),className:Rr("tlui-button-grid__button"),style:i===Nn?{color:g[e.value].solid}:void 0,onPointerEnter:p,onPointerDown:h,onPointerUp:f,onClick:d,icon:e.icon},e.value)))})}));function dk(e,[t,n]){return Math.min(n,Math.max(t,e))}const hk=["PageUp","PageDown"],pk=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],fk={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},gk="Slider",[mk,_k,yk]=Gf(gk),[wk,vk]=Bf(gk,[yk]),[bk,xk]=wk(gk),Sk=(0,e.forwardRef)(((t,n)=>{const{name:r,min:o=0,max:i=100,step:s=1,orientation:a="horizontal",disabled:c=!1,minStepsBetweenThumbs:l=0,defaultValue:u=[o],value:d,onValueChange:h=(()=>{}),onValueCommit:p=(()=>{}),inverted:f=!1,...g}=t,[m,_]=(0,e.useState)(null),y=Nf(n,(e=>_(e))),w=(0,e.useRef)(new Set),v=(0,e.useRef)(0),b="horizontal"===a,x=!m||Boolean(m.closest("form")),S=b?Ek:Ak,[k=[],C]=lg({prop:d,defaultProp:u,onChange:e=>{var t;null===(t=[...w.current][v.current])||void 0===t||t.focus(),h(e)}}),E=(0,e.useRef)(k);function A(e,t,{commit:n}={commit:!1}){const r=function(e){return(String(e).split(".")[1]||"").length}(s),a=function(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-o)/s)*s+o,r),c=dk(a,[o,i]);C(((e=[])=>{const r=function(e=[],t,n){const r=[...e];return r[n]=t,r.sort(((e,t)=>e-t))}(e,c,t);if(function(e,t){if(t>0){const n=function(e){return e.slice(0,-1).map(((t,n)=>e[n+1]-t))}(e);return Math.min(...n)>=t}return!0}(r,l*s)){v.current=r.indexOf(c);const t=String(r)!==String(e);return t&&n&&p(r),t?r:e}return e}))}return(0,e.createElement)(bk,{scope:t.__scopeSlider,disabled:c,min:o,max:i,valueIndexToChangeRef:v,thumbs:w.current,values:k,orientation:a},(0,e.createElement)(mk.Provider,{scope:t.__scopeSlider},(0,e.createElement)(mk.Slot,{scope:t.__scopeSlider},(0,e.createElement)(S,zf({"aria-disabled":c,"data-disabled":c?"":void 0},g,{ref:y,onPointerDown:Rf(g.onPointerDown,(()=>{c||(E.current=k)})),min:o,max:i,inverted:f,onSlideStart:c?void 0:function(e){const t=function(e,t){if(1===e.length)return 0;const n=e.map((e=>Math.abs(e-t))),r=Math.min(...n);return n.indexOf(r)}(k,e);A(e,t)},onSlideMove:c?void 0:function(e){A(e,v.current)},onSlideEnd:c?void 0:function(){const e=E.current[v.current];k[v.current]!==e&&p(k)},onHomeKeyDown:()=>!c&&A(o,0,{commit:!0}),onEndKeyDown:()=>!c&&A(i,k.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!c){const n=hk.includes(e.key)||e.shiftKey&&pk.includes(e.key)?10:1,r=v.current;A(k[r]+s*n*t,r,{commit:!0})}}})))),x&&k.map(((t,n)=>(0,e.createElement)(zk,{key:n,name:r?r+(k.length>1?"[]":""):void 0,value:t}))))})),[kk,Ck]=wk(gk,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Ek=(0,e.forwardRef)(((t,n)=>{const{min:r,max:o,dir:i,inverted:s,onSlideStart:a,onSlideMove:c,onSlideEnd:l,onStepKeyDown:u,...d}=t,[h,p]=(0,e.useState)(null),f=Nf(n,(e=>p(e))),g=(0,e.useRef)(),m=Tw(i),_="ltr"===m,y=_&&!s||!_&&s;function w(e){const t=g.current||h.getBoundingClientRect(),n=Rk([0,t.width],y?[r,o]:[o,r]);return g.current=t,n(e-t.left)}return(0,e.createElement)(kk,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width"},(0,e.createElement)(Ik,zf({dir:m,"data-orientation":"horizontal"},d,{ref:f,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{const t=w(e.clientX);null==a||a(t)},onSlideMove:e=>{const t=w(e.clientX);null==c||c(t)},onSlideEnd:()=>{g.current=void 0,null==l||l()},onStepKeyDown:e=>{const t=fk[y?"from-left":"from-right"].includes(e.key);null==u||u({event:e,direction:t?-1:1})}})))})),Ak=(0,e.forwardRef)(((t,n)=>{const{min:r,max:o,inverted:i,onSlideStart:s,onSlideMove:a,onSlideEnd:c,onStepKeyDown:l,...u}=t,d=(0,e.useRef)(null),h=Nf(n,d),p=(0,e.useRef)(),f=!i;function g(e){const t=p.current||d.current.getBoundingClientRect(),n=Rk([0,t.height],f?[o,r]:[r,o]);return p.current=t,n(e-t.top)}return(0,e.createElement)(kk,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1},(0,e.createElement)(Ik,zf({"data-orientation":"vertical"},u,{ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{const t=g(e.clientY);null==s||s(t)},onSlideMove:e=>{const t=g(e.clientY);null==a||a(t)},onSlideEnd:()=>{p.current=void 0,null==c||c()},onStepKeyDown:e=>{const t=fk[f?"from-bottom":"from-top"].includes(e.key);null==l||l({event:e,direction:t?-1:1})}})))})),Ik=(0,e.forwardRef)(((t,n)=>{const{__scopeSlider:r,onSlideStart:o,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:a,onEndKeyDown:c,onStepKeyDown:l,...u}=t,d=xk(gk,r);return(0,e.createElement)(qf.span,zf({},u,{ref:n,onKeyDown:Rf(t.onKeyDown,(e=>{"Home"===e.key?(a(e),e.preventDefault()):"End"===e.key?(c(e),e.preventDefault()):hk.concat(pk).includes(e.key)&&(l(e),e.preventDefault())})),onPointerDown:Rf(t.onPointerDown,(e=>{const t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():o(e)})),onPointerMove:Rf(t.onPointerMove,(e=>{e.target.hasPointerCapture(e.pointerId)&&i(e)})),onPointerUp:Rf(t.onPointerUp,(e=>{const t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),s(e))}))}))})),Pk=(0,e.forwardRef)(((t,n)=>{const{__scopeSlider:r,...o}=t,i=xk("SliderTrack",r);return(0,e.createElement)(qf.span,zf({"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation},o,{ref:n}))})),Mk="SliderRange",Tk=(0,e.forwardRef)(((t,n)=>{const{__scopeSlider:r,...o}=t,i=xk(Mk,r),s=Ck(Mk,r),a=Nf(n,(0,e.useRef)(null)),c=i.values.length,l=i.values.map((e=>Fk(e,i.min,i.max))),u=c>1?Math.min(...l):0,d=100-Math.max(...l);return(0,e.createElement)(qf.span,zf({"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0},o,{ref:a,style:{...t.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}}))})),jk="SliderThumb",Dk=(0,e.forwardRef)(((t,n)=>{const r=_k(t.__scopeSlider),[o,i]=(0,e.useState)(null),s=Nf(n,(e=>i(e))),a=(0,e.useMemo)((()=>o?r().findIndex((e=>e.ref.current===o)):-1),[r,o]);return(0,e.createElement)(Ok,zf({},t,{ref:s,index:a}))})),Ok=(0,e.forwardRef)(((t,n)=>{const{__scopeSlider:r,index:o,...i}=t,s=xk(jk,r),a=Ck(jk,r),[c,l]=(0,e.useState)(null),u=Nf(n,(e=>l(e))),d=Hv(c),h=s.values[o],p=void 0===h?0:Fk(h,s.min,s.max),f=function(e,t){return t>2?`Value ${e+1} of ${t}`:2===t?["Minimum","Maximum"][e]:void 0}(o,s.values.length),g=null==d?void 0:d[a.size],m=g?function(e,t,n){const r=e/2;return(r-Rk([0,50],[0,r])(t)*n)*n}(g,p,a.direction):0;return(0,e.useEffect)((()=>{if(c)return s.thumbs.add(c),()=>{s.thumbs.delete(c)}}),[c,s.thumbs]),(0,e.createElement)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${p}% + ${m}px)`}},(0,e.createElement)(mk.ItemSlot,{scope:t.__scopeSlider},(0,e.createElement)(qf.span,zf({role:"slider","aria-label":t["aria-label"]||f,"aria-valuemin":s.min,"aria-valuenow":h,"aria-valuemax":s.max,"aria-orientation":s.orientation,"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,tabIndex:s.disabled?void 0:0},i,{ref:u,style:void 0===h?{display:"none"}:t.style,onFocus:Rf(t.onFocus,(()=>{s.valueIndexToChangeRef.current=o}))}))))})),zk=t=>{const{value:n,...r}=t,o=(0,e.useRef)(null),i=function(t){const n=(0,e.useRef)({value:t,previous:t});return(0,e.useMemo)((()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous)),[t])}(n);return(0,e.useEffect)((()=>{const e=o.current,t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"value").set;if(i!==n&&r){const t=new Event("input",{bubbles:!0});r.call(e,n),e.dispatchEvent(t)}}),[i,n]),(0,e.createElement)("input",zf({style:{display:"none"}},r,{ref:o,defaultValue:n}))};function Fk(e,t,n){return dk(100/(n-t)*(e-t),[0,100])}function Rk(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}const Lk=Sk,Nk=Pk,Bk=Tk,$k=Dk,Uk=(0,e.memo)((function(t){const{title:n,steps:r,value:o,label:i,onValueChange:s}=t,a=Yr(),c=om(),l=(0,e.useCallback)((e=>{s(e[0],!0)}),[s]),u=(0,e.useCallback)((()=>{a.mark("click slider")}),[a]),d=(0,e.useCallback)((()=>{o&&s(o,!1)}),[o,s]);return(0,Fr.jsx)("div",{className:"tlui-slider__container",children:(0,Fr.jsxs)(Lk,{"data-testid":t["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:o?[o]:void 0,onPointerDown:u,onValueChange:l,onPointerUp:d,title:n+"  "+c(i),children:[(0,Fr.jsx)(Nk,{className:"tlui-slider__track",dir:"ltr",children:null!==o&&(0,Fr.jsx)(Bk,{className:"tlui-slider__range",dir:"ltr"})}),null!==o&&(0,Fr.jsx)($k,{className:"tlui-slider__thumb",dir:"ltr"})]})})})),Vk=e.memo((function({label:t,uiTypeA:n,uiTypeB:r,labelA:o,labelB:i,itemsA:s,itemsB:a,styleA:c,styleB:l,valueA:u,valueB:d,onValueChange:h}){const p=om(),f=e.useMemo((()=>s.find((e=>"shared"===u.type&&u.value===e.value))?.icon??"mixed"),[s,u]),g=e.useMemo((()=>a.find((e=>"shared"===d.type&&d.value===e.value))?.icon??"mixed"),[a,d]);return void 0===u&&void 0===d?null:(0,Fr.jsxs)("div",{className:"tlui-style-panel__double-select-picker",children:[(0,Fr.jsx)("div",{title:p(t),className:"tlui-style-panel__double-select-picker-label",children:p(t)}),(0,Fr.jsxs)("div",{className:"tlui-buttons__horizontal",children:[(0,Fr.jsxs)(Yx,{id:`style panel ${n} A`,children:[(0,Fr.jsx)(Lx,{asChild:!0,onTouchEnd:e=>Vr(e),children:(0,Fr.jsx)(hm,{type:"icon","data-testid":`style.${n}`,title:p(o)+"  "+(null===u||"mixed"===u.type?p("style-panel.mixed"):p(`${n}-style.${u.value}`)),icon:f,invertIcon:!0,smallIcon:!0})}),(0,Fr.jsx)(Zx,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,Fr.jsx)("div",{className:"tlui-buttons__grid",children:s.map((e=>(0,Fr.jsx)(nS,{type:"icon",title:p(o)+"  "+p(`${n}-style.${e.value}`),"data-testid":`style.${n}.${e.value}`,icon:e.icon,onClick:()=>h(c,e.value,!1),invertIcon:!0},e.value)))})})]}),(0,Fr.jsxs)(Yx,{id:`style panel ${r}`,children:[(0,Fr.jsx)(Lx,{asChild:!0,onTouchEnd:e=>Vr(e),children:(0,Fr.jsx)(hm,{type:"icon","data-testid":`style.${r}`,title:p(i)+"  "+(null===d||"mixed"===d.type?p("style-panel.mixed"):p(`${r}-style.${d.value}`)),icon:g,smallIcon:!0})}),(0,Fr.jsx)(Zx,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,Fr.jsx)("div",{className:"tlui-buttons__grid",children:a.map((e=>(0,Fr.jsx)(nS,{type:"icon",title:p(i)+"  "+p(`${r}-style.${e.value}`),"data-testid":`style.${r}.${e.value}`,icon:e.icon,onClick:()=>h(l,e.value,!1)},e.value)))})})]})]})]})})),Wk=e.memo((function({id:t,label:n,uiType:r,style:o,items:i,type:s,value:a,onValueChange:c}){const l=om(),u=e.useMemo((()=>i.find((e=>"shared"===a.type&&e.value===a.value))?.icon),[i,a]);return(0,Fr.jsxs)(Yx,{id:`style panel ${t}`,children:[(0,Fr.jsx)(Lx,{asChild:!0,onTouchEnd:e=>Vr(e),children:(0,Fr.jsx)(hm,{type:s,"data-testid":`style.${r}`,title:"mixed"===a.type?l("style-panel.mixed"):l(`${r}-style.${a.value}`),label:n,icon:u??"mixed"})}),(0,Fr.jsx)(Zx,{side:"left",align:"center",alignOffset:0,children:(0,Fr.jsx)("div",{className:"tlui-buttons__grid",children:i.map((e=>(0,Fr.jsx)(nS,{type:"icon","data-testid":`style.${r}.${e.value}`,title:l(`${r}-style.${e.value}`),icon:e.icon,onClick:()=>c(o,e.value,!1)},e.value)))})})]})})),Kk={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"cloud",icon:"geo-cloud"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},Hk=function({isMobile:t}){const n=Yr(),r=lk(),o=(0,e.useCallback)((()=>{t||n.updateInstanceState({isChangingStyle:!1})}),[n,t]);if(!r)return null;const{styles:i,opacity:s}=r,a=i.get(pr),c=i.get(qn),l=i.get(Gn),u=void 0===a,d=void 0===c&&void 0===l,h=void 0===i.get(kr),p=void 0===i.get(Vn);return(0,Fr.jsxs)("div",{className:"tlui-style-panel","data-ismobile":t,onPointerLeave:o,children:[(0,Fr.jsx)(Yk,{styles:i,opacity:s}),!p&&(0,Fr.jsx)(Xk,{styles:i}),!(u&&d&&h)&&(0,Fr.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[(0,Fr.jsx)(Zk,{styles:i}),(0,Fr.jsx)(Jk,{styles:i}),(0,Fr.jsx)(Qk,{styles:i})]})]})};function Gk(){const t=Yr();return e.useMemo((()=>function(e,n,r){t.batch((()=>{t.isIn("select")&&t.setStyleForSelectedShapes(e,n,{squashing:r}),t.setStyleForNextShapes(e,n,{squashing:r}),t.updateInstanceState({isChangingStyle:!0})}))}),[t])}const qk=[.1,.25,.5,.75,1];function Yk({styles:t,opacity:n}){const r=Yr(),o=om(),i=Gk(),s=e.useCallback(((e,t)=>{const n=qk[e];r.batch((()=>{r.isIn("select")&&r.setOpacityForSelectedShapes(n,{ephemeral:t}),r.setOpacityForNextShapes(n,{ephemeral:t}),r.updateInstanceState({isChangingStyle:!0})}))}),[r]),a=t.get(Nn),c=t.get(Un),l=t.get($n),u=t.get(Kn),d=void 0!==c||void 0!==l||void 0!==u,h="mixed"===n.type?-1:qk.indexOf(function(e,t){let r,o=1/0;for(const t of e){const e=(i=t,Math.abs(i-n.value));e<o&&(r=t,o=e)}var i;return r}(qk));return(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[void 0===a?null:(0,Fr.jsx)(uk,{title:o("style-panel.color"),uiType:"color",style:Nn,items:Kk.color,value:a,onValueChange:i}),void 0===n?null:(0,Fr.jsx)(Uk,{"data-testid":"style.opacity",value:h>=0?h:qk.length-1,label:"mixed"===n.type?"style-panel.mixed":`opacity-style.${n.value}`,onValueChange:s,steps:qk.length-1,title:o("style-panel.opacity")})]}),d&&(0,Fr.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[void 0===c?null:(0,Fr.jsx)(uk,{title:o("style-panel.fill"),uiType:"fill",style:Un,items:Kk.fill,value:c,onValueChange:i}),void 0===l?null:(0,Fr.jsx)(uk,{title:o("style-panel.dash"),uiType:"dash",style:$n,items:Kk.dash,value:l,onValueChange:i}),void 0===u?null:(0,Fr.jsx)(uk,{title:o("style-panel.size"),uiType:"size",style:Kn,items:Kk.size,value:u,onValueChange:i})]})]})}function Xk({styles:e}){const t=om(),n=Gk(),r=e.get(Vn),o=e.get(dr),i=e.get(hr);return void 0===r&&void 0===o?null:(0,Fr.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[void 0===r?null:(0,Fr.jsx)(uk,{title:t("style-panel.font"),uiType:"font",style:Vn,items:Kk.font,value:r,onValueChange:n}),void 0===o?null:(0,Fr.jsxs)("div",{className:"tlui-style-panel__row",children:[(0,Fr.jsx)(uk,{title:t("style-panel.align"),uiType:"align",style:dr,items:Kk.horizontalAlign,value:o,onValueChange:n}),(0,Fr.jsx)("div",{className:"tlui-style-panel__row__extra-button",children:void 0===i?(0,Fr.jsx)(hm,{type:"icon",title:t("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):(0,Fr.jsx)(Wk,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",style:hr,items:Kk.verticalAlign,value:i,onValueChange:n})})]})]})}function Zk({styles:e}){const t=Gk(),n=e.get(pr);return void 0===n?null:(0,Fr.jsx)(Wk,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",style:pr,items:Kk.geo,value:n,onValueChange:t})}function Qk({styles:e}){const t=Gk(),n=e.get(kr);return void 0===n?null:(0,Fr.jsx)(Wk,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",style:kr,items:Kk.spline,value:n,onValueChange:t})}function Jk({styles:e}){const t=Gk(),n=e.get(qn),r=e.get(Gn);return n&&r?(0,Fr.jsx)(Vk,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:Gn,itemsA:Kk.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:qn,itemsB:Kk.arrowheadEnd,valueB:n,onValueChange:t,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"}):null}function eC({toast:e}){const{removeToast:t}=Dy(),n=om(),r=e.actions&&e.actions.length>0;return(0,Fr.jsxs)($g,{onOpenChange:n=>{n||t(e.id)},className:"tlui-toast__container",duration:e.keepOpen?1/0:5e3,children:[e.icon&&(0,Fr.jsx)("div",{className:"tlui-toast__icon",children:(0,Fr.jsx)(sm,{icon:e.icon})}),(0,Fr.jsxs)("div",{className:"tlui-toast__main",children:[(0,Fr.jsxs)("div",{className:"tlui-toast__content",children:[e.title&&(0,Fr.jsx)(Ug,{className:"tlui-toast__title",children:e.title}),e.description&&(0,Fr.jsx)(Vg,{className:"tlui-toast__description",children:e.description})]}),e.actions&&(0,Fr.jsxs)("div",{className:"tlui-toast__actions",children:[e.actions.map(((e,t)=>(0,Fr.jsx)(Wg,{altText:e.label,asChild:!0,onClick:e.onClick,children:(0,Fr.jsx)(hm,{type:e.type,children:e.label})},t))),(0,Fr.jsx)(Kg,{asChild:!0,children:(0,Fr.jsx)(hm,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:e.closeLabel??n("toast.close")})})]})]}),!r&&(0,Fr.jsx)(Kg,{asChild:!0,children:(0,Fr.jsx)(hm,{type:"normal",className:"tlui-toast__close",children:e.closeLabel??n("toast.close")})})]})}const tC=e.memo((function(){const{toasts:e}=Dy();return(0,Fr.jsx)(Fr.Fragment,{children:e.map((e=>(0,Fr.jsx)(eC,{toast:e},e.id)))})}));function nC(){const{toasts:t}=Dy(),[n,r]=e.useState(!1);return e.useEffect((()=>{let e=!1;return t.length?r(!0):setTimeout((()=>{e||r(!1)}),1e3),()=>{e=!0}}),[t.length,r]),n?(0,Fr.jsx)(Sg,{className:"tlui-toast__viewport"}):null}function rC(){const t=Yr(),n=om(),r=lk(),o=r?.styles.get(Nn),i=Ln({isDarkMode:t.user.getIsDarkMode()}),s=("shared"===o?.type?i[o.value]:i.black).solid,a=le("isHandOrEraserToolActive",(()=>t.isInAny("hand","zoom","eraser","laser")),[t]),c=(0,e.useCallback)((e=>{e||t.updateInstanceState({isChangingStyle:!1})}),[t]);return(0,Fr.jsxs)(BS,{id:"style menu",onOpenChange:c,children:[(0,Fr.jsx)($S,{disabled:a,children:(0,Fr.jsx)(hm,{type:"tool","data-testid":"mobile.styles",style:{color:a?"var(--color-muted-1)":s},title:n("style-panel.title"),children:(0,Fr.jsx)(sm,{icon:a?"blob":"mixed"===o?.type?"mixed":"blob"})})}),(0,Fr.jsx)(US,{side:"top",align:"end",children:(0,Fr.jsx)(Hk,{isMobile:!0})})]})}const oC=["select","hand","draw","eraser","text","zoom","laser","highlight"];function iC({activeToolId:e}){const t=Yr(),n=tw(),r=om(),o=le("is tool locked",(()=>t.getInstanceState().isToolLocked),[t]);return!e||oC.includes(e)?null:(0,Fr.jsx)(hm,{type:"normal",title:r("action.toggle-tool-lock"),className:Rr("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<5}),icon:o?"lock":"unlock",onClick:()=>t.updateInstanceState({isToolLocked:!o}),smallIcon:!0})}const sC=(0,e.memo)((function(){const t=Yr(),n=om(),r=tw(),o=e.useRef(void 0),i=Uu(),s=function(){const t=e.useContext(Sw);if(!t)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return t}(),a=s.find((e=>"laser"===e.toolItem.id)),c=le("current tool id",(()=>t.getCurrentToolId()),[t]),l=le("geo",(()=>t.getSharedStyles().getAsKnownValue(pr)),[t]),u=!i,d=e=>e.label?`${n(e.label)} ${e.kbd?um(e.kbd):""}`:"",h=s.find((e=>lC(e.toolItem,c,l))),{itemsInPanel:p,itemsInDropdown:f,dropdownFirstItem:g}=e.useMemo((()=>{const e=[],t=[];let n;const i=Math.min(8,5+r);for(let r=4;r<s.length;r++){const o=s[r];r<i?e.push(o):(o===h&&(n=o),t.push(o))}return n||(o.current||(o.current=t[0]),n=o.current,t.includes(n)||(n=t[0])),o.current=n,t.length<=2&&(e.push(...t),t.length=0),{itemsInPanel:e,itemsInDropdown:t,dropdownFirstItem:n}}),[s,h,r]);return(0,Fr.jsx)("div",{className:"tlui-toolbar",children:(0,Fr.jsxs)("div",{className:"tlui-toolbar__inner",children:[(0,Fr.jsxs)("div",{className:"tlui-toolbar__left",children:[!i&&(0,Fr.jsxs)("div",{className:"tlui-toolbar__extras",children:[r<6&&!("hand"===c||"zoom"===c)&&(0,Fr.jsxs)("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[(0,Fr.jsx)(JS,{}),(0,Fr.jsx)(ZS,{}),(0,Fr.jsx)(QS,{}),(0,Fr.jsx)(WS,{}),(0,Fr.jsx)(VS,{})]}),(0,Fr.jsx)(iC,{activeToolId:c})]}),(0,Fr.jsxs)("div",{className:Rr("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[s.slice(0,2).map((({toolItem:e})=>(0,Fr.jsx)(cC,{item:e,title:d(e),isSelected:lC(e,c,l)},e.id))),i&&a&&(0,Fr.jsx)(cC,{item:a.toolItem,title:d(a.toolItem),isSelected:lC(a.toolItem,c,l)},a.toolItem.id),u&&(0,Fr.jsxs)(Fr.Fragment,{children:[s.slice(2,4).map((({toolItem:e})=>(0,Fr.jsx)(cC,{item:e,title:d(e),isSelected:lC(e,c,l)},e.id))),p.map((({toolItem:e})=>(0,Fr.jsx)(cC,{item:e,title:d(e),isSelected:lC(e,c,l)},e.id))),f.length?(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsx)(cC,{item:g.toolItem,title:d(g.toolItem),isSelected:lC(g.toolItem,c,l)},g.toolItem.id),(0,Fr.jsxs)(Yx,{id:"toolbar overflow",modal:!1,children:[(0,Fr.jsx)(Xx,{children:(0,Fr.jsx)(hm,{className:"tlui-toolbar__overflow",icon:"chevron-up",type:"tool","data-testid":"tools.more",title:n("tool-panel.more")})}),(0,Fr.jsx)(Zx,{side:"top",align:"center",children:(0,Fr.jsx)(aC,{toolbarItems:f})})]})]}):null]})]})]}),r<5&&!i&&(0,Fr.jsx)("div",{className:"tlui-toolbar__tools",children:(0,Fr.jsx)(rC,{})})]})})})),aC=se((function({toolbarItems:e}){const t=om();return(0,Fr.jsx)("div",{className:"tlui-buttons__grid",children:e.map((({toolItem:{id:e,meta:n,kbd:r,label:o,onSelect:i,icon:s}})=>(0,Fr.jsx)(nS,{type:"icon",className:"tlui-button-grid__button","data-testid":`tools.more.${e}`,"data-tool":e,"data-geo":n?.geo??"","aria-label":o,onClick:()=>i("toolbar"),title:o?`${t(o)} ${r?um(r):""}`:"",icon:s},e)))})}));function cC({item:e,title:t,isSelected:n}){return(0,Fr.jsx)(hm,{type:"tool","data-testid":`tools.${e.id}`,"data-tool":e.id,"data-geo":e.meta?.geo??"","aria-label":e.label,title:t,icon:e.icon,"data-state":n?"selected":void 0,onClick:()=>e.onSelect("toolbar"),onTouchStart:t=>{Vr(t),e.onSelect("toolbar")}})}const lC=(e,t,n)=>e.meta?.geo?"geo"===t&&n===e.meta?.geo:t===e.id,uC="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function dC(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),(()=>{n(window.event)}))}function hC(e,t){const n=t.slice(0,t.length-1);for(let t=0;t<n.length;t++)n[t]=e[n[t].toLowerCase()];return n}function pC(e){"string"!=typeof e&&(e="");const t=(e=e.replace(/\s/g,"")).split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}const fC={backspace:8,"":8,tab:9,clear:12,enter:13,"":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"":20,",":188,".":190,"/":191,"`":192,"-":uC?173:189,"=":uC?61:187,";":uC?59:186,"'":222,"[":219,"]":221,"\\":220},gC={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,cmd:91,command:91},mC={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},_C={16:!1,18:!1,17:!1,91:!1},yC={};for(let e=1;e<20;e++)fC["f".concat(e)]=111+e;let wC=[],vC=!1,bC="all";const xC=[],SC=e=>fC[e.toLowerCase()]||gC[e.toLowerCase()]||e.toUpperCase().charCodeAt(0);function kC(e){bC=e||"all"}function CC(){return bC||"all"}function EC(e){if(void 0===e)Object.keys(yC).forEach((e=>delete yC[e]));else if(Array.isArray(e))e.forEach((e=>{e.key&&AC(e)}));else if("object"==typeof e)e.key&&AC(e);else if("string"==typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[o,i]=n;"function"==typeof o&&(i=o,o=""),AC({key:e,scope:o,method:i,splitKey:"+"})}}const AC=e=>{let{key:t,scope:n,method:r,splitKey:o="+"}=e;pC(t).forEach((e=>{const t=e.split(o),i=t.length,s=t[i-1],a="*"===s?"*":SC(s);if(!yC[a])return;n||(n=CC());const c=i>1?hC(gC,t):[];yC[a]=yC[a].filter((e=>!((!r||e.method===r)&&e.scope===n&&function(e,t){const n=e.length>=t.length?e:t,r=e.length>=t.length?t:e;let o=!0;for(let e=0;e<n.length;e++)-1===r.indexOf(n[e])&&(o=!1);return o}(e.mods,c))))}))};function IC(e,t,n,r){if(t.element!==r)return;let o;if(t.scope===n||"all"===t.scope){o=t.mods.length>0;for(const e in _C)Object.prototype.hasOwnProperty.call(_C,e)&&(!_C[e]&&t.mods.indexOf(+e)>-1||_C[e]&&-1===t.mods.indexOf(+e))&&(o=!1);(0!==t.mods.length||_C[16]||_C[18]||_C[17]||_C[91])&&!o&&"*"!==t.shortcut||(t.keys=[],t.keys=t.keys.concat(wC),!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function PC(e,t){const n=yC["*"];let r=e.keyCode||e.which||e.charCode;if(!MC.filter.call(this,e))return;if(93!==r&&224!==r||(r=91),-1===wC.indexOf(r)&&229!==r&&wC.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach((t=>{const n=mC[t];e[t]&&-1===wC.indexOf(n)?wC.push(n):!e[t]&&wC.indexOf(n)>-1?wC.splice(wC.indexOf(n),1):"metaKey"===t&&e[t]&&3===wC.length&&(e.ctrlKey||e.shiftKey||e.altKey||(wC=wC.slice(wC.indexOf(n))))})),r in _C){_C[r]=!0;for(const e in gC)gC[e]===r&&(MC[e]=!0);if(!n)return}for(const t in _C)Object.prototype.hasOwnProperty.call(_C,t)&&(_C[t]=e[mC[t]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===wC.indexOf(17)&&wC.push(17),-1===wC.indexOf(18)&&wC.push(18),_C[17]=!0,_C[18]=!0);const o=CC();if(n)for(let r=0;r<n.length;r++)n[r].scope===o&&("keydown"===e.type&&n[r].keydown||"keyup"===e.type&&n[r].keyup)&&IC(e,n[r],o,t);if(r in yC)for(let n=0;n<yC[r].length;n++)if(("keydown"===e.type&&yC[r][n].keydown||"keyup"===e.type&&yC[r][n].keyup)&&yC[r][n].key){const i=yC[r][n],{splitKey:s}=i,a=i.key.split(s),c=[];for(let e=0;e<a.length;e++)c.push(SC(a[e]));c.sort().join("")===wC.sort().join("")&&IC(e,i,o,t)}}function MC(e,t,n){wC=[];const r=pC(e);let o=[],i="all",s=document,a=0,c=!1,l=!0,u="+",d=!1,h=!1;for(void 0===n&&"function"==typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(i=t.scope),t.element&&(s=t.element),t.keyup&&(c=t.keyup),void 0!==t.keydown&&(l=t.keydown),void 0!==t.capture&&(d=t.capture),"string"==typeof t.splitKey&&(u=t.splitKey),!0===t.single&&(h=!0)),"string"==typeof t&&(i=t),h&&EC(e,i);a<r.length;a++)o=[],(e=r[a].split(u)).length>1&&(o=hC(gC,e)),(e="*"===(e=e[e.length-1])?"*":SC(e))in yC||(yC[e]=[]),yC[e].push({keyup:c,keydown:l,scope:i,mods:o,shortcut:r[a],method:n,key:r[a],splitKey:u,element:s});void 0!==s&&!function(e){return xC.indexOf(e)>-1}(s)&&window&&(xC.push(s),dC(s,"keydown",(e=>{PC(e,s)}),d),vC||(vC=!0,dC(window,"focus",(()=>{wC=[]}),d)),dC(s,"keyup",(e=>{PC(e,s),function(e){let t=e.keyCode||e.which||e.charCode;const n=wC.indexOf(t);if(n>=0&&wC.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&wC.splice(0,wC.length),93!==t&&224!==t||(t=91),t in _C){_C[t]=!1;for(const e in gC)gC[e]===t&&(MC[e]=!1)}}(e)}),d))}const TC={getPressedKeyString:function(){return wC.map((e=>{return t=e,Object.keys(fC).find((e=>fC[e]===t))||(e=>Object.keys(gC).find((t=>gC[t]===e)))(e)||String.fromCharCode(e);var t}))},setScope:kC,getScope:CC,deleteScope:function(e,t){let n,r;e||(e=CC());for(const t in yC)if(Object.prototype.hasOwnProperty.call(yC,t))for(n=yC[t],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;CC()===e&&kC(t||"all")},getPressedKeyCodes:function(){return wC.slice(0)},getAllKeyCodes:function(){const e=[];return Object.keys(yC).forEach((t=>{yC[t].forEach((t=>{let{key:n,scope:r,mods:o,shortcut:i}=t;e.push({scope:r,shortcut:i,mods:o,keys:n.split("+").map((e=>SC(e)))})}))})),e},isPressed:function(e){return"string"==typeof e&&(e=SC(e)),-1!==wC.indexOf(e)},filter:function(e){const t=e.target||e.srcElement,{tagName:n}=t;let r=!0;return!t.isContentEditable&&("INPUT"!==n&&"TEXTAREA"!==n&&"SELECT"!==n||t.readOnly)||(r=!1),r},trigger:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(yC).forEach((n=>{yC[n].filter((n=>n.scope===t&&n.shortcut===e)).forEach((e=>{e&&e.method&&e.method()}))}))},unbind:EC,keyMap:fC,modifier:gC,modifierMap:mC};for(const e in TC)Object.prototype.hasOwnProperty.call(TC,e)&&(MC[e]=TC[e]);if("undefined"!=typeof window){const e=window.hotkeys;MC.noConflict=t=>(t&&window.hotkeys===MC&&(window.hotkeys=e),MC),window.hotkeys=MC}const jC=["copy","cut","paste","asset"];function DC(e){return function(e){"string"!=typeof e&&(e="");const t=(e=e.replace(/\s/g,"")).split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}(e).map((e=>{let t="";const n=e.split("");return t=1===n.length?n[0]:"!"===n[0]?`shift+${n[1]}`:"?"===n[0]?3===n.length&&"!"===n[1]?`alt+shift+${n[2]}`:`alt+${n[1]}`:"$"===n[0]?"!"===n[1]?`cmd+shift+${n[2]},ctrl+shift+${n[2]}`:"?"===n[1]?`cmd++${n[2]},ctrl+alt+${n[2]}`:`cmd+${n[1]},ctrl+${n[1]}`:e,t})).join(",")}const OC=e.memo((function({shareZone:e,topZone:t,renderDebugMenuItems:n,children:r,hideUi:o,...i}){return(0,Fr.jsx)(Aw,{...i,children:(0,Fr.jsx)(zC,{hideUi:o,shareZone:e,topZone:t,renderDebugMenuItems:n,children:r})})})),zC=e.memo((function({children:e,hideUi:t,...n}){return(0,Fr.jsxs)(Fr.Fragment,{children:[e,t?null:(0,Fr.jsx)(FC,{...n})]})})),FC=e.memo((function({shareZone:t,topZone:n,renderDebugMenuItems:r}){const o=Yr(),i=om(),s=tw(),a=le("isReadonlyMode",(()=>o.getInstanceState().isReadonly),[o]),c=le("focus",(()=>o.getInstanceState().isFocusMode),[o]),l=le("debug",(()=>o.getInstanceState().isDebugMode),[o]);!function(){const t=Yr(),n=Uu(),r=Uy(),o=dw(),i=le("is focused",(()=>t.getInstanceState().isFocused),[t]);(0,e.useEffect)((()=>{if(!i)return;const e=t.getContainer();MC.setScope(t.store.id);const s=(n,r)=>{MC(n,{element:e,scope:t.store.id},r)},a=()=>t.getIsMenuOpen()||null!==t.getEditingShapeId()||t.getCrashingError();for(const e of Object.values(r))e.kbd&&(n&&!e.readonlyOk||jC.includes(e.id)||s(DC(e.kbd),(t=>{a()||(Vr(t),e.onSelect("kbd"))})));for(const e of Object.values(o))!e.kbd||!e.readonlyOk&&t.getInstanceState().isReadonly||jC.includes(e.id)||s(DC(e.kbd),(t=>{a()||(Vr(t),e.onSelect("kbd"))}));return()=>{MC.deleteScope(t.store.id)}}),[r,o,n,t,i])}(),function(){const t=Yr(),n=_y(),r=le("editor.isFocused",(()=>t.getInstanceState().isFocused),[t]);(0,e.useEffect)((()=>{if(!r)return;const e=()=>{0===t.getSelectedShapeIds().length||null!==t.getEditingShapeId()||vy(t)||(Ey(t),n("copy",{source:"kbd"}))};function o(){0===t.getSelectedShapeIds().length||null!==t.getEditingShapeId()||vy(t)||(Ey(t),t.deleteShapes(t.getSelectedShapeIds()),n("cut",{source:"kbd"}))}let i=!1;const s=e=>{1===e.button&&(i=!0,requestAnimationFrame((()=>{i=!1})))},a=e=>{i?e.stopPropagation():null!==t.getEditingShapeId()||vy(t)||(e.clipboardData&&!t.inputs.shiftKey?(async(e,t,n)=>{if(null!==e.getEditingShapeId())return;if(!t)throw Error("No clipboard data");const r=[];for(const e of Object.values(t.items))switch(e.kind){case"file":r.push({type:"file",source:new Promise((t=>t(e.getAsFile())))});break;case"string":"text/html"===e.type?r.push({type:"html",source:new Promise((t=>e.getAsString(t)))}):"text/plain"===e.type?r.push({type:"text",source:new Promise((t=>e.getAsString(t)))}):r.push({type:e.type,source:new Promise((t=>e.getAsString(t)))})}Cy(e,r,void 0)})(t,e.clipboardData):navigator.clipboard.read().then((e=>{Array.isArray(e)&&e[0]instanceof ClipboardItem&&ky(t,e,t.inputs.currentPagePoint)})),n("paste",{source:"kbd"}))};return document.addEventListener("copy",e),document.addEventListener("cut",o),document.addEventListener("paste",a),document.addEventListener("pointerup",s),()=>{document.removeEventListener("copy",e),document.removeEventListener("cut",o),document.removeEventListener("paste",a),document.removeEventListener("pointerup",s)}}),[t,n,r])}(),function(){const t=Yr(),{addToast:n}=Dy();(0,e.useEffect)((()=>{function e({name:e,count:t}){n({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${e} (${t}). Please delete some shapes or move to a different page to continue.`})}return t.addListener("max-shapes",e),()=>{t.removeListener("max-shapes",e)}}),[t,n])}();const{"toggle-focus-mode":u}=Uy();return(0,Fr.jsx)(wg,{children:(0,Fr.jsxs)("div",{className:Rr("tlui-layout",{"tlui-layout__mobile":s<5}),"data-breakpoint":s,children:[c?(0,Fr.jsx)("div",{className:"tlui-layout__top",children:(0,Fr.jsx)(hm,{type:"icon",className:"tlui-focus-button",title:`${i("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>u.onSelect("menu")})}):(0,Fr.jsxs)(Fr.Fragment,{children:[(0,Fr.jsxs)("div",{className:"tlui-layout__top",children:[(0,Fr.jsxs)("div",{className:"tlui-layout__top__left",children:[(0,Fr.jsx)(ek,{}),(0,Fr.jsxs)("div",{className:"tlui-helper-buttons",children:[(0,Fr.jsx)(sk,{}),(0,Fr.jsx)(Pw,{}),(0,Fr.jsx)(ak,{})]})]}),(0,Fr.jsx)("div",{className:"tlui-layout__top__center",children:n}),(0,Fr.jsxs)("div",{className:"tlui-layout__top__right",children:[t,s>=5&&!a&&(0,Fr.jsx)("div",{className:"tlui-style-panel__wrapper",children:(0,Fr.jsx)(Hk,{})})]})]}),(0,Fr.jsxs)("div",{className:"tlui-layout__bottom",children:[(0,Fr.jsxs)("div",{className:"tlui-layout__bottom__main",children:[(0,Fr.jsx)(ik,{}),(0,Fr.jsx)(sC,{}),s>=4&&(0,Fr.jsx)(yS,{})]}),l&&(0,Fr.jsx)(sS,{renderDebugMenuItems:r??null})]})]}),(0,Fr.jsx)(tC,{}),(0,Fr.jsx)(fS,{}),(0,Fr.jsx)(nC,{}),(0,Fr.jsx)(gS,{})]})})})),RC="ContextMenu",[LC,NC]=Bf(RC,[Fb]),BC=Fb(),[$C,UC]=LC(RC);function VC(e){return t=>"mouse"!==t.pointerType?e(t):void 0}const WC=t=>{const{__scopeContextMenu:n,children:r,onOpenChange:o,dir:i,modal:s=!0}=t,[a,c]=(0,e.useState)(!1),l=BC(n),u=Xf(o),d=(0,e.useCallback)((e=>{c(e),u(e)}),[u]);return(0,e.createElement)($C,{scope:n,open:a,onOpenChange:d,modal:s},(0,e.createElement)(vx,zf({},l,{dir:i,open:a,onOpenChange:d,modal:s}),r))},KC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,disabled:o=!1,...i}=t,s=UC("ContextMenuTrigger",r),a=BC(r),c=(0,e.useRef)({x:0,y:0}),l=(0,e.useRef)({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...c.current})}),u=(0,e.useRef)(0),d=(0,e.useCallback)((()=>window.clearTimeout(u.current)),[]),h=e=>{c.current={x:e.clientX,y:e.clientY},s.onOpenChange(!0)};return(0,e.useEffect)((()=>d),[d]),(0,e.useEffect)((()=>{o&&d()}),[o,d]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(bx,zf({},a,{virtualRef:l})),(0,e.createElement)(qf.span,zf({"data-state":s.open?"open":"closed","data-disabled":o?"":void 0},i,{ref:n,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:o?t.onContextMenu:Rf(t.onContextMenu,(e=>{d(),h(e),e.preventDefault()})),onPointerDown:o?t.onPointerDown:Rf(t.onPointerDown,VC((e=>{d(),u.current=window.setTimeout((()=>h(e)),700)}))),onPointerMove:o?t.onPointerMove:Rf(t.onPointerMove,VC(d)),onPointerCancel:o?t.onPointerCancel:Rf(t.onPointerCancel,VC(d)),onPointerUp:o?t.onPointerUp:Rf(t.onPointerUp,VC(d))})))})),HC=t=>{const{__scopeContextMenu:n,...r}=t,o=BC(n);return(0,e.createElement)(xx,zf({},o,r))},GC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,...o}=t,i=UC("ContextMenuContent",r),s=BC(r),a=(0,e.useRef)(!1);return(0,e.createElement)(Sx,zf({},s,o,{ref:n,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:e=>{var n;null===(n=t.onCloseAutoFocus)||void 0===n||n.call(t,e),!e.defaultPrevented&&a.current&&e.preventDefault(),a.current=!1},onInteractOutside:e=>{var n;null===(n=t.onInteractOutside)||void 0===n||n.call(t,e),e.defaultPrevented||i.modal||(a.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))})),qC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,...o}=t,i=BC(r);return(0,e.createElement)(kx,zf({},i,o,{ref:n}))})),YC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,...o}=t,i=BC(r);return(0,e.createElement)(Cx,zf({},i,o,{ref:n}))})),XC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,...o}=t,i=BC(r);return(0,e.createElement)(Ex,zf({},i,o,{ref:n}))})),ZC=t=>{const{__scopeContextMenu:n,children:r,onOpenChange:o,open:i,defaultOpen:s}=t,a=BC(n),[c,l]=lg({prop:i,defaultProp:s,onChange:o});return(0,e.createElement)(Ix,zf({},a,{open:c,onOpenChange:l}),r)},QC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,...o}=t,i=BC(r);return(0,e.createElement)(Px,zf({},i,o,{ref:n}))})),JC=(0,e.forwardRef)(((t,n)=>{const{__scopeContextMenu:r,...o}=t,i=BC(r);return(0,e.createElement)(Mx,zf({},i,o,{ref:n,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))})),eE=se((function(){const e=Yr(),t=Qr(),n=e.getPages(),r=e.getCurrentPageId(),o=om(),{addToast:i}=Dy();return(0,Fr.jsxs)(ZC,{children:[(0,Fr.jsx)(QC,{dir:"ltr",asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),(0,Fr.jsx)(HC,{container:t,children:(0,Fr.jsxs)(JC,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[(0,Fr.jsx)(qC,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:n.map((t=>(0,Fr.jsx)(YC,{disabled:r===t.id,onSelect:()=>{e.mark("move_shapes_to_page"),e.moveShapesToPage(e.getSelectedShapeIds(),t.id);const n=e.getPage(t.id);n&&i({title:"Changed Page",description:`Moved to ${n.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{e.mark("change-page"),e.setCurrentPage(r)}}]})},asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",title:t.name,className:"tlui-context-menu__move-to-page__name",children:(0,Fr.jsx)("span",{className:"tlui-button__label",children:t.name})})},t.id)))},"pages"),(0,Fr.jsx)(qC,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:(0,Fr.jsx)(YC,{onSelect:()=>{const t=Qt.createId(),n=e.getSelectedShapeIds();e.batch((()=>{e.mark("move_shapes_to_page"),e.createPage({name:"Page",id:t}),e.moveShapesToPage(n,t)}))},asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",title:o("context.pages.new-page"),className:"tlui-context-menu__move-to-page__name",children:(0,Fr.jsx)("span",{className:"tlui-button__label",children:o("context.pages.new-page")})})},"new-page")},"new-page")]})})]})})),tE=function({children:t}){const n=Yr(),r=cw(),o=(0,e.useCallback)((e=>{if(e){if(n.getInstanceState().isCoarsePointer){const e=n.getSelectedShapes(),{inputs:{currentPagePoint:t}}=n,r=n.getShapesAtPoint(t);if(!n.getSelectedShapes().length||!r.some((t=>e.includes(t)))){const e=r.filter((e=>n.isShapeOrAncestorLocked(e)));e.length&&n.select(...e.map((e=>e.id)))}}}else{const e=n.getOnlySelectedShape();e&&n.isShapeOrAncestorLocked(e)&&n.setSelectedShapes([])}}),[n]),i=Qr(),[s,a]=qx("context menu",o),c=Uu(),l=0===r.length||c&&r.every((e=>!e.readonlyOk)),u=!le("isSelectToolActive",(()=>"select"===n.getCurrentToolId()),[n])||l;return(0,Fr.jsxs)(WC,{dir:"ltr",onOpenChange:a,children:[(0,Fr.jsx)(KC,{onContextMenu:u?Vr:void 0,dir:"ltr",disabled:u,children:t}),(0,Fr.jsx)(HC,{container:i,children:(0,Fr.jsx)(nE,{})})]})},nE=(0,e.forwardRef)((function(){const t=Yr(),n=om(),r=cw(),[o,i]=qx("context menu sub"),s=Uu(),a=tw(),c=Qr(),[l,u]=(0,e.useState)(!1);function d(e,t,r,o){if(!t)return null;if(s&&!t.readonlyOk)return null;switch(t.type){case"custom":if("MOVE_TO_PAGE_MENU"===t.id)return(0,Fr.jsx)(eE,{},t.id);break;case"group":return(0,Fr.jsx)(qC,{dir:"ltr",className:Rr("tlui-menu__group",{"tlui-menu__group__small":"submenu"===r?.type}),"data-testid":`menu-item.${t.id}`,children:t.children.map((n=>d(e,n,t,o+1)))},t.id);case"submenu":return(0,Fr.jsxs)(ZC,{onOpenChange:i,children:[(0,Fr.jsx)(QC,{dir:"ltr",disabled:t.disabled,asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu",label:t.label,"data-testid":`menu-item.${t.id}`,icon:"chevron-right"})}),(0,Fr.jsx)(HC,{container:c,children:(0,Fr.jsx)(JC,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:t.children.map((n=>d(e,n,t,o+1)))})})]},t.id);case"item":{if(s&&!t.readonlyOk)return null;const{id:e,checkbox:r,contextMenuLabel:i,label:c,onSelect:d,kbd:h,icon:p}=t.actionItem,f=i??c,g=f?n(f):void 0;return r?(0,Fr.jsxs)(XC,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",disabled:t.disabled,onSelect:e=>{d("context-menu"),Vr(e)},title:g||void 0,checked:t.checked,children:[(0,Fr.jsx)(sm,{small:!0,icon:t.checked?"check":"checkbox-empty"}),g&&(0,Fr.jsx)("span",{className:"tlui-button__label",draggable:!1,children:g}),h&&(0,Fr.jsx)(dm,{children:h})]},e):(0,Fr.jsx)(YC,{dir:"ltr",asChild:!0,children:(0,Fr.jsx)(hm,{type:"menu","data-testid":`menu-item.${e}`,kbd:h,label:f,disabled:t.disabled,iconLeft:a<3&&o>2?p:void 0,onClick:()=>{l?u(!1):d("context-menu")}})},e)}}}return(0,Fr.jsx)(HC,{container:c,children:(0,Fr.jsx)(GC,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:Vr,children:r.map((e=>d(t,e,null,0)))})})})),rE=(t,n)=>{const[r,o]=(0,e.useState)(2);return(0,e.useEffect)((()=>{const{url:e,style:r="normal",weight:i="500",display:s,featureSettings:a,stretch:c,unicodeRange:l,variant:u}=n;let d=!1;o(2);const h=new FontFace(t,`url(${e})`,{style:r,weight:i,display:s,featureSettings:a,stretch:c,unicodeRange:l,variant:u});return h.load().then((()=>{d||(document.fonts.add(h),o(0))})).catch((e=>{d||(console.error(e),o(1))})),h.$$_url=e,h.$$_fontface=`\n@font-face {\n\tfont-family: ${h.family};\n\tfont-stretch: ${h.stretch};\n\tfont-weight: ${h.weight};\n\tfont-style: ${h.style};\n\tsrc: url("${e}") format("woff2")\n}`,()=>{document.fonts.delete(h),d=!0}}),[t,n]),r};function oE(t){const{children:n,maxImageDimension:r,maxAssetSize:o,acceptedImageMimeTypes:i,acceptedVideoMimeTypes:s,onMount:a,...c}=t,l={initialState:"select",...c,components:(0,e.useMemo)((()=>({Scribble:Bu,CollaboratorScribble:Bu,SelectionForeground:Wu,SelectionBackground:$u,Handles:Pu,HoveredShapeIndicator:Mu,...c.components})),[c.components]),shapeUtils:(0,e.useMemo)((()=>[...Up,...c.shapeUtils??[]]),[c.shapeUtils]),tools:(0,e.useMemo)((()=>[...Of,...Hd,...c.tools??[]]),[c.tools])},u=(d=c.assetUrls,(0,e.useMemo)((()=>d?{fonts:{...Gg.fonts,...d?.fonts}}:Gg),[d]));var d;const{done:h,error:p}=function(t){const n=(0,e.useMemo)((()=>function(e){return{draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}}(t)),[t]),r=[rE("tldraw_draw",n.draw),rE("tldraw_serif",n.serif),rE("tldraw_sans",n.sansSerif),rE("tldraw_mono",n.monospace)];return{error:r.some((e=>1===e)),done:!r.some((e=>2===e))}}(u);return p?(0,Fr.jsx)(du,{children:"Could not load assets. Please refresh the page."}):h?(0,Fr.jsx)(ou,{...l,children:(0,Fr.jsxs)(OC,{...l,children:[(0,Fr.jsx)(tE,{children:(0,Fr.jsx)(Ns,{})}),(0,Fr.jsx)(iE,{maxImageDimension:r,maxAssetSize:o,acceptedImageMimeTypes:i,acceptedVideoMimeTypes:s,onMount:a}),n]})}):(0,Fr.jsx)(uu,{children:"Loading assets..."})}function iE({maxImageDimension:t=1e3,maxAssetSize:n=10485760,acceptedImageMimeTypes:r=["image/jpeg","image/png","image/gif","image/svg+xml"],acceptedVideoMimeTypes:o=["video/mp4","video/quicktime"],onMount:i}){const s=Yr(),a=function(t){const n=(0,e.useRef)();return(0,e.useLayoutEffect)((()=>{n.current=t})),(0,e.useDebugValue)(t),(0,e.useCallback)(((...e)=>{const t=n.current;return me(t,"fn does not exist"),t(...e)}),[])}((e=>{const s=[];return s.push(...function(e){return[e.sideEffects.registerAfterChangeHandler("instance",((t,n)=>{t.isFocused!==n.isFocused&&(n.isFocused?(e.getContainer().focus(),e.updateViewportScreenBounds()):(e.complete(),e.getContainer().blur(),e.updateViewportScreenBounds()))})),e.sideEffects.registerAfterChangeHandler("instance_page_state",((t,n)=>{if(t.croppingShapeId!==n.croppingShapeId){const r=e.isInAny("select.crop","select.pointing_crop_handle","select.cropping");!t.croppingShapeId&&n.croppingShapeId?r||e.setCurrentTool("select.crop.idle"):t.croppingShapeId&&!n.croppingShapeId&&r&&e.setCurrentTool("select.idle")}t.editingShapeId!==n.editingShapeId&&(!t.editingShapeId&&n.editingShapeId?e.isIn("select.editing_shape")||e.setCurrentTool("select.editing_shape"):t.editingShapeId&&!n.editingShapeId&&e.isIn("select.editing_shape")&&e.setCurrentTool("select.idle"))}))]}(e)),Md(e,{maxImageDimension:t,maxAssetSize:n,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:o}),s.push(i?.(e)),()=>{s.forEach((e=>e?.()))}}));return(0,e.useLayoutEffect)((()=>{if(s)return a?.(s)}),[s,a]),null}function sE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Mt({tldrawFileFormatVersion:Ct,schema:Mt({schemaVersion:kt,storeVersion:kt,recordVersions:Dt(wt,Mt({version:kt,subTypeVersions:Dt(wt,kt).optional(),subTypeKey:wt.optional()}))}),records:Pt(Mt({id:wt,typeName:wt}).allowUnknownProperties())});class aE extends pu{constructor(){super(...arguments),sE(this,"isAspectRatioLocked",(e=>!1)),sE(this,"canResize",(e=>!1)),sE(this,"canBind",(e=>!0)),sE(this,"hideRotateHandle",(e=>!0))}getDefaultProps(){return{w:120,h:120,borderColor:"black",backgroundColor:"white",name:"AWS Service",iconPath:""}}component(e){return(0,Fr.jsx)(Fr.Fragment,{children:(0,Fr.jsxs)(hu,{id:e.id,style:{border:"2px solid ".concat(e.props.borderColor),borderRadius:"0.25rem",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"all",backgroundColor:e.props.backgroundColor},children:[(0,Fr.jsx)("div",{className:"absolute top-0 left-0 text-center max-w-full p-1 text-sm text-black truncate rounded-br",children:e.props.name}),(0,Fr.jsx)("img",{src:e.props.iconPath,className:"absolute bottom-4 h-16 w-16 rounded pointer-events-none select-none"})]})})}async toSvg(e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"g"),r=document.createElementNS(t,"rect");r.setAttributeNS(null,"width",e.props.w.toString()),r.setAttributeNS(null,"height",e.props.h.toString()),r.setAttributeNS(null,"rx","4"),r.setAttributeNS(null,"fill",e.props.backgroundColor),r.setAttributeNS(null,"stroke",e.props.borderColor),r.setAttributeNS(null,"stroke-width","2"),n.appendChild(r);const o=document.createElementNS(t,"text");o.textContent=e.props.name,o.setAttributeNS(null,"x",5..toString()),o.setAttributeNS(null,"y","17"),o.setAttributeNS(null,"style","font-family: sans-serif; font-size: ".concat(14,"px; fill: ").concat(e.props.borderColor,";")),o.setAttributeNS(null,"dominant-baseline","middle"),((e,t)=>{const n=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(n),n.appendChild(e);let r=e.getComputedTextLength();for(;r>t&&e.textContent.length>0;)e.textContent=e.textContent.slice(0,-4)+"...",r=e.getComputedTextLength();document.body.removeChild(n)})(o,e.props.w-10),n.appendChild(o);const i=e.props.w/2-32,s=e.props.h-64-16,a=document.createElementNS(t,"image");try{const t=await(c=e.props.iconPath,new Promise(((e,t)=>{const n=new Image;n.crossOrigin="Anonymous",n.onload=()=>{let t=document.createElement("canvas");t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0);const r=t.toDataURL("image/png");e(r)},n.onerror=()=>{t("Could not load image")},n.src=c})));a.setAttributeNS("http://www.w3.org/1999/xlink","href",t)}catch(e){console.error("Error converting image to data URL",e)}var c;a.setAttributeNS(null,"x",i.toString()),a.setAttributeNS(null,"y",s.toString()),a.setAttributeNS(null,"width",64..toString()),a.setAttributeNS(null,"height",64..toString());const l=document.createElementNS(t,"clipPath");l.setAttributeNS(null,"id","rounded-corners");const u=document.createElementNS(t,"rect");return u.setAttributeNS(null,"x",i.toString()),u.setAttributeNS(null,"y",s.toString()),u.setAttributeNS(null,"width",64..toString()),u.setAttributeNS(null,"height",64..toString()),u.setAttributeNS(null,"rx","4"),u.setAttributeNS(null,"ry","4"),l.appendChild(u),n.appendChild(l),a.setAttributeNS(null,"clip-path","url(#rounded-corners)"),a.onerror=e=>{console.error("Failed to load image",e)},n.appendChild(a),n}indicator(e){return(0,Fr.jsx)("rect",{width:e.props.w,height:e.props.h})}}sE(aE,"type","node"),sE(aE,"props",{w:vt,h:vt,borderColor:wt,backgroundColor:wt,name:wt,iconPath:wt});class cE extends _u{constructor(){super(...arguments),sE(this,"shapeType","node"),sE(this,"props",{w:vt,h:vt,color:Nn})}}sE(cE,"id","node"),sE(cE,"initial","idle");var lE=o(681),uE=o.n(lE),dE=o(7460),hE=o.n(dE);function pE(e){return function(e){return"object"==typeof e&&null!==e&&"Node"===e.$$type&&"string"==typeof e.id}(e)||function(e){return"object"==typeof e&&null!==e&&"string"==typeof e.id}(e)}function fE(e){return"string"==typeof e||pE(e)}function gE(e){if(pE(e))return e;const[t,n,r]=e.split(":");return["n","ne","e","se","s","sw","w","nw","c"].includes(r)?{id:t,port:n,compass:r}:{id:t,port:n}}const mE=Object.seal({Graph:null,Digraph:null,Subgraph:null,Node:null,Edge:null});function _E(e){return Object.assign(Object.seal(Object.assign({},mE)),e)}const yE=e=>(...t)=>n=>e(n,...t),wE=e=>({[Symbol.iterator]:e});yE(((e,t)=>Array.from(wE((function*(){for(const n of e)yield t(n)}))))),yE(((e,t)=>Array.from(wE((function*(){for(const n of e)t(n)&&(yield n)})))));class vE{options;getLocation(){return this.options?.locationFunction?.()??null}constructor(e){this.options=e}createElement(e,t,n=[]){return{location:this.getLocation(),...t,type:e,children:n}}}vE.prototype.createElement.bind(new vE);function bE(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}!function(e,...t){(function(...e){const[t,...n]=e})(e,...t)}((e=>e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/"/g,'\\"')),('"',e=>'"'+e+'"'));let xE=class extends Error{static buildMessage(e,t){function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+n(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+n(e)))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(e=>"\\x0"+n(e))).replace(/[\x10-\x1F\x7F-\x9F]/g,(e=>"\\x"+n(e)))}function i(e){switch(e.type){case"literal":return'"'+r(e.text)+'"';case"class":const t=e.parts.map((e=>Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)));return"["+(e.inverted?"^":"")+t+"]";case"any":return"any character";case"end":return"end of input";case"other":return e.description}}return"Expected "+function(e){const t=e.map(i);let n,r;if(t.sort(),t.length>0){for(n=1,r=1;n<t.length;n++)t[n-1]!==t[n]&&(t[r]=t[n],r++);t.length=r}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(e)+" but "+((s=t)?'"'+r(s)+'"':"end of input")+" found.";var s}message;expected;found;location;name;constructor(e,t,n,r){super(),this.message=e,this.expected=t,this.found=n,this.location=r,this.name="DotSyntaxError","function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(this,xE.prototype):this.__proto__=xE.prototype,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,xE)}format(e){let t="Error: "+this.message;if(this.location){let n,r=null;for(n=0;n<e.length;n++)if(e[n].grammarSource===this.location.source){r=e[n].text.split(/\r\n|\n|\r/g);break}let o=this.location.start,i=this.location.source+":"+o.line+":"+o.column;if(r){let e=this.location.end,n=bE("",o.line.toString().length," "),s=r[o.line-1],a=o.line===e.line?e.column:s.length+1;t+="\n --\x3e "+i+"\n"+n+" |\n"+o.line+" | "+s+"\n"+n+" | "+bE("",o.column-1," ")+bE("",a-o.column,"^")}else t+="\n at "+i}return t}};const SE=function(e,t){const n={},r=(t=void 0!==t?t:{}).grammarSource,o={Dot:cn,Graph:ln,Subgraph:fn,Node:un,Edge:pn,AttributeList:dn,Attribute:hn,ClusterStatements:yn};let i=cn;const s=function(e){return e},a=function(e,t,n){return Bn.createElement("Dot",{},[...e,t,...n])},c="strict",l=tn("strict",!0),u="graph",d=tn("graph",!0),h="digraph",p=tn("digraph",!0),f="{",g=tn("{",!1),m="}",_=tn("}",!1),y=function(e,t,n,r){const o=!!e,i="digraph"===t.toLowerCase();for(const e of Nn)i?"->"!==e.operator&&en('In digraph, it\'s necessary to describe with "->" operator to create edge.',e.location):"--"!==e.operator&&en('In graph, it\'s necessary to describe with "--" operator to create edge.',e.location);return Bn.createElement("Graph",null!==n?{id:n,directed:i,strict:o}:{directed:i,strict:o},r)},w=";",v=tn(";",!1),b=function(e){return Bn.createElement("Attribute",{...e},[])},x="node",S=tn("node",!0),k="edge",C=tn("edge",!0),E=function(e,t){return Bn.createElement("AttributeList",{kind:`${e.slice(0,1).toUpperCase()}${e.slice(1).toLowerCase()}`},t)},A=function(e,t,n){return Bn.createElement("Edge",{targets:[e,...t]},n??[])},I=function(e,t){return Bn.createElement("Node",{id:e},t??[])},P="=",M=tn("=",!1),T=function(e,t){return{key:e,value:t}},j=",",D=tn(",",!1),O=function(e){return Bn.createElement("Attribute",{...e,location:Jt()},[])},z="[",F=tn("[",!1),R="]",L=tn("]",!1),N=function(e){return e},B=function(e,t){return t},$=function(e,t){return Bn.createElement("NodeRefGroup",{},[e,...t])},U="->",V=tn("->",!1),W="--",K=tn("--",!1),H=function(e){return{operator:e,location:Jt()}},G=function(e,t,n){return Nn.push(e),[t].concat(n||[])},q=function(e,t){return Bn.createElement("NodeRef",{id:e,...t},[])},Y=rn("port"),X=":",Z=tn(":",!1),Q=function(e,t){return t},J=function(e,t){return["n","ne","e","se","s","sw","w","nw"].includes(e)?{compass:e}:t?{port:e,compass:t}:{port:e}},ee="subgraph",te=tn("subgraph",!0),ne=function(e){return e},re=function(e,t){const n=t??[];return Bn.createElement("Subgraph",e?{id:e}:{},n)},oe="n",ie=tn("n",!1),se="ne",ae=tn("ne",!1),ce="e",le=tn("e",!1),ue="se",de=tn("se",!1),he="s",pe=tn("s",!1),fe="sw",ge=tn("sw",!1),me="w",_e=tn("w",!1),ye="nw",we=tn("nw",!1),ve=function(e){return{value:e,quoted:!1}},be='"',xe=tn('"',!1),Se=function(e){return{value:e,quoted:!0}},ke=function(e){return Bn.createElement("Literal",{...e},[])},Ce=function(e){return Bn.createElement("Literal",{value:e,quoted:!1},[])},Ee="/*",Ae=tn("/*",!1),Ie="*/",Pe=tn("*/",!1),Me={type:"any"},Te=function(e){return Bn.createElement("Comment",{kind:"Block",value:Ln(e.join("").replace(/[ \t]*\*/g,""))},[])},je=function(e){return Bn.createElement("Comment",{kind:"Slash",value:Ln(e.join("\n"))},[])},De="//",Oe=tn("//",!1),ze=function(e){return e.join("")},Fe=function(e){return Bn.createElement("Comment",{kind:"Macro",value:Ln(e.join("\n"))},[])},Re="#",Le=tn("#",!1),Ne=rn("UNICODE_STRING"),Be=function(e,t){return e+t.join("")},$e=function(e,t){return e+t},Ue="$",Ve=tn("$",!1),We="_",Ke=tn("_",!1),He=rn("NUMBER"),Ge="-",qe=tn("-",!1),Ye=".",Xe=tn(".",!1),Ze=/^[0-9]/,Qe=nn([["0","9"]],!1,!1),Je=function(e){return Qt()},et=function(e){return Bn.createElement("Literal",{value:e.slice(1,e.length-1),quoted:"html"},[])},tt="<",nt=tn("<",!1),rt=">",ot=tn(">",!1),it=function(e){return"<"+e.join("")+">"},st=function(e){return Bn.createElement("Literal",{value:e.join(""),quoted:!0},[])},at=function(){return Qt()},ct="\\",lt=tn("\\",!1),ut=function(e){return'"'===e[1]?'"':e[0]+e[1]},dt=function(){return""},ht=/^[\n\r\u2028\u2029]/,pt=nn(["\n","\r","\u2028","\u2029"],!1,!1),ft=rn("end of line"),gt="\n",mt=tn("\n",!1),_t="\r\n",yt=tn("\r\n",!1),wt="\r",vt=tn("\r",!1),bt="\u2028",xt=tn("\u2028",!1),St="\u2029",kt=tn("\u2029",!1),Ct=rn("whitespace"),Et=rn("WHITESPACE"),At=/^[\n\r]/,It=nn(["\n","\r"],!1,!1),Pt=/^[ \t]/,Mt=nn([" ","\t"],!1,!1),Tt=/^[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137-\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148-\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C-\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA-\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9-\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC-\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF-\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F-\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0-\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB-\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE-\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0561-\u0587\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6-\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FC7\u1FD0-\u1FD3\u1FD6-\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6-\u1FF7\u210A\u210E-\u210F\u2113\u212F\u2134\u2139\u213C-\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65-\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73-\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3-\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7FA\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]/,jt=nn([["a","z"],"",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","",["",""],"","",["",""],"","","","","",["",""],"","","","",["",""],["",""],"","","","","","","","","","",["",""],"","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"",["",""],"","","","","",["",""],["",""],"","","",["",""],"",["",""],["",""],["",""],"","","","","","","","","","","",["",""],"","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","","","",["",""],["",""],"","",["",""],"",["",""],"","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","",["",""],["",""],["",""]],!1,!1),Dt=/^[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5-\u06E6\u07F4-\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C-\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D-\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA717-\uA71F\uA770\uA788\uA7F8-\uA7F9\uA9CF\uAA70\uAADD\uAAF3-\uAAF4\uFF70\uFF9E-\uFF9F]/,Ot=nn([["",""],["",""],["",""],"","","","","","",["",""],["",""],"","","","","","","","","","","",["",""],["",""],"",["",""],"","",["",""],["",""],"","","",["",""],"",["",""],["",""],"",["",""],"","",["",""],"","",["",""],"","","",["",""],"",["",""]],!1,!1),zt=/^[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0977\u0979-\u097F\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58-\u0C59\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E45\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A-\uA62B\uA66E\uA6A0-\uA6E5\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Ft=nn(["","","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],"","",["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),Rt=/^[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,Lt=nn(["","","","",["",""],["",""],["",""],"","",""],!1,!1),Nt=/^[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178-\u0179\u017B\u017D\u0181-\u0182\u0184\u0186-\u0187\u0189-\u018B\u018E-\u0191\u0193-\u0194\u0196-\u0198\u019C-\u019D\u019F-\u01A0\u01A2\u01A4\u01A6-\u01A7\u01A9\u01AC\u01AE-\u01AF\u01B1-\u01B3\u01B5\u01B7-\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A-\u023B\u023D-\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u0386\u0388-\u038A\u038C\u038E-\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9-\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0-\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E-\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D-\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA\uFF21-\uFF3A]/,Bt=nn([["A","Z"],["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"","",["",""],["",""],"",["",""],"","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],"",["",""],"","","","","","","","",["",""],"",["",""],["",""],["",""],"",["",""],"","","","","","","","","","","","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],"","","","",["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],"",["",""],"","","",["",""],["",""],["",""],"","",["",""],"",["",""],"","","",["",""],"","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","",["",""]],!1,!1),$t=/^[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]/,Ut=nn([["",""],["",""],["",""],"",["",""],["",""],["",""]],!1,!1),Vt=/^[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/,Wt=nn([["0","9"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1);let Kt=0,Ht=0;const Gt=[{line:1,column:1}];let qt,Yt=0,Xt=[],Zt=0;if(void 0!==t.startRule){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=o[t.startRule]}function Qt(){return e.substring(Ht,Kt)}function Jt(){return sn(Ht,Kt)}function en(e,t){throw function(e,t){return new xE(e,[],"",t)}(e,t=void 0!==t?t:sn(Ht,Kt))}function tn(e,t){return{type:"literal",text:e,ignoreCase:t}}function nn(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function rn(e){return{type:"other",description:e}}function on(t){let n,r=Gt[t];if(r)return r;for(n=t-1;!Gt[n];)n--;for(r=Gt[n],r={line:r.line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Gt[t]=r,r}function sn(e,t){const n=on(e),o=on(t);return{source:r,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:o.line,column:o.column}}}function an(e){Kt<Yt||(Kt>Yt&&(Yt=Kt,Xt=[]),Xt.push(e))}function cn(){let e,t,r,o;return e=Kt,t=zn(),t!==n?(r=function(){let e,t,r,o,i;for(e=Kt,t=[],r=_n();r!==n;)t.push(r),r=_n();if(t!==n)if(r=ln(),r!==n){for(o=[],i=_n();i!==n;)o.push(i),i=_n();o!==n?(Ht=e,t=a(t,r,o),e=t):(Kt=e,e=n)}else Kt=e,e=n;else Kt=e,e=n;return e}(),r!==n?(o=zn(),o!==n?(Ht=e,t=s(r),e=t):(Kt=e,e=n)):(Kt=e,e=n)):(Kt=e,e=n),e}function ln(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i,s,a,w,v,b,x,S;return t=Kt,e.substr(Kt,6).toLowerCase()===c?(r=e.substr(Kt,6),Kt+=6):(r=n,0===Zt&&an(l)),r===n&&(r=null),r!==n?(o=On(),o!==n?(e.substr(Kt,5).toLowerCase()===u?(i=e.substr(Kt,5),Kt+=5):(i=n,0===Zt&&an(d)),i===n&&(e.substr(Kt,7).toLowerCase()===h?(i=e.substr(Kt,7),Kt+=7):(i=n,0===Zt&&an(p))),i!==n?(s=On(),s!==n?(a=kn(),a===n&&(a=null),a!==n?(w=zn(),w!==n?(123===e.charCodeAt(Kt)?(v=f,Kt++):(v=n,0===Zt&&an(g)),v!==n?(b=yn(),b!==n?(x=zn(),x!==n?(125===e.charCodeAt(Kt)?(S=m,Kt++):(S=n,0===Zt&&an(_)),S!==n?(Ht=t,r=y(r,i,a,b),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function un(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i,s,a;return t=Kt,r=kn(),r!==n?(o=On(),o!==n?(i=vn(),i===n&&(i=null),i!==n?(s=On(),s!==n?(59===e.charCodeAt(Kt)?(a=w,Kt++):(a=n,0===Zt&&an(v)),a===n&&(a=null),a!==n?(Ht=t,r=I(r,i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function dn(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i,s;return t=Kt,e.substr(Kt,5).toLowerCase()===u?(r=e.substr(Kt,5),Kt+=5):(r=n,0===Zt&&an(d)),r===n&&(e.substr(Kt,4).toLowerCase()===x?(r=e.substr(Kt,4),Kt+=4):(r=n,0===Zt&&an(S)),r===n&&(e.substr(Kt,4).toLowerCase()===k?(r=e.substr(Kt,4),Kt+=4):(r=n,0===Zt&&an(C)))),r!==n?(o=vn(),o!==n?(i=On(),i!==n?(59===e.charCodeAt(Kt)?(s=w,Kt++):(s=n,0===Zt&&an(v)),s===n&&(s=null),s!==n?(Ht=t,r=E(r,o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function hn(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i;return t=Kt,r=wn(),r!==n?(o=On(),o!==n?(59===e.charCodeAt(Kt)?(i=w,Kt++):(i=n,0===Zt&&an(v)),i===n&&(i=null),i!==n?(Ht=t,r=b(r),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function pn(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i,s,a;return t=Kt,r=bn(),r!==n?(o=xn(),o!==n?(i=vn(),i===n&&(i=null),i!==n?(s=On(),s!==n?(59===e.charCodeAt(Kt)?(a=w,Kt++):(a=n,0===Zt&&an(v)),a===n&&(a=null),a!==n?(Ht=t,r=A(r,o,i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function fn(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i,s,a;return t=Kt,r=function(){let t,r,o,i,s;return t=Kt,e.substr(Kt,8).toLowerCase()===ee?(r=e.substr(Kt,8),Kt+=8):(r=n,0===Zt&&an(te)),r!==n?(o=On(),o!==n?(i=kn(),i===n&&(i=null),i!==n?(s=On(),s!==n?(Ht=t,r=ne(i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),r===n&&(r=null),r!==n?(123===e.charCodeAt(Kt)?(o=f,Kt++):(o=n,0===Zt&&an(g)),o!==n?(i=yn(),i===n&&(i=null),i!==n?(s=zn(),s!==n?(125===e.charCodeAt(Kt)?(a=m,Kt++):(a=n,0===Zt&&an(_)),a!==n?(Ht=t,r=re(r,i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function gn(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o;return t=Kt,r=kn(),r!==n?(o=function(){let t,r,o,i,s,a;return Zt++,t=Kt,58===e.charCodeAt(Kt)?(r=X,Kt++):(r=n,0===Zt&&an(Z)),r!==n?(o=kn(),o!==n?(i=Kt,58===e.charCodeAt(Kt)?(s=X,Kt++):(s=n,0===Zt&&an(Z)),s!==n?(a=function(){let t,r,o,i,s;return t=Kt,r=Kt,o=Sn(),o!==n&&(Ht=r,o=ve(o)),r=o,r===n&&(r=Kt,34===e.charCodeAt(Kt)?(o=be,Kt++):(o=n,0===Zt&&an(xe)),o!==n?(i=Sn(),i!==n?(34===e.charCodeAt(Kt)?(s=be,Kt++):(s=n,0===Zt&&an(xe)),s!==n?(Ht=r,o=Se(i),r=o):(Kt=r,r=n)):(Kt=r,r=n)):(Kt=r,r=n)),r!==n&&(Ht=t,r=ke(r)),t=r,t}(),a!==n?(Ht=i,s=Q(o,a),i=s):(Kt=i,i=n)):(Kt=i,i=n),i===n&&(i=null),i!==n?(Ht=t,r=J(o,i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),Zt--,t===n&&(r=n,0===Zt&&an(Y)),t}(),o===n&&(o=null),o!==n?(Ht=t,r=q(r,o),t=r):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function mn(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t,r,o,i;return t=Kt,r=wn(),r!==n?(o=On(),o!==n?(44===e.charCodeAt(Kt)?(i=j,Kt++):(i=n,0===Zt&&an(D)),i===n&&(59===e.charCodeAt(Kt)?(i=w,Kt++):(i=n,0===Zt&&an(v))),i===n&&(i=null),i!==n?(Ht=t,r=O(r),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function _n(){let t,r,o,i;return t=Kt,r=zn(),r!==n?(o=function(){let t;return t=function(){let t,r,o,i,a,c;if(t=Kt,e.substr(Kt,2)===Ee?(r=Ee,Kt+=2):(r=n,0===Zt&&an(Ae)),r!==n){for(o=[],i=Kt,a=Kt,Zt++,e.substr(Kt,2)===Ie?(c=Ie,Kt+=2):(c=n,0===Zt&&an(Pe)),Zt--,c===n?a=void 0:(Kt=a,a=n),a!==n?(e.length>Kt?(c=e.charAt(Kt),Kt++):(c=n,0===Zt&&an(Me)),c!==n?(Ht=i,a=s(c),i=a):(Kt=i,i=n)):(Kt=i,i=n);i!==n;)o.push(i),i=Kt,a=Kt,Zt++,e.substr(Kt,2)===Ie?(c=Ie,Kt+=2):(c=n,0===Zt&&an(Pe)),Zt--,c===n?a=void 0:(Kt=a,a=n),a!==n?(e.length>Kt?(c=e.charAt(Kt),Kt++):(c=n,0===Zt&&an(Me)),c!==n?(Ht=i,a=s(c),i=a):(Kt=i,i=n)):(Kt=i,i=n);o!==n?(e.substr(Kt,2)===Ie?(i=Ie,Kt+=2):(i=n,0===Zt&&an(Pe)),i!==n?(Ht=t,r=Te(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;return t}(),t===n&&(t=function(){let e,t,r;if(e=Kt,t=[],r=Cn(),r!==n)for(;r!==n;)t.push(r),r=Cn();else t=n;return t!==n&&(Ht=e,t=je(t)),e=t,e}(),t===n&&(t=function(){let e,t,r;if(e=Kt,t=[],r=En(),r!==n)for(;r!==n;)t.push(r),r=En();else t=n;return t!==n&&(Ht=e,t=Fe(t)),e=t,e}())),t}(),o!==n?(i=zn(),i!==n?(Ht=t,r=s(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function yn(){let e,t;for(e=[],t=hn(),t===n&&(t=dn(),t===n&&(t=pn(),t===n&&(t=fn(),t===n&&(t=un(),t===n&&(t=_n())))));t!==n;)e.push(t),t=hn(),t===n&&(t=dn(),t===n&&(t=pn(),t===n&&(t=fn(),t===n&&(t=un(),t===n&&(t=_n())))));return e}function wn(){let t,r,o,i,s,a;return t=Kt,r=kn(),r!==n?(o=On(),o!==n?(61===e.charCodeAt(Kt)?(i=P,Kt++):(i=n,0===Zt&&an(M)),i!==n?(s=On(),s!==n?(a=kn(),a!==n?(Ht=t,r=T(r,a),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function vn(){let t,r,o,i,s,a;if(t=Kt,r=On(),r!==n)if(91===e.charCodeAt(Kt)?(o=z,Kt++):(o=n,0===Zt&&an(F)),o!==n){for(i=[],s=mn(),s===n&&(s=_n());s!==n;)i.push(s),s=mn(),s===n&&(s=_n());i!==n?(s=zn(),s!==n?(93===e.charCodeAt(Kt)?(a=R,Kt++):(a=n,0===Zt&&an(L)),a!==n?(Ht=t,r=N(i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;else Kt=t,t=n;return t}function bn(){let t;return t=function(){let t,r,o,i,s,a,c;if(t=Kt,123===e.charCodeAt(Kt)?(r=f,Kt++):(r=n,0===Zt&&an(g)),r!==n)if(o=gn(),o!==n){for(i=[],s=Kt,44===e.charCodeAt(Kt)?(a=j,Kt++):(a=n,0===Zt&&an(D)),a===n&&(59===e.charCodeAt(Kt)?(a=w,Kt++):(a=n,0===Zt&&an(v))),a===n&&(a=null),a!==n?(c=gn(),c!==n?(Ht=s,a=B(o,c),s=a):(Kt=s,s=n)):(Kt=s,s=n);s!==n;)i.push(s),s=Kt,44===e.charCodeAt(Kt)?(a=j,Kt++):(a=n,0===Zt&&an(D)),a===n&&(59===e.charCodeAt(Kt)?(a=w,Kt++):(a=n,0===Zt&&an(v))),a===n&&(a=null),a!==n?(c=gn(),c!==n?(Ht=s,a=B(o,c),s=a):(Kt=s,s=n)):(Kt=s,s=n);i!==n?(44===e.charCodeAt(Kt)?(s=j,Kt++):(s=n,0===Zt&&an(D)),s===n&&(59===e.charCodeAt(Kt)?(s=w,Kt++):(s=n,0===Zt&&an(v))),s===n&&(s=null),s!==n?(a=zn(),a!==n?(125===e.charCodeAt(Kt)?(c=m,Kt++):(c=n,0===Zt&&an(_)),c!==n?(Ht=t,r=$(o,i),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;else Kt=t,t=n;return t}(),t===n&&(t=gn()),t}function xn(){let t,r,o,i,s,a,c;return t=Kt,r=On(),r!==n?(o=function(){let t,r;return t=Kt,e.substr(Kt,2)===U?(r=U,Kt+=2):(r=n,0===Zt&&an(V)),r===n&&(e.substr(Kt,2)===W?(r=W,Kt+=2):(r=n,0===Zt&&an(K))),r!==n&&(Ht=t,r=H(r)),t=r,t}(),o!==n?(i=On(),i!==n?(s=bn(),s!==n?(a=On(),a!==n?(c=xn(),c===n&&(c=null),c!==n?(Ht=t,r=G(o,s,c),t=r):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n)):(Kt=t,t=n),t}function Sn(){let t;return 110===e.charCodeAt(Kt)?(t=oe,Kt++):(t=n,0===Zt&&an(ie)),t===n&&(e.substr(Kt,2)===se?(t=se,Kt+=2):(t=n,0===Zt&&an(ae)),t===n&&(101===e.charCodeAt(Kt)?(t=ce,Kt++):(t=n,0===Zt&&an(le)),t===n&&(e.substr(Kt,2)===ue?(t=ue,Kt+=2):(t=n,0===Zt&&an(de)),t===n&&(115===e.charCodeAt(Kt)?(t=he,Kt++):(t=n,0===Zt&&an(pe)),t===n&&(e.substr(Kt,2)===fe?(t=fe,Kt+=2):(t=n,0===Zt&&an(ge)),t===n&&(119===e.charCodeAt(Kt)?(t=me,Kt++):(t=n,0===Zt&&an(_e)),t===n&&(e.substr(Kt,2)===ye?(t=ye,Kt+=2):(t=n,0===Zt&&an(we))))))))),t}function kn(){let t,r;return t=function(){let t,r,o,i;if(t=Kt,34===e.charCodeAt(Kt)?(r=be,Kt++):(r=n,0===Zt&&an(xe)),r!==n){for(o=[],i=Dn();i!==n;)o.push(i),i=Dn();o!==n?(34===e.charCodeAt(Kt)?(i=be,Kt++):(i=n,0===Zt&&an(xe)),i!==n?(Ht=t,r=st(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;return t}(),t===n&&(t=function(){let e,t;return e=Kt,t=Tn(),t!==n&&(Ht=e,t=et(t)),e=t,e}(),t===n&&(t=Kt,r=An(),r===n&&(r=function(){let e,t,r;return e=Kt,t=Mn(),t!==n?(r=An(),r!==n?(Ht=e,t=$e(t,r),e=t):(Kt=e,e=n)):(Kt=e,e=n),e}(),r===n&&(r=Mn())),r!==n&&(Ht=t,r=Ce(r)),t=r)),t}function Cn(){let t,r,o,i,a,c,l;if(t=Kt,r=On(),r!==n)if(e.substr(Kt,2)===De?(o=De,Kt+=2):(o=n,0===Zt&&an(Oe)),o!==n){for(i=[],a=Kt,c=Kt,Zt++,l=Fn(),Zt--,l===n?c=void 0:(Kt=c,c=n),c!==n?(e.length>Kt?(l=e.charAt(Kt),Kt++):(l=n,0===Zt&&an(Me)),l!==n?(Ht=a,c=s(l),a=c):(Kt=a,a=n)):(Kt=a,a=n);a!==n;)i.push(a),a=Kt,c=Kt,Zt++,l=Fn(),Zt--,l===n?c=void 0:(Kt=c,c=n),c!==n?(e.length>Kt?(l=e.charAt(Kt),Kt++):(l=n,0===Zt&&an(Me)),l!==n?(Ht=a,c=s(l),a=c):(Kt=a,a=n)):(Kt=a,a=n);i!==n?(a=Fn(),a===n&&(a=null),a!==n?(Ht=t,r=ze(i),t=r):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;else Kt=t,t=n;return t}function En(){let t,r,o,i,a,c,l;if(t=Kt,r=On(),r!==n)if(35===e.charCodeAt(Kt)?(o=Re,Kt++):(o=n,0===Zt&&an(Le)),o!==n){for(i=[],a=Kt,c=Kt,Zt++,l=Fn(),Zt--,l===n?c=void 0:(Kt=c,c=n),c!==n?(e.length>Kt?(l=e.charAt(Kt),Kt++):(l=n,0===Zt&&an(Me)),l!==n?(Ht=a,c=s(l),a=c):(Kt=a,a=n)):(Kt=a,a=n);a!==n;)i.push(a),a=Kt,c=Kt,Zt++,l=Fn(),Zt--,l===n?c=void 0:(Kt=c,c=n),c!==n?(e.length>Kt?(l=e.charAt(Kt),Kt++):(l=n,0===Zt&&an(Me)),l!==n?(Ht=a,c=s(l),a=c):(Kt=a,a=n)):(Kt=a,a=n);i!==n?(a=Fn(),a===n&&(a=null),a!==n?(Ht=t,r=ze(i),t=r):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;else Kt=t,t=n;return t}function An(){let e,t,r,o;if(Zt++,e=Kt,t=In(),t!==n){for(r=[],o=Pn();o!==n;)r.push(o),o=Pn();r!==n?(Ht=e,t=Be(t,r),e=t):(Kt=e,e=n)}else Kt=e,e=n;return Zt--,e===n&&(t=n,0===Zt&&an(Ne)),e}function In(){let t;return t=function(){let t;return t=function(){let t;return Nt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Bt)),t}(),t===n&&(t=function(){let t;return Tt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(jt)),t}(),t===n&&(t=function(){let t;return Rt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Lt)),t}(),t===n&&(t=function(){let t;return Dt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Ot)),t}(),t===n&&(t=function(){let t;return zt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Ft)),t}(),t===n&&(t=function(){let t;return $t.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Ut)),t}()))))),t}(),t===n&&(36===e.charCodeAt(Kt)?(t=Ue,Kt++):(t=n,0===Zt&&an(Ve)),t===n&&(95===e.charCodeAt(Kt)?(t=We,Kt++):(t=n,0===Zt&&an(Ke)))),t}function Pn(){let t;return t=In(),t===n&&(t=function(){let t;return Vt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Wt)),t}()),t}function Mn(){let t,r,o,i,s,a,c,l,u;if(Zt++,t=Kt,r=Kt,45===e.charCodeAt(Kt)?(o=Ge,Kt++):(o=n,0===Zt&&an(qe)),o===n&&(o=null),o!==n){if(i=Kt,46===e.charCodeAt(Kt)?(s=Ye,Kt++):(s=n,0===Zt&&an(Xe)),s!==n){if(a=[],Ze.test(e.charAt(Kt))?(c=e.charAt(Kt),Kt++):(c=n,0===Zt&&an(Qe)),c!==n)for(;c!==n;)a.push(c),Ze.test(e.charAt(Kt))?(c=e.charAt(Kt),Kt++):(c=n,0===Zt&&an(Qe));else a=n;a!==n?(s=[s,a],i=s):(Kt=i,i=n)}else Kt=i,i=n;if(i===n){if(i=Kt,s=[],Ze.test(e.charAt(Kt))?(a=e.charAt(Kt),Kt++):(a=n,0===Zt&&an(Qe)),a!==n)for(;a!==n;)s.push(a),Ze.test(e.charAt(Kt))?(a=e.charAt(Kt),Kt++):(a=n,0===Zt&&an(Qe));else s=n;if(s!==n){if(a=Kt,46===e.charCodeAt(Kt)?(c=Ye,Kt++):(c=n,0===Zt&&an(Xe)),c!==n){for(l=[],Ze.test(e.charAt(Kt))?(u=e.charAt(Kt),Kt++):(u=n,0===Zt&&an(Qe));u!==n;)l.push(u),Ze.test(e.charAt(Kt))?(u=e.charAt(Kt),Kt++):(u=n,0===Zt&&an(Qe));l!==n?(c=[c,l],a=c):(Kt=a,a=n)}else Kt=a,a=n;a===n&&(a=null),a!==n?(s=[s,a],i=s):(Kt=i,i=n)}else Kt=i,i=n}i!==n?(o=[o,i],r=o):(Kt=r,r=n)}else Kt=r,r=n;return r!==n&&(Ht=t,r=Je()),t=r,Zt--,t===n&&(r=n,0===Zt&&an(He)),t}function Tn(){let t,r,o,i;if(t=Kt,60===e.charCodeAt(Kt)?(r=tt,Kt++):(r=n,0===Zt&&an(nt)),r!==n){for(o=[],i=jn(),i===n&&(i=Tn());i!==n;)o.push(i),i=jn(),i===n&&(i=Tn());o!==n?(62===e.charCodeAt(Kt)?(i=rt,Kt++):(i=n,0===Zt&&an(ot)),i!==n?(Ht=t,r=it(o),t=r):(Kt=t,t=n)):(Kt=t,t=n)}else Kt=t,t=n;return t}function jn(){let t,r,o,i,a;if(t=Kt,r=[],o=Kt,i=Kt,Zt++,62===e.charCodeAt(Kt)?(a=rt,Kt++):(a=n,0===Zt&&an(ot)),a===n&&(60===e.charCodeAt(Kt)?(a=tt,Kt++):(a=n,0===Zt&&an(nt))),Zt--,a===n?i=void 0:(Kt=i,i=n),i!==n?(e.length>Kt?(a=e.charAt(Kt),Kt++):(a=n,0===Zt&&an(Me)),a!==n?(Ht=o,i=s(a),o=i):(Kt=o,o=n)):(Kt=o,o=n),o!==n)for(;o!==n;)r.push(o),o=Kt,i=Kt,Zt++,62===e.charCodeAt(Kt)?(a=rt,Kt++):(a=n,0===Zt&&an(ot)),a===n&&(60===e.charCodeAt(Kt)?(a=tt,Kt++):(a=n,0===Zt&&an(nt))),Zt--,a===n?i=void 0:(Kt=i,i=n),i!==n?(e.length>Kt?(a=e.charAt(Kt),Kt++):(a=n,0===Zt&&an(Me)),a!==n?(Ht=o,i=s(a),o=i):(Kt=o,o=n)):(Kt=o,o=n);else r=n;return r!==n&&(Ht=t,r=ze(r)),t=r,t}function Dn(){let t,r,o;return t=function(){let t,r,o,i;return t=Kt,r=Kt,92===e.charCodeAt(Kt)?(o=ct,Kt++):(o=n,0===Zt&&an(lt)),o!==n?(e.length>Kt?(i=e.charAt(Kt),Kt++):(i=n,0===Zt&&an(Me)),i!==n?(o=[o,i],r=o):(Kt=r,r=n)):(Kt=r,r=n),r!==n&&(Ht=t,r=ut(r)),t=r,t}(),t===n&&(t=Kt,r=Kt,Zt++,34===e.charCodeAt(Kt)?(o=be,Kt++):(o=n,0===Zt&&an(xe)),o===n&&(o=function(){let t;return ht.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(pt)),t}()),Zt--,o===n?r=void 0:(Kt=r,r=n),r!==n?(o=function(){let t;return e.length>Kt?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Me)),t}(),o!==n?(Ht=t,r=at(),t=r):(Kt=t,t=n)):(Kt=t,t=n),t===n&&(t=function(){let t,r,o;return t=Kt,92===e.charCodeAt(Kt)?(r=ct,Kt++):(r=n,0===Zt&&an(lt)),r!==n?(o=function(){let t;return Zt++,10===e.charCodeAt(Kt)?(t=gt,Kt++):(t=n,0===Zt&&an(mt)),t===n&&(e.substr(Kt,2)===_t?(t=_t,Kt+=2):(t=n,0===Zt&&an(yt)),t===n&&(13===e.charCodeAt(Kt)?(t=wt,Kt++):(t=n,0===Zt&&an(vt)),t===n&&(8232===e.charCodeAt(Kt)?(t=bt,Kt++):(t=n,0===Zt&&an(xt)),t===n&&(8233===e.charCodeAt(Kt)?(t=St,Kt++):(t=n,0===Zt&&an(kt)))))),Zt--,t===n&&0===Zt&&an(ft),t}(),o!==n?(Ht=t,r=dt(),t=r):(Kt=t,t=n)):(Kt=t,t=n),t}())),t}function On(){let e,t;for(Zt++,e=[],t=Rn();t!==n;)e.push(t),t=Rn();return Zt--,e===n&&(t=n,0===Zt&&an(Ct)),e}function zn(){let e,t;for(Zt++,e=[],t=Rn(),t===n&&(t=Fn());t!==n;)e.push(t),t=Rn(),t===n&&(t=Fn());return Zt--,e===n&&(t=n,0===Zt&&an(Et)),e}function Fn(){let t;return At.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(It)),t}function Rn(){let t;return Pt.test(e.charAt(Kt))?(t=e.charAt(Kt),Kt++):(t=n,0===Zt&&an(Mt)),t}function Ln(e){const t=e.trim(),n=t.match(/\n([\t ]+|(?!\s).)/g);if(n){const e=n.map((e=>e.match(/[\t ]/g)?.length??0)),r=new RegExp(`\n[\t ]{${Math.min(...e)}}`,"g");return t.replace(r,"\n")}return t}const Nn=[],Bn=new vE({locationFunction:Jt});if(qt=i(),qt!==n&&Kt===e.length)return qt;throw qt!==n&&Kt<e.length&&an({type:"end"}),$n=Xt,Un=Yt<e.length?e.charAt(Yt):null,Vn=Yt<e.length?sn(Yt,Yt+1):sn(Yt,Yt),new xE(xE.buildMessage($n,Un),$n,Un,Vn);var $n,Un,Vn};class kE{comment=null;set(e){this.comment=e}reset(){this.comment=null}apply(e,t){t&&this.comment?.location?"Block"===this.comment?.kind?this.comment.location.end.line===t.start.line-1&&(e.comment=this.comment.value):this.comment.location.end.line===t.start.line&&(e.comment=this.comment.value):e.comment=this.comment?.value,this.reset()}}function CE(e){return e.targets.map((e=>{switch(e.type){case"NodeRef":return{id:e.id.value,port:e.port?.value,compass:e.compass?.value};case"NodeRefGroup":return e.children.map((e=>({id:e.id.value,port:e.port?.value,compass:e.compass?.value})))}}))}function EE(e,t){const n=new kE;for(const r of t)switch(r.type){case"Subgraph":const t=r.id?e.subgraph(r.id.value):e.subgraph();EE(t,r.children),n.apply(t,r.location);break;case"Attribute":e.set(r.key.value,r.value.value),n.reset();break;case"Node":n.apply(e.node(r.id.value,r.children.filter((e=>"Attribute"===e.type)).reduce(((e,t)=>({...e,[t.key.value]:t.value.value})),{})),r.location);break;case"Edge":n.apply(e.edge(CE(r),r.children.filter((e=>"Attribute"===e.type)).reduce(((e,t)=>({...e,[t.key.value]:t.value.value})),{})),r.location);break;case"AttributeList":const o=r.children.filter((e=>"Attribute"===e.type)).reduce(((e,t)=>({...e,[t.key.value]:t.value.value})),{});switch(r.kind){case"Edge":e.edge(o);break;case"Node":e.node(o);break;case"Graph":e.graph(o)}n.reset();break;case"Comment":n.set(r)}}const AE=[{match:e=>"Node"===e.type,convert:(e,t)=>new e.models.Node(t.id.value,t.children.filter((e=>"Attribute"===e.type)).reduce(((e,t)=>({...e,[t.key.value]:t.value.value})),{}))},{match:e=>"Edge"===e.type,convert:(e,t)=>new e.models.Edge(CE(t),t.children.filter((e=>"Attribute"===e.type)).reduce(((e,t)=>({...e,[t.key.value]:t.value.value})),{}))},{match:e=>"Subgraph"===e.type,convert(e,t){const n=new e.models.Subgraph(t.id?.value);return EE(n,t.children),n}},{match:e=>"Graph"===e.type,convert(e,t){const n=new(t.directed?e.models.Digraph:e.models.Graph)(t.id?.value,t.strict);return EE(n,t.children),n}},{match:e=>"Dot"===e.type,convert(e,t){const n=new kE;for(const r of t.children)switch(r.type){case"Comment":n.set(r);break;case"Graph":const t=e.convert(r);return n.apply(t,r.location),t}throw Error()}}];class IE{options;plugins=[...AE];constructor(e={}){this.options=e}convert(e){const t=[...this.plugins],n={models:_E(this.options.models??{}),convert(e){for(const r of t)if(r.match(e))return r.convert(n,e);throw Error()}};return n.convert(e)}}new Proxy(Object.freeze({}),{get:(e,t)=>t});class PE{}class ME extends PE{#e=new Map;constructor(e){super(),void 0!==e&&this.apply(e)}get values(){return Array.from(this.#e.entries())}get size(){return this.#e.size}get(e){return this.#e.get(e)}set(e,t){null!=t&&this.#e.set(e,t)}delete(e){this.#e.delete(e)}apply(e){const t=Array.isArray(e)?e:Object.entries(e);for(const[e,n]of t)this.set(e,n)}clear(){this.#e.clear()}}class TE extends ME{$$kind;get $$type(){return"AttributeList"}comment;constructor(e,t){super(t),this.$$kind=e}}class jE extends ME{#t=mE;id;comment;attributes=Object.freeze({graph:new TE("Graph"),edge:new TE("Edge"),node:new TE("Node")});get nodes(){return Array.from(this.#n.nodes.values())}get edges(){return Array.from(this.#n.edges.values())}get subgraphs(){return Array.from(this.#n.subgraphs.values())}#n={nodes:new Map,edges:new Set,subgraphs:new Set};with(e){this.#t=_E(e)}addNode(e){this.#n.nodes.set(e.id,e)}addEdge(e){this.#n.edges.add(e)}addSubgraph(e){this.#n.subgraphs.add(e)}existNode(e){return this.#n.nodes.has(e)}existEdge(e){return this.#n.edges.has(e)}existSubgraph(e){return this.#n.subgraphs.has(e)}createSubgraph(...e){const t=new this.#t.Subgraph(...e);return t.with(this.#t),this.addSubgraph(t),t}removeNode(e){this.#n.nodes.delete("string"==typeof e?e:e.id)}removeEdge(e){this.#n.edges.delete(e)}removeSubgraph(e){this.#n.subgraphs.delete(e)}createNode(e,t){const n=new this.#t.Node(e,t);return this.addNode(n),n}getSubgraph(e){return Array.from(this.#n.subgraphs.values()).find((t=>t.id===e))}getNode(e){return this.#n.nodes.get(e)}createEdge(e,t){const n=e.map((e=>{return t=e,Array.isArray(t)&&t.every(fE)?function(e){if(e.length<2&&!1===(fE(e[0])&&fE(e[1])))throw Error("EdgeTargets must have at least 2 elements.");return e.map((e=>gE(e)))}(e):gE(e);var t})),r=new this.#t.Edge(n,t);return this.addEdge(r),r}subgraph(...e){const t=e.find((e=>"string"==typeof e)),n=e.find((e=>"object"==typeof e&&null!==e)),r=e.find((e=>"function"==typeof e)),o=t?this.getSubgraph(t)??this.createSubgraph(t):this.createSubgraph();return void 0!==n&&o.apply(n),void 0!==r&&r(o),o}node(e,...t){if("string"==typeof e){const n=e,r=t.find((e=>"object"==typeof e&&null!==e)),o=t.find((e=>"function"==typeof e)),i=this.getNode(n)??this.createNode(n);return void 0!==r&&i.attributes.apply(r),void 0!==o&&o(i),i}"object"==typeof e&&null!==e&&this.attributes.node.apply(e)}edge(e,...t){if(Array.isArray(e)){const n=e,r=t.find((e=>"object"==typeof e)),o=t.find((e=>"function"==typeof e)),i=this.createEdge(n,r);return void 0!==o&&o(i),i}"object"==typeof e&&null!==e&&this.attributes.edge.apply(e)}graph(e){this.attributes.graph.apply(e)}}class DE extends jE{get $$type(){return"Graph"}id;strict;constructor(...e){super(),this.id=e.find((e=>"string"==typeof e)),this.strict=e.find((e=>"boolean"==typeof e))??!1;const t=e.find((e=>"object"==typeof e&&null!==e));void 0!==t&&this.apply(t)}}class OE extends ME{comment}function zE(e,t){return(...n)=>{const r=e?this.Digraph:this.Graph,o=n.find((e=>"string"==typeof e)),i=n.find((e=>"object"==typeof e)),s=n.find((e=>"function"==typeof e)),a=new r(o,t,i);return a.with(this),"function"==typeof s&&s(a),a}}function FE(e,t=mE){return Object.freeze({digraph:zE.call(t,!0,e),graph:zE.call(t,!1,e)})}Object.assign(mE,{Graph:class extends DE{get directed(){return!1}},Digraph:class extends DE{get directed(){return!0}},Subgraph:class extends jE{get $$type(){return"Subgraph"}id;constructor(...e){super(),this.id=e.find((e=>"string"==typeof e));const t=e.find((e=>"object"==typeof e&&null!==e));void 0!==t&&this.apply(t)}isSubgraphCluster(){return"string"==typeof this.id&&this.id.startsWith("cluster")}},Node:class extends PE{id;get $$type(){return"Node"}comment;attributes;constructor(e,t){super(),this.id=e,this.attributes=new OE(t)}port(e){return"string"==typeof e?{id:this.id,port:e}:{id:this.id,...e}}},Edge:class extends PE{targets;get $$type(){return"Edge"}comment;attributes;constructor(e,t){if(super(),this.targets=e,e.length<2&&!1===(fE(e[0])&&fE(e[1])))throw Error("The element of Edge target is missing or not satisfied as Edge target.");this.attributes=new OE(t)}}});const RE=FE(!1);RE.digraph,RE.graph,FE(!0);const LE=[aE],NE=()=>{const[t,n]=(0,e.useState)(null),r=(0,e.useCallback)((e=>{n(e)}),[]),o=e=>{let t="";e.startsWith("module.")&&(t=e.split(".")[1],e=e.split(".").slice(2).join("."));const n=!e&&t,r=e.startsWith("data."),o=e.startsWith("var."),i=e.startsWith("local."),s=e.startsWith("output."),a=e.startsWith("provider["),c=e.startsWith("aws_");r||o||i||s||a||c||n||console.warn("Unknown block type",e);const l=e.split("."),u=c&&l.length>1;return c||n||(e=l.slice(1).join(".")),{processedBlockId:e,isData:r,isVariable:o,isResource:c,isLocal:i,isOutput:s,isProvider:a,isModule:n,isResourceWithName:u,moduleName:t}},i=e=>{const t=e.split(".")&&e.split(".").filter((e=>e.startsWith("aws_"))).length>0?e.split(".").filter((e=>e.startsWith("aws_")))[0]:void 0,n=t&&e.split(".").filter(((n,r)=>r>0&&e.split(".")[r-1]===t))[0].split(" ")[0];return{resourceType:t,resourceName:n}},s=(e,t,n,r,a,c)=>{r.edges.filter((t=>t.targets[a?0:1].id===e.id)).forEach(((e,l)=>{console.log("edge",l,e);let u=e.targets[a?1:0].id.split(" ")[1];if(u){const{isResourceWithName:l,processedBlockId:d,isData:h}=o(u);if(l||h){const{resourceType:o,resourceName:l}=i(d),u=Array.from(n.values()).some((t=>t.nodes.some((t=>t.id===e.targets[a?1:0].id))));if(o&&l&&c&&!u&&c.data.some((e=>e["Main Diagram Blocks"].split(",").some((e=>e===t.type))&&(e["Missing Resources"].split(",").some((e=>e===o))||e["Data Sources"].split(",").some((e=>e===o)))))){const o=r.nodes.filter((t=>t.id===e.targets[a?1:0].id))[0];o&&(t.nodes.push(o),console.log("GOING DEEPER 1"),s(o,t,n,r,a,c),console.log("GOING DEEPER 2"),s(o,t,n,r,!a,c))}}}}))},a=(0,e.useRef)(null);return(0,Fr.jsx)("div",{style:{position:"fixed",inset:0},children:(0,Fr.jsxs)("div",{style:{height:"100%",transitionProperty:"all",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"150ms"},children:[(0,Fr.jsx)(oE,{shapeUtils:LE,onMount:r}),(0,Fr.jsx)("textarea",{ref:a,id:"inkdrop-graphviz-textarea"}),(0,Fr.jsx)("button",{onClick:()=>{console.log("clicked btn"),a.current&&a.current.value&&(console.log("graphvizText",a.current.value),(e=>{const n=new Map,r=hE().parse('Service Name,Main Diagram Blocks,Missing Resources,Data Sources,Category,Icon Path\nACM,aws_acm_certificate,,,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Certificate-Manager_48.png\nACM PCA,aws_acmpca_certificate_authority,"aws_acmpca_certificate,aws_acmpca_certificate_authority_certificate,aws_acmpca_permission,aws_acmpca_policy","aws_acmpca_certificate,aws_acmpca_certificate_authority",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Private-Certificate-Authority_48.png\nAMP,aws_prometheus_workspace,"aws_prometheus_alert_manager_definition,aws_prometheus_rule_group_namespace","aws_prometheus_workspace,aws_prometheus_workspaces",Management Governance,Icons/Arch_Management-Governance/48/Arch_Amazon-Managed-Service-for-Prometheus_48.png\nAPI Gateway,"aws_api_gateway_rest_api,aws_api_gateway_stage,aws_api_gateway_resource,aws_api_gateway_method","aws_api_gateway_account,aws_api_gateway_api_key,aws_api_gateway_authorizer,aws_api_gateway_base_path_mapping,aws_api_gateway_client_certificate,aws_api_gateway_deployment,aws_api_gateway_documentation_part,aws_api_gateway_documentation_version,aws_api_gateway_domain_name,aws_api_gateway_gateway_response,aws_api_gateway_integration,aws_api_gateway_integration_response,aws_api_gateway_method_response,aws_api_gateway_method_settings,aws_api_gateway_model,aws_api_gateway_request_validator,aws_api_gateway_rest_api_policy,aws_api_gateway_usage_plan,aws_api_gateway_usage_plan_key,aws_api_gateway_vpc_link","aws_api_gateway_api_key,aws_api_gateway_authorizer,aws_api_gateway_authorizers,aws_api_gateway_domain_name,aws_api_gateway_export,aws_api_gateway_resource,aws_api_gateway_rest_api,aws_api_gateway_sdk,aws_api_gateway_vpc_link",App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-API-Gateway_48.png\nAPI Gateway V2,"aws_apigatewayv2_api,aws_apigatewayv2_stage","aws_apigatewayv2_api_mapping,aws_apigatewayv2_authorizer,aws_apigatewayv2_deployment,aws_apigatewayv2_domain_name,aws_apigatewayv2_integration,aws_apigatewayv2_integration_response,aws_apigatewayv2_model,aws_apigatewayv2_route,aws_apigatewayv2_route_response,aws_apigatewayv2_vpc_link","aws_apigatewayv2_api,aws_apigatewayv2_apis,aws_apigatewayv2_export,aws_apigatewayv2_vpc_link",App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-API-Gateway_48.png\nApp Mesh,"aws_appmesh_mesh,aws_appmesh_gateway_route,aws_appmesh_virtual_gateway,aws_appmesh_virtual_service,aws_appmesh_virtual_node,aws_appmesh_virtual_router",aws_appmesh_route,"aws_appmesh_gateway_route,aws_appmesh_mesh,aws_appmesh_route,aws_appmesh_virtual_gateway,aws_appmesh_virtual_node,aws_appmesh_virtual_router,aws_appmesh_virtual_service",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_AWS-App-Mesh_48.png\nApp Runner,aws_apprunner_service,"aws_apprunner_auto_scaling_configuration_version,aws_apprunner_connection,aws_apprunner_custom_domain_association,aws_apprunner_default_auto_scaling_configuration_version,aws_apprunner_observability_configuration,aws_apprunner_vpc_connector,aws_apprunner_vpc_ingress_connection",,Compute,Icons/Arch_Compute/48/Arch_AWS-App-Runner_48.png\nAppConfig,,"aws_appconfig_application,aws_appconfig_configuration_profile,aws_appconfig_deployment,aws_appconfig_deployment_strategy,aws_appconfig_environment,aws_appconfig_extension,aws_appconfig_extension_association,aws_appconfig_hosted_configuration_version","aws_appconfig_configuration_profile,aws_appconfig_configuration_profiles,aws_appconfig_environment,aws_appconfig_environments",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-AppConfig_48.png\nAppFlow,aws_appflow_flow,aws_appflow_connector_profile,,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-AppFlow_48.png\nAppIntegrations,aws_appintegrations_event_integration,aws_appintegrations_data_integration,aws_appintegrations_event_integration,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-AppFlow_48.png\nAppStream 2.0,"aws_appstream_fleet,aws_appstream_stack","aws_appstream_directory_config,aws_appstream_fleet_stack_association,aws_appstream_image_builder,aws_appstream_user,aws_appstream_user_stack_association",,End User Computing,Icons/Arch_End-User-Computing/48/Arch_Amazon-AppStream_48.png\nAppSync,aws_appsync_graphql_api,"aws_appsync_api_cache,aws_appsync_api_key,aws_appsync_datasource,aws_appsync_domain_name,aws_appsync_domain_name_api_association,aws_appsync_function,aws_appsync_resolver,aws_appsync_type",,App Integration,Icons/Arch_App-Integration/48/Arch_AWS-AppSync_48.png\nApplication Auto Scaling,aws_appautoscaling_target,"aws_appautoscaling_policy,aws_appautoscaling_scheduled_action",,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Application-Auto-Scaling_48.png\nAthena,,"aws_athena_data_catalog,aws_athena_database,aws_athena_named_query,aws_athena_prepared_statement,aws_athena_workgroup",aws_athena_named_query,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Athena_48.png\nAudit Manager,,"aws_auditmanager_account_registration,aws_auditmanager_assessment,aws_auditmanager_assessment_delegation,aws_auditmanager_assessment_report,aws_auditmanager_control,aws_auditmanager_framework,aws_auditmanager_framework_share,aws_auditmanager_organization_admin_account_registration","aws_auditmanager_control,aws_auditmanager_framework",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Audit-Manager_48.png\nAuto Scaling,aws_autoscaling_group,"aws_autoscaling_attachment,aws_autoscaling_group_tag,aws_autoscaling_lifecycle_hook,aws_autoscaling_notification,aws_autoscaling_policy,aws_autoscaling_schedule,aws_autoscaling_traffic_source_attachment,aws_launch_configuration","aws_autoscaling_group,aws_autoscaling_groups,aws_launch_configuration",Compute,Icons/Arch_Compute/48/Arch_Amazon-EC2-Auto-Scaling_48.png\nAuto Scaling Plans,aws_autoscalingplans_scaling_plan,,,Compute,Icons/Arch_Compute/48/Arch_AWS-Auto-Scaling_48.png\nBackup,aws_backup_vault,"aws_backup_framework,aws_backup_global_settings,aws_backup_plan,aws_backup_region_settings,aws_backup_report_plan,aws_backup_selection,aws_backup_vault_lock_configuration,aws_backup_vault_notifications,aws_backup_vault_policy","aws_backup_framework,aws_backup_plan,aws_backup_report_plan,aws_backup_selection,aws_backup_vault",Storage,Icons/Arch_Storage/48/Arch_AWS-Backup_48.png\nBatch,"aws_batch_job_queue,aws_batch_compute_environment","aws_batch_job_definition,aws_batch_scheduling_policy","aws_batch_compute_environment,aws_batch_job_queue,aws_batch_scheduling_policy",Compute,Icons/Arch_Compute/48/Arch_AWS-Batch_48.png\nCE,,"aws_ce_anomaly_monitor,aws_ce_anomaly_subscription,aws_ce_cost_allocation_tag,aws_ce_cost_category","aws_ce_cost_category,aws_ce_tags",Cloud Financial Management,Icons/Arch_Cloud-Financial-Management/48/Arch_AWS-Cost-Explorer_48.png\nChime,aws_chime_voice_connector,"aws_chime_voice_connector_group,aws_chime_voice_connector_logging,aws_chime_voice_connector_origination,aws_chime_voice_connector_streaming,aws_chime_voice_connector_termination,aws_chime_voice_connector_termination_credentials",,Business Applications,Icons/Arch_Business-Applications/48/Arch_Amazon-Chime_48.png\nChime SDK Media Pipelines,,aws_chimesdkmediapipelines_media_insights_pipeline_configuration,,Business Applications,Icons/Arch_Business-Applications/48/Arch_Amazon-Chime-SDK_48.png\nChime SDK Voice,,"aws_chimesdkvoice_global_settings,aws_chimesdkvoice_sip_media_application,aws_chimesdkvoice_sip_rule,aws_chimesdkvoice_voice_profile_domain",,Business Applications,Icons/Arch_Business-Applications/48/Arch_Amazon-Chime-SDK_48.png\nClean Rooms,,"aws_cleanrooms_collaboration,aws_cleanrooms_configured_table",,Analytics,Icons/Arch_Analytics/48/Arch_AWS-Clean-Rooms_48.png\nCloud Control API,,aws_cloudcontrolapi_resource,aws_cloudcontrolapi_resource,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-Cloud-Control-API_48.png\nCloud Map,aws_service_discovery_service,"aws_service_discovery_http_namespace,aws_service_discovery_instance,aws_service_discovery_private_dns_namespace,aws_service_discovery_public_dns_namespace","aws_service_discovery_dns_namespace,aws_service_discovery_http_namespace,aws_service_discovery_service",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_AWS-Cloud-Map_48.png\nCloud9,aws_cloud9_environment_ec2,aws_cloud9_environment_membership,,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-Cloud9_48.png\nCloudFront,aws_cloudfront_distribution,"aws_cloudfront_cache_policy,aws_cloudfront_continuous_deployment_policy,aws_cloudfront_field_level_encryption_config,aws_cloudfront_field_level_encryption_profile,aws_cloudfront_function,aws_cloudfront_key_group,aws_cloudfront_monitoring_subscription,aws_cloudfront_origin_access_control,aws_cloudfront_origin_access_identity,aws_cloudfront_origin_request_policy,aws_cloudfront_public_key,aws_cloudfront_realtime_log_config,aws_cloudfront_response_headers_policy","aws_cloudfront_cache_policy,aws_cloudfront_distribution,aws_cloudfront_function,aws_cloudfront_log_delivery_canonical_user_id,aws_cloudfront_origin_access_identities,aws_cloudfront_origin_access_identity,aws_cloudfront_origin_request_policy,aws_cloudfront_realtime_log_config,aws_cloudfront_response_headers_policy",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-CloudFront_48.png\nCloudHSM,aws_cloudhsm_v2_cluster,aws_cloudhsm_v2_hsm,aws_cloudhsm_v2_cluster,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-CloudHSM_48.png\nCloudSearch,aws_cloudsearch_domain,aws_cloudsearch_domain_service_access_policy,,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-CloudSearch_48.png\nCloudTrail,aws_cloudtrail,aws_cloudtrail_event_data_store,aws_cloudtrail_service_account,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-CloudTrail_48.png\nCloudWatch,"aws_cloudwatch_dashboard,aws_cloudwatch_metric_alarm","aws_cloudwatch_composite_alarm,aws_cloudwatch_metric_stream",,Management Governance,Icons/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.png\nCloudWatch Logs,aws_cloudwatch_log_group,"aws_cloudwatch_log_data_protection_policy,aws_cloudwatch_log_destination,aws_cloudwatch_log_destination_policy,aws_cloudwatch_log_metric_filter,aws_cloudwatch_log_resource_policy,aws_cloudwatch_log_stream,aws_cloudwatch_log_subscription_filter,aws_cloudwatch_query_definition","aws_cloudwatch_log_data_protection_policy_document,aws_cloudwatch_log_group,aws_cloudwatch_log_groups",Management Governance,Icons/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.png\nCodeArtifact,aws_codeartifact_repository,"aws_codeartifact_domain,aws_codeartifact_domain_permissions_policy,aws_codeartifact_repository_permissions_policy","aws_codeartifact_authorization_token,aws_codeartifact_repository_endpoint",Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-CodeArtifact_48.png\nCodeBuild,aws_codebuild_project,"aws_codebuild_report_group,aws_codebuild_resource_policy,aws_codebuild_source_credential,aws_codebuild_webhook",,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-CodeBuild_48.png\nCodeDeploy,aws_codedeploy_deployment_group,"aws_codedeploy_app,aws_codedeploy_deployment_config",,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-CodeDeploy_48.png\nCodeGuru Profiler,aws_codeguruprofiler_profiling_group,,aws_codeguruprofiler_profiling_group,Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-CodeGuru_48.png\nCodeGuru Reviewer,aws_codegurureviewer_repository_association,,,Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-CodeGuru_48.png\nCodePipeline,aws_codepipeline,"aws_codepipeline_custom_action_type,aws_codepipeline_webhook",,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-CodePipeline_48.png\nCodeStar Connections,aws_codestarconnections_connection,aws_codestarconnections_host,aws_codestarconnections_connection,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-CodeStar_48.png\nCodeStar Notifications,aws_codestarnotifications_notification_rule,,,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-CodeStar_48.png\nCognito IDP,aws_cognito_user_pool,"aws_cognito_identity_provider,aws_cognito_managed_user_pool_client,aws_cognito_resource_server,aws_cognito_risk_configuration,aws_cognito_user,aws_cognito_user_group,aws_cognito_user_in_group,aws_cognito_user_pool_client,aws_cognito_user_pool_domain,aws_cognito_user_pool_ui_customization","aws_cognito_user_pool_client,aws_cognito_user_pool_clients,aws_cognito_user_pool_signing_certificate,aws_cognito_user_pools",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-Cognito_48.png\nCognito Identity,aws_cognito_identity_pool,"aws_cognito_identity_pool_provider_principal_tag,aws_cognito_identity_pool_roles_attachment",aws_cognito_identity_pool,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-Cognito_48.png\nComprehend,,"aws_comprehend_document_classifier,aws_comprehend_entity_recognizer",,Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-Comprehend_48.png\nConfig,"aws_config_config_rule,aws_config_configuration_recorder","aws_config_aggregate_authorization,aws_config_configuration_aggregator,aws_config_configuration_recorder_status,aws_config_conformance_pack,aws_config_delivery_channel,aws_config_organization_conformance_pack,aws_config_organization_custom_policy_rule,aws_config_organization_custom_rule,aws_config_organization_managed_rule,aws_config_remediation_configuration",,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Config_48.png\nConnect,aws_connect_instance,"aws_connect_bot_association,aws_connect_contact_flow,aws_connect_contact_flow_module,aws_connect_hours_of_operation,aws_connect_instance_storage_config,aws_connect_lambda_function_association,aws_connect_phone_number,aws_connect_queue,aws_connect_quick_connect,aws_connect_routing_profile,aws_connect_security_profile,aws_connect_user,aws_connect_user_hierarchy_group,aws_connect_user_hierarchy_structure,aws_connect_vocabulary","aws_connect_bot_association,aws_connect_contact_flow,aws_connect_contact_flow_module,aws_connect_hours_of_operation,aws_connect_instance,aws_connect_instance_storage_config,aws_connect_lambda_function_association,aws_connect_prompt,aws_connect_queue,aws_connect_quick_connect,aws_connect_routing_profile,aws_connect_security_profile,aws_connect_user,aws_connect_user_hierarchy_group,aws_connect_user_hierarchy_structure,aws_connect_vocabulary",Business Applications,Icons/Arch_Business-Applications/48/Arch_Amazon-Connect_48.png\nConnect Customer Profiles,aws_customerprofiles_domain,aws_customerprofiles_profile,,Business Applications,Icons/Arch_Business-Applications/48/Arch_Amazon-Connect_48.png\nControl Tower,,aws_controltower_control,aws_controltower_controls,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Control-Tower_48.png\nCost and Usage Report,,aws_cur_report_definition,aws_cur_report_definition,Cloud Financial Management,Icons/Arch_Cloud-Financial-Management/48/Arch_AWS-Cost-and-Usage-Report_48.png\nDLM,aws_dlm_lifecycle_policy,,,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-DLM_48.png\nDMS,"aws_dms_replication_instance,aws_dms_endpoint","aws_dms_certificate,aws_dms_event_subscription,aws_dms_replication_config,aws_dms_replication_subnet_group,aws_dms_replication_task,aws_dms_s3_endpoint","aws_dms_certificate,aws_dms_endpoint,aws_dms_replication_instance,aws_dms_replication_subnet_group,aws_dms_replication_task",Database,Icons/Arch_Database/48/Arch_AWS-Database-Migration-Service_48.png\nData Exchange,aws_dataexchange_data_set,aws_dataexchange_revision,,Analytics,Icons/Arch_Analytics/48/Arch_AWS-Data-Exchange_48.png\nData Pipeline,,"aws_datapipeline_pipeline,aws_datapipeline_pipeline_definition","aws_datapipeline_pipeline,aws_datapipeline_pipeline_definition",Analytics,Icons/Arch_Analytics/48/Arch_AWS-Data-Pipeline_48.png\nDataSync,aws_datasync_task,"aws_datasync_agent,aws_datasync_location_azure_blob,aws_datasync_location_efs,aws_datasync_location_fsx_lustre_file_system,aws_datasync_location_fsx_ontap_file_system,aws_datasync_location_fsx_openzfs_file_system,aws_datasync_location_fsx_windows_file_system,aws_datasync_location_hdfs,aws_datasync_location_nfs,aws_datasync_location_object_storage,aws_datasync_location_s3,aws_datasync_location_smb",,Migration Transfer,Icons/Arch_Migration-Transfer/48/Arch_AWS-DataSync_48.png\nDetective,aws_detective_graph,"aws_detective_invitation_accepter,aws_detective_member,aws_detective_organization_admin_account,aws_detective_organization_configuration",,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-Detective_48.png\nDevice Farm,aws_devicefarm_project,"aws_devicefarm_device_pool,aws_devicefarm_instance_profile,aws_devicefarm_network_profile,aws_devicefarm_test_grid_project,aws_devicefarm_upload",,Front End Web Mobile,Icons/Arch_Front-End-Web-Mobile/48/Arch_AWS-Device-Farm_48.png\nDirect Connect,"aws_dx_connection,aws_dx_gateway","aws_dx_bgp_peer,aws_dx_connection_association,aws_dx_connection_confirmation,aws_dx_gateway_association,aws_dx_gateway_association_proposal,aws_dx_hosted_connection,aws_dx_hosted_private_virtual_interface,aws_dx_hosted_private_virtual_interface_accepter,aws_dx_hosted_public_virtual_interface,aws_dx_hosted_public_virtual_interface_accepter,aws_dx_hosted_transit_virtual_interface,aws_dx_hosted_transit_virtual_interface_accepter,aws_dx_lag,aws_dx_macsec_key_association,aws_dx_private_virtual_interface,aws_dx_public_virtual_interface,aws_dx_transit_virtual_interface","aws_dx_connection,aws_dx_gateway,aws_dx_location,aws_dx_locations,aws_dx_router_configuration",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_AWS-Direct-Connect_48.png\nDirectory Service,aws_directory_service_directory,"aws_directory_service_conditional_forwarder,aws_directory_service_log_subscription,aws_directory_service_radius_settings,aws_directory_service_region,aws_directory_service_shared_directory,aws_directory_service_shared_directory_accepter,aws_directory_service_trust",aws_directory_service_directory,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Directory-Service_48.png\nDocumentDB,"aws_docdb_cluster,aws_docdb_cluster_instance","aws_docdb_cluster_parameter_group,aws_docdb_cluster_snapshot,aws_docdb_event_subscription,aws_docdb_global_cluster,aws_docdb_subnet_group","aws_docdb_engine_version,aws_docdb_orderable_db_instance",Database,Icons/Arch_Database/48/Arch_Amazon-DocumentDB_48.png\nDocumentDB Elastic,aws_docdbelastic_cluster,,,Database,Icons/Arch_Database/48/Arch_Amazon-DocumentDB_48.png \nDynamoDB,aws_dynamodb_table,"aws_dynamodb_contributor_insights,aws_dynamodb_global_table,aws_dynamodb_kinesis_streaming_destination,aws_dynamodb_table_item,aws_dynamodb_table_replica,aws_dynamodb_tag","aws_dynamodb_table,aws_dynamodb_table_item",Database,Icons/Arch_Database/48/Arch_Amazon-DynamoDB_48.png\nDynamoDB Accelerator,aws_dax_cluster,"aws_dax_parameter_group,aws_dax_subnet_group",,Database,Icons/Arch_Database/48/Arch_Amazon-DynamoDB_48.png \nEBS,"aws_ebs_snapshot,aws_ebs_volume","aws_ebs_default_kms_key,aws_ebs_encryption_by_default,aws_ebs_snapshot_copy,aws_ebs_snapshot_import,aws_snapshot_create_volume_permission,aws_volume_attachment","aws_ebs_default_kms_key,aws_ebs_encryption_by_default,aws_ebs_snapshot,aws_ebs_snapshot_ids,aws_ebs_volume,aws_ebs_volumes",Storage,Icons/Arch_Storage/48/Arch_Amazon-Elastic-Block-Store_48.png\nEC2,"aws_instance,aws_security_group,aws_subnet,aws_vpc","aws_ami,aws_ami_copy,aws_ami_from_instance,aws_ami_launch_permission,aws_ec2_availability_zone_group,aws_ec2_capacity_reservation,aws_ec2_fleet,aws_ec2_host,aws_ec2_image_block_public_access,aws_ec2_instance_connect_endpoint,aws_ec2_instance_state,aws_ec2_serial_console_access,aws_ec2_tag,aws_eip,aws_eip_association,aws_key_pair,aws_launch_template,aws_placement_group,aws_spot_datafeed_subscription,aws_spot_fleet_request,aws_spot_instance_request","aws_ami,aws_ami_ids,aws_availability_zone,aws_availability_zones,aws_ec2_host,aws_ec2_instance_type,aws_ec2_instance_type_offering,aws_ec2_instance_type_offerings,aws_ec2_instance_types,aws_ec2_public_ipv4_pool,aws_ec2_public_ipv4_pools,aws_ec2_serial_console_access,aws_ec2_spot_price,aws_eip,aws_eips,aws_instance,aws_instances,aws_key_pair,aws_launch_template",Compute,Icons/Arch_Compute/48/Arch_Amazon-EC2_48.png\nEC2 Image Builder,aws_imagebuilder_image_pipeline,"aws_imagebuilder_component,aws_imagebuilder_container_recipe,aws_imagebuilder_distribution_configuration,aws_imagebuilder_image,aws_imagebuilder_image_recipe,aws_imagebuilder_infrastructure_configuration","aws_imagebuilder_component,aws_imagebuilder_components,aws_imagebuilder_container_recipe,aws_imagebuilder_container_recipes,aws_imagebuilder_distribution_configuration,aws_imagebuilder_distribution_configurations,aws_imagebuilder_image,aws_imagebuilder_image_pipeline,aws_imagebuilder_image_pipelines,aws_imagebuilder_image_recipe,aws_imagebuilder_image_recipes,aws_imagebuilder_infrastructure_configuration,aws_imagebuilder_infrastructure_configurations",Compute,Icons/Arch_Compute/48/Arch_Amazon-EC2-Image-Builder_48.png\nECR,aws_ecr_repository,"aws_ecr_lifecycle_policy,aws_ecr_pull_through_cache_rule,aws_ecr_registry_policy,aws_ecr_registry_scanning_configuration,aws_ecr_replication_configuration,aws_ecr_repository_policy","aws_ecr_authorization_token,aws_ecr_image,aws_ecr_pull_through_cache_rule,aws_ecr_repositories,aws_ecr_repository",Containers,Icons/Arch_Containers/48/Arch_Amazon-Elastic-Container-Registry_48.png\nECR Public,aws_ecrpublic_repository,aws_ecrpublic_repository_policy,aws_ecrpublic_authorization_token,Containers,Icons/Arch_Containers/48/Arch_Amazon-Elastic-Container-Registry_48.png \nECS,"aws_ecs_service,aws_ecs_cluster","aws_ecs_account_setting_default,aws_ecs_capacity_provider,aws_ecs_cluster_capacity_providers,aws_ecs_tag,aws_ecs_task_definition,aws_ecs_task_set","aws_ecs_cluster,aws_ecs_container_definition,aws_ecs_service,aws_ecs_task_definition,aws_ecs_task_execution",Containers,Icons/Arch_Containers/48/Arch_Amazon-Elastic-Container-Service_48.png\nEFS,"aws_efs_file_system,aws_efs_mount_target","aws_efs_access_point,aws_efs_backup_policy,aws_efs_file_system_policy,aws_efs_replication_configuration","aws_efs_access_point,aws_efs_access_points,aws_efs_file_system,aws_efs_mount_target",Storage,Icons/Arch_Storage/48/Arch_Amazon-EFS_48.png\nEKS,aws_eks_cluster,"aws_eks_addon,aws_eks_fargate_profile,aws_eks_identity_provider_config,aws_eks_node_group,aws_eks_pod_identity_association","aws_eks_addon,aws_eks_addon_version,aws_eks_cluster,aws_eks_cluster_auth,aws_eks_clusters,aws_eks_node_group,aws_eks_node_groups",Containers,Icons/Arch_Containers/48/Arch_Amazon-Elastic-Kubernetes-Service_48.png\nELB Classic,aws_elb,"aws_app_cookie_stickiness_policy,aws_elb_attachment,aws_lb_cookie_stickiness_policy,aws_lb_ssl_negotiation_policy,aws_load_balancer_backend_server_policy,aws_load_balancer_listener_policy,aws_load_balancer_policy,aws_proxy_protocol_policy","aws_elb,aws_elb_hosted_zone_id,aws_elb_service_account",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Elastic-Load-Balancing_48.png\nELB,aws_lb,"aws_lb_listener,aws_lb_listener_certificate,aws_lb_listener_rule,aws_lb_target_group,aws_lb_target_group_attachment,aws_lb_trust_store,aws_lb_trust_store_revocation","aws_lb,aws_lb_hosted_zone_id,aws_lb_listener,aws_lb_target_group,aws_lb_trust_store,aws_lbs",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Elastic-Load-Balancing_48.png \nEMR,aws_emr_cluster,"aws_emr_block_public_access_configuration,aws_emr_instance_fleet,aws_emr_instance_group,aws_emr_managed_scaling_policy,aws_emr_security_configuration,aws_emr_studio,aws_emr_studio_session_mapping","aws_emr_release_labels,aws_emr_supported_instance_types",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-EMR_48.png\nEMR Containers,aws_emrcontainers_virtual_cluster,aws_emrcontainers_job_template,aws_emrcontainers_virtual_cluster,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-EMR_48.png \nEMR Serverless,aws_emrserverless_application,,,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-EMR_48.png \nElastiCache,"aws_elasticache_cluster,aws_elasticache_replication_group","aws_elasticache_global_replication_group,aws_elasticache_parameter_group,aws_elasticache_subnet_group,aws_elasticache_user,aws_elasticache_user_group,aws_elasticache_user_group_association","aws_elasticache_cluster,aws_elasticache_replication_group,aws_elasticache_subnet_group,aws_elasticache_user",Database,Icons/Arch_Database/48/Arch_Amazon-ElastiCache_48.png\nElastic Beanstalk,aws_elastic_beanstalk_environment,"aws_elastic_beanstalk_application,aws_elastic_beanstalk_application_version,aws_elastic_beanstalk_configuration_template","aws_elastic_beanstalk_application,aws_elastic_beanstalk_hosted_zone,aws_elastic_beanstalk_solution_stack",Compute,Icons/Arch_Compute/48/Arch_AWS-Elastic-Beanstalk_48.png\nElastic Transcoder,aws_elastictranscoder_pipeline,aws_elastictranscoder_preset,,Media Services,Icons/Arch_Media-Services/48/Arch_Amazon-Elastic-Transcoder_48.png\nElasticsearch,aws_elasticsearch_domain,"aws_elasticsearch_domain_policy,aws_elasticsearch_domain_saml_options,aws_elasticsearch_vpc_endpoint",aws_elasticsearch_domain,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.png \nElemental MediaConvert,,aws_media_convert_queue,aws_media_convert_queue,Media Services,Icons/Arch_Media-Services/48/Arch_AWS-Elemental-MediaConvert_48.png\nElemental MediaLive,aws_medialive_channel,"aws_medialive_input,aws_medialive_input_security_group,aws_medialive_multiplex,aws_medialive_multiplex_program",,Media Services,Icons/Arch_Media-Services/48/Arch_AWS-Elemental-MediaLive_48.png\nElemental MediaPackage,aws_media_package_channel,,,Media Services,Icons/Arch_Media-Services/48/Arch_AWS-Elemental-MediaPackage_48.png\nElemental MediaStore,aws_media_store_container,aws_media_store_container_policy,,Media Services,Icons/Arch_Media-Services/48/Arch_AWS-Elemental-MediaStore_48.png\nEventBridge,"aws_cloudwatch_event_bus,aws_cloudwatch_event_rule","aws_cloudwatch_event_api_destination,aws_cloudwatch_event_archive,aws_cloudwatch_event_bus_policy,aws_cloudwatch_event_connection,aws_cloudwatch_event_endpoint,aws_cloudwatch_event_permission,aws_cloudwatch_event_target","aws_cloudwatch_event_bus,aws_cloudwatch_event_connection,aws_cloudwatch_event_source",App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-EventBridge_48.png\nEventBridge Pipes,aws_pipes_pipe,,,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-EventBridge_48.png \nEventBridge Scheduler,"aws_scheduler_schedule,aws_scheduler_schedule_group",,,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-EventBridge_48.png \nEventBridge Schemas,aws_schemas_schema,"aws_schemas_discoverer,aws_schemas_registry,aws_schemas_registry_policy",,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-EventBridge_48.png \nFIS,aws_fis_experiment_template,,,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Fault-Injection-Simulator_48.png\nFMS,aws_fms_policy,aws_fms_admin_account,,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Firewall-Manager_48.png\nFSx,aws_fsx_file_system,"aws_fsx_backup,aws_fsx_data_repository_association,aws_fsx_file_cache,aws_fsx_lustre_file_system,aws_fsx_ontap_file_system,aws_fsx_ontap_storage_virtual_machine,aws_fsx_ontap_volume,aws_fsx_openzfs_file_system,aws_fsx_openzfs_snapshot,aws_fsx_openzfs_volume,aws_fsx_windows_file_system","aws_fsx_ontap_file_system,aws_fsx_ontap_storage_virtual_machine,aws_fsx_ontap_storage_virtual_machines,aws_fsx_openzfs_snapshot,aws_fsx_windows_file_system",Storage,Icons/Arch_Storage/48/Arch_Amazon-FSx_48.png\nFinSpace,,"aws_finspace_kx_cluster,aws_finspace_kx_database,aws_finspace_kx_environment,aws_finspace_kx_user",,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-FinSpace_48.png\nGameLift,aws_gamelift_fleet,"aws_gamelift_alias,aws_gamelift_build,aws_gamelift_game_server_group,aws_gamelift_game_session_queue,aws_gamelift_script",,Games,Icons/Arch_Games/48/Arch_Amazon-GameLift_48.png\nGlobal Accelerator,aws_globalaccelerator_accelerator,"aws_globalaccelerator_custom_routing_accelerator,aws_globalaccelerator_custom_routing_endpoint_group,aws_globalaccelerator_custom_routing_listener,aws_globalaccelerator_endpoint_group,aws_globalaccelerator_listener","aws_globalaccelerator_accelerator,aws_globalaccelerator_custom_routing_accelerator",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_AWS-Global-Accelerator_48.png\nGlue,"aws_glue_catalog_database,aws_glue_job,aws_glue_crawler","aws_glue_catalog_table,aws_glue_classifier,aws_glue_connection,aws_glue_data_catalog_encryption_settings,aws_glue_data_quality_ruleset,aws_glue_dev_endpoint,aws_glue_ml_transform,aws_glue_partition,aws_glue_partition_index,aws_glue_registry,aws_glue_resource_policy,aws_glue_schema,aws_glue_security_configuration,aws_glue_trigger,aws_glue_user_defined_function,aws_glue_workflow","aws_glue_catalog_table,aws_glue_connection,aws_glue_data_catalog_encryption_settings,aws_glue_script",Analytics,Icons/Arch_Analytics/48/Arch_AWS-Glue_48.png\nGuardDuty,aws_guardduty_detector,"aws_guardduty_detector_feature,aws_guardduty_filter,aws_guardduty_invite_accepter,aws_guardduty_ipset,aws_guardduty_member,aws_guardduty_organization_admin_account,aws_guardduty_organization_configuration,aws_guardduty_organization_configuration_feature,aws_guardduty_publishing_destination,aws_guardduty_threatintelset","aws_guardduty_detector,aws_guardduty_finding_ids",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-GuardDuty_48.png\nIAM,"aws_iam_user,aws_iam_role,aws_iam_policy","aws_iam_access_key,aws_iam_account_alias,aws_iam_account_password_policy,aws_iam_group,aws_iam_group_membership,aws_iam_group_policy,aws_iam_group_policy_attachment,aws_iam_instance_profile,aws_iam_openid_connect_provider,aws_iam_policy_attachment,aws_iam_role_policy,aws_iam_role_policy_attachment,aws_iam_saml_provider,aws_iam_security_token_service_preferences,aws_iam_server_certificate,aws_iam_service_linked_role,aws_iam_service_specific_credential,aws_iam_signing_certificate,aws_iam_user_group_membership,aws_iam_user_login_profile,aws_iam_user_policy,aws_iam_user_policy_attachment,aws_iam_user_ssh_key,aws_iam_virtual_mfa_device","aws_iam_access_keys,aws_iam_account_alias,aws_iam_group,aws_iam_instance_profile,aws_iam_instance_profiles,aws_iam_openid_connect_provider,aws_iam_policy,aws_iam_policy_document,aws_iam_principal_policy_simulation,aws_iam_role,aws_iam_roles,aws_iam_saml_provider,aws_iam_server_certificate,aws_iam_session_context,aws_iam_user,aws_iam_user_ssh_key,aws_iam_users",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.png\nIAM Access Analyzer,aws_accessanalyzer_analyzer,aws_accessanalyzer_archive_rule,,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.png \nIVS,aws_ivs_channel,"aws_ivs_playback_key_pair,aws_ivs_recording_configuration",aws_ivs_stream_key,Media Services,Icons/Arch_Media-Services/48/Arch_Amazon-Interactive-Video-Service_48.png\nIVS Chat,aws_ivschat_room,aws_ivschat_logging_configuration,,Media Services,Icons/Arch_Media-Services/48/Arch_Amazon-Interactive-Video-Service_48.png \nInspector,,"aws_inspector2_delegated_admin_account,aws_inspector2_enabler,aws_inspector2_member_association,aws_inspector2_organization_configuration",,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-Inspector_48.png\nInspector Classic,aws_inspector_assessment_target,"aws_inspector_assessment_template,aws_inspector_resource_group",aws_inspector_rules_packages,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-Inspector_48.png \nIoT Core,"aws_iot_thing,aws_iot_policy","aws_iot_authorizer,aws_iot_billing_group,aws_iot_ca_certificate,aws_iot_certificate,aws_iot_domain_configuration,aws_iot_event_configurations,aws_iot_indexing_configuration,aws_iot_logging_options,aws_iot_policy_attachment,aws_iot_provisioning_template,aws_iot_role_alias,aws_iot_thing_group,aws_iot_thing_group_membership,aws_iot_thing_principal_attachment,aws_iot_thing_type,aws_iot_topic_rule,aws_iot_topic_rule_destination","aws_iot_endpoint,aws_iot_registration_code",Internet of Things,Icons/Arch_Internet-of-Things/48/Arch_AWS-IoT-Core_48.png\nKMS,aws_kms_key,"aws_kms_alias,aws_kms_ciphertext,aws_kms_custom_key_store,aws_kms_external_key,aws_kms_grant,aws_kms_key_policy,aws_kms_replica_external_key,aws_kms_replica_key","aws_kms_alias,aws_kms_ciphertext,aws_kms_custom_key_store,aws_kms_key,aws_kms_public_key,aws_kms_secret,aws_kms_secrets",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Key-Management-Service_48.png\nKendra,aws_kendra_index,"aws_kendra_data_source,aws_kendra_experience,aws_kendra_faq,aws_kendra_query_suggestions_block_list,aws_kendra_thesaurus","aws_kendra_experience,aws_kendra_faq,aws_kendra_index,aws_kendra_query_suggestions_block_list,aws_kendra_thesaurus",Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-Kendra_48.png\nKeyspaces,aws_keyspaces_table,aws_keyspaces_keyspace,,Database,Icons/Arch_Database/48/Arch_Amazon-Keyspaces_48.png\nKinesis,aws_kinesis_stream,aws_kinesis_stream_consumer,"aws_kinesis_stream,aws_kinesis_stream_consumer",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Kinesis_48.png\nKinesis Analytics,aws_kinesis_analytics_application,,,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Kinesis-Data-Streams_48.png \nKinesis Analytics V2,aws_kinesisanalyticsv2_application,aws_kinesisanalyticsv2_application_snapshot,,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Kinesis-Data-Streams_48.png \nKinesis Firehose,aws_kinesis_firehose_delivery_stream,,aws_kinesis_firehose_delivery_stream,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Kinesis-Data-Firehose_48.png\nKinesis Video,aws_kinesis_video_stream,,,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Kinesis-Video-Streams_48.png\nLake Formation,aws_lakeformation_resource,"aws_lakeformation_data_lake_settings,aws_lakeformation_lf_tag,aws_lakeformation_permissions,aws_lakeformation_resource_lf_tags","aws_lakeformation_data_lake_settings,aws_lakeformation_permissions,aws_lakeformation_resource",Analytics,Icons/Arch_Analytics/48/Arch_AWS-Lake-Formation_48.png\nLambda,aws_lambda_function,"aws_lambda_alias,aws_lambda_code_signing_config,aws_lambda_event_source_mapping,aws_lambda_function_event_invoke_config,aws_lambda_function_url,aws_lambda_invocation,aws_lambda_layer_version,aws_lambda_layer_version_permission,aws_lambda_permission,aws_lambda_provisioned_concurrency_config","aws_lambda_alias,aws_lambda_code_signing_config,aws_lambda_function,aws_lambda_function_url,aws_lambda_functions,aws_lambda_invocation,aws_lambda_layer_version",Compute,Icons/Arch_Compute/48/Arch_AWS-Lambda_48.png\nLex Model Building,aws_lex_bot,"aws_lex_bot_alias,aws_lex_intent,aws_lex_slot_type","aws_lex_bot,aws_lex_bot_alias,aws_lex_intent,aws_lex_slot_type",Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-Lex_48.png \nLex V2 Models,aws_lexv2models_bot,"aws_lexv2models_bot_locale,aws_lexv2models_bot_version",,Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-Lex_48.png \nLicense Manager,aws_licensemanager_license_configuration,"aws_licensemanager_association,aws_licensemanager_grant,aws_licensemanager_grant_accepter","aws_licensemanager_grants,aws_licensemanager_received_license,aws_licensemanager_received_licenses",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-License-Manager_48.png\nLightsail,"aws_lightsail_instance,aws_lightsail_bucket","aws_lightsail_bucket_access_key,aws_lightsail_bucket_resource_access,aws_lightsail_certificate,aws_lightsail_container_service,aws_lightsail_container_service_deployment_version,aws_lightsail_database,aws_lightsail_disk,aws_lightsail_disk_attachment,aws_lightsail_distribution,aws_lightsail_domain,aws_lightsail_domain_entry,aws_lightsail_instance_public_ports,aws_lightsail_key_pair,aws_lightsail_lb,aws_lightsail_lb_attachment,aws_lightsail_lb_certificate,aws_lightsail_lb_certificate_attachment,aws_lightsail_lb_https_redirection_policy,aws_lightsail_lb_stickiness_policy,aws_lightsail_static_ip,aws_lightsail_static_ip_attachment",,Compute,Icons/Arch_Compute/48/Arch_Amazon-Lightsail_48.png\nLocation,aws_location_router_calculator,"aws_location_geofence_collection,aws_location_map,aws_location_place_index,aws_location_route_calculator,aws_location_tracker,aws_location_tracker_association","aws_location_geofence_collection,aws_location_map,aws_location_place_index,aws_location_route_calculator,aws_location_tracker,aws_location_tracker_association,aws_location_tracker_associations",Front End Web Mobile,Icons/Arch_Front-End-Web-Mobile/48/Arch_Amazon-Location-Service_48.png\nMQ,aws_mq_broker,aws_mq_configuration,"aws_mq_broker,aws_mq_broker_instance_type_offerings",App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-MQ_48.png\nMWAA,aws_mwaa_environment,,,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-Managed-Workflows-for-Apache-Airflow_48.png\nMacie,aws_macie2_account,"aws_macie2_classification_export_configuration,aws_macie2_classification_job,aws_macie2_custom_data_identifier,aws_macie2_findings_filter,aws_macie2_invitation_accepter,aws_macie2_member,aws_macie2_organization_admin_account",,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_Amazon-Macie_48.png\nManaged Grafana,aws_grafana_workspace,"aws_grafana_license_association,aws_grafana_role_association,aws_grafana_workspace_api_key,aws_grafana_workspace_saml_configuration",aws_grafana_workspace,Management Governance,Icons/Arch_Management-Governance/48/Arch_Amazon-Managed-Grafana_48.png\nManaged Streaming for Kafka,aws_msk_cluster,"aws_msk_cluster_policy,aws_msk_configuration,aws_msk_replicator,aws_msk_scram_secret_association,aws_msk_serverless_cluster,aws_msk_vpc_connection","aws_msk_broker_nodes,aws_msk_cluster,aws_msk_configuration,aws_msk_kafka_version,aws_msk_vpc_connection",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Managed-Streaming-for-Apache-Kafka_48.png\nManaged Streaming for Kafka Connect,aws_mskconnect_connector,"aws_mskconnect_custom_plugin,aws_mskconnect_worker_configuration","aws_mskconnect_connector,aws_mskconnect_custom_plugin,aws_mskconnect_worker_configuration",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Managed-Streaming-for-Apache-Kafka_48.png \nMemoryDB for Redis,aws_memorydb_cluster,"aws_memorydb_acl,aws_memorydb_parameter_group,aws_memorydb_snapshot,aws_memorydb_subnet_group,aws_memorydb_user","aws_memorydb_acl,aws_memorydb_cluster,aws_memorydb_parameter_group,aws_memorydb_snapshot,aws_memorydb_subnet_group,aws_memorydb_user,aws_arn,aws_billing_service_account,aws_default_tags,aws_ip_ranges,aws_partition,aws_region,aws_regions,aws_service",Database,Icons/Arch_Database/48/Arch_Amazon-MemoryDB-for-Redis_48.png\nMeta Data Sources,,"aws_arn,aws_billing_service_account,aws_default_tags,aws_ip_ranges,aws_partition,aws_region,aws_regions,aws_service",,Unknown,Icons/\nNeptune,aws_neptune_cluster,"aws_neptune_cluster_endpoint,aws_neptune_cluster_instance,aws_neptune_cluster_parameter_group,aws_neptune_cluster_snapshot,aws_neptune_event_subscription,aws_neptune_global_cluster,aws_neptune_parameter_group,aws_neptune_subnet_group","aws_neptune_engine_version,aws_neptune_orderable_db_instance",Database,Icons/Arch_Database/48/Arch_Amazon-Neptune_48.png\nNetwork Firewall,aws_networkfirewall_firewall,"aws_networkfirewall_firewall_policy,aws_networkfirewall_logging_configuration,aws_networkfirewall_resource_policy,aws_networkfirewall_rule_group","aws_networkfirewall_firewall,aws_networkfirewall_firewall_policy,aws_networkfirewall_resource_policy",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Network-Firewall_48.png\nNetwork Manager,aws_networkmanager_global_network,"aws_networkmanager_attachment_accepter,aws_networkmanager_connect_attachment,aws_networkmanager_connect_peer,aws_networkmanager_connection,aws_networkmanager_core_network,aws_networkmanager_core_network_policy_attachment,aws_networkmanager_customer_gateway_association,aws_networkmanager_device,aws_networkmanager_link,aws_networkmanager_link_association,aws_networkmanager_site,aws_networkmanager_site_to_site_vpn_attachment,aws_networkmanager_transit_gateway_connect_peer_association,aws_networkmanager_transit_gateway_peering,aws_networkmanager_transit_gateway_registration,aws_networkmanager_transit_gateway_route_table_attachment,aws_networkmanager_vpc_attachment","aws_networkmanager_connection,aws_networkmanager_connections,aws_networkmanager_core_network_policy_document,aws_networkmanager_device,aws_networkmanager_devices,aws_networkmanager_global_network,aws_networkmanager_global_networks,aws_networkmanager_link,aws_networkmanager_links,aws_networkmanager_site,aws_networkmanager_sites",Networking Content Delivery,Icons/\nOpenSearch,aws_opensearch_domain,"aws_opensearch_domain_policy,aws_opensearch_domain_saml_options,aws_opensearch_inbound_connection_accepter,aws_opensearch_outbound_connection,aws_opensearch_package,aws_opensearch_package_association,aws_opensearch_vpc_endpoint",aws_opensearch_domain,Analytics,Icons/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.png\nOpenSearch Serverless,aws_opensearchserverless_collection,"aws_opensearchserverless_access_policy,aws_opensearchserverless_lifecycle_policy,aws_opensearchserverless_security_config,aws_opensearchserverless_security_policy,aws_opensearchserverless_vpc_endpoint","aws_opensearchserverless_access_policy,aws_opensearchserverless_collection,aws_opensearchserverless_lifecycle_policy,aws_opensearchserverless_security_config,aws_opensearchserverless_security_policy,aws_opensearchserverless_vpc_endpoint",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.png \nOpsWorks,aws_opsworks_stack,"aws_opsworks_application,aws_opsworks_custom_layer,aws_opsworks_ecs_cluster_layer,aws_opsworks_ganglia_layer,aws_opsworks_haproxy_layer,aws_opsworks_instance,aws_opsworks_java_app_layer,aws_opsworks_memcached_layer,aws_opsworks_mysql_layer,aws_opsworks_nodejs_app_layer,aws_opsworks_permission,aws_opsworks_php_app_layer,aws_opsworks_rails_app_layer,aws_opsworks_rds_db_instance,aws_opsworks_static_web_layer,aws_opsworks_user_profile",,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-OpsWorks_48.png\nOrganizations,aws_organizations_organization,"aws_organizations_account,aws_organizations_delegated_administrator,aws_organizations_organizational_unit,aws_organizations_policy,aws_organizations_policy_attachment,aws_organizations_resource_policy","aws_organizations_delegated_administrators,aws_organizations_delegated_services,aws_organizations_organization,aws_organizations_organizational_unit,aws_organizations_organizational_unit_child_accounts,aws_organizations_organizational_unit_descendant_accounts,aws_organizations_organizational_units,aws_organizations_policies,aws_organizations_policies_for_target,aws_organizations_policy,aws_organizations_resource_tags",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Organizations_48.png\nOutposts,aws_outposts_outpost,,"aws_outposts_asset,aws_outposts_assets,aws_outposts_outpost,aws_outposts_outpost_instance_type,aws_outposts_outpost_instance_types,aws_outposts_outposts,aws_outposts_site,aws_outposts_sites",Compute,Icons/Arch_Compute/48/Arch_AWS-Outposts-family_48.png\nOutposts (EC2),,"aws_ec2_local_gateway_route,aws_ec2_local_gateway_route_table_vpc_association","aws_ec2_coip_pool,aws_ec2_coip_pools,aws_ec2_local_gateway,aws_ec2_local_gateway_route_table,aws_ec2_local_gateway_route_tables,aws_ec2_local_gateway_virtual_interface,aws_ec2_local_gateway_virtual_interface_group,aws_ec2_local_gateway_virtual_interface_groups,aws_ec2_local_gateways",Compute,Icons/Arch_Compute/48/Arch_AWS-Outposts-family_48.png \nPinpoint,aws_pinpoint_app,"aws_pinpoint_adm_channel,aws_pinpoint_apns_channel,aws_pinpoint_apns_sandbox_channel,aws_pinpoint_apns_voip_channel,aws_pinpoint_apns_voip_sandbox_channel,aws_pinpoint_baidu_channel,aws_pinpoint_email_channel,aws_pinpoint_event_stream,aws_pinpoint_gcm_channel,aws_pinpoint_sms_channel",,Marketing,Icons/\nPricing Calculator,,,aws_pricing_product,Unknown,Icons/\nQLDB,aws_qldb_ledger,aws_qldb_stream,aws_qldb_ledger,Database,Icons/Arch_Database/48/Arch_Amazon-Quantum-Ledger-Database_48.png\nQuickSight,aws_quicksight_analysis,"aws_quicksight_account_subscription,aws_quicksight_dashboard,aws_quicksight_data_set,aws_quicksight_data_source,aws_quicksight_folder,aws_quicksight_folder_membership,aws_quicksight_group,aws_quicksight_group_membership,aws_quicksight_iam_policy_assignment,aws_quicksight_ingestion,aws_quicksight_namespace,aws_quicksight_refresh_schedule,aws_quicksight_template,aws_quicksight_template_alias,aws_quicksight_theme,aws_quicksight_user,aws_quicksight_vpc_connection","aws_quicksight_data_set,aws_quicksight_group,aws_quicksight_theme,aws_quicksight_user",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-QuickSight_48.png\nRAM,aws_ram_resource_share,"aws_ram_principal_association,aws_ram_resource_association,aws_ram_resource_share_accepter,aws_ram_sharing_with_organization",aws_ram_resource_share,Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Resource-Access-Manager_48.png\nRDS,"aws_rds_cluster,aws_db_instance,aws_db_subnet_group","aws_db_cluster_snapshot,aws_db_event_subscription,aws_db_instance_automated_backups_replication,aws_db_instance_role_association,aws_db_option_group,aws_db_parameter_group,aws_db_proxy,aws_db_proxy_default_target_group,aws_db_proxy_endpoint,aws_db_proxy_target,aws_db_snapshot,aws_db_snapshot_copy,aws_rds_cluster_activity_stream,aws_rds_cluster_endpoint,aws_rds_cluster_instance,aws_rds_cluster_parameter_group,aws_rds_cluster_role_association,aws_rds_custom_db_engine_version,aws_rds_export_task,aws_rds_global_cluster,aws_rds_reserved_instance","aws_db_cluster_snapshot,aws_db_event_categories,aws_db_instance,aws_db_instances,aws_db_proxy,aws_db_snapshot,aws_db_subnet_group,aws_rds_certificate,aws_rds_cluster,aws_rds_clusters,aws_rds_engine_version,aws_rds_orderable_db_instance,aws_rds_reserved_instance_offering",Database,Icons/Arch_Database/48/Arch_Amazon-RDS_48.png\nRecycle Bin,aws_rbin_rule,,,Storage,Icons/\nRedshift,aws_redshift_cluster,"aws_redshift_authentication_profile,aws_redshift_cluster_iam_roles,aws_redshift_cluster_snapshot,aws_redshift_endpoint_access,aws_redshift_endpoint_authorization,aws_redshift_event_subscription,aws_redshift_hsm_client_certificate,aws_redshift_hsm_configuration,aws_redshift_parameter_group,aws_redshift_partner,aws_redshift_resource_policy,aws_redshift_scheduled_action,aws_redshift_snapshot_copy_grant,aws_redshift_snapshot_schedule,aws_redshift_snapshot_schedule_association,aws_redshift_subnet_group,aws_redshift_usage_limit","aws_redshift_cluster,aws_redshift_cluster_credentials,aws_redshift_orderable_cluster,aws_redshift_service_account,aws_redshift_subnet_group",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Redshift_48.png\nRedshift Serverless,aws_redshiftserverless_namespace,"aws_redshiftserverless_endpoint_access,aws_redshiftserverless_resource_policy,aws_redshiftserverless_snapshot,aws_redshiftserverless_usage_limit,aws_redshiftserverless_workgroup","aws_redshiftserverless_credentials,aws_redshiftserverless_namespace,aws_redshiftserverless_workgroup",Analytics,Icons/Arch_Analytics/48/Arch_Amazon-Redshift_48.png \nResource Explorer,aws_resourceexplorer2_index,aws_resourceexplorer2_view,,Management Governance,Icons/\nResource Groups,aws_resourcegroups_group,aws_resourcegroups_resource,,Management Governance,Icons/\nResource Groups Tagging,,,aws_resourcegroupstaggingapi_resources,Management Governance,Icons/\nRoles Anywhere,aws_rolesanywhere_trust_anchor,aws_rolesanywhere_profile,,Security Identity Compliance,Icons/\nRoute 53,aws_route53_zone,"aws_route53_cidr_collection,aws_route53_cidr_location,aws_route53_delegation_set,aws_route53_health_check,aws_route53_hosted_zone_dnssec,aws_route53_key_signing_key,aws_route53_query_log,aws_route53_record,aws_route53_traffic_policy,aws_route53_traffic_policy_instance,aws_route53_vpc_association_authorization,aws_route53_zone_association","aws_route53_delegation_set,aws_route53_traffic_policy_document,aws_route53_zone",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.png\nRoute 53 Domains,aws_route53domains_registered_domain,,,Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.png \nRoute 53 Recovery Control Config,aws_route53recoverycontrolconfig_cluster,"aws_route53recoverycontrolconfig_control_panel,aws_route53recoverycontrolconfig_routing_control,aws_route53recoverycontrolconfig_safety_rule",,Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.png \nRoute 53 Recovery Readiness,aws_route53recoveryreadiness_recovery_group,"aws_route53recoveryreadiness_cell,aws_route53recoveryreadiness_readiness_check,aws_route53recoveryreadiness_resource_set",,Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.png \nRoute 53 Resolver,aws_route53_resolver_endpoint,"aws_route53_resolver_config,aws_route53_resolver_dnssec_config,aws_route53_resolver_firewall_config,aws_route53_resolver_firewall_domain_list,aws_route53_resolver_firewall_rule,aws_route53_resolver_firewall_rule_group,aws_route53_resolver_firewall_rule_group_association,aws_route53_resolver_query_log_config,aws_route53_resolver_query_log_config_association,aws_route53_resolver_rule,aws_route53_resolver_rule_association","aws_route53_resolver_endpoint,aws_route53_resolver_firewall_config,aws_route53_resolver_firewall_domain_list,aws_route53_resolver_firewall_rule_group,aws_route53_resolver_firewall_rule_group_association,aws_route53_resolver_firewall_rules,aws_route53_resolver_query_log_config,aws_route53_resolver_rule,aws_route53_resolver_rules",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.png \nS3,aws_s3_bucket,"aws_s3_bucket_accelerate_configuration,aws_s3_bucket_acl,aws_s3_bucket_analytics_configuration,aws_s3_bucket_cors_configuration,aws_s3_bucket_intelligent_tiering_configuration,aws_s3_bucket_inventory,aws_s3_bucket_lifecycle_configuration,aws_s3_bucket_logging,aws_s3_bucket_metric,aws_s3_bucket_notification,aws_s3_bucket_object,aws_s3_bucket_object_lock_configuration,aws_s3_bucket_ownership_controls,aws_s3_bucket_policy,aws_s3_bucket_public_access_block,aws_s3_bucket_replication_configuration,aws_s3_bucket_request_payment_configuration,aws_s3_bucket_server_side_encryption_configuration,aws_s3_bucket_versioning,aws_s3_bucket_website_configuration,aws_s3_directory_bucket,aws_s3_object,aws_s3_object_copy","aws_canonical_user_id,aws_s3_bucket,aws_s3_bucket_object,aws_s3_bucket_objects,aws_s3_bucket_policy,aws_s3_directory_buckets,aws_s3_object,aws_s3_objects",Storage,Icons/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.png\nS3 Control,aws_s3control_bucket,"aws_s3_access_point,aws_s3_account_public_access_block,aws_s3control_access_grant,aws_s3control_access_grants_instance,aws_s3control_access_grants_instance_resource_policy,aws_s3control_access_grants_location,aws_s3control_access_point_policy,aws_s3control_bucket_lifecycle_configuration,aws_s3control_bucket_policy,aws_s3control_multi_region_access_point,aws_s3control_multi_region_access_point_policy,aws_s3control_object_lambda_access_point,aws_s3control_object_lambda_access_point_policy,aws_s3control_storage_lens_configuration","aws_s3_account_public_access_block,aws_s3control_multi_region_access_point",Storage,Icons/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.png \nS3 Glacier,aws_glacier_vault,aws_glacier_vault_lock,,Storage,Icons/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service-Glacier_48.png\nS3 on Outposts,aws_s3outposts_endpoint,,,Storage,Icons/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.png\nSDB,aws_simpledb_domain,,,Database,Icons/\nSES,aws_ses_domain_identity,"aws_ses_active_receipt_rule_set,aws_ses_configuration_set,aws_ses_domain_dkim,aws_ses_domain_identity_verification,aws_ses_domain_mail_from,aws_ses_email_identity,aws_ses_event_destination,aws_ses_identity_notification_topic,aws_ses_identity_policy,aws_ses_receipt_filter,aws_ses_receipt_rule,aws_ses_receipt_rule_set,aws_ses_template","aws_ses_active_receipt_rule_set,aws_ses_domain_identity,aws_ses_email_identity",Marketing,Icons/\nSESv2,aws_sesv2_email_identity,"aws_sesv2_account_vdm_attributes,aws_sesv2_configuration_set,aws_sesv2_configuration_set_event_destination,aws_sesv2_contact_list,aws_sesv2_dedicated_ip_assignment,aws_sesv2_dedicated_ip_pool,aws_sesv2_email_identity_feedback_attributes,aws_sesv2_email_identity_mail_from_attributes","aws_sesv2_configuration_set,aws_sesv2_dedicated_ip_pool,aws_sesv2_email_identity,aws_sesv2_email_identity_mail_from_attributes",Marketing,Icons/\nSFN,aws_sfn_state_machine,"aws_sfn_activity,aws_sfn_alias","aws_sfn_activity,aws_sfn_alias,aws_sfn_state_machine,aws_sfn_state_machine_versions",App Integration,Icons/Arch_App-Integration/48/Arch_AWS-Step-Functions_48.png\nSNS,aws_sns_topic,"aws_sns_platform_application,aws_sns_sms_preferences,aws_sns_topic_data_protection_policy,aws_sns_topic_policy,aws_sns_topic_subscription",aws_sns_topic,App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.png\nSQS,aws_sqs_queue,"aws_sqs_queue_policy,aws_sqs_queue_redrive_allow_policy,aws_sqs_queue_redrive_policy","aws_sqs_queue,aws_sqs_queues",App Integration,Icons/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.png\nSSM,aws_ssm_document,"aws_ssm_activation,aws_ssm_association,aws_ssm_default_patch_baseline,aws_ssm_maintenance_window,aws_ssm_maintenance_window_target,aws_ssm_maintenance_window_task,aws_ssm_parameter,aws_ssm_patch_baseline,aws_ssm_patch_group,aws_ssm_resource_data_sync,aws_ssm_service_setting","aws_ssm_document,aws_ssm_instances,aws_ssm_maintenance_windows,aws_ssm_parameter,aws_ssm_parameters_by_path,aws_ssm_patch_baseline",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.png\nSSM Contacts,aws_ssmcontacts_contact,"aws_ssmcontacts_contact_channel,aws_ssmcontacts_plan","aws_ssmcontacts_contact,aws_ssmcontacts_contact_channel,aws_ssmcontacts_plan",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.png \nSSM Incident Manager Incidents,aws_ssmincidents_response_plan,aws_ssmincidents_replication_set,"aws_ssmincidents_replication_set,aws_ssmincidents_response_plan",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.png \nSSO Admin,aws_ssoadmin_managed_policy_attachment,"aws_ssoadmin_account_assignment,aws_ssoadmin_application,aws_ssoadmin_application_assignment,aws_ssoadmin_application_assignment_configuration,aws_ssoadmin_customer_managed_policy_attachment,aws_ssoadmin_instance_access_control_attributes,aws_ssoadmin_permission_set,aws_ssoadmin_permission_set_inline_policy,aws_ssoadmin_permissions_boundary_attachment","aws_ssoadmin_application,aws_ssoadmin_application_providers,aws_ssoadmin_instances,aws_ssoadmin_permission_set",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-IAM-Identity-Center_48.png \nSSO Identity Store,aws_identitystore_group,"aws_identitystore_group_membership,aws_identitystore_user","aws_identitystore_group,aws_identitystore_user",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-IAM-Identity-Center_48.png \nSTS,,,aws_caller_identity,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Security-Token-Service_48.png\nSWF,aws_swf_domain,,,App Integration,Icons/\nSageMaker,"aws_sagemaker_domain,aws_sagemaker_endpoint,aws_sagemaker_model","aws_sagemaker_app,aws_sagemaker_app_image_config,aws_sagemaker_code_repository,aws_sagemaker_data_quality_job_definition,aws_sagemaker_device,aws_sagemaker_device_fleet,aws_sagemaker_endpoint_configuration,aws_sagemaker_feature_group,aws_sagemaker_flow_definition,aws_sagemaker_human_task_ui,aws_sagemaker_image,aws_sagemaker_image_version,aws_sagemaker_model_package_group,aws_sagemaker_model_package_group_policy,aws_sagemaker_monitoring_schedule,aws_sagemaker_notebook_instance,aws_sagemaker_notebook_instance_lifecycle_configuration,aws_sagemaker_pipeline,aws_sagemaker_project,aws_sagemaker_servicecatalog_portfolio_status,aws_sagemaker_space,aws_sagemaker_studio_lifecycle_config,aws_sagemaker_user_profile,aws_sagemaker_workforce,aws_sagemaker_workteam",aws_sagemaker_prebuilt_ecr_image,Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-SageMaker_48.png\nSecrets Manager,aws_secretsmanager_secret,"aws_secretsmanager_secret_policy,aws_secretsmanager_secret_rotation,aws_secretsmanager_secret_version","aws_secretsmanager_random_password,aws_secretsmanager_secret,aws_secretsmanager_secret_rotation,aws_secretsmanager_secret_version,aws_secretsmanager_secrets",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.png\nSecurity Hub,aws_securityhub_account,"aws_securityhub_action_target,aws_securityhub_finding_aggregator,aws_securityhub_insight,aws_securityhub_invite_accepter,aws_securityhub_member,aws_securityhub_organization_admin_account,aws_securityhub_organization_configuration,aws_securityhub_product_subscription,aws_securityhub_standards_control,aws_securityhub_standards_subscription",,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Security-Hub_48.png\nSecurity Lake,aws_securitylake_data_lake,,,Security Identity Compliance,Icons/\nServerless Application Repository,aws_serverlessapplicationrepository_cloudformation_stack,,aws_serverlessapplicationrepository_application,Compute,Icons/Arch_Compute/48/Arch_AWS-Serverless-Application-Repository_48.png\nService Catalog,aws_servicecatalog_portfolio,"aws_servicecatalog_budget_resource_association,aws_servicecatalog_constraint,aws_servicecatalog_organizations_access,aws_servicecatalog_portfolio_share,aws_servicecatalog_principal_portfolio_association,aws_servicecatalog_product,aws_servicecatalog_product_portfolio_association,aws_servicecatalog_provisioned_product,aws_servicecatalog_provisioning_artifact,aws_servicecatalog_service_action,aws_servicecatalog_tag_option,aws_servicecatalog_tag_option_resource_association","aws_servicecatalog_constraint,aws_servicecatalog_launch_paths,aws_servicecatalog_portfolio,aws_servicecatalog_portfolio_constraints,aws_servicecatalog_product,aws_servicecatalog_provisioning_artifacts",Management Governance,Icons/Arch_Management-Governance/48/Arch_AWS-Service-Catalog_48.png\nService Quotas,aws_servicequotas_service_quota,"aws_servicequotas_template,aws_servicequotas_template_association","aws_servicequotas_service,aws_servicequotas_service_quota,aws_servicequotas_templates",Management Governance,Icons/\nShield,aws_shield_protection,"aws_shield_application_layer_automatic_response,aws_shield_drt_access_log_bucket_association,aws_shield_drt_access_role_arn_association,aws_shield_protection_group,aws_shield_protection_health_check_association",,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Shield_48.png\nSigner,aws_signer_signing_profile,"aws_signer_signing_job,aws_signer_signing_profile_permission","aws_signer_signing_job,aws_signer_signing_profile",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Signer_48.png\nStorage Gateway,aws_storagegateway_gateway,"aws_storagegateway_cache,aws_storagegateway_cached_iscsi_volume,aws_storagegateway_file_system_association,aws_storagegateway_nfs_file_share,aws_storagegateway_smb_file_share,aws_storagegateway_stored_iscsi_volume,aws_storagegateway_tape_pool,aws_storagegateway_upload_buffer,aws_storagegateway_working_storage",aws_storagegateway_local_disk,Storage,Icons/Arch_Storage/48/Arch_AWS-Storage-Gateway_48.png\nTimestream Write,aws_timestreamwrite_database,aws_timestreamwrite_table,,Database,Icons/Arch_Database/48/Arch_Amazon-Timestream_48.png\nTranscribe,,"aws_transcribe_language_model,aws_transcribe_medical_vocabulary,aws_transcribe_vocabulary,aws_transcribe_vocabulary_filter",,Machine Learning,Icons/Arch_Machine-Learning/48/Arch_Amazon-Transcribe_48.png\nTransfer Family,aws_transfer_server,"aws_transfer_access,aws_transfer_agreement,aws_transfer_certificate,aws_transfer_connector,aws_transfer_profile,aws_transfer_ssh_key,aws_transfer_tag,aws_transfer_user,aws_transfer_workflow",aws_transfer_server,Migration Transfer,Icons/Arch_Migration-Transfer/48/Arch_AWS-Transfer-Family_48.png\nTransit Gateway,aws_ec2_transit_gateway,"aws_ec2_transit_gateway_connect,aws_ec2_transit_gateway_connect_peer,aws_ec2_transit_gateway_multicast_domain,aws_ec2_transit_gateway_multicast_domain_association,aws_ec2_transit_gateway_multicast_group_member,aws_ec2_transit_gateway_multicast_group_source,aws_ec2_transit_gateway_peering_attachment,aws_ec2_transit_gateway_peering_attachment_accepter,aws_ec2_transit_gateway_policy_table,aws_ec2_transit_gateway_policy_table_association,aws_ec2_transit_gateway_prefix_list_reference,aws_ec2_transit_gateway_route,aws_ec2_transit_gateway_route_table,aws_ec2_transit_gateway_route_table_association,aws_ec2_transit_gateway_route_table_propagation,aws_ec2_transit_gateway_vpc_attachment,aws_ec2_transit_gateway_vpc_attachment_accepter","aws_ec2_transit_gateway,aws_ec2_transit_gateway_attachment,aws_ec2_transit_gateway_attachments,aws_ec2_transit_gateway_connect,aws_ec2_transit_gateway_connect_peer,aws_ec2_transit_gateway_dx_gateway_attachment,aws_ec2_transit_gateway_multicast_domain,aws_ec2_transit_gateway_peering_attachment,aws_ec2_transit_gateway_route_table,aws_ec2_transit_gateway_route_table_associations,aws_ec2_transit_gateway_route_table_propagations,aws_ec2_transit_gateway_route_table_routes,aws_ec2_transit_gateway_route_tables,aws_ec2_transit_gateway_vpc_attachment,aws_ec2_transit_gateway_vpc_attachments,aws_ec2_transit_gateway_vpn_attachment",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_AWS-Transit-Gateway_48.png\nVPC,"aws_vpc,aws_subnet,aws_security_group,aws_nat_gateway,aws_internet_gateway","aws_default_network_acl,aws_default_route_table,aws_default_security_group,aws_default_subnet,aws_default_vpc,aws_default_vpc_dhcp_options,aws_ec2_managed_prefix_list,aws_ec2_managed_prefix_list_entry,aws_ec2_network_insights_analysis,aws_ec2_network_insights_path,aws_ec2_subnet_cidr_reservation,aws_ec2_traffic_mirror_filter,aws_ec2_traffic_mirror_filter_rule,aws_ec2_traffic_mirror_session,aws_ec2_traffic_mirror_target,aws_egress_only_internet_gateway,aws_flow_log,aws_internet_gateway_attachment,aws_main_route_table_association,aws_network_acl,aws_network_acl_association,aws_network_acl_rule,aws_network_interface,aws_network_interface_attachment,aws_network_interface_sg_attachment,aws_route,aws_route_table,aws_route_table_association,aws_security_group_rule,aws_vpc_dhcp_options,aws_vpc_dhcp_options_association,aws_vpc_endpoint,aws_vpc_endpoint_connection_accepter,aws_vpc_endpoint_connection_notification,aws_vpc_endpoint_policy,aws_vpc_endpoint_route_table_association,aws_vpc_endpoint_security_group_association,aws_vpc_endpoint_service,aws_vpc_endpoint_service_allowed_principal,aws_vpc_endpoint_subnet_association,aws_vpc_ipv4_cidr_block_association,aws_vpc_ipv6_cidr_block_association,aws_vpc_network_performance_metric_subscription,aws_vpc_peering_connection,aws_vpc_peering_connection_accepter,aws_vpc_peering_connection_options,aws_vpc_security_group_egress_rule,aws_vpc_security_group_ingress_rule","aws_ec2_managed_prefix_list,aws_ec2_managed_prefix_lists,aws_ec2_network_insights_analysis,aws_ec2_network_insights_path,aws_internet_gateway,aws_nat_gateway,aws_nat_gateways,aws_network_acls,aws_network_interface,aws_network_interfaces,aws_prefix_list,aws_route,aws_route_table,aws_route_tables,aws_security_group,aws_security_groups,aws_subnet,aws_subnets,aws_vpc,aws_vpc_dhcp_options,aws_vpc_endpoint,aws_vpc_endpoint_service,aws_vpc_peering_connection,aws_vpc_peering_connections,aws_vpc_security_group_rule,aws_vpc_security_group_rules,aws_vpcs",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Virtual-Private-Cloud_48.png\nVPC IPAM,aws_vpc_ipam,"aws_vpc_ipam_organization_admin_account,aws_vpc_ipam_pool,aws_vpc_ipam_pool_cidr,aws_vpc_ipam_pool_cidr_allocation,aws_vpc_ipam_preview_next_cidr,aws_vpc_ipam_resource_discovery,aws_vpc_ipam_resource_discovery_association,aws_vpc_ipam_scope","aws_vpc_ipam_pool,aws_vpc_ipam_pool_cidrs,aws_vpc_ipam_pools,aws_vpc_ipam_preview_next_cidr",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-Virtual-Private-Cloud_48.png \nVPC Lattice,aws_vpclattice_service,"aws_vpclattice_access_log_subscription,aws_vpclattice_auth_policy,aws_vpclattice_listener,aws_vpclattice_listener_rule,aws_vpclattice_resource_policy,aws_vpclattice_service_network,aws_vpclattice_service_network_service_association,aws_vpclattice_service_network_vpc_association,aws_vpclattice_target_group,aws_vpclattice_target_group_attachment","aws_vpclattice_auth_policy,aws_vpclattice_listener,aws_vpclattice_resource_policy,aws_vpclattice_service,aws_vpclattice_service_network",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_Amazon-VPC-Lattice_48.png\nVPN,"aws_vpn_gateway,aws_vpn_connection","aws_customer_gateway,aws_vpn_connection_route,aws_vpn_gateway_attachment,aws_vpn_gateway_route_propagation","aws_customer_gateway,aws_vpn_gateway",Networking Content Delivery,Icons/Arch_Networking-Content-Delivery/48/Arch_AWS-Site-to-Site-VPN_48.png\nVerified Access,aws_verifiedaccess_endpoint,"aws_verifiedaccess_group,aws_verifiedaccess_instance,aws_verifiedaccess_instance_logging_configuration,aws_verifiedaccess_instance_trust_provider_attachment,aws_verifiedaccess_trust_provider",,Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-Verified-Access_48.png\nWAF,aws_wafv2_web_acl,"aws_wafv2_ip_set,aws_wafv2_regex_pattern_set,aws_wafv2_rule_group,aws_wafv2_web_acl_association,aws_wafv2_web_acl_logging_configuration","aws_wafv2_ip_set,aws_wafv2_regex_pattern_set,aws_wafv2_rule_group,aws_wafv2_web_acl",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-WAF_48.png\nWAF Classic,aws_waf_web_acl,"aws_waf_byte_match_set,aws_waf_geo_match_set,aws_waf_ipset,aws_waf_rate_based_rule,aws_waf_regex_match_set,aws_waf_regex_pattern_set,aws_waf_rule,aws_waf_rule_group,aws_waf_size_constraint_set,aws_waf_sql_injection_match_set,aws_waf_xss_match_set","aws_waf_ipset,aws_waf_rate_based_rule,aws_waf_rule,aws_waf_subscribed_rule_group,aws_waf_web_acl",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-WAF_48.png \nWAF Classic Regional,aws_wafregional_web_acl,"aws_wafregional_byte_match_set,aws_wafregional_geo_match_set,aws_wafregional_ipset,aws_wafregional_rate_based_rule,aws_wafregional_regex_match_set,aws_wafregional_regex_pattern_set,aws_wafregional_rule,aws_wafregional_rule_group,aws_wafregional_size_constraint_set,aws_wafregional_sql_injection_match_set,aws_wafregional_web_acl_association,aws_wafregional_xss_match_set","aws_wafregional_ipset,aws_wafregional_rate_based_rule,aws_wafregional_rule,aws_wafregional_subscribed_rule_group,aws_wafregional_web_acl",Security Identity Compliance,Icons/Arch_Security-Identity-Compliance/48/Arch_AWS-WAF_48.png \nWavelength,aws_ec2_carrier_gateway,,,Compute,Icons/Arch_Compute/48/Arch_AWS-Wavelength_48.png\nWeb Services Budgets,aws_budgets_budget,aws_budgets_budget_action,aws_budgets_budget,Cloud Financial Management,Icons/\nWorkLink,aws_worklink_fleet,aws_worklink_website_certificate_authority_association,,End User Computing,Icons/Arch_End-User-Computing/48/Arch_Amazon-WorkLink_48.png\nWorkSpaces,aws_workspaces_workspace,"aws_workspaces_connection_alias,aws_workspaces_directory,aws_workspaces_ip_group","aws_workspaces_bundle,aws_workspaces_directory,aws_workspaces_image,aws_workspaces_workspace",End User Computing,Icons/Arch_End-User-Computing/48/Arch_Amazon-WorkSpaces-Family_48.png\nX-Ray,aws_xray_group,"aws_xray_encryption_config,aws_xray_sampling_rule",,Developer Tools,Icons/Arch_Developer-Tools/48/Arch_AWS-X-Ray_48.png',{delimiter:",",header:!0});console.log("jsonArray",r),e.subgraphs.forEach((e=>{e.nodes.forEach((e=>{let t=e.id.split(" ")[1];if(t){const{processedBlockId:s,isResourceWithName:a,moduleName:c}=o(t);if(a){const{resourceType:t,resourceName:o}=i(s);t&&o&&r&&r.data.forEach((r=>{r["Main Diagram Blocks"].split(",").some((e=>e===t))&&n.set(e.id.split(" ")[1],{nodes:[e],mainNode:e,name:o,type:t,serviceName:r["Service Name"],iconPath:r["Icon Path"].trim(),connectionsIn:[],connectionsOut:[],moduleName:c})}))}}}))})),console.log("nodeGroups1",n),n.forEach((t=>{console.log("nodeGroup for edges analysis",t),s(t.mainNode,t,n,e.subgraphs[0],!0,r),s(t.mainNode,t,n,e.subgraphs[0],!1,r)})),console.log("FINISHED ANALYSIS EDGES",n),e.subgraphs[0].edges.forEach((e=>{const t=e.targets[0].id,r=e.targets[1].id,o=Array.from(n).filter((e=>{let[n,r]=e;return r.nodes.some((e=>e.id===t))}))[0],i=Array.from(n).filter((e=>{let[t,n]=e;return n.nodes.some((e=>e.id===r))}))[0];if(o&&i&&o!==i){const e=o[0],t=i[0];o[1].connectionsOut.includes(t)||i[1].connectionsIn.includes(e)||(o[1].connectionsOut.push(t),i[1].connectionsIn.push(e))}})),console.log("nodeGroups",n),(e=>{const n=new(uE().graphlib.Graph)({compound:!0});n.setGraph({rankdir:"TB",ranksep:120}),n.setDefaultEdgeLabel((function(){return{}})),e.forEach(((e,t)=>{n.setNode(t,{label:e.name,width:120,height:120}),e.connectionsOut.forEach((e=>{n.setEdge(t,e)})),e.moduleName&&(n.hasNode("module."+e.moduleName)||n.setNode("module."+e.moduleName,{label:e.moduleName}),n.setParent(t,"module."+e.moduleName))})),uE().layout(n);const r=Date.now();null==t||t.createShapes(n.nodes().filter((e=>n.children(e)&&n.children(e).length>0)).map((e=>{const t=n.node(e);return{id:"shape:"+e+r,type:"frame",x:t.x-t.width/2,y:t.y-t.height/2,props:{name:e,w:t.width,h:t.height}}}))),null==t||t.createShapes(n.nodes().filter((e=>!n.children(e)||0===n.children(e).length)).map((t=>{var o;const i=n.node(t);return{id:"shape:"+t+r,type:"node",x:i.x-i.width/2,y:i.y-i.height/2,props:{name:i.label,iconPath:null===(o=e.get(t))||void 0===o?void 0:o.iconPath}}})));const o=[];e.forEach(((n,i)=>{n.connectionsOut.forEach((n=>{if(e.get(n)){const e=null==t?void 0:t.getShape("shape:"+i+r),s=null==t?void 0:t.getShape("shape:"+n+r);e&&s&&o.push({id:"shape:"+i+"-"+n+r,type:"arrow",props:{size:"s",start:{type:"binding",boundShapeId:e.id,normalizedAnchor:{x:.5,y:.5},isExact:!1},end:{type:"binding",boundShapeId:s.id,normalizedAnchor:{x:.5,y:.5},isExact:!1}}})}}))})),null==t||t.createShapes(o),console.log("Created shapes",null==t?void 0:t.getPageShapeIds(t.getCurrentPage()))})(n)})(function(e,t){const n=function(e,t){return SE(e,t)}(e,t?.parse);if(Array.isArray(n)||"Attribute"===n.type||"AttributeList"===n.type||"Comment"===n.type||"NodeRef"===n.type||"NodeRefGroup"===n.type||"Literal"===n.type)throw new Error;return function(e,t){return new IE(t).convert(e)}(n,t?.convert)}(a.current.value)))},id:"render-button",children:"Render"})]})})};n.createRoot(document.getElementById("root")).render((0,Fr.jsx)(e.StrictMode,{children:(0,Fr.jsx)(NE,{})}))})()})();